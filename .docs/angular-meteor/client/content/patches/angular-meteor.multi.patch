From 837175cfa2a6792fcae90f541f68ad7e28bb0c58 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 00:46:56 +0300
Subject: [PATCH 001/215] Step 0.2: Remove all starter files

---
 socially.css  |  1 -
 socially.html | 14 --------------
 socially.js   | 23 -----------------------
 3 files changed, 38 deletions(-)
 delete mode 100644 socially.css
 delete mode 100644 socially.html
 delete mode 100644 socially.js

diff --git a/socially.css b/socially.css
deleted file mode 100644
index b6b4052..0000000
--- a/socially.css
+++ /dev/null
@@ -1 +0,0 @@
-/* CSS declarations go here */
diff --git a/socially.html b/socially.html
deleted file mode 100644
index cea01d7..0000000
--- a/socially.html
+++ /dev/null
@@ -1,14 +0,0 @@
-<head>
-  <title>socially</title>
-</head>
-
-<body>
-  <h1>Welcome to Meteor!</h1>
-
-  {{> hello}}
-</body>
-
-<template name="hello">
-  <button>Click Me</button>
-  <p>You've pressed the button {{counter}} times.</p>
-</template>
diff --git a/socially.js b/socially.js
deleted file mode 100644
index 4f8c65d..0000000
--- a/socially.js
+++ /dev/null
@@ -1,23 +0,0 @@
-if (Meteor.isClient) {
-  // counter starts at 0
-  Session.setDefault('counter', 0);
-
-  Template.hello.helpers({
-    counter: function () {
-      return Session.get('counter');
-    }
-  });
-
-  Template.hello.events({
-    'click button': function () {
-      // increment the counter when button is clicked
-      Session.set('counter', Session.get('counter') + 1);
-    }
-  });
-}
-
-if (Meteor.isServer) {
-  Meteor.startup(function () {
-    // code to run on server at startup
-  });
-}
-- 
2.3.2 (Apple Git-55)


From 504c01e454b92a4c6ac851d698b6a57c6c919355 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 14:23:47 +0300
Subject: [PATCH 002/215] Step 0.3: Create empty index.html file

---
 index.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 index.html

diff --git a/index.html b/index.html
new file mode 100644
index 0000000..ef412ef
--- /dev/null
+++ b/index.html
@@ -0,0 +1,3 @@
+<body>
+  <p>Nothing here</p>
+</body>
-- 
2.3.2 (Apple Git-55)


From 89a811d397c55566eb16b92e823786127906e36d Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 00:50:28 +0300
Subject: [PATCH 003/215] Step 0.4: Add the Angular package

---
 .meteor/packages | 1 +
 .meteor/versions | 4 ++++
 2 files changed, 5 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index a9f8340..03949b6 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,3 +18,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
+angular
diff --git a/.meteor/versions b/.meteor/versions
index e378b68..a702ca4 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,5 @@
+angular@1.0.0-rc.11
+angular:angular@1.4.6
 autopublish@1.0.4
 autoupdate@1.2.3
 babel-compiler@5.8.24_1
@@ -12,6 +14,7 @@ caching-compiler@1.0.0
 caching-html-compiler@1.0.1
 callback-hook@1.0.4
 check@1.0.6
+dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
 ddp-common@1.2.1
@@ -31,6 +34,7 @@ http@1.1.1
 id-map@1.0.4
 insecure@1.0.4
 jquery@1.11.4
+lai:collection-extensions@0.1.4
 launch-screen@1.0.4
 livedata@1.0.15
 logging@1.0.8
-- 
2.3.2 (Apple Git-55)


From 4049da5de2547362eadbd8fa446d8b33812e55ad Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 16 Oct 2015 17:27:24 +0300
Subject: [PATCH 004/215] Update angular to 1.0.2

---
 .meteor/packages | 2 +-
 .meteor/versions | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 03949b6..3216f31 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,4 +18,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
-angular
+angular@1.0.2
diff --git a/.meteor/versions b/.meteor/versions
index a702ca4..ea97952 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,4 +1,4 @@
-angular@1.0.0-rc.11
+angular@1.0.2
 angular:angular@1.4.6
 autopublish@1.0.4
 autoupdate@1.2.3
-- 
2.3.2 (Apple Git-55)


From a82fd7e74a9f01e7ef1a67956a2396160791fcc0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 16:47:59 +0300
Subject: [PATCH 005/215] Step 0.5: Move the main HTML content into
 index.ng.html

---
 index.ng.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 index.ng.html

diff --git a/index.ng.html b/index.ng.html
new file mode 100644
index 0000000..79ed426
--- /dev/null
+++ b/index.ng.html
@@ -0,0 +1 @@
+<p>Nothing here</p>
-- 
2.3.2 (Apple Git-55)


From 207a3d45dc1c310d2eb3e1e6cd9c9e5022d97202 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 16:49:45 +0300
Subject: [PATCH 006/215] Step 0.6: Include the angular main file inside the
 index.html file

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index ef412ef..bf21494 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
 <body>
-  <p>Nothing here</p>
+  <div ng-include="'index.ng.html'"></div>
 </body>
-- 
2.3.2 (Apple Git-55)


From edf9b48edc5a6619b2308829b25cb32c010a6c77 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:14:56 +0300
Subject: [PATCH 007/215] Step 0.7: Create app.js file to contain the AngularJS
 application

---
 app.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 app.js

diff --git a/app.js b/app.js
new file mode 100644
index 0000000..2465ea1
--- /dev/null
+++ b/app.js
@@ -0,0 +1,3 @@
+if (Meteor.isClient) {
+
+}
-- 
2.3.2 (Apple Git-55)


From fcdbd2429c8570c1a78278c794b03d89f5b1dfd6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:16:03 +0300
Subject: [PATCH 008/215] Step 0.8: Create AngularJS module and add
 angular-meteor dependency

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index 2465ea1..987f384 100644
--- a/app.js
+++ b/app.js
@@ -1,3 +1,3 @@
 if (Meteor.isClient) {
-
+  angular.module('socially',['angular-meteor']);
 }
-- 
2.3.2 (Apple Git-55)


From c9dd151a5487f16f3a54a27cf948374b8ab7fd88 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:25:28 +0300
Subject: [PATCH 009/215] Step 0.9: Add ng-app

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index bf21494..963f4fa 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
-<body>
+<body ng-app="socially">
   <div ng-include="'index.ng.html'"></div>
 </body>
-- 
2.3.2 (Apple Git-55)


From e4da0d69d90d100ccf826ce30b3d3bb94dd536f3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:31:28 +0300
Subject: [PATCH 010/215] Step 0.10: Add AngularJS code!

---
 index.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.ng.html b/index.ng.html
index 79ed426..a9c8ddc 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -1 +1 @@
-<p>Nothing here</p>
+<p>Nothing here {{ 'yet' + '!' }}</p>
-- 
2.3.2 (Apple Git-55)


From 00832c099f3496b855f6ed4d8ee81fe406093f3a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:18:08 +0300
Subject: [PATCH 011/215] Step 1.1: Add some static HTML the to main page

---
 index.ng.html | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/index.ng.html b/index.ng.html
index a9c8ddc..dd1ef68 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -1 +1,14 @@
-<p>Nothing here {{ 'yet' + '!' }}</p>
+<ul>
+  <li>
+    <span>Dubstep-Free Zone</span>
+    <p>
+      Can we please just for an evening not listen to dubstep.
+    </p>
+  </li>
+  <li>
+    <span>All dubstep all the time</span>
+    <p>
+      Get it on!
+    </p>
+  </li>
+</ul>
-- 
2.3.2 (Apple Git-55)


From 8ade441544e92af8b86d4f65286b959b46a2662c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:20:42 +0300
Subject: [PATCH 012/215] Step 2.1: Use dynamic template instead of static

---
 index.ng.html | 22 ++++++++--------------
 1 file changed, 8 insertions(+), 14 deletions(-)

diff --git a/index.ng.html b/index.ng.html
index dd1ef68..7f8c6d9 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -1,14 +1,8 @@
-<ul>
-  <li>
-    <span>Dubstep-Free Zone</span>
-    <p>
-      Can we please just for an evening not listen to dubstep.
-    </p>
-  </li>
-  <li>
-    <span>All dubstep all the time</span>
-    <p>
-      Get it on!
-    </p>
-  </li>
-</ul>
+<div ng-controller="PartiesListCtrl">
+  <ul>
+    <li ng-repeat="party in parties">
+      {{party.name}}
+      <p>{{party.description}}</p>
+    </li>
+  </ul>
+</div>
-- 
2.3.2 (Apple Git-55)


From 02dd1a8586769a2a1123e77d9009d9087a4e6451 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:22:53 +0300
Subject: [PATCH 013/215] Step 2.2: Add the parties controller

---
 app.js | 21 +++++++++++++++++++--
 1 file changed, 19 insertions(+), 2 deletions(-)

diff --git a/app.js b/app.js
index 987f384..9cbfb86 100644
--- a/app.js
+++ b/app.js
@@ -1,3 +1,20 @@
 if (Meteor.isClient) {
-  angular.module('socially',['angular-meteor']);
-}
+  angular.module('socially', ['angular-meteor']);
+
+  angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
+    $scope.parties = [
+      {
+        'name': 'Dubstep-Free Zone',
+        'description': 'Can we please just for an evening not listen to dubstep.'
+      },
+      {
+        'name': 'All dubstep all the time',
+        'description': 'Get it on!'
+      },
+      {
+        'name': 'Savage lounging',
+        'description': 'Leisure suit required. And only fiercest manners.'
+      }
+    ];
+  }]);
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4a82ce1c1cb12b871d78d64a49053d223745e245 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 16 Oct 2015 18:32:21 +0300
Subject: [PATCH 014/215] Step 2.3: Change `.js` to `.ng.js` extension

---
 app.js    | 20 --------------------
 app.ng.js | 20 ++++++++++++++++++++
 2 files changed, 20 insertions(+), 20 deletions(-)
 delete mode 100644 app.js
 create mode 100644 app.ng.js

diff --git a/app.js b/app.js
deleted file mode 100644
index 9cbfb86..0000000
--- a/app.js
+++ /dev/null
@@ -1,20 +0,0 @@
-if (Meteor.isClient) {
-  angular.module('socially', ['angular-meteor']);
-
-  angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
-    $scope.parties = [
-      {
-        'name': 'Dubstep-Free Zone',
-        'description': 'Can we please just for an evening not listen to dubstep.'
-      },
-      {
-        'name': 'All dubstep all the time',
-        'description': 'Get it on!'
-      },
-      {
-        'name': 'Savage lounging',
-        'description': 'Leisure suit required. And only fiercest manners.'
-      }
-    ];
-  }]);
-}
\ No newline at end of file
diff --git a/app.ng.js b/app.ng.js
new file mode 100644
index 0000000..9cbfb86
--- /dev/null
+++ b/app.ng.js
@@ -0,0 +1,20 @@
+if (Meteor.isClient) {
+  angular.module('socially', ['angular-meteor']);
+
+  angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
+    $scope.parties = [
+      {
+        'name': 'Dubstep-Free Zone',
+        'description': 'Can we please just for an evening not listen to dubstep.'
+      },
+      {
+        'name': 'All dubstep all the time',
+        'description': 'Get it on!'
+      },
+      {
+        'name': 'Savage lounging',
+        'description': 'Leisure suit required. And only fiercest manners.'
+      }
+    ];
+  }]);
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 52c7e04591549effd79ac3af78c7c461f3a18c48 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 16 Oct 2015 18:32:53 +0300
Subject: [PATCH 015/215] Step 2.4: Remove the DI double decleration

---
 app.ng.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/app.ng.js b/app.ng.js
index 9cbfb86..eaef6a3 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -1,7 +1,7 @@
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-  angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
+  angular.module('socially').controller('PartiesListCtrl', function ($scope) {
     $scope.parties = [
       {
         'name': 'Dubstep-Free Zone',
@@ -16,5 +16,5 @@ if (Meteor.isClient) {
         'description': 'Leisure suit required. And only fiercest manners.'
       }
     ];
-  }]);
+  });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e17ad9f03a090a8afd70dd68c45070d89f4e66dd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 22:15:32 +0300
Subject: [PATCH 016/215] Step 2.5: Add ng-strict-di directive to the ng-app

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index 963f4fa..cbd22c9 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
-<body ng-app="socially">
+<body ng-app="socially" ng-strict-di="">
   <div ng-include="'index.ng.html'"></div>
 </body>
-- 
2.3.2 (Apple Git-55)


From a7db4024327d53cfe3967c1f7bd3e9b5f967ce05 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:27:33 +0300
Subject: [PATCH 017/215] Step 3.1: Add the parties collection

---
 app.ng.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/app.ng.js b/app.ng.js
index eaef6a3..89788bb 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -1,3 +1,5 @@
+Parties = new Mongo.Collection("parties");
+
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-- 
2.3.2 (Apple Git-55)


From ca289953534ec38c9aa0ba0d83f7600ca01d86db Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:39:33 +0300
Subject: [PATCH 018/215] Step 3.2: Add the $meteor.collection to the $scope

---
 app.ng.js | 17 ++---------------
 1 file changed, 2 insertions(+), 15 deletions(-)

diff --git a/app.ng.js b/app.ng.js
index 89788bb..5c2763d 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -3,20 +3,7 @@ Parties = new Mongo.Collection("parties");
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-  angular.module('socially').controller('PartiesListCtrl', function ($scope) {
-    $scope.parties = [
-      {
-        'name': 'Dubstep-Free Zone',
-        'description': 'Can we please just for an evening not listen to dubstep.'
-      },
-      {
-        'name': 'All dubstep all the time',
-        'description': 'Get it on!'
-      },
-      {
-        'name': 'Savage lounging',
-        'description': 'Leisure suit required. And only fiercest manners.'
-      }
-    ];
+  angular.module('socially').controller('PartiesListCtrl',function ($scope) {
+    $scope.parties = $meteor.collection(Parties);
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2f370ac092db0ef63a65e2f7086e999bcf1667af Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:40:05 +0300
Subject: [PATCH 019/215] Step 3.3: Add a dependency to $meteor

---
 app.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.ng.js b/app.ng.js
index 5c2763d..89bb0f2 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -3,7 +3,7 @@ Parties = new Mongo.Collection("parties");
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-  angular.module('socially').controller('PartiesListCtrl',function ($scope) {
+  angular.module('socially').controller('PartiesListCtrl', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 71c0521caac0adf05da6484fe1ab1337affe955f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:43:17 +0300
Subject: [PATCH 020/215] Step 3.4: Add some data to the parties collection

---
 app.ng.js |  2 --
 server.js | 18 ++++++++++++++++++
 2 files changed, 18 insertions(+), 2 deletions(-)
 create mode 100644 server.js

diff --git a/app.ng.js b/app.ng.js
index 89bb0f2..da36506 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -1,5 +1,3 @@
-Parties = new Mongo.Collection("parties");
-
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
diff --git a/server.js b/server.js
new file mode 100644
index 0000000..3ce2ef4
--- /dev/null
+++ b/server.js
@@ -0,0 +1,18 @@
+Parties = new Mongo.Collection("parties");
+
+if (Meteor.isServer) {
+  Meteor.startup(function () {
+    if (Parties.find().count() === 0) {
+      var parties = [
+        {'name': 'Dubstep-Free Zone',
+          'description': 'Fast just got faster with Nexus S.'},
+        {'name': 'All dubstep all the time',
+          'description': 'Get it on!'},
+        {'name': 'Savage lounging',
+          'description': 'Leisure suit required. And only fiercest manners.'}
+      ];
+      for (var i = 0; i < parties.length; i++)
+        Parties.insert(parties[i]);
+    }
+  });
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7481fbe121e398f9428b0a859e3e9af18f1d69dd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:49:37 +0300
Subject: [PATCH 021/215] Step 4.1: Add basic form to the view

---
 index.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/index.ng.html b/index.ng.html
index 7f8c6d9..4880315 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -1,4 +1,11 @@
 <div ng-controller="PartiesListCtrl">
+  <form>
+    <label>Name</label>
+    <input>
+    <label>Description</label>
+    <input>
+    <button>Add</button>
+  </form>
   <ul>
     <li ng-repeat="party in parties">
       {{party.name}}
-- 
2.3.2 (Apple Git-55)


From a33a01a14403f43cf087c68b7b23c8d1de79fe84 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:50:38 +0300
Subject: [PATCH 022/215] Step 4.2: Add ng-model to the form's inputs

---
 index.ng.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/index.ng.html b/index.ng.html
index 4880315..ea6dc8f 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -1,9 +1,9 @@
 <div ng-controller="PartiesListCtrl">
   <form>
     <label>Name</label>
-    <input>
+    <input ng-model="newParty.name">
     <label>Description</label>
-    <input>
+    <input ng-model="newParty.description">
     <button>Add</button>
   </form>
   <ul>
-- 
2.3.2 (Apple Git-55)


From 9a552526b71640df3fd67c0feea31fb6e5b25f55 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:51:15 +0300
Subject: [PATCH 023/215] Step 4.3: Add ng-click logic to the "Add" button

---
 index.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.ng.html b/index.ng.html
index ea6dc8f..d39fd36 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -4,7 +4,7 @@
     <input ng-model="newParty.name">
     <label>Description</label>
     <input ng-model="newParty.description">
-    <button>Add</button>
+    <button ng-click="parties.push(newParty); newParty='';">Add</button>
   </form>
   <ul>
     <li ng-repeat="party in parties">
-- 
2.3.2 (Apple Git-55)


From 795249b01f920b10d2e4f6cec4db172592206e98 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:52:46 +0300
Subject: [PATCH 024/215] Step 4.4: Add delete button to the parties list

---
 index.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/index.ng.html b/index.ng.html
index d39fd36..614c3a0 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -10,6 +10,7 @@
     <li ng-repeat="party in parties">
       {{party.name}}
       <p>{{party.description}}</p>
+      <button ng-click="remove(party)">X</button>
     </li>
   </ul>
 </div>
-- 
2.3.2 (Apple Git-55)


From e906fd64f51f6e7dcbb24ef15f9b22da3751b7c7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:53:55 +0300
Subject: [PATCH 025/215] Step 4.5: Add remove logic to the controller

---
 app.ng.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/app.ng.js b/app.ng.js
index da36506..994968f 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -3,5 +3,9 @@ if (Meteor.isClient) {
 
   angular.module('socially').controller('PartiesListCtrl', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
+
+    $scope.remove = function(party){
+      $scope.parties.splice($scope.parties.indexOf(party), 1);
+    };
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1bc0069720137f5f06981d5ea174d9f8aa6d6945 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:55:39 +0300
Subject: [PATCH 026/215] Step 4.6: Replace push with save

---
 index.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.ng.html b/index.ng.html
index 614c3a0..68ec2ac 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -4,7 +4,7 @@
     <input ng-model="newParty.name">
     <label>Description</label>
     <input ng-model="newParty.description">
-    <button ng-click="parties.push(newParty); newParty='';">Add</button>
+    <button ng-click="parties.save(newParty); newParty='';">Add</button>
   </form>
   <ul>
     <li ng-repeat="party in parties">
-- 
2.3.2 (Apple Git-55)


From 83d8bcff5928d9bdfc0ccc1e6352b2902460496f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:56:41 +0300
Subject: [PATCH 027/215] Step 4.7: Use remove function instead of splice

---
 app.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.ng.js b/app.ng.js
index 994968f..30a428e 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -5,7 +5,7 @@ if (Meteor.isClient) {
     $scope.parties = $meteor.collection(Parties);
 
     $scope.remove = function(party){
-      $scope.parties.splice($scope.parties.indexOf(party), 1);
+      $scope.parties.remove(party);
     };
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a140533151ec088e697a305930319df829cb4f0e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:57:38 +0300
Subject: [PATCH 028/215] Step 4.8: Add Remove All button

---
 index.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/index.ng.html b/index.ng.html
index 68ec2ac..5c567a8 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -5,6 +5,7 @@
     <label>Description</label>
     <input ng-model="newParty.description">
     <button ng-click="parties.save(newParty); newParty='';">Add</button>
+    <button ng-click="removeAll()">Remove All</button>
   </form>
   <ul>
     <li ng-repeat="party in parties">
-- 
2.3.2 (Apple Git-55)


From 0ce3ea6aff9cea29dc40ec92a3ef060df9f314b6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:58:20 +0300
Subject: [PATCH 029/215] Step 4.9: Add Remove All logic to the controller

---
 app.ng.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/app.ng.js b/app.ng.js
index 30a428e..6ea7dce 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -7,5 +7,9 @@ if (Meteor.isClient) {
     $scope.remove = function(party){
       $scope.parties.remove(party);
     };
+
+    $scope.removeAll = function(){
+      $scope.parties.remove();
+    };
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cfff4d678e01fff4a141b2b6322b04a98a64a13e Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 01:24:43 +0300
Subject: [PATCH 030/215] Step 5.1: Add the angularui:angular-ui-router package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 3216f31..5b8d808 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
 angular@1.0.2
+angularui:angular-ui-router
\ No newline at end of file
diff --git a/.meteor/versions b/.meteor/versions
index ea97952..ff41b50 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,6 @@
 angular@1.0.2
 angular:angular@1.4.6
+angularui:angular-ui-router@0.2.15
 autopublish@1.0.4
 autoupdate@1.2.3
 babel-compiler@5.8.24_1
-- 
2.3.2 (Apple Git-55)


From 6d9e925b1da9f28ffd519584651f9e60b1db226e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:03:28 +0300
Subject: [PATCH 031/215] Step 5.2: Add angular-ui-router dependency

---
 app.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.ng.js b/app.ng.js
index 6ea7dce..ce8c242 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -1,5 +1,5 @@
 if (Meteor.isClient) {
-  angular.module('socially', ['angular-meteor']);
+  angular.module('socially', ['angular-meteor', 'ui.router']);
 
   angular.module('socially').controller('PartiesListCtrl', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
-- 
2.3.2 (Apple Git-55)


From d845abfed492d08441f60bd527a606dd0dbd13f1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:08:18 +0300
Subject: [PATCH 032/215] Step 5.3: Create parties list page

---
 parties-list.ng.html | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 parties-list.ng.html

diff --git a/parties-list.ng.html b/parties-list.ng.html
new file mode 100644
index 0000000..28a1881
--- /dev/null
+++ b/parties-list.ng.html
@@ -0,0 +1,15 @@
+<form>
+  <label>Name</label>
+  <input ng-model="newParty.name">
+  <label>Description</label>
+  <input ng-model="newParty.description">
+  <button ng-click="parties.push(newParty)">Add</button>
+  <button ng-click="removeAll()">Remove All</button>
+</form>
+<ul>
+  <li ng-repeat="party in parties">
+    <a href="/parties/{{party._id}}">{{party.name}}</a>
+    <p>{{party.description}}</p>
+    <button ng-click="remove(party)">X</button>
+  </li>
+</ul>
-- 
2.3.2 (Apple Git-55)


From c50b5e51c9768c245ab8ce5188101922a312c0a9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:09:27 +0300
Subject: [PATCH 033/215] Step 5.4: Update index.html

---
 index.html | 17 ++++++++++++++---
 1 file changed, 14 insertions(+), 3 deletions(-)

diff --git a/index.html b/index.html
index cbd22c9..16d4ecd 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,14 @@
-<body ng-app="socially" ng-strict-di="">
-  <div ng-include="'index.ng.html'"></div>
-</body>
+<head>
+  <base href="/">
+</head>
+<body>
+
+<div ng-app="socially" ng-strict-di="">
+  <h1>
+    <a href="/parties">Home</a>
+  </h1>
+
+  <div ui-view></div>
+</div>
+
+</body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 826a71e1eef1f69ee77de43cc3018a6ba81c5a6e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:12:39 +0300
Subject: [PATCH 034/215] Step 5.5: Remove index.ng.html

---
 index.ng.html | 17 -----------------
 1 file changed, 17 deletions(-)
 delete mode 100644 index.ng.html

diff --git a/index.ng.html b/index.ng.html
deleted file mode 100644
index 5c567a8..0000000
--- a/index.ng.html
+++ /dev/null
@@ -1,17 +0,0 @@
-<div ng-controller="PartiesListCtrl">
-  <form>
-    <label>Name</label>
-    <input ng-model="newParty.name">
-    <label>Description</label>
-    <input ng-model="newParty.description">
-    <button ng-click="parties.save(newParty); newParty='';">Add</button>
-    <button ng-click="removeAll()">Remove All</button>
-  </form>
-  <ul>
-    <li ng-repeat="party in parties">
-      {{party.name}}
-      <p>{{party.description}}</p>
-      <button ng-click="remove(party)">X</button>
-    </li>
-  </ul>
-</div>
-- 
2.3.2 (Apple Git-55)


From 9424a3e4b8945f19efbfed06205fa466f608ac63 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:12:51 +0300
Subject: [PATCH 035/215] Step 5.6: Create party details page

---
 party-details.ng.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 party-details.ng.html

diff --git a/party-details.ng.html b/party-details.ng.html
new file mode 100644
index 0000000..68fe7fe
--- /dev/null
+++ b/party-details.ng.html
@@ -0,0 +1 @@
+Here you will see the details of party number: {{ partyId }}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4b7fff786aca233025bb99eef47bcbb4b939cec0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:16:01 +0300
Subject: [PATCH 036/215] Step 5.7: Add routes definitions

---
 app.ng.js | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

diff --git a/app.ng.js b/app.ng.js
index ce8c242..a3966b2 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -1,6 +1,25 @@
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor', 'ui.router']);
 
+  angular.module('socially').config(function($urlRouterProvider, $stateProvider, $locationProvider){
+
+      $locationProvider.html5Mode(true);
+
+      $stateProvider
+        .state('parties', {
+          url: '/parties',
+          templateUrl: 'parties-list.ng.html',
+          controller: 'PartiesListCtrl'
+        })
+        .state('partyDetails', {
+          url: '/parties/:partyId',
+          templateUrl: 'party-details.ng.html',
+          controller: 'PartyDetailsCtrl'
+        });
+
+      $urlRouterProvider.otherwise("/parties");
+    });
+  
   angular.module('socially').controller('PartiesListCtrl', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
 
-- 
2.3.2 (Apple Git-55)


From ac842f278185168496eb0b13883c7ba848fca7e9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:17:00 +0300
Subject: [PATCH 037/215] Step 5.8: Add party details controller

---
 app.ng.js | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/app.ng.js b/app.ng.js
index a3966b2..90dbf90 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -1,3 +1,5 @@
+Parties = new Mongo.Collection("parties");
+
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor', 'ui.router']);
 
@@ -31,4 +33,8 @@ if (Meteor.isClient) {
       $scope.parties.remove();
     };
   });
+
+  angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams) {
+    $scope.partyId = $stateParams.partyId;
+  });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 197dab12662bd5185823c729e8ea2e0320a32445 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:41:12 +0300
Subject: [PATCH 038/215] Step 6.1: Add $meteor.object to the controller

---
 app.ng.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/app.ng.js b/app.ng.js
index 90dbf90..e1f8c30 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -34,7 +34,7 @@ if (Meteor.isClient) {
     };
   });
 
-  angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams) {
-    $scope.partyId = $stateParams.partyId;
+  angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams, $meteor) {
+    $scope.party = $meteor.object(Parties, $stateParams.partyId);
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From bef39c559bf86dbf7c81eb40da1b6e374c4aebb8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:44:09 +0300
Subject: [PATCH 039/215] Step 6.2: Add binding to the party details

---
 party-details.ng.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/party-details.ng.html b/party-details.ng.html
index 68fe7fe..31f8472 100644
--- a/party-details.ng.html
+++ b/party-details.ng.html
@@ -1 +1,4 @@
-Here you will see the details of party number: {{ partyId }}
\ No newline at end of file
+Here you will see and change the details of the party:
+
+<input ng-model="party.name">
+<input ng-model="party.description">
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8e50ea4330c66329b5f031f652aef193cad40e00 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:46:20 +0300
Subject: [PATCH 040/215] Step 6.3: Add some buttons to the form

---
 party-details.ng.html | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/party-details.ng.html b/party-details.ng.html
index 31f8472..52e92e7 100644
--- a/party-details.ng.html
+++ b/party-details.ng.html
@@ -1,4 +1,8 @@
 Here you will see and change the details of the party:
 
 <input ng-model="party.name">
-<input ng-model="party.description">
\ No newline at end of file
+<input ng-model="party.description">
+
+<button ng-click="save()">Save</button>
+<button ng-click="reset()">Reset form</button>
+<button ui-sref="parties">Cancel</button>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d29c0e758fa629f508d1019c13d860e12a68772f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:46:51 +0300
Subject: [PATCH 041/215] Step 6.4: Update the usage of $meteor.object

---
 app.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.ng.js b/app.ng.js
index e1f8c30..9e31d5d 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -35,6 +35,6 @@ if (Meteor.isClient) {
   });
 
   angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams, $meteor) {
-    $scope.party = $meteor.object(Parties, $stateParams.partyId);
+    $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5d43d7c366cf26198e3c9a58a691dd33865ce600 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:47:13 +0300
Subject: [PATCH 042/215] Step 6.5: Add logic to the controller

---
 app.ng.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/app.ng.js b/app.ng.js
index 9e31d5d..0d212e6 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -36,5 +36,13 @@ if (Meteor.isClient) {
 
   angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams, $meteor) {
     $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
+
+    $scope.save = function() {
+      $scope.party.save();
+    };
+
+    $scope.reset = function() {
+      $scope.party.reset();
+    };
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c0b5b3ea42187ff7fb940bf756d68c4dd7c64bda Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:48:18 +0300
Subject: [PATCH 043/215] Step 6.6: Full implementation of the controller logic

---
 app.ng.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/app.ng.js b/app.ng.js
index 0d212e6..46819b9 100644
--- a/app.ng.js
+++ b/app.ng.js
@@ -38,7 +38,11 @@ if (Meteor.isClient) {
     $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
 
     $scope.save = function() {
-      $scope.party.save();
+      $scope.party.save().then(function(numberOfDocs){
+        console.log('save success doc affected ', numberOfDocs);
+      }, function(error){
+        console.log('save error', error);
+      });
     };
 
     $scope.reset = function() {
-- 
2.3.2 (Apple Git-55)


From 614a1720770512ca5291958dc6635df1a679ef2b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:54:24 +0300
Subject: [PATCH 044/215] Step 7.1: client/lib/app.ng.js

---
 client/lib/app.ng.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/lib/app.ng.js

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
new file mode 100644
index 0000000..999bdc1
--- /dev/null
+++ b/client/lib/app.ng.js
@@ -0,0 +1 @@
+angular.module('socially',['angular-meteor', 'ui.router']);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 104a7056695358b3f4ee592bc2c6e36308cde230 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:00:58 +0300
Subject: [PATCH 045/215] Step 7.2: model/parties.js

---
 model/parties.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 model/parties.js

diff --git a/model/parties.js b/model/parties.js
new file mode 100644
index 0000000..dc0ccc3
--- /dev/null
+++ b/model/parties.js
@@ -0,0 +1 @@
+Parties = new Mongo.Collection("parties");
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d8ed4fe6ea6043a07846747eea0268b7c192762a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:04:29 +0300
Subject: [PATCH 046/215] Step 7.3: server/startup/loadParties.js

---
 server/startup/loadParties.js | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 create mode 100644 server/startup/loadParties.js

diff --git a/server/startup/loadParties.js b/server/startup/loadParties.js
new file mode 100644
index 0000000..8d3780e
--- /dev/null
+++ b/server/startup/loadParties.js
@@ -0,0 +1,14 @@
+Meteor.startup(function () {
+  if (Parties.find().count() === 0) {
+    var parties = [
+      {'name': 'Dubstep-Free Zone',
+        'description': 'Fast just got faster with Nexus S.'},
+      {'name': 'All dubstep all the time',
+        'description': 'Get it on!'},
+      {'name': 'Savage lounging',
+        'description': 'Leisure suit required. And only fiercest manners.'}
+    ];
+    for (var i = 0; i < parties.length; i++)
+      Parties.insert({name: parties[i].name, description: parties[i].description});
+  }
+});
-- 
2.3.2 (Apple Git-55)


From e84c87fea4b39ed9c071978c7d8c682aaf368591 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:06:09 +0300
Subject: [PATCH 047/215] Step 7.4: client/routes.ng.js

---
 client/routes.ng.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
 create mode 100644 client/routes.ng.js

diff --git a/client/routes.ng.js b/client/routes.ng.js
new file mode 100644
index 0000000..4dc1ad3
--- /dev/null
+++ b/client/routes.ng.js
@@ -0,0 +1,17 @@
+angular.module("socially").config(function ($urlRouterProvider, $stateProvider, $locationProvider) {
+  $locationProvider.html5Mode(true);
+
+  $stateProvider
+    .state('parties', {
+      url: '/parties',
+      templateUrl: 'parties-list.ng.html',
+      controller: 'PartiesListCtrl'
+    })
+    .state('partyDetails', {
+      url: '/parties/:partyId',
+      templateUrl: 'party-details.ng.html',
+      controller: 'PartyDetailsCtrl'
+    });
+
+  $urlRouterProvider.otherwise("/parties");
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 14f7ab6586c29d59401fca9befad6f7373fd0ae2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:07:25 +0300
Subject: [PATCH 048/215] Step 7.5: client/parties/controllers/partiesList.js

---
 client/parties/controllers/partiesList.ng.js | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 client/parties/controllers/partiesList.ng.js

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
new file mode 100644
index 0000000..ef2c64f
--- /dev/null
+++ b/client/parties/controllers/partiesList.ng.js
@@ -0,0 +1,11 @@
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor) {
+  $scope.parties = $meteor.collection(Parties);
+
+  $scope.remove = function (party) {
+    $scope.parties.splice($scope.parties.indexOf(party), 1);
+  };
+
+  $scope.removeAll = function () {
+    $scope.parties.remove();
+  };
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 13362646887db9c8a8484c293a5585ef9ebcb710 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:08:05 +0300
Subject: [PATCH 049/215] Step 7.6: client/parties/controllers/partyDetails.js

---
 client/parties/controllers/partyDetails.ng.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 client/parties/controllers/partyDetails.ng.js

diff --git a/client/parties/controllers/partyDetails.ng.js b/client/parties/controllers/partyDetails.ng.js
new file mode 100644
index 0000000..a46e036
--- /dev/null
+++ b/client/parties/controllers/partyDetails.ng.js
@@ -0,0 +1,3 @@
+angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $stateParams, $meteor) {
+  $scope.party = $meteor.object(Parties, $stateParams.partyId);
+});
-- 
2.3.2 (Apple Git-55)


From 85270f81891d8343e01b8f689e0596b376ffae5d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:10:21 +0300
Subject: [PATCH 050/215] Step 7.7: Move index.html

---
 client/index.html | 14 ++++++++++++++
 index.html        | 14 --------------
 2 files changed, 14 insertions(+), 14 deletions(-)
 create mode 100644 client/index.html
 delete mode 100644 index.html

diff --git a/client/index.html b/client/index.html
new file mode 100644
index 0000000..16d4ecd
--- /dev/null
+++ b/client/index.html
@@ -0,0 +1,14 @@
+<head>
+  <base href="/">
+</head>
+<body>
+
+<div ng-app="socially" ng-strict-di="">
+  <h1>
+    <a href="/parties">Home</a>
+  </h1>
+
+  <div ui-view></div>
+</div>
+
+</body>
\ No newline at end of file
diff --git a/index.html b/index.html
deleted file mode 100644
index 16d4ecd..0000000
--- a/index.html
+++ /dev/null
@@ -1,14 +0,0 @@
-<head>
-  <base href="/">
-</head>
-<body>
-
-<div ng-app="socially" ng-strict-di="">
-  <h1>
-    <a href="/parties">Home</a>
-  </h1>
-
-  <div ui-view></div>
-</div>
-
-</body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d7003b52cb1a0d3cd0885e0b291f49760522599a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:11:30 +0300
Subject: [PATCH 051/215] Step 7.8: Move to
 client/parties/views/parties-list.ng.html

---
 client/parties/views/parties-list.ng.html | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 client/parties/views/parties-list.ng.html

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
new file mode 100644
index 0000000..2b64715
--- /dev/null
+++ b/client/parties/views/parties-list.ng.html
@@ -0,0 +1,15 @@
+<form>
+  <label>Name</label>
+  <input ng-model="newParty.name">
+  <label>Description</label>
+  <input ng-model="newParty.description">
+  <button ng-click="parties.push(newParty)">Add</button>
+  <button ng-click="removeAll()">Remove All</button>
+</form>
+<ul>
+  <li ng-repeat="party in parties">
+    <a href="/parties/{{party._id}}">{{party.name}}</a>
+    <p>{{party.description}}</p>
+    <button ng-click="remove(party)">X</button>
+  </li>
+</ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b64c8393b672e034e410b3dc389ab0182e4b675a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:09:03 +0300
Subject: [PATCH 052/215] Step 7.9: Move party-details.ng.html view

---
 client/parties/views/party-details.ng.html | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 client/parties/views/party-details.ng.html

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
new file mode 100644
index 0000000..31f8472
--- /dev/null
+++ b/client/parties/views/party-details.ng.html
@@ -0,0 +1,4 @@
+Here you will see and change the details of the party:
+
+<input ng-model="party.name">
+<input ng-model="party.description">
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From bee2f6b93a3f5b6c11d5b90105c1d7c0079b18c8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:09:22 +0300
Subject: [PATCH 053/215] Step 7.10: Update routes file

---
 client/routes.ng.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/routes.ng.js b/client/routes.ng.js
index 4dc1ad3..e146f42 100644
--- a/client/routes.ng.js
+++ b/client/routes.ng.js
@@ -4,12 +4,12 @@ angular.module("socially").config(function ($urlRouterProvider, $stateProvider,
   $stateProvider
     .state('parties', {
       url: '/parties',
-      templateUrl: 'parties-list.ng.html',
+      templateUrl: 'client/parties/views/parties-list.ng.html',
       controller: 'PartiesListCtrl'
     })
     .state('partyDetails', {
       url: '/parties/:partyId',
-      templateUrl: 'party-details.ng.html',
+      templateUrl: 'client/parties/views/party-details.ng.html',
       controller: 'PartyDetailsCtrl'
     });
 
-- 
2.3.2 (Apple Git-55)


From 978564c67490fc6172f9f307a5fc9a7c21b0f377 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 01:58:45 +0300
Subject: [PATCH 054/215] Step 7.11: Delete remaining files

---
 app.ng.js             | 52 ---------------------------------------------------
 parties-list.ng.html  | 15 ---------------
 party-details.ng.html |  8 --------
 server.js             | 18 ------------------
 4 files changed, 93 deletions(-)
 delete mode 100644 app.ng.js
 delete mode 100644 parties-list.ng.html
 delete mode 100644 party-details.ng.html
 delete mode 100644 server.js

diff --git a/app.ng.js b/app.ng.js
deleted file mode 100644
index 46819b9..0000000
--- a/app.ng.js
+++ /dev/null
@@ -1,52 +0,0 @@
-Parties = new Mongo.Collection("parties");
-
-if (Meteor.isClient) {
-  angular.module('socially', ['angular-meteor', 'ui.router']);
-
-  angular.module('socially').config(function($urlRouterProvider, $stateProvider, $locationProvider){
-
-      $locationProvider.html5Mode(true);
-
-      $stateProvider
-        .state('parties', {
-          url: '/parties',
-          templateUrl: 'parties-list.ng.html',
-          controller: 'PartiesListCtrl'
-        })
-        .state('partyDetails', {
-          url: '/parties/:partyId',
-          templateUrl: 'party-details.ng.html',
-          controller: 'PartyDetailsCtrl'
-        });
-
-      $urlRouterProvider.otherwise("/parties");
-    });
-  
-  angular.module('socially').controller('PartiesListCtrl', function ($scope, $meteor) {
-    $scope.parties = $meteor.collection(Parties);
-
-    $scope.remove = function(party){
-      $scope.parties.remove(party);
-    };
-
-    $scope.removeAll = function(){
-      $scope.parties.remove();
-    };
-  });
-
-  angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams, $meteor) {
-    $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
-
-    $scope.save = function() {
-      $scope.party.save().then(function(numberOfDocs){
-        console.log('save success doc affected ', numberOfDocs);
-      }, function(error){
-        console.log('save error', error);
-      });
-    };
-
-    $scope.reset = function() {
-      $scope.party.reset();
-    };
-  });
-}
\ No newline at end of file
diff --git a/parties-list.ng.html b/parties-list.ng.html
deleted file mode 100644
index 28a1881..0000000
--- a/parties-list.ng.html
+++ /dev/null
@@ -1,15 +0,0 @@
-<form>
-  <label>Name</label>
-  <input ng-model="newParty.name">
-  <label>Description</label>
-  <input ng-model="newParty.description">
-  <button ng-click="parties.push(newParty)">Add</button>
-  <button ng-click="removeAll()">Remove All</button>
-</form>
-<ul>
-  <li ng-repeat="party in parties">
-    <a href="/parties/{{party._id}}">{{party.name}}</a>
-    <p>{{party.description}}</p>
-    <button ng-click="remove(party)">X</button>
-  </li>
-</ul>
diff --git a/party-details.ng.html b/party-details.ng.html
deleted file mode 100644
index 52e92e7..0000000
--- a/party-details.ng.html
+++ /dev/null
@@ -1,8 +0,0 @@
-Here you will see and change the details of the party:
-
-<input ng-model="party.name">
-<input ng-model="party.description">
-
-<button ng-click="save()">Save</button>
-<button ng-click="reset()">Reset form</button>
-<button ui-sref="parties">Cancel</button>
\ No newline at end of file
diff --git a/server.js b/server.js
deleted file mode 100644
index 3ce2ef4..0000000
--- a/server.js
+++ /dev/null
@@ -1,18 +0,0 @@
-Parties = new Mongo.Collection("parties");
-
-if (Meteor.isServer) {
-  Meteor.startup(function () {
-    if (Parties.find().count() === 0) {
-      var parties = [
-        {'name': 'Dubstep-Free Zone',
-          'description': 'Fast just got faster with Nexus S.'},
-        {'name': 'All dubstep all the time',
-          'description': 'Get it on!'},
-        {'name': 'Savage lounging',
-          'description': 'Leisure suit required. And only fiercest manners.'}
-      ];
-      for (var i = 0; i < parties.length; i++)
-        Parties.insert(parties[i]);
-    }
-  });
-}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 55974c38a9b3072494cf9d4b31158dadd8365107 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:08:39 +0300
Subject: [PATCH 055/215] Step 8.1: Remove the insecure package

---
 .meteor/packages | 4 +---
 .meteor/versions | 1 -
 2 files changed, 1 insertion(+), 4 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 5b8d808..290e8fa 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -15,8 +15,6 @@ tracker                 # Meteor's client-side reactive programming library
 standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 ecmascript              # Enable ECMAScript2015+ syntax in app code
-
 autopublish             # Publish all data to the clients (for prototyping)
-insecure                # Allow all DB writes from clients (for prototyping)
 angular@1.0.2
-angularui:angular-ui-router
\ No newline at end of file
+angularui:angular-ui-router
diff --git a/.meteor/versions b/.meteor/versions
index ff41b50..d15cf4d 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -33,7 +33,6 @@ html-tools@1.0.5
 htmljs@1.0.5
 http@1.1.1
 id-map@1.0.4
-insecure@1.0.4
 jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
-- 
2.3.2 (Apple Git-55)


From a8e56eee1171191af1457107aac3925e943b7d65 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:09:42 +0300
Subject: [PATCH 056/215] Step 8.2: Add the accounts-password package

---
 .meteor/packages |  1 +
 .meteor/versions | 10 ++++++++++
 2 files changed, 11 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 290e8fa..354c60f 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,3 +18,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 autopublish             # Publish all data to the clients (for prototyping)
 angular@1.0.2
 angularui:angular-ui-router
+accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index d15cf4d..1a4d49d 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,5 @@
+accounts-base@1.2.1
+accounts-password@1.1.3
 angular@1.0.2
 angular:angular@1.4.6
 angularui:angular-ui-router@0.2.15
@@ -19,12 +21,14 @@ dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
 ddp-common@1.2.1
+ddp-rate-limiter@1.0.0
 ddp-server@1.2.1
 deps@1.0.9
 diff-sequence@1.0.1
 ecmascript@0.1.4
 ecmascript-collections@0.1.6
 ejson@1.0.7
+email@1.0.7
 es5-shim@4.1.13
 fastclick@1.0.7
 geojson-utils@1.0.4
@@ -37,6 +41,7 @@ jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
 livedata@1.0.15
+localstorage@1.0.5
 logging@1.0.8
 meteor@1.1.7
 meteor-base@1.0.1
@@ -46,19 +51,24 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.1
 mongo-id@1.0.1
+npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 promise@0.4.8
 random@1.0.4
+rate-limit@1.0.0
 reactive-dict@1.1.1
 reactive-var@1.0.6
 reload@1.1.4
 retry@1.0.4
 routepolicy@1.0.6
+service-configuration@1.0.5
 session@1.1.1
+sha@1.0.4
 spacebars@1.0.7
 spacebars-compiler@1.0.7
+srp@1.0.4
 standard-minifiers@1.0.0
 templating@1.1.3
 templating-tools@1.0.0
-- 
2.3.2 (Apple Git-55)


From 3f71749c1709a81b0557089f13ebdd391e37d1b9 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:10:30 +0300
Subject: [PATCH 057/215] Step 8.3: Add the accounts-ui package

---
 .meteor/packages | 1 +
 .meteor/versions | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 354c60f..66b2d96 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,4 @@ autopublish             # Publish all data to the clients (for prototyping)
 angular@1.0.2
 angularui:angular-ui-router
 accounts-password
+accounts-ui
diff --git a/.meteor/versions b/.meteor/versions
index 1a4d49d..c29d0ee 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,7 @@
 accounts-base@1.2.1
 accounts-password@1.1.3
+accounts-ui@1.1.6
+accounts-ui-unstyled@1.1.8
 angular@1.0.2
 angular:angular@1.4.6
 angularui:angular-ui-router@0.2.15
@@ -40,6 +42,7 @@ id-map@1.0.4
 jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
+less@2.5.0_2
 livedata@1.0.15
 localstorage@1.0.5
 logging@1.0.8
-- 
2.3.2 (Apple Git-55)


From 26669d6deb78ca705baa9c4feeb0388eeb6e906d Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:11:49 +0300
Subject: [PATCH 058/215] Step 8.4: Add the urigo:angular-blaze-template
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 66b2d96..22040db 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -20,3 +20,4 @@ angular@1.0.2
 angularui:angular-ui-router
 accounts-password
 accounts-ui
+urigo:angular-blaze-template
diff --git a/.meteor/versions b/.meteor/versions
index c29d0ee..a5c0311 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -78,6 +78,7 @@ templating-tools@1.0.0
 tracker@1.0.8
 ui@1.0.8
 underscore@1.0.4
+urigo:angular-blaze-template@0.0.1
 url@1.0.5
 webapp@1.2.2
 webapp-hashing@1.0.5
-- 
2.3.2 (Apple Git-55)


From aa24c7fc69cdfc1268daa7bd8d0eb54ab1b5d1c9 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:14:04 +0300
Subject: [PATCH 059/215] Step 8.5: Use blaze-template directive to load the
 loginButtons Blaze template

---
 client/index.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/index.html b/client/index.html
index 16d4ecd..e529a71 100644
--- a/client/index.html
+++ b/client/index.html
@@ -4,6 +4,7 @@
 <body>
 
 <div ng-app="socially" ng-strict-di="">
+  <blaze-template name="loginButtons"></blaze-template>
   <h1>
     <a href="/parties">Home</a>
   </h1>
-- 
2.3.2 (Apple Git-55)


From 0172474250d9c0d96508f7a442b947db316a8007 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:29:32 +0300
Subject: [PATCH 060/215] Step 8.6: Add allow logic to the model

---
 model/parties.js | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/model/parties.js b/model/parties.js
index dc0ccc3..b793c1f 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -1 +1,13 @@
-Parties = new Mongo.Collection("parties");
\ No newline at end of file
+Parties = new Mongo.Collection("parties");
+
+Parties.allow({
+  insert: function (userId, party) {
+    return userId && party.owner === userId;
+  },
+  update: function (userId, party, fields, modifier) {
+    return userId && party.owner === userId;
+  },
+  remove: function (userId, party) {
+    return userId && party.owner === userId;
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4850eb0beaf517bf0535daa16549de002a0ab023 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:34:30 +0300
Subject: [PATCH 061/215] Step 8.7: Add current user to the new party

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 2b64715..afbe90d 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -3,7 +3,7 @@
   <input ng-model="newParty.name">
   <label>Description</label>
   <input ng-model="newParty.description">
-  <button ng-click="parties.push(newParty)">Add</button>
+  <button ng-click="newParty.owner=$root.currentUser._id; parties.push(newParty)">Add</button>
   <button ng-click="removeAll()">Remove All</button>
 </form>
 <ul>
-- 
2.3.2 (Apple Git-55)


From 148fd7070df86eb2257b8bd0192e15e9fb70dc7c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:15:06 +0300
Subject: [PATCH 062/215] Step 8.8: Add accounts-facebook accounts-twitter
 packages

---
 .meteor/packages | 2 ++
 .meteor/versions | 8 ++++++++
 2 files changed, 10 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 22040db..6db4923 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -21,3 +21,5 @@ angularui:angular-ui-router
 accounts-password
 accounts-ui
 urigo:angular-blaze-template
+accounts-facebook
+accounts-twitter
diff --git a/.meteor/versions b/.meteor/versions
index a5c0311..a6541d7 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,8 @@
 accounts-base@1.2.1
+accounts-facebook@1.0.6
+accounts-oauth@1.1.7
 accounts-password@1.1.3
+accounts-twitter@1.0.6
 accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
 angular@1.0.2
@@ -32,6 +35,7 @@ ecmascript-collections@0.1.6
 ejson@1.0.7
 email@1.0.7
 es5-shim@4.1.13
+facebook@1.2.2
 fastclick@1.0.7
 geojson-utils@1.0.4
 hot-code-push@1.0.0
@@ -56,6 +60,9 @@ mongo@1.1.1
 mongo-id@1.0.1
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
+oauth@1.1.6
+oauth1@1.1.5
+oauth2@1.1.5
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 promise@0.4.8
@@ -76,6 +83,7 @@ standard-minifiers@1.0.0
 templating@1.1.3
 templating-tools@1.0.0
 tracker@1.0.8
+twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
 urigo:angular-blaze-template@0.0.1
-- 
2.3.2 (Apple Git-55)


From 5fdcf2dffce2d2943df11c73e77152bf41aa8e6a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:18:06 +0300
Subject: [PATCH 063/215] Step 8.9: Add resolve logic to the routes

---
 client/routes.ng.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/client/routes.ng.js b/client/routes.ng.js
index e146f42..1a29b62d 100644
--- a/client/routes.ng.js
+++ b/client/routes.ng.js
@@ -10,7 +10,12 @@ angular.module("socially").config(function ($urlRouterProvider, $stateProvider,
     .state('partyDetails', {
       url: '/parties/:partyId',
       templateUrl: 'client/parties/views/party-details.ng.html',
-      controller: 'PartyDetailsCtrl'
+      controller: 'PartyDetailsCtrl',
+      resolve: {
+        "currentUser": function ($meteor) {
+          return $meteor.requireUser();
+        }
+      }
     });
 
   $urlRouterProvider.otherwise("/parties");
-- 
2.3.2 (Apple Git-55)


From d98b0aeba790ae73dc21ac948278a0851df79904 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:18:27 +0300
Subject: [PATCH 064/215] Step 8.10: Add authentication logic to the routes

---
 client/routes.ng.js | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/routes.ng.js b/client/routes.ng.js
index 1a29b62d..66296a4 100644
--- a/client/routes.ng.js
+++ b/client/routes.ng.js
@@ -1,3 +1,13 @@
+angular.module("socially").run(function ($rootScope, $state) {
+  $rootScope.$on('$stateChangeError', function (event, toState, toParams, fromState, fromParams, error) {
+    // We can catch the error thrown when the $requireUser promise is rejected
+    // and redirect the user back to the main page
+    if (error === 'AUTH_REQUIRED') {
+      $state.go('parties');
+    }
+  });
+});
+
 angular.module("socially").config(function ($urlRouterProvider, $stateProvider, $locationProvider) {
   $locationProvider.html5Mode(true);
 
-- 
2.3.2 (Apple Git-55)


From 0eba09e2102b37a89ad766bf6b958a3f88e88bf9 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:27:21 +0300
Subject: [PATCH 065/215] Step 9.1: Remove the autopublish package

---
 .meteor/packages | 2 --
 .meteor/versions | 1 -
 2 files changed, 3 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 6db4923..dd2976d 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -11,11 +11,9 @@ blaze-html-templates    # Compile .html files into Meteor Blaze views
 session                 # Client-side reactive dictionary for your app
 jquery                  # Helpful client-side library
 tracker                 # Meteor's client-side reactive programming library
-
 standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 ecmascript              # Enable ECMAScript2015+ syntax in app code
-autopublish             # Publish all data to the clients (for prototyping)
 angular@1.0.2
 angularui:angular-ui-router
 accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index a6541d7..edc1d00 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -8,7 +8,6 @@ accounts-ui-unstyled@1.1.8
 angular@1.0.2
 angular:angular@1.4.6
 angularui:angular-ui-router@0.2.15
-autopublish@1.0.4
 autoupdate@1.2.3
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
-- 
2.3.2 (Apple Git-55)


From 1bdd2a92b20118b58d522590924fb5627360f356 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:50:23 +0300
Subject: [PATCH 066/215] Step 9.2: Usage of publish method

---
 server/parties.js | 13 +++++++++++++
 1 file changed, 13 insertions(+)
 create mode 100644 server/parties.js

diff --git a/server/parties.js b/server/parties.js
new file mode 100644
index 0000000..277f09a
--- /dev/null
+++ b/server/parties.js
@@ -0,0 +1,13 @@
+Meteor.publish("parties", function () {
+  return Parties.find({
+    $or:[
+      {$and:[
+        {"public": true},
+        {"public": {$exists: true}}
+      ]},
+      {$and:[
+        {owner: this.userId},
+        {owner: {$exists: true}}
+      ]}
+    ]});
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8dfc67689b6b2e9db9fc6ee87ffc0c0b46dd27ce Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 17:44:37 +0300
Subject: [PATCH 067/215] Step 9.3: Add subscription for parties

---
 client/parties/controllers/partiesList.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index ef2c64f..34e0d55 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -1,5 +1,5 @@
 angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor) {
-  $scope.parties = $meteor.collection(Parties);
+  $scope.parties = $meteor.collection(Parties).subscribe('parties');
 
   $scope.remove = function (party) {
     $scope.parties.splice($scope.parties.indexOf(party), 1);
-- 
2.3.2 (Apple Git-55)


From 56b400a57ddf198a823d45c86ffdd1181b240d87 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:00:41 +0300
Subject: [PATCH 068/215] Step 9.4: Add checkbox for public party

---
 client/parties/views/parties-list.ng.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index afbe90d..ca956ea 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -3,6 +3,8 @@
   <input ng-model="newParty.name">
   <label>Description</label>
   <input ng-model="newParty.description">
+  <label>Public</label>
+  <input type="checkbox" ng-model="newParty.public">
   <button ng-click="newParty.owner=$root.currentUser._id; parties.push(newParty)">Add</button>
   <button ng-click="removeAll()">Remove All</button>
 </form>
-- 
2.3.2 (Apple Git-55)


From 7c0f15712c832b97e4ab88cff2273bb063952361 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:03:38 +0300
Subject: [PATCH 069/215] Step 9.5: Add checkbox for public party in the
 details

---
 client/parties/views/party-details.ng.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 31f8472..f798477 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -1,4 +1,6 @@
 Here you will see and change the details of the party:
 
 <input ng-model="party.name">
-<input ng-model="party.description">
\ No newline at end of file
+<input ng-model="party.description">
+<label>Is public</label>
+<input type="checkbox" ng-model="party.public">
-- 
2.3.2 (Apple Git-55)


From 54992f1a440d9449c3e4fad789011c9c8a22acb8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 17:49:40 +0300
Subject: [PATCH 070/215] Step 9.6: Create the users publication in the server

---
 server/users.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 server/users.js

diff --git a/server/users.js b/server/users.js
new file mode 100644
index 0000000..f5becea
--- /dev/null
+++ b/server/users.js
@@ -0,0 +1,3 @@
+Meteor.publish("users", function () {
+  return Meteor.users.find({}, {fields: {emails: 1, profile: 1}});
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a7874eb0f7c6403f15aac10bb38ae06f2e6047f6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 17:52:46 +0300
Subject: [PATCH 071/215] Step 9.7: Add subscription to users

---
 client/parties/controllers/partyDetails.ng.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.ng.js b/client/parties/controllers/partyDetails.ng.js
index a46e036..7d31eb1 100644
--- a/client/parties/controllers/partyDetails.ng.js
+++ b/client/parties/controllers/partyDetails.ng.js
@@ -1,3 +1,4 @@
 angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $stateParams, $meteor) {
   $scope.party = $meteor.object(Parties, $stateParams.partyId);
-});
+  $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 25df0d323c6fad80df1322d1b82dc7e8bb73072b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 17:53:01 +0300
Subject: [PATCH 072/215] Step 9.8: Add subscription to parties

---
 client/parties/controllers/partyDetails.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.ng.js b/client/parties/controllers/partyDetails.ng.js
index 7d31eb1..2d9322e 100644
--- a/client/parties/controllers/partyDetails.ng.js
+++ b/client/parties/controllers/partyDetails.ng.js
@@ -1,4 +1,4 @@
 angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $stateParams, $meteor) {
-  $scope.party = $meteor.object(Parties, $stateParams.partyId);
+  $scope.party = $meteor.object(Parties, $stateParams.partyId).subscribe('parties');
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c6a4529b27abd553997cca8683a6e260e21597a1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:09:09 +0300
Subject: [PATCH 073/215] Step 9.9: Add the user details

---
 client/parties/views/party-details.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index f798477..a640092 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -4,3 +4,10 @@ Here you will see and change the details of the party:
 <input ng-model="party.description">
 <label>Is public</label>
 <input type="checkbox" ng-model="party.public">
+
+<ul>
+  Users:
+  <li ng-repeat="user in users">
+    <div>{{ user.emails[0].address }}</div>
+  </li>
+</ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c0091f5195398081a6949c648798a4cae09fb949 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:13:54 +0300
Subject: [PATCH 074/215] Step 11.1: Update the module initialization

---
 client/lib/app.ng.js | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
index 999bdc1..526887e 100644
--- a/client/lib/app.ng.js
+++ b/client/lib/app.ng.js
@@ -1 +1,12 @@
-angular.module('socially',['angular-meteor', 'ui.router']);
\ No newline at end of file
+angular.module('socially',['angular-meteor', 'ui.router']);
+
+function onReady() {
+  angular.bootstrap(document, ['socially'], {
+    strictDi: true
+  });
+}
+
+if (Meteor.isCordova)
+  angular.element(document).on("deviceready", onReady);
+else
+  angular.element(document).ready(onReady);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d0b9a49a02d3b7ca6762c1b32476265d2ed2e435 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:16:29 +0300
Subject: [PATCH 075/215] Step 11.2: Remove the ng-app directive

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index e529a71..30e8bee 100644
--- a/client/index.html
+++ b/client/index.html
@@ -3,7 +3,7 @@
 </head>
 <body>
 
-<div ng-app="socially" ng-strict-di="">
+<div>
   <blaze-template name="loginButtons"></blaze-template>
   <h1>
     <a href="/parties">Home</a>
-- 
2.3.2 (Apple Git-55)


From a9bc5990ce6ed8359ab32e259faf7fc6b025d6d7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:32:39 +0300
Subject: [PATCH 076/215] Step 12.1: Add the parties publish

---
 server/parties.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/server/parties.js b/server/parties.js
index 277f09a..663bcd8 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,4 @@
-Meteor.publish("parties", function () {
+Meteor.publish("parties", function (options) {
   return Parties.find({
     $or:[
       {$and:[
@@ -9,5 +9,5 @@ Meteor.publish("parties", function () {
         {owner: this.userId},
         {owner: {$exists: true}}
       ]}
-    ]});
+    ]}, options);
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a36b19f7879734564bed6b3f5b472d8db841a444 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:33:21 +0300
Subject: [PATCH 077/215] Step 12.2: Add pagination and sort scope params

---
 client/parties/controllers/partiesList.ng.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 34e0d55..6f4d8f6 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -1,6 +1,10 @@
 angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor) {
   $scope.parties = $meteor.collection(Parties).subscribe('parties');
 
+  $scope.page = 1;
+  $scope.perPage = 3;
+  $scope.sort = {name: 1};
+
   $scope.remove = function (party) {
     $scope.parties.splice($scope.parties.indexOf(party), 1);
   };
-- 
2.3.2 (Apple Git-55)


From 114c6367dec29c67acafea1db70f2dc9983bda97 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:33:49 +0300
Subject: [PATCH 078/215] Step 12.3: Add parties subscription

---
 client/parties/controllers/partiesList.ng.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 6f4d8f6..f89772c 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -5,6 +5,8 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.perPage = 3;
   $scope.sort = {name: 1};
 
+  $meteor.subscribe('parties');
+
   $scope.remove = function (party) {
     $scope.parties.splice($scope.parties.indexOf(party), 1);
   };
-- 
2.3.2 (Apple Git-55)


From f52f04e562187432e3be88ea96c30efa4941e823 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:34:10 +0300
Subject: [PATCH 079/215] Step 12.4: Add the params to the subscription

---
 client/parties/controllers/partiesList.ng.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index f89772c..bf8cce4 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -5,7 +5,11 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.perPage = 3;
   $scope.sort = {name: 1};
 
-  $meteor.subscribe('parties');
+  $meteor.subscribe('parties', {
+    limit: parseInt($scope.perPage),
+    skip: parseInt(($scope.page - 1) * $scope.perPage),
+    sort: $scope.sort
+  });
 
   $scope.remove = function (party) {
     $scope.parties.splice($scope.parties.indexOf(party), 1);
-- 
2.3.2 (Apple Git-55)


From 2591b5d313a7389bc854a44c89aedd1b37b30054 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:34:38 +0300
Subject: [PATCH 080/215] Step 12.5: Use cursor in the parties collection

---
 client/parties/controllers/partiesList.ng.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index bf8cce4..d784995 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -1,10 +1,15 @@
 angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor) {
-  $scope.parties = $meteor.collection(Parties).subscribe('parties');
 
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
 
+  $scope.parties = $meteor.collection(function() {
+    return Parties.find({}, {
+      sort : $scope.sort
+    });
+  });
+
   $meteor.subscribe('parties', {
     limit: parseInt($scope.perPage),
     skip: parseInt(($scope.page - 1) * $scope.perPage),
-- 
2.3.2 (Apple Git-55)


From 67dd465b3e9900fb02d5cea6304b0fb02d6dce98 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:48:28 +0300
Subject: [PATCH 081/215] Step 12.6: Add the angularutils:pagination package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index dd2976d..44fbc47 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -21,3 +21,4 @@ accounts-ui
 urigo:angular-blaze-template
 accounts-facebook
 accounts-twitter
+angularutils:pagination
diff --git a/.meteor/versions b/.meteor/versions
index edc1d00..05ac158 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -8,6 +8,7 @@ accounts-ui-unstyled@1.1.8
 angular@1.0.2
 angular:angular@1.4.6
 angularui:angular-ui-router@0.2.15
+angularutils:pagination@0.7.0
 autoupdate@1.2.3
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
-- 
2.3.2 (Apple Git-55)


From d423b6d656bf290e50c0bf04100b8f2a9bfab3d1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:32:41 +0300
Subject: [PATCH 082/215] Step 12.7: Add the pagination module

---
 client/lib/app.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
index 526887e..f6f5f1c 100644
--- a/client/lib/app.ng.js
+++ b/client/lib/app.ng.js
@@ -1,4 +1,4 @@
-angular.module('socially',['angular-meteor', 'ui.router']);
+angular.module('socially',['angular-meteor', 'ui.router', 'angularUtils.directives.dirPagination']);
 
 function onReady() {
   angular.bootstrap(document, ['socially'], {
-- 
2.3.2 (Apple Git-55)


From 95fd21814fa36930d40a5a96a4cf3753323df396 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:33:26 +0300
Subject: [PATCH 083/215] Step 12.8: Use the pagination directive

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index ca956ea..806534f 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -9,7 +9,7 @@
   <button ng-click="removeAll()">Remove All</button>
 </form>
 <ul>
-  <li ng-repeat="party in parties">
+  <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
-- 
2.3.2 (Apple Git-55)


From 38539ac59b04ab07f7ccfc6e0df75867c6163ef9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:38:23 +0300
Subject: [PATCH 084/215] Step 12.9: Add the pagination controls

---
 client/parties/views/parties-list.ng.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 806534f..1041916 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -14,4 +14,5 @@
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
   </li>
-</ul>
\ No newline at end of file
+</ul>
+<dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 39d85050f863635dcb023a9bf1ffe854d618efe2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:38:36 +0300
Subject: [PATCH 085/215] Step 12.10: Add the pageChanged method to the
 controller

---
 client/parties/controllers/partiesList.ng.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index d784995..fc5a8ea 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -20,7 +20,11 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     $scope.parties.splice($scope.parties.indexOf(party), 1);
   };
 
-  $scope.removeAll = function () {
+  $scope.removeAll = function(){
     $scope.parties.remove();
   };
+
+  $scope.pageChanged = function(newPage) {
+    $scope.page = newPage;
+  };
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7c6e9320cb22dd63b15a3a01c8742bca29a8fc4f Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:50:32 +0300
Subject: [PATCH 086/215] Step 12.11: Add the tmeasday:publish-counts package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 44fbc47..0cf31b9 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -22,3 +22,4 @@ urigo:angular-blaze-template
 accounts-facebook
 accounts-twitter
 angularutils:pagination
+tmeasday:publish-counts
diff --git a/.meteor/versions b/.meteor/versions
index 05ac158..edabe3a 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -82,6 +82,7 @@ srp@1.0.4
 standard-minifiers@1.0.0
 templating@1.1.3
 templating-tools@1.0.0
+tmeasday:publish-counts@0.7.2
 tracker@1.0.8
 twitter@1.1.5
 ui@1.0.8
-- 
2.3.2 (Apple Git-55)


From 94617cad6ae5d3fb660c275d2f8791d89e4cfcec Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:41:09 +0300
Subject: [PATCH 087/215] Step 12.12: Add parties count publish

---
 server/parties.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index 663bcd8..9622905 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,16 @@
 Meteor.publish("parties", function (options) {
+  Counts.publish(this, 'numberOfParties', Parties.find({
+    $or:[
+      {$and:[
+        {'public': true},
+        {'public': {$exists: true}}
+      ]},
+      {$and:[
+        {owner: this.userId},
+        {owner: {$exists: true}}
+      ]}
+    ]}), { noReady: true });
+
   return Parties.find({
     $or:[
       {$and:[
-- 
2.3.2 (Apple Git-55)


From 9c30b5e9988e4e75e395de611132d13ffb764e58 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:44:18 +0300
Subject: [PATCH 088/215] Step 12.13: Add parties count to the client

---
 client/parties/controllers/partiesList.ng.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index fc5a8ea..a3be704 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -14,6 +14,8 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     limit: parseInt($scope.perPage),
     skip: parseInt(($scope.page - 1) * $scope.perPage),
     sort: $scope.sort
+  }).then(function(){
+    $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
   });
 
   $scope.remove = function (party) {
-- 
2.3.2 (Apple Git-55)


From 5b6becfa71506dc7ec25d7051bfe58263657b200 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:44:44 +0300
Subject: [PATCH 089/215] Step 12.14: Add autorun to wrap the subscribe

---
 client/parties/controllers/partiesList.ng.js | 14 ++++++++------
 1 file changed, 8 insertions(+), 6 deletions(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index a3be704..3bac6c9 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -10,12 +10,14 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     });
   });
 
-  $meteor.subscribe('parties', {
-    limit: parseInt($scope.perPage),
-    skip: parseInt(($scope.page - 1) * $scope.perPage),
-    sort: $scope.sort
-  }).then(function(){
-    $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
+  $meteor.autorun($scope, function() {
+    $meteor.subscribe('parties', {
+      limit: parseInt($scope.perPage),
+      skip: parseInt(($scope.page - 1) * $scope.perPage),
+      sort: $scope.sort
+    }).then(function(){
+      $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
+    });
   });
 
   $scope.remove = function (party) {
-- 
2.3.2 (Apple Git-55)


From 4fd1295bcf5300e08c3dd60601e88ef25cf56d38 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:45:18 +0300
Subject: [PATCH 090/215] Step 12.15: Added usage of getReactively

---
 client/parties/controllers/partiesList.ng.js | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 3bac6c9..a356dd0 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -12,9 +12,9 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
 
   $meteor.autorun($scope, function() {
     $meteor.subscribe('parties', {
-      limit: parseInt($scope.perPage),
-      skip: parseInt(($scope.page - 1) * $scope.perPage),
-      sort: $scope.sort
+      limit: parseInt($scope.getReactively('perPage')),
+      skip: (parseInt($scope.getReactively('page')) - 1) * parseInt($scope.getReactively('perPage')),
+      sort: $scope.getReactively('sort')
     }).then(function(){
       $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
     });
-- 
2.3.2 (Apple Git-55)


From 21290d74d324c1b96f7bc7238f255d53a3fd9a68 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:45:55 +0300
Subject: [PATCH 091/215] Step 12.16: Added usage of getReactively to the
 collection

---
 client/parties/controllers/partiesList.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index a356dd0..b252774 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -6,7 +6,7 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
 
   $scope.parties = $meteor.collection(function() {
     return Parties.find({}, {
-      sort : $scope.sort
+      sort : $scope.getReactively('sort')
     });
   });
 
-- 
2.3.2 (Apple Git-55)


From c83042903cf2a1e7b0f1f87bc4000063ee97765b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:48:12 +0300
Subject: [PATCH 092/215] Step 12.17: Add sort controls to the view

---
 client/parties/views/parties-list.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 1041916..3d39e49 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -9,6 +9,13 @@
   <button ng-click="removeAll()">Remove All</button>
 </form>
 <ul>
+  <h1>Parties:</h1>
+  <div>
+    <select ng-model="orderProperty">
+      <option value="1">Ascending</option>
+      <option value="-1">Descending</option>
+    </select>
+  </div>
   <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
-- 
2.3.2 (Apple Git-55)


From b27228beea611588524703a855d429394a1f43f6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:49:18 +0300
Subject: [PATCH 093/215] Step 12.18: Add order logic to the client

---
 client/parties/controllers/partiesList.ng.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index b252774..9a6d599 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -31,4 +31,9 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.pageChanged = function(newPage) {
     $scope.page = newPage;
   };
+
+  $scope.$watch('orderProperty', function(){
+    if ($scope.orderProperty)
+      $scope.sort = {name: parseInt($scope.orderProperty)};
+  });
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From da69f1861864be453162d0a1041604977fd44c94 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:49:41 +0300
Subject: [PATCH 094/215] Step 12.19: Add default sort definition

---
 client/parties/controllers/partiesList.ng.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 9a6d599..09e746c 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -3,6 +3,7 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
+  $scope.orderProperty = '1';
 
   $scope.parties = $meteor.collection(function() {
     return Parties.find({}, {
-- 
2.3.2 (Apple Git-55)


From fab505cd9dba96b3fe4bec7e118c2080d82d8f80 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:48:55 +0300
Subject: [PATCH 095/215] Step 12.20: Add search string to the collection

---
 server/parties.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/server/parties.js b/server/parties.js
index 9622905..5366910 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,4 @@
-Meteor.publish("parties", function (options) {
+Meteor.publish("parties", function (options, searchString) {
   Counts.publish(this, 'numberOfParties', Parties.find({
     $or:[
       {$and:[
-- 
2.3.2 (Apple Git-55)


From d7fd9d22ca28dbe01e44ebbb7c488dad450fe221 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:50:07 +0300
Subject: [PATCH 096/215] Step 12.21: Add the search logic

---
 server/parties.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index 5366910..c2dc88b 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,5 +1,9 @@
 Meteor.publish("parties", function (options, searchString) {
+  if (searchString == null)
+    searchString = '';
+
   Counts.publish(this, 'numberOfParties', Parties.find({
+    'name' : { '$regex' : '.*' + searchString || '' + '.*', '$options' : 'i' },
     $or:[
       {$and:[
         {'public': true},
@@ -12,6 +16,7 @@ Meteor.publish("parties", function (options, searchString) {
     ]}), { noReady: true });
 
   return Parties.find({
+    'name' : { '$regex' : '.*' + searchString || '' + '.*', '$options' : 'i' },
     $or:[
       {$and:[
         {"public": true},
-- 
2.3.2 (Apple Git-55)


From 63344096e5580abf29157891cbcf67becb6e6cf4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:52:28 +0300
Subject: [PATCH 097/215] Step 12.22: Add the search input

---
 client/parties/views/parties-list.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 3d39e49..e5fd486 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -11,6 +11,7 @@
 <ul>
   <h1>Parties:</h1>
   <div>
+    <input type="search" ng-model="search" placeholder="Search">
     <select ng-model="orderProperty">
       <option value="1">Ascending</option>
       <option value="-1">Descending</option>
-- 
2.3.2 (Apple Git-55)


From 7dbc63018c5b3a6b45c5e1148107702f515f1cf7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:53:48 +0300
Subject: [PATCH 098/215] Step 12.23: Add the search param to the subscribe

---
 client/parties/controllers/partiesList.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 09e746c..ccb3442 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -16,7 +16,7 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
       limit: parseInt($scope.getReactively('perPage')),
       skip: (parseInt($scope.getReactively('page')) - 1) * parseInt($scope.getReactively('perPage')),
       sort: $scope.getReactively('sort')
-    }).then(function(){
+    }, $scope.getReactively('search')).then(function(){
       $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
     });
   });
-- 
2.3.2 (Apple Git-55)


From 4c699d60cd8dc843415fde6850dc0b654a2e17ec Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:54:32 +0300
Subject: [PATCH 099/215] Step 12.24: Remove the subscription from the object

---
 client/parties/controllers/partyDetails.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.ng.js b/client/parties/controllers/partyDetails.ng.js
index 2d9322e..7d31eb1 100644
--- a/client/parties/controllers/partyDetails.ng.js
+++ b/client/parties/controllers/partyDetails.ng.js
@@ -1,4 +1,4 @@
 angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $stateParams, $meteor) {
-  $scope.party = $meteor.object(Parties, $stateParams.partyId).subscribe('parties');
+  $scope.party = $meteor.object(Parties, $stateParams.partyId);
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a99d2d02485a4d3b2169b286c6d56d7d0360b130 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:54:58 +0300
Subject: [PATCH 100/215] Step 12.25: Add $scope subscription to the collection

---
 client/parties/controllers/partyDetails.ng.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/partyDetails.ng.js b/client/parties/controllers/partyDetails.ng.js
index 7d31eb1..09a8dc7 100644
--- a/client/parties/controllers/partyDetails.ng.js
+++ b/client/parties/controllers/partyDetails.ng.js
@@ -1,4 +1,5 @@
 angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $stateParams, $meteor) {
   $scope.party = $meteor.object(Parties, $stateParams.partyId);
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
+  $scope.$meteorSubscribe('parties');
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9d4d854c7bd09370182efb53180040e6840890cc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:57:59 +0300
Subject: [PATCH 101/215] Step 13.1: Create the filter

---
 client/parties/filters/uninvited.ng.js | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 create mode 100644 client/parties/filters/uninvited.ng.js

diff --git a/client/parties/filters/uninvited.ng.js b/client/parties/filters/uninvited.ng.js
new file mode 100644
index 0000000..9166e47
--- /dev/null
+++ b/client/parties/filters/uninvited.ng.js
@@ -0,0 +1,14 @@
+angular.module('socially').filter('uninvited', function () {
+  return function (users, party) {
+    if (!party)
+      return false;
+
+    return _.filter(users, function (user) {
+      if (user._id == party.owner ||
+        _.contains(party.invited, user._id))
+        return false;
+      else
+        return true;
+    });
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9588bb92893d8443b054b5a840057ee3c04f4786 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:59:45 +0300
Subject: [PATCH 102/215] Step 13.2: Use the filter

---
 client/parties/views/party-details.ng.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index a640092..5ab9471 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -6,8 +6,8 @@ Here you will see and change the details of the party:
 <input type="checkbox" ng-model="party.public">
 
 <ul>
-  Users:
-  <li ng-repeat="user in users">
+  Users to invite:
+  <li ng-repeat="user in users | uninvited:party">
     <div>{{ user.emails[0].address }}</div>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6626815a6a22255bd48472e46ed90c427905f9e1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:00:48 +0300
Subject: [PATCH 103/215] Step 13.3: Use filter to display user details

---
 client/parties/views/party-details.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 5ab9471..4642f74 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -8,6 +8,6 @@ Here you will see and change the details of the party:
 <ul>
   Users to invite:
   <li ng-repeat="user in users | uninvited:party">
-    <div>{{ user.emails[0].address }}</div>
+    <div>{{ user | displayName }}</div>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 935611b0fa877b817094051c2f4dfd9c30c98db8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:01:22 +0300
Subject: [PATCH 104/215] Step 13.4: Create the displayName filter

---
 client/parties/filters/displayName.ng.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 client/parties/filters/displayName.ng.js

diff --git a/client/parties/filters/displayName.ng.js b/client/parties/filters/displayName.ng.js
new file mode 100644
index 0000000..162f496
--- /dev/null
+++ b/client/parties/filters/displayName.ng.js
@@ -0,0 +1,12 @@
+angular.module('socially').filter('displayName', function () {
+  return function (user) {
+    if (!user)
+      return;
+    if (user.profile && user.profile.name)
+      return user.profile.name;
+    else if (user.emails)
+      return user.emails[0].address;
+    else
+      return user;
+  }
+});
-- 
2.3.2 (Apple Git-55)


From b078dc11699379ef43aa5fd5806e89fda0172b7b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:57:40 +0300
Subject: [PATCH 105/215] Step 13.5: Added user details

---
 client/parties/views/parties-list.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index e5fd486..3d05a0e 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -21,6 +21,7 @@
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
+    <p><small>Posted by {{ creator(party) }}</small></p>
   </li>
 </ul>
 <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4af8b35f5622ba1177a9c5928acf3f5f16b3c535 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:59:06 +0300
Subject: [PATCH 106/215] Step 13.6: Added the logic to the controller

---
 client/parties/controllers/partiesList.ng.js | 22 ++++++++++++++++++++--
 1 file changed, 20 insertions(+), 2 deletions(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index ccb3442..0cbc2f8 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -1,5 +1,4 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor) {
-
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope) {
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
@@ -37,4 +36,23 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     if ($scope.orderProperty)
       $scope.sort = {name: parseInt($scope.orderProperty)};
   });
+
+  $scope.getUserById = function(userId){
+    return Meteor.users.findOne(userId);
+  };
+
+  $scope.creator = function(party){
+    if (!party)
+      return;
+    var owner = $scope.getUserById(party.owner);
+    if (!owner)
+      return 'nobody';
+
+    if ($rootScope.currentUser)
+      if ($rootScope.currentUser._id)
+        if (owner._id === $rootScope.currentUser._id)
+          return 'me';
+
+    return owner;
+  };
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 89e2c4495395c96e11b1d36ce6e1ce69eaa28369 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:01:26 +0300
Subject: [PATCH 107/215] Step 13.7: Added subscribe to the users collection

---
 client/parties/controllers/partiesList.ng.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 0cbc2f8..5e36b3f 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -4,6 +4,8 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.sort = {name: 1};
   $scope.orderProperty = '1';
 
+  $scope.$meteorSubscribe('users');
+
   $scope.parties = $meteor.collection(function() {
     return Parties.find({}, {
       sort : $scope.getReactively('sort')
-- 
2.3.2 (Apple Git-55)


From 221eb3414e88f106401e78bee1590b7b8ba6e991 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:13:48 +0300
Subject: [PATCH 108/215] Step 13.8: Use filter to display the user info

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 3d05a0e..d3cc5e0 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -21,7 +21,7 @@
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
-    <p><small>Posted by {{ creator(party) }}</small></p>
+    <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
 </ul>
 <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a483c584087a3501e79ba47c824f4c2de6a9799e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:23:03 +0300
Subject: [PATCH 109/215] Step 14.1: Add meteor method to the model

---
 model/parties.js | 46 +++++++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 45 insertions(+), 1 deletion(-)

diff --git a/model/parties.js b/model/parties.js
index b793c1f..8998b5e 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -10,4 +10,48 @@ Parties.allow({
   remove: function (userId, party) {
     return userId && party.owner === userId;
   }
-});
\ No newline at end of file
+});
+
+Meteor.methods({
+  invite: function (partyId, userId) {
+    check(partyId, String);
+    check(userId, String);
+    var party = Parties.findOne(partyId);
+    if (!party)
+      throw new Meteor.Error(404, "No such party");
+    if (party.owner !== this.userId)
+      throw new Meteor.Error(404, "No such party");
+    if (party.public)
+      throw new Meteor.Error(400,
+        "That party is public. No need to invite people.");
+
+    if (userId !== party.owner && ! _.contains(party.invited, userId)) {
+      Parties.update(partyId, { $addToSet: { invited: userId } });
+
+      var from = contactEmail(Meteor.users.findOne(this.userId));
+      var to = contactEmail(Meteor.users.findOne(userId));
+
+      if (Meteor.isServer && to) {
+        // This code only runs on the server. If you didn't want clients
+        // to be able to see it, you could move it to a separate file.
+        Email.send({
+          from: "noreply@socially.com",
+          to: to,
+          replyTo: from || undefined,
+          subject: "PARTY: " + party.title,
+          text:
+          "Hey, I just invited you to '" + party.title + "' on Socially." +
+          "\n\nCome check it out: " + Meteor.absoluteUrl() + "\n"
+        });
+      }
+    }
+  }
+});
+
+var contactEmail = function (user) {
+  if (user.emails && user.emails.length)
+    return user.emails[0].address;
+  if (user.services && user.services.facebook && user.services.facebook.email)
+    return user.services.facebook.email;
+  return null;
+};
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 067d676c60006f3053a191b28d67d43b9bec2eca Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:10:17 +0300
Subject: [PATCH 110/215] Add check package to the project

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 0cf31b9..9d7b75a 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -23,3 +23,4 @@ accounts-facebook
 accounts-twitter
 angularutils:pagination
 tmeasday:publish-counts
+check
-- 
2.3.2 (Apple Git-55)


From 390c924ea2cce4fdf1587ef3c7973bdf3dfb5e13 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:01:09 +0300
Subject: [PATCH 111/215] Step 14.2: Add the email package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 9d7b75a..038d55d 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -24,3 +24,4 @@ accounts-twitter
 angularutils:pagination
 tmeasday:publish-counts
 check
+email
-- 
2.3.2 (Apple Git-55)


From 4d1d14ed91fa7a4613f1e5b33f9288df809c5dd6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:11:27 +0300
Subject: [PATCH 112/215] Step 14.3: Add invite method to the client

---
 client/parties/controllers/partyDetails.ng.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/parties/controllers/partyDetails.ng.js b/client/parties/controllers/partyDetails.ng.js
index 09a8dc7..ecba146 100644
--- a/client/parties/controllers/partyDetails.ng.js
+++ b/client/parties/controllers/partyDetails.ng.js
@@ -2,4 +2,15 @@ angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $sta
   $scope.party = $meteor.object(Parties, $stateParams.partyId);
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
   $scope.$meteorSubscribe('parties');
+
+  $scope.invite = function(user){
+    $meteor.call('invite', $scope.party._id, user._id).then(
+      function(data){
+        console.log('success inviting', data);
+      },
+      function(err){
+        console.log('failed', err);
+      }
+    );
+  };
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6a779405aae57317e35492935223f0ed92a1ef26 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:26:39 +0300
Subject: [PATCH 113/215] Step 14.4: Add invite button to the view

---
 client/parties/views/party-details.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 4642f74..609a4ba 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -9,5 +9,6 @@ Here you will see and change the details of the party:
   Users to invite:
   <li ng-repeat="user in users | uninvited:party">
     <div>{{ user | displayName }}</div>
+    <button ng-click="invite(user)">Invite</button>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d1962a7cdb2d8fb598616a84bcfc8cfa5587f4ef Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:27:54 +0300
Subject: [PATCH 114/215] Step 14.5: Add invited logic to the publish

---
 server/parties.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index c2dc88b..b691e30 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -12,6 +12,10 @@ Meteor.publish("parties", function (options, searchString) {
       {$and:[
         {owner: this.userId},
         {owner: {$exists: true}}
+      ]},
+      {$and:[
+        {invited: this.userId},
+        {invited: {$exists: true}}
       ]}
     ]}), { noReady: true });
 
@@ -25,6 +29,10 @@ Meteor.publish("parties", function (options, searchString) {
       {$and:[
         {owner: this.userId},
         {owner: {$exists: true}}
+      ]},
+      {$and:[
+        {invited: this.userId},
+        {invited: {$exists: true}}
       ]}
     ]}, options);
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c2b9f6d47e0dcd49753b404613b9bf0eea709b51 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:12:59 +0300
Subject: [PATCH 115/215] Step 14.6: Add RSVP function to the server

---
 model/parties.js | 40 ++++++++++++++++++++++++++++++++++++++++
 1 file changed, 40 insertions(+)

diff --git a/model/parties.js b/model/parties.js
index 8998b5e..37b10e5 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -45,6 +45,46 @@ Meteor.methods({
         });
       }
     }
+  },
+  rsvp: function (partyId, rsvp) {
+    check(partyId, String);
+    check(rsvp, String);
+    if (! this.userId)
+      throw new Meteor.Error(403, "You must be logged in to RSVP");
+    if (! _.contains(['yes', 'no', 'maybe'], rsvp))
+      throw new Meteor.Error(400, "Invalid RSVP");
+    var party = Parties.findOne(partyId);
+    if (! party)
+      throw new Meteor.Error(404, "No such party");
+    if (! party.public && party.owner !== this.userId &&
+      !_.contains(party.invited, this.userId))
+    // private, but let's not tell this to the user
+      throw new Meteor.Error(403, "No such party");
+
+    var rsvpIndex = _.indexOf(_.pluck(party.rsvps, 'user'), this.userId);
+    if (rsvpIndex !== -1) {
+      // update existing rsvp entry
+
+      if (Meteor.isServer) {
+        // update the appropriate rsvp entry with $
+        Parties.update(
+          {_id: partyId, "rsvps.user": this.userId},
+          {$set: {"rsvps.$.rsvp": rsvp}});
+      } else {
+        // minimongo doesn't yet support $ in modifier. as a temporary
+        // workaround, make a modifier that uses an index. this is
+        // safe on the client since there's only one thread.
+        var modifier = {$set: {}};
+        modifier.$set["rsvps." + rsvpIndex + ".rsvp"] = rsvp;
+        Parties.update(partyId, modifier);
+      }
+      // Possible improvement: send email to the other people that are
+      // coming to the party.
+    } else {
+      // add new rsvp entry
+      Parties.update(partyId,
+        {$push: {rsvps: {user: this.userId, rsvp: rsvp}}});
+    }
   }
 });
 
-- 
2.3.2 (Apple Git-55)


From ba75a1b3525c724b3698b1409c77bd99e0bb9a33 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:13:38 +0300
Subject: [PATCH 116/215] Step 14.7: Add RSVP function to the client

---
 client/parties/controllers/partiesList.ng.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 5e36b3f..c8ba61c 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -39,6 +39,17 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
       $scope.sort = {name: parseInt($scope.orderProperty)};
   });
 
+  $scope.rsvp = function(partyId, rsvp){
+    $meteor.call('rsvp', partyId, rsvp).then(
+      function(data){
+        console.log('success responding', data);
+      },
+      function(err){
+        console.log('failed', err);
+      }
+    );
+  };
+
   $scope.getUserById = function(userId){
     return Meteor.users.findOne(userId);
   };
-- 
2.3.2 (Apple Git-55)


From 5f302bafa466c0ac9abba69951166743a07d5384 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:33:05 +0300
Subject: [PATCH 117/215] Step 14.8: Add RSVP control to the view

---
 client/parties/views/parties-list.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index d3cc5e0..451835f 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -21,6 +21,13 @@
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
+
+    <div>
+      <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
+      <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
+      <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
+    </div>
+
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From 896ac3797d8a867d7b20530211d3bd69479d865e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:33:44 +0300
Subject: [PATCH 118/215] Step 14.9: Add RSVP list to the view

---
 client/parties/views/parties-list.ng.html | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 451835f..98e33e5 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -27,6 +27,21 @@
       <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
     </div>
+    <div>
+      Who is coming:
+      Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
+      Maybe - {{ (party.rsvps | filter:{rsvp:'maybe'}).length }}
+      No - {{ (party.rsvps | filter:{rsvp:'no'}).length }}
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'yes'}">
+        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'maybe'}">
+        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'no'}">
+        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+    </div>
 
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
-- 
2.3.2 (Apple Git-55)


From 1f4ff342614f6703709ae770121b1e35414295ca Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:15:51 +0300
Subject: [PATCH 119/215] Step 14.10: Add RSVP list to the view of users who
 not responded

---
 client/parties/views/parties-list.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 98e33e5..feb6cd6 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -43,6 +43,13 @@
       </div>
     </div>
 
+    <ul>
+      Users who not responded:
+      <li ng-repeat="invitedUser in outstandingInvitations(party)">
+        {{ invitedUser | displayName }}
+      </li>
+    </ul>
+
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From 5550081b9bce8bdb4374b53b783251902fc2e63e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:16:26 +0300
Subject: [PATCH 120/215] Step 14.11: Added logic to the controller

---
 client/parties/controllers/partiesList.ng.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index c8ba61c..1bae778 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -50,6 +50,13 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     );
   };
 
+  $scope.outstandingInvitations = function (party) {
+    return _.filter($scope.users, function (user) {
+      return (_.contains(party.invited, user._id) &&
+      !_.findWhere(party.rsvps, {user: user._id}));
+    });
+  };
+
   $scope.getUserById = function(userId){
     return Meteor.users.findOne(userId);
   };
-- 
2.3.2 (Apple Git-55)


From 36415e466f100d5766d1f69e55ae1bd35b84bc61 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:16:58 +0300
Subject: [PATCH 121/215] Step 14.12: Add users collection

---
 client/parties/controllers/partiesList.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 1bae778..d81440d 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -4,7 +4,7 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.sort = {name: 1};
   $scope.orderProperty = '1';
 
-  $scope.$meteorSubscribe('users');
+  $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
 
   $scope.parties = $meteor.collection(function() {
     return Parties.find({}, {
-- 
2.3.2 (Apple Git-55)


From 158d937e57a47438822474c9ae8e0046fd42f982 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:39:54 +0300
Subject: [PATCH 122/215] Step 15.1: Add ng-show to the directive

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index feb6cd6..4ccaaa8 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -1,4 +1,4 @@
-<form>
+<form ng-show="$root.currentUser">
   <label>Name</label>
   <input ng-model="newParty.name">
   <label>Description</label>
-- 
2.3.2 (Apple Git-55)


From a2d9542660e81fd08e0a10526caf06f1d5bcb496 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:40:35 +0300
Subject: [PATCH 123/215] Step 15.2: Add message to users that not logged in

---
 client/parties/views/parties-list.ng.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 4ccaaa8..7adf8b6 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -8,6 +8,9 @@
   <button ng-click="newParty.owner=$root.currentUser._id; parties.push(newParty)">Add</button>
   <button ng-click="removeAll()">Remove All</button>
 </form>
+<div ng-hide="$root.currentUser || $root.loggingIn">
+  Log in to create a party!
+</div>
 <ul>
   <h1>Parties:</h1>
   <div>
-- 
2.3.2 (Apple Git-55)


From 943026731637cbf1ae8e7fe1998fd13f64d5353a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:41:09 +0300
Subject: [PATCH 124/215] Step 15.3: Add ng-show to the RSVP buttons

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 7adf8b6..294ab3a 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -25,7 +25,7 @@
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
 
-    <div>
+    <div ng-show="$root.currentUser">
       <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
       <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
-- 
2.3.2 (Apple Git-55)


From d250dc3abd44baae29ae47739a9fe4e5d06a3f54 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:41:46 +0300
Subject: [PATCH 125/215] Step 15.4: Add message for not-logged in users on the
 RSVP buttons

---
 client/parties/views/parties-list.ng.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 294ab3a..bafd3b8 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -30,6 +30,10 @@
       <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
     </div>
+    <div ng-hide="$root.currentUser">
+      <i>Sign in to RSVP for this party.</i>
+    </div>
+
     <div>
       Who is coming:
       Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
-- 
2.3.2 (Apple Git-55)


From ce1bdf694c45b780c1761c92e532e2e9c65a6e1d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:42:52 +0300
Subject: [PATCH 126/215] Step 15.5: Add ng-show to delete button

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index bafd3b8..fac465d 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -23,7 +23,7 @@
   <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
-    <button ng-click="remove(party)">X</button>
+    <button ng-click="remove(party)" ng-show="$root.currentUser && $root.currentUser._id == party.owner">X</button>
 
     <div ng-show="$root.currentUser">
       <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
-- 
2.3.2 (Apple Git-55)


From 76b21b80a1bc39effaed2e20d352dca3b351dd59 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:18:44 +0300
Subject: [PATCH 127/215] Step 15.6: Add ng-if to outstanding RSVP

---
 client/parties/views/parties-list.ng.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index fac465d..13cd0f7 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -50,12 +50,15 @@
       </div>
     </div>
 
-    <ul>
+    <ul ng-if="!party.public">
       Users who not responded:
       <li ng-repeat="invitedUser in outstandingInvitations(party)">
         {{ invitedUser | displayName }}
       </li>
     </ul>
+    <div ng-if="party.public">
+      Everyone is invited
+    </div>
 
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
-- 
2.3.2 (Apple Git-55)


From dcffb3ee5655eec2c5bf49cc0b9ebcef0eb849c0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:19:00 +0300
Subject: [PATCH 128/215] Step 15.7: Add canInvite logic

---
 client/parties/controllers/partyDetails.ng.js | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.ng.js b/client/parties/controllers/partyDetails.ng.js
index ecba146..21613a2 100644
--- a/client/parties/controllers/partyDetails.ng.js
+++ b/client/parties/controllers/partyDetails.ng.js
@@ -13,4 +13,12 @@ angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $sta
       }
     );
   };
-});
\ No newline at end of file
+
+  $scope.canInvite = function (){
+    if (!$scope.party)
+      return false;
+
+    return !$scope.party.public &&
+      $scope.party.owner === Meteor.userId();
+  };
+});
-- 
2.3.2 (Apple Git-55)


From 02f4c96679daf821d3e84eaa78bca320ef0a7e05 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:47:19 +0300
Subject: [PATCH 129/215] Step 15.8: Add usage for ng-show with canInvite

---
 client/parties/views/party-details.ng.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 609a4ba..a695811 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -5,10 +5,13 @@ Here you will see and change the details of the party:
 <label>Is public</label>
 <input type="checkbox" ng-model="party.public">
 
-<ul>
+<ul ng-show="canInvite()">
   Users to invite:
   <li ng-repeat="user in users | uninvited:party">
     <div>{{ user | displayName }}</div>
     <button ng-click="invite(user)">Invite</button>
   </li>
+  <li ng-if="(users | uninvited:party).length <= 0">
+    Everyone are already invited.
+  </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 375fdd0540a33699b6ad98c5cefd3324025f5ce1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:49:32 +0300
Subject: [PATCH 130/215] Step 15.9: Example of ng-disabled

---
 client/parties/views/party-details.ng.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index a695811..f17a8f2 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -1,9 +1,9 @@
 Here you will see and change the details of the party:
 
-<input ng-model="party.name">
-<input ng-model="party.description">
+<input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id">
+<input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id">
 <label>Is public</label>
-<input type="checkbox" ng-model="party.public">
+<input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
 
 <ul ng-show="canInvite()">
   Users to invite:
-- 
2.3.2 (Apple Git-55)


From 3c0740a9cbf305bf674c244b52b121ef90da8141 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:07:46 +0300
Subject: [PATCH 131/215] Step 16.1: Add the angularui:angular-google-maps
 package

---
 .meteor/packages | 3 ++-
 .meteor/versions | 3 +++
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/.meteor/packages b/.meteor/packages
index 038d55d..08fcf96 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -23,5 +23,6 @@ accounts-facebook
 accounts-twitter
 angularutils:pagination
 tmeasday:publish-counts
-check
 email
+check
+angularui:angular-google-maps
diff --git a/.meteor/versions b/.meteor/versions
index edabe3a..e48771a 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -7,6 +7,7 @@ accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
 angular@1.0.2
 angular:angular@1.4.6
+angularui:angular-google-maps@2.2.1
 angularui:angular-ui-router@0.2.15
 angularutils:pagination@0.7.0
 autoupdate@1.2.3
@@ -58,6 +59,7 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.1
 mongo-id@1.0.1
+nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
 oauth@1.1.6
@@ -80,6 +82,7 @@ spacebars@1.0.7
 spacebars-compiler@1.0.7
 srp@1.0.4
 standard-minifiers@1.0.0
+stevezhu:lodash@1.0.2
 templating@1.1.3
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
-- 
2.3.2 (Apple Git-55)


From 0705064809b20886aa42fb2c7cb59249180b1753 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:54:08 +0300
Subject: [PATCH 132/215] Step 16.1: Add google maps module dependency

---
 client/lib/app.ng.js | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
index f6f5f1c..a7ee61e 100644
--- a/client/lib/app.ng.js
+++ b/client/lib/app.ng.js
@@ -1,5 +1,9 @@
-angular.module('socially',['angular-meteor', 'ui.router', 'angularUtils.directives.dirPagination']);
-
+angular.module('socially',[
+  'angular-meteor',
+  'ui.router',
+  'angularUtils.directives.dirPagination',
+  'uiGmapgoogle-maps'
+]);
 function onReady() {
   angular.bootstrap(document, ['socially'], {
     strictDi: true
-- 
2.3.2 (Apple Git-55)


From 2cc72b67abd3e1eb48a5de8c2f104c3ae9bcf175 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:21:32 +0300
Subject: [PATCH 133/215] Step 16.2: Add basic map to the view

---
 client/parties/views/party-details.ng.html | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index f17a8f2..73c4640 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -14,4 +14,12 @@ Here you will see and change the details of the party:
   <li ng-if="(users | uninvited:party).length <= 0">
     Everyone are already invited.
   </li>
-</ul>
\ No newline at end of file
+</ul>
+
+<div class="party-details-maps">
+  <div class="angular-google-map-container">
+    <ui-gmap-google-map center="party.location || map.center"
+                        events="map.events" zoom="map.zoom">
+    </ui-gmap-google-map>
+  </div>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c469a02cd2cf92e564ef7ea2f23c7dcfec769237 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:21:52 +0300
Subject: [PATCH 134/215] Step 16.3: Add map params to the controller

---
 client/parties/controllers/partyDetails.ng.js | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/client/parties/controllers/partyDetails.ng.js b/client/parties/controllers/partyDetails.ng.js
index 21613a2..88063ff 100644
--- a/client/parties/controllers/partyDetails.ng.js
+++ b/client/parties/controllers/partyDetails.ng.js
@@ -21,4 +21,13 @@ angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $sta
     return !$scope.party.public &&
       $scope.party.owner === Meteor.userId();
   };
+
+  $scope.map = {
+    center: {
+      latitude: 45,
+      longitude: -73
+    },
+    zoom: 8,
+    events: {}
+  };
 });
-- 
2.3.2 (Apple Git-55)


From 564ab0fa775ab3feae354f0a3f5748b79a98fcb4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:56:18 +0300
Subject: [PATCH 135/215] Step 16.4: Create basic CSS style with google map
 style

---
 client/parties/styles/parties.css | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 client/parties/styles/parties.css

diff --git a/client/parties/styles/parties.css b/client/parties/styles/parties.css
new file mode 100644
index 0000000..219ff39
--- /dev/null
+++ b/client/parties/styles/parties.css
@@ -0,0 +1,4 @@
+.angular-google-map-container {
+    height: 400px;
+    width: 400px;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0157e7a449528203e2e8e8aade82c19c61b3bcb3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:23:30 +0300
Subject: [PATCH 136/215] Step 16.5: Add party marker to the map

---
 client/parties/views/party-details.ng.html | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 73c4640..7ef1f8d 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -16,10 +16,11 @@ Here you will see and change the details of the party:
   </li>
 </ul>
 
-<div class="party-details-maps">
-  <div class="angular-google-map-container">
-    <ui-gmap-google-map center="party.location || map.center"
-                        events="map.events" zoom="map.zoom">
-    </ui-gmap-google-map>
-  </div>
+<div class="angular-google-map-container">
+  <ui-gmap-google-map center="party.location || map.center"
+                      events="map.events" zoom="map.zoom">
+    <ui-gmap-marker coords="party.location" options="map.marker.options"
+                    events="map.marker.events" idkey="party._id">
+    </ui-gmap-marker>
+  </ui-gmap-google-map>
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 3dcb0268aec67fd0c24e575ecdccef3d59f135ce Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:23:49 +0300
Subject: [PATCH 137/215] Step 16.6: Add the marker creation logic to the
 controller

---
 client/parties/controllers/partyDetails.ng.js | 27 ++++++++++++++++++++++++++-
 1 file changed, 26 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.ng.js b/client/parties/controllers/partyDetails.ng.js
index 88063ff..bbd4b0a 100644
--- a/client/parties/controllers/partyDetails.ng.js
+++ b/client/parties/controllers/partyDetails.ng.js
@@ -28,6 +28,31 @@ angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $sta
       longitude: -73
     },
     zoom: 8,
-    events: {}
+    events: {
+      click: function (mapModel, eventName, originalEventArgs) {
+        if (!$scope.party)
+          return;
+
+        if (!$scope.party.location)
+          $scope.party.location = {};
+
+        $scope.party.location.latitude = originalEventArgs[0].latLng.lat();
+        $scope.party.location.longitude = originalEventArgs[0].latLng.lng();
+        //scope apply required because this event handler is outside of the angular domain
+        $scope.$apply();
+      }
+    },
+    marker: {
+      options: { draggable: true },
+      events: {
+        dragend: function (marker, eventName, args) {
+          if (!$scope.party.location)
+            $scope.party.location = {};
+
+          $scope.party.location.latitude = marker.getPosition().lat();
+          $scope.party.location.longitude = marker.getPosition().lng();
+        }
+      }
+    }
   };
 });
-- 
2.3.2 (Apple Git-55)


From ce38ec3bb4e266624b79ea88854cbe146c040659 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:26:01 +0300
Subject: [PATCH 138/215] Step 16.7: Add map to the parties list

---
 client/parties/views/parties-list.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 13cd0f7..ec5e761 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -20,6 +20,13 @@
       <option value="-1">Descending</option>
     </select>
   </div>
+  <div class="angular-google-map-container">
+    <ui-gmap-google-map center="party.location || map.center" zoom="map.zoom">
+      <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
+                       fit="true" idkey="'_id'" doRebuildAll="true">
+      </ui-gmap-markers>
+    </ui-gmap-google-map>
+  </div>
   <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
-- 
2.3.2 (Apple Git-55)


From 6906a417242688644efc0b8c3b44edbd7f155d67 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:26:16 +0300
Subject: [PATCH 139/215] Step 16.8: Add map logic to the parties list
 controller

---
 client/parties/controllers/partiesList.ng.js | 17 ++++++++++++++++-
 1 file changed, 16 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index d81440d..88ce88b 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -1,4 +1,4 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope) {
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state) {
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
@@ -19,6 +19,21 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
       sort: $scope.getReactively('sort')
     }, $scope.getReactively('search')).then(function(){
       $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
+
+      $scope.parties.forEach( function (party) {
+        party.onClicked = function () {
+          $state.go('partyDetails', {partyId: party._id});
+        };
+      });
+
+      $scope.map = {
+        center: {
+          latitude: 45,
+          longitude: -73
+        },
+        zoom: 8
+      };
+
     });
   });
 
-- 
2.3.2 (Apple Git-55)


From bb835c564ad2755f8218bacee60dbf05a625e55d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:08:21 +0300
Subject: [PATCH 140/215] Step 17.1: Add main CSS file

---
 client/styles/main.css | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 client/styles/main.css

diff --git a/client/styles/main.css b/client/styles/main.css
new file mode 100644
index 0000000..4397047
--- /dev/null
+++ b/client/styles/main.css
@@ -0,0 +1,3 @@
+body {
+    background-color: rgba(0,0,0,.04);
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 419896176cdfa7af8221a02250cec00be0866678 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:27:28 +0300
Subject: [PATCH 141/215] Step 17.2: Add the twbs:bootstrap package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 08fcf96..71959ae 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -26,3 +26,4 @@ tmeasday:publish-counts
 email
 check
 angularui:angular-google-maps
+twbs:bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index e48771a..3890c74 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -87,6 +87,7 @@ templating@1.1.3
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
 tracker@1.0.8
+twbs:bootstrap@3.3.5
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
-- 
2.3.2 (Apple Git-55)


From f3c85c42fccd7395a9138486e4e5ce453000c06e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:09:03 +0300
Subject: [PATCH 142/215] Step 17.3: Add navbar and style to the login button

---
 client/index.html | 17 +++++++++++------
 1 file changed, 11 insertions(+), 6 deletions(-)

diff --git a/client/index.html b/client/index.html
index 30e8bee..ceefe3a 100644
--- a/client/index.html
+++ b/client/index.html
@@ -4,12 +4,17 @@
 <body>
 
 <div>
-  <blaze-template name="loginButtons"></blaze-template>
-  <h1>
-    <a href="/parties">Home</a>
-  </h1>
-
-  <div ui-view></div>
+  <header class="navbar navbar-fixed-top">
+    <div class="container-fluid">
+      <div class="navbar-header">
+        <h1>
+          <a href="/parties">Home</a>
+        </h1>
+      </div>
+      <blaze-template name="loginButtons"></blaze-template>
+    </div>
+  </header>
+  <div ui-view class="container-fluid"></div>
 </div>
 
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d0dc14b6d9bb0fcf0c090c4e721509fa80413417 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:48:29 +0300
Subject: [PATCH 143/215] Step 17.4: Add the less package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 71959ae..0ec7f97 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -27,3 +27,4 @@ email
 check
 angularui:angular-google-maps
 twbs:bootstrap
+less
-- 
2.3.2 (Apple Git-55)


From 85b331529d4d908d5b3f30d65533cb3446a450a6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:09:43 +0300
Subject: [PATCH 144/215] Step 17.5: Basic usage of LESS

---
 client/styles/main.css  | 3 ---
 client/styles/main.less | 8 ++++++++
 2 files changed, 8 insertions(+), 3 deletions(-)
 delete mode 100644 client/styles/main.css
 create mode 100644 client/styles/main.less

diff --git a/client/styles/main.css b/client/styles/main.css
deleted file mode 100644
index 4397047..0000000
--- a/client/styles/main.css
+++ /dev/null
@@ -1,3 +0,0 @@
-body {
-    background-color: rgba(0,0,0,.04);
-}
\ No newline at end of file
diff --git a/client/styles/main.less b/client/styles/main.less
new file mode 100644
index 0000000..6acada4
--- /dev/null
+++ b/client/styles/main.less
@@ -0,0 +1,8 @@
+body {
+    background-color: rgba(0,0,0,.2);
+    padding-top: 70px;
+
+    .navbar {
+        background-color: #ffffff;
+    }
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From bb92285526eb6e6b3b062ce6afca7d4d45f38749 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:10:22 +0300
Subject: [PATCH 145/215] Step 17.6: Change the name of parties css

---
 client/parties/styles/parties.css         | 4 ----
 client/parties/styles/parties.import.less | 4 ++++
 2 files changed, 4 insertions(+), 4 deletions(-)
 delete mode 100644 client/parties/styles/parties.css
 create mode 100644 client/parties/styles/parties.import.less

diff --git a/client/parties/styles/parties.css b/client/parties/styles/parties.css
deleted file mode 100644
index 219ff39..0000000
--- a/client/parties/styles/parties.css
+++ /dev/null
@@ -1,4 +0,0 @@
-.angular-google-map-container {
-    height: 400px;
-    width: 400px;
-}
\ No newline at end of file
diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
new file mode 100644
index 0000000..219ff39
--- /dev/null
+++ b/client/parties/styles/parties.import.less
@@ -0,0 +1,4 @@
+.angular-google-map-container {
+    height: 400px;
+    width: 400px;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6a8915b64d1b9cb5fe177cb8d8fa4bb0e7166800 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:10:50 +0300
Subject: [PATCH 146/215] Step 17.7: Add import to parties LESS file

---
 client/styles/main.less | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/styles/main.less b/client/styles/main.less
index 6acada4..87c5240 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -5,4 +5,7 @@ body {
     .navbar {
         background-color: #ffffff;
     }
-}
\ No newline at end of file
+}
+
+
+@import "../parties/styles/parties.import.less";
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 77194610265af6288da567651b502bd85e25ac28 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:55:47 +0300
Subject: [PATCH 147/215] Step 17.8: Add the angularui:angular-ui-bootstrap
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 0ec7f97..8c4626c 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -28,3 +28,4 @@ check
 angularui:angular-google-maps
 twbs:bootstrap
 less
+angularui:angular-ui-bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index 3890c74..2127a7f 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -8,6 +8,7 @@ accounts-ui-unstyled@1.1.8
 angular@1.0.2
 angular:angular@1.4.6
 angularui:angular-google-maps@2.2.1
+angularui:angular-ui-bootstrap@0.13.0
 angularui:angular-ui-router@0.2.15
 angularutils:pagination@0.7.0
 autoupdate@1.2.3
-- 
2.3.2 (Apple Git-55)


From b0b7a0a99161bf8c600136d41987d54c73aed723 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:45:31 +0300
Subject: [PATCH 148/215] Step 17.9: Update the index.html style and tags

---
 client/index.html | 25 ++++++++++++++-----------
 1 file changed, 14 insertions(+), 11 deletions(-)

diff --git a/client/index.html b/client/index.html
index ceefe3a..4ac712e 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,20 +1,23 @@
 <head>
+  <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
+  <link href='http://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
+  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
 </head>
 <body>
 
-<div>
-  <header class="navbar navbar-fixed-top">
-    <div class="container-fluid">
-      <div class="navbar-header">
-        <h1>
-          <a href="/parties">Home</a>
-        </h1>
-      </div>
+<nav class="navbar navbar-default navbar-fixed-top">
+  <div class="container">
+    <div class="navbar-header">
+      <a class="navbar-brand" href="/">socially</a>
+    </div>
+    <div class="navbar-right-container">
       <blaze-template name="loginButtons"></blaze-template>
     </div>
-  </header>
-  <div ui-view class="container-fluid"></div>
-</div>
+  </div>
+</nav>
 
+<div class="h100">
+  <div ui-view class="ma-main-container container-fluid h100"></div>
+</div>
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 12c4a002a36d94e5671353b7d9991b57bdeb1d19 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:47:43 +0300
Subject: [PATCH 149/215] Step 17.10: Add dependency for ui-bootstrap

---
 client/lib/app.ng.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
index a7ee61e..b466d8f 100644
--- a/client/lib/app.ng.js
+++ b/client/lib/app.ng.js
@@ -2,7 +2,8 @@ angular.module('socially',[
   'angular-meteor',
   'ui.router',
   'angularUtils.directives.dirPagination',
-  'uiGmapgoogle-maps'
+  'uiGmapgoogle-maps',
+  'ui.bootstrap'
 ]);
 function onReady() {
   angular.bootstrap(document, ['socially'], {
-- 
2.3.2 (Apple Git-55)


From ae96e9ede81dcdd2358539abd70e5ba7d3ddd0e7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:49:19 +0300
Subject: [PATCH 150/215] Step 17.11: Move the logic of add new party to
 separated controller

---
 client/parties/controllers/addNewParty.ng.js | 10 ++++++++++
 1 file changed, 10 insertions(+)
 create mode 100644 client/parties/controllers/addNewParty.ng.js

diff --git a/client/parties/controllers/addNewParty.ng.js b/client/parties/controllers/addNewParty.ng.js
new file mode 100644
index 0000000..f2d0d1a
--- /dev/null
+++ b/client/parties/controllers/addNewParty.ng.js
@@ -0,0 +1,10 @@
+angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$modalInstance', 'parties',
+  function ($scope, $meteor, $rootScope, $state, $modalInstance, parties) {
+
+    $scope.addNewParty = function () {
+      $scope.newParty.owner = $rootScope.currentUser._id;
+      parties.push($scope.newParty);
+      $scope.newParty = '';
+      $modalInstance.close();
+    }
+  }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ec7fcf8294f7429591412d4f833cb9ddf1943ed0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:57:13 +0300
Subject: [PATCH 151/215] Step 17.12: Create the view of new party modal

---
 client/parties/views/add-new-party-modal.ng.html | 24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 client/parties/views/add-new-party-modal.ng.html

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
new file mode 100644
index 0000000..5fd3485
--- /dev/null
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -0,0 +1,24 @@
+<div class="container-fluid ma-add-new-party-container">
+  <div class="alert alert-info" ng-hide="$root.currentUser || $root.loggingIn">
+    Please log in to create a party!
+  </div>
+
+  <form ng-show="$root.currentUser || $root.loggingIn">
+    <h2>Create a new party</h2>
+
+    <div class="form-group">
+      <label for="nameInput">Name</label>
+      <input ng-model="newParty.name" id="nameInput" type="text" class="form-control">
+    </div>
+    <div class="form-group">
+      <label for="description">Description</label>
+      <input ng-model="newParty.description" id="description" type="text" class="form-control">
+    </div>
+    <div class="form-group">
+      <label for="public">
+        <input type="checkbox" ng-model="newParty.public" id="public"> Public
+      </label>
+    </div>
+    <button ng-click="addNewParty()" class="btn">Add</button>
+  </form>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From aa4154fbe26c0b97f9228ddac914a31e362bbc17 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:29:08 +0300
Subject: [PATCH 152/215] Step 17.13: Update the parties list HTML

---
 client/parties/views/parties-list.ng.html | 175 +++++++++++++++++++-----------
 1 file changed, 110 insertions(+), 65 deletions(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index ec5e761..c66ae56 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -1,73 +1,118 @@
-<form ng-show="$root.currentUser">
-  <label>Name</label>
-  <input ng-model="newParty.name">
-  <label>Description</label>
-  <input ng-model="newParty.description">
-  <label>Public</label>
-  <input type="checkbox" ng-model="newParty.public">
-  <button ng-click="newParty.owner=$root.currentUser._id; parties.push(newParty)">Add</button>
-  <button ng-click="removeAll()">Remove All</button>
-</form>
-<div ng-hide="$root.currentUser || $root.loggingIn">
-  Log in to create a party!
-</div>
-<ul>
-  <h1>Parties:</h1>
-  <div>
-    <input type="search" ng-model="search" placeholder="Search">
-    <select ng-model="orderProperty">
-      <option value="1">Ascending</option>
-      <option value="-1">Descending</option>
-    </select>
-  </div>
-  <div class="angular-google-map-container">
-    <ui-gmap-google-map center="party.location || map.center" zoom="map.zoom">
-      <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
-                       fit="true" idkey="'_id'" doRebuildAll="true">
-      </ui-gmap-markers>
-    </ui-gmap-google-map>
-  </div>
-  <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
-    <a href="/parties/{{party._id}}">{{party.name}}</a>
-    <p>{{party.description}}</p>
-    <button ng-click="remove(party)" ng-show="$root.currentUser && $root.currentUser._id == party.owner">X</button>
-
-    <div ng-show="$root.currentUser">
-      <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
-      <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
-      <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
-    </div>
-    <div ng-hide="$root.currentUser">
-      <i>Sign in to RSVP for this party.</i>
-    </div>
+<div class="row h100">
+  <div class="col-md-6 ma-parties-col">
+    <div class="row">
+      <div class="col-xs-8">
+        <form class="form-inline search-form">
+          <div class="form-group">
+            <label class="sr-only" for="search">Search</label>
 
-    <div>
-      Who is coming:
-      Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
-      Maybe - {{ (party.rsvps | filter:{rsvp:'maybe'}).length }}
-      No - {{ (party.rsvps | filter:{rsvp:'no'}).length }}
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'yes'}">
-        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
-      </div>
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'maybe'}">
-        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+            <div class="input-group">
+              <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div>
+              <input type="text" ng-model="search" placeholder="Search" id="search" class="form-control">
+            </div>
+          </div>
+          <div class="form-group">
+            <label class="sr-only" for="sort-order">Sort Order</label>
+            <select ng-model="orderProperty" class="form-control">
+              <option value="1">Ascending</option>
+              <option value="-1">Descending</option>
+            </select>
+          </div>
+        </form>
       </div>
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'no'}">
-        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      <div class="col-xs-4 ma-add-button-container">
+        <button class="btn" ng-click="openAddNewPartyModal()"><i class="fa fa-plus"></i></button>
       </div>
     </div>
+    <ul class="list-group">
+      <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count"
+          class="list-group-item ma-party-item">
+
+        <i ng-click="remove(party)" class="ma-remove fa fa-times"
+           ng-show="$root.currentUser && $root.currentUser._id == party.owner"></i>
+
+
+        <div class="row">
+          <div class="col-sm-8">
+            <h2 class="ma-party-name"><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
+
+            <p class="ma-party-description">{{party.description}}</p>
+          </div>
+        </div>
+
+        <div class="row ma-party-item-bottom">
+          <div class="col-sm-8 ma-posted-by-col">
+            <span class="ma-posted-by">Posted by {{ creator(party) | displayName }}  </span>
+
+            <span ng-if="party.public" class="ma-everyone-invited"><i class="fa fa-male"></i> Everyone is invited</span>
+
+                        <span ng-if="!party.public" class="ma-everyone-invited">
+                             <i class="fa fa-user-secret"></i>  This is a private event
+                        </span>
+
+            <div ng-show="$root.currentUser" class="ma-rsvp-buttons">
+              <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')" class="btn"
+                     ng-class="{'btn-primary' : isRSVP('yes', party)}">
+              <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')" class="btn"
+                     ng-class="{'btn-primary' : isRSVP('maybe', party)}">
+              <input type="button" value="No" ng-click="rsvp(party._id, 'no')" class="btn"
+                     ng-class="{'btn-primary' : isRSVP('no', party)}">
+            </div>
+            <div ng-hide="$root.currentUser">
+              <i>Sign in to RSVP for this party.</i>
+            </div>
+
+
+          </div>
+          <div class="col-sm-4">
+            <div class="ma-rsvp-sum">
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'yes'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  YES
+                </div>
+              </div>
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  MAYBE
+                </div>
+              </div>
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'no'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  NO
+                </div>
+              </div>
+            </div>
+
+            <ul ng-if="!party.public">
+              <li ng-repeat="invitedUser in outstandingInvitations(party)">
+                {{ invitedUser | displayName }}
+              </li>
+            </ul>
+
+          </div>
+        </div>
 
-    <ul ng-if="!party.public">
-      Users who not responded:
-      <li ng-repeat="invitedUser in outstandingInvitations(party)">
-        {{ invitedUser | displayName }}
       </li>
     </ul>
-    <div ng-if="party.public">
-      Everyone is invited
-    </div>
+    <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
 
-    <p><small>Posted by {{ creator(party) | displayName }}</small></p>
-  </li>
-</ul>
-<dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
+  </div>
+  <div class="col-md-6 h100 ma-angular-map-col">
+    <div class="angular-google-map-container h100">
+      <ui-gmap-google-map center="map.center" zoom="map.zoom" options="map.options">
+        <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
+                         fit="true" idkey="'_id'" doRebuildAll="true">
+        </ui-gmap-markers>
+      </ui-gmap-google-map>
+    </div>
+  </div>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 62a8387a004524c4d1a60280390bce561cca832a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:29:32 +0300
Subject: [PATCH 153/215] Step 17.14: Update the logic of the parties list and
 add style to the map

---
 client/parties/controllers/partiesList.ng.js | 116 +++++++++++++++++++++++----
 1 file changed, 102 insertions(+), 14 deletions(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 88ce88b..20974ea 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -1,4 +1,4 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state) {
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $modal) {
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
@@ -20,22 +20,82 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     }, $scope.getReactively('search')).then(function(){
       $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
 
-      $scope.parties.forEach( function (party) {
-        party.onClicked = function () {
-          $state.go('partyDetails', {partyId: party._id});
+        $scope.parties.forEach( function (party) {
+          party.onClicked = function () {
+            $state.go('partyDetails', {partyId: party._id});
+          };
+        });
+
+        var styles1 = [{
+          "featureType": "landscape.natural",
+          "elementType": "geometry.fill",
+          "stylers": [{"visibility": "on"}, {"color": "#e0efef"}]
+        }, {
+          "featureType": "poi",
+          "elementType": "geometry.fill",
+          "stylers": [{"visibility": "on"}, {"hue": "#1900ff"}, {"color": "#c0e8e8"}]
+        }, {
+          "featureType": "road",
+          "elementType": "geometry",
+          "stylers": [{"lightness": 100}, {"visibility": "simplified"}]
+        }, {
+          "featureType": "road",
+          "elementType": "labels",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "transit.line",
+          "elementType": "geometry",
+          "stylers": [{"visibility": "on"}, {"lightness": 700}]
+        }, {"featureType": "water", "elementType": "all", "stylers": [{"color": "#7dcdcd"}]}];
+        var styles2 = [{
+          "featureType": "administrative",
+          "elementType": "labels.text.fill",
+          "stylers": [{"color": "#444444"}]
+        }, {
+          "featureType": "landscape",
+          "elementType": "all",
+          "stylers": [{"color": "#f2f2f2"}]
+        }, {
+          "featureType": "poi",
+          "elementType": "all",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "road",
+          "elementType": "all",
+          "stylers": [{"saturation": -100}, {"lightness": 45}]
+        }, {
+          "featureType": "road.highway",
+          "elementType": "all",
+          "stylers": [{"visibility": "simplified"}]
+        }, {
+          "featureType": "road.arterial",
+          "elementType": "labels.icon",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "transit",
+          "elementType": "all",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "water",
+          "elementType": "all",
+          "stylers": [{"color": "#46bcec"}, {"visibility": "on"}]
+        }];
+
+
+        $scope.map = {
+          center: {
+            latitude: 45,
+            longitude: -73
+          },
+          options: {
+            styles: styles2,
+            maxZoom: 10
+          },
+          zoom: 8
         };
-      });
-
-      $scope.map = {
-        center: {
-          latitude: 45,
-          longitude: -73
-        },
-        zoom: 8
-      };
 
+      });
     });
-  });
 
   $scope.remove = function (party) {
     $scope.parties.splice($scope.parties.indexOf(party), 1);
@@ -90,4 +150,32 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
 
     return owner;
   };
+  
+  $scope.openAddNewPartyModal = function () {
+    var modalInstance = $modal.open({
+      animation: true,
+      templateUrl: 'client/parties/views/add-new-party-modal.ng.html',
+      controller: 'AddNewPartyCtrl',
+      resolve: {
+        parties: function () {
+          return $scope.parties;
+        }
+      }
+    });
+
+    modalInstance.result.then(function () {
+    }, function () {
+    });
+  };
+
+  $scope.isRSVP = function (rsvp, party) {
+    if (!$rootScope.currentUser._id) return false;
+    var rsvpIndex = party.myRsvpIndex;
+    rsvpIndex = rsvpIndex || _.indexOf(_.pluck(party.rsvps, 'user'), $rootScope.currentUser._id);
+
+    if (rsvpIndex !== -1) {
+      party.myRsvpIndex = rsvpIndex;
+      return party.rsvps[rsvpIndex].rsvp === rsvp;
+    }
+  }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e2a72039df722316f42b0084afa19751ca0053ce Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 15:03:57 +0300
Subject: [PATCH 154/215] Step 17.15: Create less file for each component and
 update the CSS rules

---
 client/parties/styles/navbar.import.less        |  35 +++++++
 client/parties/styles/new.party.import.less     |  19 ++++
 client/parties/styles/parties.import.less       | 123 +++++++++++++++++++++++-
 client/parties/styles/party.details.import.less |  26 +++++
 4 files changed, 200 insertions(+), 3 deletions(-)
 create mode 100644 client/parties/styles/navbar.import.less
 create mode 100644 client/parties/styles/new.party.import.less
 create mode 100644 client/parties/styles/party.details.import.less

diff --git a/client/parties/styles/navbar.import.less b/client/parties/styles/navbar.import.less
new file mode 100644
index 0000000..96a6b49
--- /dev/null
+++ b/client/parties/styles/navbar.import.less
@@ -0,0 +1,35 @@
+// Override Bootstrap navbar
+.navbar {
+  background-color: #ffffff;
+  border-bottom: #eee 1px solid;
+  color: @color3;
+  font-family: 'Muli', sans-serif;
+  a {
+    color: @color3;
+    text-decoration: none !important;
+  }
+
+  .navbar-right-container {
+    position: absolute;
+    top: 17px;
+    right: 17px;
+  }
+}
+
+// Overrise Meteor Login Buttons
+#login-dropdown-list.accounts-dialog {
+  right: 14px;
+  left: auto;
+}
+
+#login-buttons .login-button,
+.accounts-dialog .login-button {
+  background: @color3;
+  color: white;
+  border: none;
+
+  &:hover {
+    background: @color3;
+    color: white;
+  }
+}
\ No newline at end of file
diff --git a/client/parties/styles/new.party.import.less b/client/parties/styles/new.party.import.less
new file mode 100644
index 0000000..6c678fe
--- /dev/null
+++ b/client/parties/styles/new.party.import.less
@@ -0,0 +1,19 @@
+.ma-add-new-party-container {
+  padding: 20px;
+  > form {
+    > h2 {
+      font-siz: 15px;
+      margin-bottom: 20px;
+    }
+    button {
+      background: @color3;
+      color: @color5;
+    }
+  }
+
+  .alert.alert-info {
+    background: @color3;
+    color: @color5;
+    margin-bottom: 0;
+  }
+}
\ No newline at end of file
diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 219ff39..e863737 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -1,4 +1,121 @@
-.angular-google-map-container {
-    height: 400px;
-    width: 400px;
+.ma-add-button-container {
+    button.btn {
+        background: @color3;
+        float: right;
+        margin-right: 5px;
+        outline: none;
+        i {
+            color: @color5;
+        }
+    }
+}
+
+.ma-parties-col {
+    padding-top: 20px;
+}
+
+.ma-party-item {
+    .ma-party-name {
+        margin-bottom: 20px;
+        a {
+            color: @color6;
+            text-decoration: none !important;
+            font-weight: 400;
+        }
+    }
+    .ma-party-description {
+        color: @color6;
+        font-weight: 300;
+        padding-left: 18px;
+        font-size: 14px;
+    }
+
+    .ma-remove {
+        color: lighten(@color7, 20%);
+        position: absolute;
+        right: 20px;
+        top: 20px;
+        &:hover {
+            color: @color7;
+        }
+    }
+
+    .ma-party-item-bottom {
+        padding-top: 10px;
+        .ma-posted-by-col {
+            .ma-posted-by {
+                color: darken(@color4, 30%);
+                font-size: 12px;
+            }
+            .ma-everyone-invited {
+                @media (max-width: 400px) {
+                    display: block;
+                    i {
+                        margin-left: 0px !important;
+                    }
+                }
+                font-size: 12px;
+                color: darken(@color4, 10%);
+                i {
+                    color: darken(@color4, 10%);
+                    margin-left: 5px;
+                }
+            }
+        }
+
+        .ma-rsvp-buttons {
+            input.btn {
+                color: darken(@color3, 20%);
+                background: transparent !important;
+                outline: none;
+                padding-left: 0;
+                &:active {
+                    box-shadow: none;
+                }
+                &:hover {
+                    color: darken(@color3, 30%);
+                }
+                &.btn-primary {
+                    color: lighten(@color3, 10%);
+                    border: 0;
+                    background: transparent !important;
+                }
+            }
+        }
+
+        .ma-rsvp-sum {
+            width: 160px;
+            @media (min-width: 400px) {
+                float: right;
+            }
+            @media (max-width: 400px) {
+                margin: 0 auto;
+            }
+        }
+        .ma-rsvp-amount {
+            display: inline-block;
+            text-align: center;
+            width: 50px;
+            .ma-amount {
+                font-weight: bold;
+                font-size: 20px;
+            }
+            .ma-rsvp-title {
+                font-size: 11px;
+                color: #aaa;
+                text-transform: uppercase;
+            }
+        }
+    }
+}
+
+.ma-angular-map-col {
+    .angular-google-map-container, .angular-google-map {
+        height: 100%;
+        width: 100%;
+    }
+}
+
+.search-form {
+    margin-bottom: 1em;
 }
\ No newline at end of file
diff --git a/client/parties/styles/party.details.import.less b/client/parties/styles/party.details.import.less
new file mode 100644
index 0000000..4f19b98
--- /dev/null
+++ b/client/parties/styles/party.details.import.less
@@ -0,0 +1,26 @@
+.ma-party-details-container {
+  padding: 20px;
+  .angular-google-map-container {
+    width: 100%;
+    height: 100%;
+  }
+  .angular-google-map {
+    width: 100%;
+    height: 400px;
+  }
+  .ma-map-title {
+    font-size: 16px;
+    font-weight: bolder;
+  }
+  .ma-invite-list {
+    margin-top: 20px;
+    margin-bottom: 20px;
+    h3 {
+      font-size: 16px;
+      font-weight: bolder;
+    }
+    ul {
+      padding: 0;
+    }
+  }
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8d6da53f868b52d6ef659472cd5fade35c4f4359 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 15:04:28 +0300
Subject: [PATCH 155/215] Step 17.16: Update the main less file to use the new
 files

---
 client/styles/main.less | 38 ++++++++++++++++++++++++++++++++------
 1 file changed, 32 insertions(+), 6 deletions(-)

diff --git a/client/styles/main.less b/client/styles/main.less
index 87c5240..e75ad09 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,11 +1,37 @@
+@color1 : #2F2933;
+@color2 : #01A2A6;
+@color3 : #29D9C2;
+@color4 : #BDF271;
+@color5 : #FFFFA6;
+@color6 : #2F2933;
+@color7 : #FF6F69;
+
+html,body{
+    height:100%;
+}
+
 body {
-    background-color: rgba(0,0,0,.2);
-    padding-top: 70px;
+    background-color: #f8f8f8;
+    padding-top: 50px;
+    font-family: 'Muli', sans-serif;
+}
 
-    .navbar {
-        background-color: #ffffff;
-    }
+.h100{
+    height : 100%;
 }
 
+.w100{
+    width:100%;
+}
+
+
+.ma-main-container{
+    @media (min-width: 400px) {
+        padding-right : 0;
+    }
+}
 
-@import "../parties/styles/parties.import.less";
\ No newline at end of file
+@import "../parties/styles/parties.import.less";
+@import "../parties/styles/navbar.import.less";
+@import "../parties/styles/new.party.import.less";
+@import "../parties/styles/party.details.import.less";
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5c3c97c405246de74ce4f4334958f9f66e2b64c1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 15:05:35 +0300
Subject: [PATCH 156/215] Step 17.17: Update the view of party details page

---
 client/parties/views/party-details.ng.html | 72 +++++++++++++++++++++---------
 1 file changed, 50 insertions(+), 22 deletions(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 7ef1f8d..104a657 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -1,26 +1,54 @@
-Here you will see and change the details of the party:
+<div class="row ma-party-details-container">
+  <div class="col-sm-6 col-sm-offset-3">
+    <legend>
+      View and Edit Your Party Details:
+    </legend>
+    <form class="form-horizontal">
+      <div class="form-group">
+        <label>Party Name</label>
+        <input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id" type="text"
+               class="form-control">
+      </div>
+      <div class="form-group">
+        <label>Party Name</label>
+        <input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id" type="text"
+               class="form-control">
+      </div>
+      <div class="form-group">
+        <label>Is public</label>
+        <input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
+      </div>
+    </form>
 
-<input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id">
-<input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id">
-<label>Is public</label>
-<input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
+    <div class="ma-invite-list" ng-show="canInvite()">
+      <h3>
+        Users to invite:
+      </h3>
+      <ul>
 
-<ul ng-show="canInvite()">
-  Users to invite:
-  <li ng-repeat="user in users | uninvited:party">
-    <div>{{ user | displayName }}</div>
-    <button ng-click="invite(user)">Invite</button>
-  </li>
-  <li ng-if="(users | uninvited:party).length <= 0">
-    Everyone are already invited.
-  </li>
-</ul>
+        <li ng-repeat="user in users | uninvited:party">
+          <div>{{ user | displayName }}</div>
+          <button ng-click="invite(user)">Invite</button>
+        </li>
+        <li ng-if="(users | uninvited:party).length <= 0">
+          Everyone are already invited.
+        </li>
+      </ul>
+    </div>
+
+
+    <h3 class="ma-map-title">
+      Click the map to set the party location
+    </h3>
+
+    <div class="angular-google-map-container">
+      <ui-gmap-google-map center="party.location || map.center" 
+                          events="map.events" zoom="map.zoom">
+        <ui-gmap-marker coords="party.location" options="map.marker.options" 
+                        events="map.marker.events" idkey="party._id">
+        </ui-gmap-marker>
+      </ui-gmap-google-map>
+    </div>
+  </div>
 
-<div class="angular-google-map-container">
-  <ui-gmap-google-map center="party.location || map.center"
-                      events="map.events" zoom="map.zoom">
-    <ui-gmap-marker coords="party.location" options="map.marker.options"
-                    events="map.marker.events" idkey="party._id">
-    </ui-gmap-marker>
-  </ui-gmap-google-map>
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ed2ee9f7c85a310e70d97ee529b51cf421333acb Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:17:21 +0300
Subject: [PATCH 157/215] Step 18.1: Remove the twbs:bootstrap package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 8c4626c..c18f667 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -26,6 +26,5 @@ tmeasday:publish-counts
 email
 check
 angularui:angular-google-maps
-twbs:bootstrap
 less
 angularui:angular-ui-bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index 2127a7f..b14e623 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -88,7 +88,6 @@ templating@1.1.3
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
 tracker@1.0.8
-twbs:bootstrap@3.3.5
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
-- 
2.3.2 (Apple Git-55)


From 0dfb988cb6981a633730a8f32771e2bfebd025ef Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:20:39 +0300
Subject: [PATCH 158/215] Step 18.2: Add the angular:angular-material package

---
 .meteor/packages | 1 +
 .meteor/versions | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index c18f667..70f2fee 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -28,3 +28,4 @@ check
 angularui:angular-google-maps
 less
 angularui:angular-ui-bootstrap
+angular:angular-material
diff --git a/.meteor/versions b/.meteor/versions
index b14e623..2c5dfcc 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -7,6 +7,9 @@ accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
 angular@1.0.2
 angular:angular@1.4.6
+angular:angular-animate@1.4.6
+angular:angular-aria@1.4.6
+angular:angular-material@0.11.0
 angularui:angular-google-maps@2.2.1
 angularui:angular-ui-bootstrap@0.13.0
 angularui:angular-ui-router@0.2.15
-- 
2.3.2 (Apple Git-55)


From 5bcc900f6d48224231ec81571e325a0129a34c76 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:32:13 +0300
Subject: [PATCH 159/215] Step 18.3: Add the ngMaterial dependency

---
 client/lib/app.ng.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
index b466d8f..2ca6523 100644
--- a/client/lib/app.ng.js
+++ b/client/lib/app.ng.js
@@ -3,7 +3,7 @@ angular.module('socially',[
   'ui.router',
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
-  'ui.bootstrap'
+  'ngMaterial'
 ]);
 function onReady() {
   angular.bootstrap(document, ['socially'], {
-- 
2.3.2 (Apple Git-55)


From 95d2459a6593f527b2fd07eedc47458834916d80 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:32:28 +0300
Subject: [PATCH 160/215] Step 18.4: Remove $modal and use $mdDialog instead

---
 client/parties/controllers/partiesList.ng.js | 39 ++++++++++++++--------------
 1 file changed, 20 insertions(+), 19 deletions(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 20974ea..9498791 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -1,4 +1,4 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $modal) {
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $mdDialog) {
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
@@ -148,25 +148,26 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
         if (owner._id === $rootScope.currentUser._id)
           return 'me';
 
-    return owner;
-  };
-  
-  $scope.openAddNewPartyModal = function () {
-    var modalInstance = $modal.open({
-      animation: true,
-      templateUrl: 'client/parties/views/add-new-party-modal.ng.html',
-      controller: 'AddNewPartyCtrl',
-      resolve: {
-        parties: function () {
-          return $scope.parties;
+      return owner;
+    };
+
+    $scope.openAddNewPartyModal = function(){
+      $mdDialog.show({
+        controller: 'AddNewPartyCtrl',
+        templateUrl: 'client/parties/views/add-new-party-modal.ng.html',
+        clickOutsideToClose:true,
+        resolve: {
+          parties: function () {
+            return $scope.parties;
+          }
         }
-      }
-    });
-
-    modalInstance.result.then(function () {
-    }, function () {
-    });
-  };
+      })
+        .then(function(answer) {
+          $scope.status = 'You said the information was "' + answer + '".';
+        }, function() {
+          $scope.status = 'You cancelled the dialog.';
+        });
+    };
 
   $scope.isRSVP = function (rsvp, party) {
     if (!$rootScope.currentUser._id) return false;
-- 
2.3.2 (Apple Git-55)


From a142e2865ce1d4c0782f1f1619deab95512df6f0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:34:26 +0300
Subject: [PATCH 161/215] Step 18.5: Update usage in the modal controller

---
 client/parties/controllers/addNewParty.ng.js | 19 ++++++++++++-------
 1 file changed, 12 insertions(+), 7 deletions(-)

diff --git a/client/parties/controllers/addNewParty.ng.js b/client/parties/controllers/addNewParty.ng.js
index f2d0d1a..af25c36 100644
--- a/client/parties/controllers/addNewParty.ng.js
+++ b/client/parties/controllers/addNewParty.ng.js
@@ -1,10 +1,15 @@
-angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$modalInstance', 'parties',
-  function ($scope, $meteor, $rootScope, $state, $modalInstance, parties) {
-
+angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog', 'parties',
+  function ($scope, $meteor, $rootScope, $state, $mdDialog, parties) {
+    $scope.newParty = {};
     $scope.addNewParty = function () {
-      $scope.newParty.owner = $rootScope.currentUser._id;
-      parties.push($scope.newParty);
-      $scope.newParty = '';
-      $modalInstance.close();
+      if($scope.newParty.name){
+        $scope.newParty.owner = $rootScope.currentUser._id;
+        parties.push($scope.newParty);
+        $scope.newParty = '';
+        $mdDialog.hide();
+      }
+    }
+    $scope.close = function () {
+      $mdDialog.hide();
     }
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2326791cc589e1d9ffb91060fdf751c552a9ae37 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:46:47 +0300
Subject: [PATCH 162/215] Step 18.6: Update the LESS files to match
 angular-material

---
 client/parties/styles/navbar.import.less        |  36 +-----
 client/parties/styles/new.party.import.less     |  19 ---
 client/parties/styles/parties.import.less       | 151 ++++++++----------------
 client/parties/styles/party.details.import.less |  28 +----
 client/styles/main.less                         |  35 +-----
 5 files changed, 55 insertions(+), 214 deletions(-)
 delete mode 100644 client/parties/styles/new.party.import.less

diff --git a/client/parties/styles/navbar.import.less b/client/parties/styles/navbar.import.less
index 96a6b49..f42291d 100644
--- a/client/parties/styles/navbar.import.less
+++ b/client/parties/styles/navbar.import.less
@@ -1,35 +1,5 @@
-// Override Bootstrap navbar
-.navbar {
-  background-color: #ffffff;
-  border-bottom: #eee 1px solid;
-  color: @color3;
-  font-family: 'Muli', sans-serif;
-  a {
-    color: @color3;
-    text-decoration: none !important;
-  }
-
-  .navbar-right-container {
-    position: absolute;
-    top: 17px;
-    right: 17px;
-  }
-}
-
-// Overrise Meteor Login Buttons
-#login-dropdown-list.accounts-dialog {
-  right: 14px;
-  left: auto;
-}
-
-#login-buttons .login-button,
-.accounts-dialog .login-button {
-  background: @color3;
-  color: white;
-  border: none;
-
-  &:hover {
-    background: @color3;
-    color: white;
+md-toolbar {
+  h2{
+    margin : 0;
   }
 }
\ No newline at end of file
diff --git a/client/parties/styles/new.party.import.less b/client/parties/styles/new.party.import.less
deleted file mode 100644
index 6c678fe..0000000
--- a/client/parties/styles/new.party.import.less
+++ /dev/null
@@ -1,19 +0,0 @@
-.ma-add-new-party-container {
-  padding: 20px;
-  > form {
-    > h2 {
-      font-siz: 15px;
-      margin-bottom: 20px;
-    }
-    button {
-      background: @color3;
-      color: @color5;
-    }
-  }
-
-  .alert.alert-info {
-    background: @color3;
-    color: @color5;
-    margin-bottom: 0;
-  }
-}
\ No newline at end of file
diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index e863737..0f7beb6 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -1,121 +1,62 @@
-.ma-add-button-container {
-    button.btn {
-        background: @color3;
-        float: right;
-        margin-right: 5px;
-        outline: none;
-        i {
-            color: @color5;
-        }
-    }
+
+.navbar-text {
+    margin-right: 0;
 }
 
-.ma-parties-col {
-    padding-top: 20px;
+#login-dropdown-list.accounts-dialog {
+    right: 14px;
+    left: auto;
 }
 
-.ma-party-item {
-    .ma-party-name {
-        margin-bottom: 20px;
-        a {
-            color: @color6;
-            text-decoration: none !important;
-            font-weight: 400;
-        }
-    }
-    .ma-party-description {
-        color: @color6;
-        font-weight: 300;
-        padding-left: 18px;
-        font-size: 14px;
+.search-form {
+    margin-bottom: 1em;
+}
+
+.ma-parties-list{
+    .angular-google-map{
+        box-sizing: border-box;
+        -webkit-flex: 1;
+        -ms-flex: 1;
+        flex: 1;
+        -webkit-flex-direction: row;
+        -ms-flex-direction: row;
+        flex-direction: row;
+        box-sizing: border-box;
+        display: -webkit-flex;
+        display: -moz-flex;
+        display: -ms-flexbox;
+        display: flex;
     }
 
-    .ma-remove {
-        color: lighten(@color7, 20%);
-        position: absolute;
-        right: 20px;
-        top: 20px;
-        &:hover {
-            color: @color7;
-        }
+    .angular-google-map-container{
+        box-sizing: border-box;
+        -webkit-flex: 1;
+        -ms-flex: 1;
+        flex: 1;
     }
 
-    .ma-party-item-bottom {
-        padding-top: 10px;
-        .ma-posted-by-col {
-            .ma-posted-by {
-                color: darken(@color4, 30%);
-                font-size: 12px;
-            }
-            .ma-everyone-invited {
-                @media (max-width: 400px) {
-                    display: block;
-                    i {
-                        margin-left: 0px !important;
-                    }
-                }
-                font-size: 12px;
-                color: darken(@color4, 10%);
-                i {
-                    color: darken(@color4, 10%);
-                    margin-left: 5px;
-                }
-            }
+    .rsvps-sum{
+        float:left;
+        width:50px;
+        text-align: center;
+        .rsvps-amount{
+            font-size:24px;
         }
-
-        .ma-rsvp-buttons {
-            input.btn {
-                color: darken(@color3, 20%);
-                background: transparent !important;
-                outline: none;
-                padding-left: 0;
-                &:active {
-                    box-shadow: none;
-                }
-                &:hover {
-                    color: darken(@color3, 30%);
-                }
-                &.btn-primary {
-                    color: lighten(@color3, 10%);
-                    border: 0;
-                    background: transparent !important;
-                }
-            }
+        .rsvps-title{
+            font-size:13px;
+            color:#aaa;
         }
+    }
 
-        .ma-rsvp-sum {
-            width: 160px;
-            @media (min-width: 400px) {
-                float: right;
-            }
-            @media (max-width: 400px) {
-                margin: 0 auto;
+    .ma-party{
+        .ma-name{
+            a{
+                text-decoration: none;
+                color : #333;
             }
         }
-        .ma-rsvp-amount {
-            display: inline-block;
-            text-align: center;
-            width: 50px;
-            .ma-amount {
-                font-weight: bold;
-                font-size: 20px;
-            }
-            .ma-rsvp-title {
-                font-size: 11px;
-                color: #aaa;
-                text-transform: uppercase;
-            }
-        }
-    }
-}
+        .ma-description{
 
-.ma-angular-map-col {
-    .angular-google-map-container, .angular-google-map {
-        height: 100%;
-        width: 100%;
+        }
     }
-}
-
-.search-form {
-    margin-bottom: 1em;
 }
\ No newline at end of file
diff --git a/client/parties/styles/party.details.import.less b/client/parties/styles/party.details.import.less
index 4f19b98..6011e87 100644
--- a/client/parties/styles/party.details.import.less
+++ b/client/parties/styles/party.details.import.less
@@ -1,26 +1,6 @@
-.ma-party-details-container {
-  padding: 20px;
-  .angular-google-map-container {
-    width: 100%;
-    height: 100%;
-  }
-  .angular-google-map {
-    width: 100%;
-    height: 400px;
-  }
-  .ma-map-title {
-    font-size: 16px;
-    font-weight: bolder;
-  }
-  .ma-invite-list {
-    margin-top: 20px;
-    margin-bottom: 20px;
-    h3 {
-      font-size: 16px;
-      font-weight: bolder;
-    }
-    ul {
-      padding: 0;
-    }
+.ma-party-details{
+  .angular-google-map-container, .angular-google-map{
+    width:100%;
+    height:400px;
   }
 }
\ No newline at end of file
diff --git a/client/styles/main.less b/client/styles/main.less
index e75ad09..438dc59 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,37 +1,6 @@
-@color1 : #2F2933;
-@color2 : #01A2A6;
-@color3 : #29D9C2;
-@color4 : #BDF271;
-@color5 : #FFFFA6;
-@color6 : #2F2933;
-@color7 : #FF6F69;
-
-html,body{
-    height:100%;
-}
-
-body {
-    background-color: #f8f8f8;
-    padding-top: 50px;
-    font-family: 'Muli', sans-serif;
-}
-
-.h100{
-    height : 100%;
-}
-
-.w100{
-    width:100%;
-}
-
-
-.ma-main-container{
-    @media (min-width: 400px) {
-        padding-right : 0;
-    }
+html, body {
 }
 
 @import "../parties/styles/parties.import.less";
+@import "../parties/styles/party.details.import.less";
 @import "../parties/styles/navbar.import.less";
-@import "../parties/styles/new.party.import.less";
-@import "../parties/styles/party.details.import.less";
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 57f0a17f8021ce3a89bbad223128bd8033f3114f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:49:04 +0300
Subject: [PATCH 163/215] Step 18.7: Update the index.html to use
 angular-material

---
 client/index.html | 28 +++++++++++-----------------
 1 file changed, 11 insertions(+), 17 deletions(-)

diff --git a/client/index.html b/client/index.html
index 4ac712e..a5d537e 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,23 +1,17 @@
 <head>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
-  <link href='http://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
-  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
+  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
 </head>
-<body>
-
-<nav class="navbar navbar-default navbar-fixed-top">
-  <div class="container">
-    <div class="navbar-header">
-      <a class="navbar-brand" href="/">socially</a>
-    </div>
-    <div class="navbar-right-container">
-      <blaze-template name="loginButtons"></blaze-template>
-    </div>
+<body layout="column">
+<md-toolbar md-scroll-shrink layout="row" layout-align="start center" layout-padding>
+  <h2>
+    <a ui-sref="parties"><span class="md-title">Socially</span></a>
+  </h2>
+  <span flex></span>
+  <div class="navbar-right navbar-text">
+    <blaze-template name="loginButtons"></blaze-template>
   </div>
-</nav>
-
-<div class="h100">
-  <div ui-view class="ma-main-container container-fluid h100"></div>
-</div>
+</md-toolbar>
+<div ui-view flex-gt-sm layout-gt-sm="row"></div>
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2182597f0824b6e2f34e495af70d5bfbc8eb0f31 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:51:31 +0300
Subject: [PATCH 164/215] Step 18.8: Update parties list to use material's
 directives

---
 client/parties/views/parties-list.ng.html | 163 +++++++++++-------------------
 1 file changed, 60 insertions(+), 103 deletions(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index c66ae56..a389551 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -1,118 +1,75 @@
-<div class="row h100">
-  <div class="col-md-6 ma-parties-col">
-    <div class="row">
-      <div class="col-xs-8">
-        <form class="form-inline search-form">
-          <div class="form-group">
-            <label class="sr-only" for="search">Search</label>
-
-            <div class="input-group">
-              <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div>
-              <input type="text" ng-model="search" placeholder="Search" id="search" class="form-control">
-            </div>
-          </div>
-          <div class="form-group">
-            <label class="sr-only" for="sort-order">Sort Order</label>
-            <select ng-model="orderProperty" class="form-control">
-              <option value="1">Ascending</option>
-              <option value="-1">Descending</option>
-            </select>
-          </div>
-        </form>
-      </div>
-      <div class="col-xs-4 ma-add-button-container">
-        <button class="btn" ng-click="openAddNewPartyModal()"><i class="fa fa-plus"></i></button>
-      </div>
-    </div>
-    <ul class="list-group">
-      <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count"
-          class="list-group-item ma-party-item">
-
-        <i ng-click="remove(party)" class="ma-remove fa fa-times"
-           ng-show="$root.currentUser && $root.currentUser._id == party.owner"></i>
-
-
-        <div class="row">
-          <div class="col-sm-8">
-            <h2 class="ma-party-name"><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
-
-            <p class="ma-party-description">{{party.description}}</p>
-          </div>
+<md-content flex-gt-sm layout-gt-sm="row" class="ma-parties-list">
+  <div layout-gt-sm="row" flex-gt-sm>
+    <div flex-gt-sm="50" flex-sm>
+      <div>
+        <div layout-padding layout="row">
+          <md-input-container style="width:50%;margin-right:10px;">
+            <label>Search</label>
+            <input type="text" ng-model="search"/>
+          </md-input-container>
+          <md-select ng-model="orderProperty" placeholder="Sort Order" >
+            <md-option value="1">Ascending</md-option>
+            <md-option value="-1">Descending</md-option>
+          </md-select>
+          <md-button class="md-fab" aria-label="Eat cake" ng-click="openAddNewPartyModal()">
+            <md-icon md-font-set="material-icons"> add </md-icon>
+          </md-button>
         </div>
+      </div>
+      <md-content class="md-padding" style="padding-top:0;">
+        <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
+        <div  dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count" class="ma-party">
+          <md-card>
+            <md-card-content>
+              <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
+              <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
 
-        <div class="row ma-party-item-bottom">
-          <div class="col-sm-8 ma-posted-by-col">
-            <span class="ma-posted-by">Posted by {{ creator(party) | displayName }}  </span>
-
-            <span ng-if="party.public" class="ma-everyone-invited"><i class="fa fa-male"></i> Everyone is invited</span>
-
-                        <span ng-if="!party.public" class="ma-everyone-invited">
-                             <i class="fa fa-user-secret"></i>  This is a private event
-                        </span>
-
-            <div ng-show="$root.currentUser" class="ma-rsvp-buttons">
-              <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')" class="btn"
-                     ng-class="{'btn-primary' : isRSVP('yes', party)}">
-              <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')" class="btn"
-                     ng-class="{'btn-primary' : isRSVP('maybe', party)}">
-              <input type="button" value="No" ng-click="rsvp(party._id, 'no')" class="btn"
-                     ng-class="{'btn-primary' : isRSVP('no', party)}">
-            </div>
-            <div ng-hide="$root.currentUser">
-              <i>Sign in to RSVP for this party.</i>
-            </div>
 
+              <div layout="row">
+                <div flex="1">
+                  <p style="margin-top:0px;margin-bottom:3px;font-size:14px;color:#aaa;">
+                    <small>Posted by {{ creator(party) | displayName }}</small>
+                    <span ng-if="party.public" style="font-size:12px;color:#999;">| Everyone is invited</span>
+                  </p>
 
-          </div>
-          <div class="col-sm-4">
-            <div class="ma-rsvp-sum">
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'yes'}).length || "0"}}
+                  <div ng-show="$root.currentUser" class="md-actions" layout="row">
+                    <md-button ng-click="rsvp(party._id, 'yes')">I'm going!</md-button>
+                    <md-button ng-click="rsvp(party._id, 'maybe')">Maybe</md-button>
+                    <md-button ng-click="rsvp(party._id, 'no')">No</md-button>
+                  </div>
                 </div>
-                <div class="ma-rsvp-title">
-                  YES
+                <div  layout="row" layout-align="end end">
+                  <div ng-hide="$root.currentUser" style="font-size:13px;margin-bottom:10px;">
+                    Sign in to RSVP for this party
+                  </div>
+                  <div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'yes'}).length || "0" }}</div>
+                      <div class="rsvps-title">Yes</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0" }}</div>
+                      <div class="rsvps-title">Maybe</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'no'}).length || "0" }}</div>
+                      <div class="rsvps-title">No</div>
+                    </div>
+                  </div>
                 </div>
               </div>
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0"}}
-                </div>
-                <div class="ma-rsvp-title">
-                  MAYBE
-                </div>
-              </div>
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'no'}).length || "0"}}
-                </div>
-                <div class="ma-rsvp-title">
-                  NO
-                </div>
-              </div>
-            </div>
-
-            <ul ng-if="!party.public">
-              <li ng-repeat="invitedUser in outstandingInvitations(party)">
-                {{ invitedUser | displayName }}
-              </li>
-            </ul>
-
-          </div>
+            </md-card-content>
+          </md-card>
         </div>
+      </md-content>
 
-      </li>
-    </ul>
-    <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
-
-  </div>
-  <div class="col-md-6 h100 ma-angular-map-col">
-    <div class="angular-google-map-container h100">
-      <ui-gmap-google-map center="map.center" zoom="map.zoom" options="map.options">
+    </div>
+    <div flex-gt-sm="50" flex-sm layout="row" style="min-height:300px;">
+      <ui-gmap-google-map options="map.options" center="map.center" zoom="map.zoom" flex layout="row">
         <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
                          fit="true" idkey="'_id'" doRebuildAll="true">
         </ui-gmap-markers>
       </ui-gmap-google-map>
     </div>
   </div>
-</div>
\ No newline at end of file
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1f2a09820fec24b9fbd7e3fb058a50129fba07a0 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:34:12 +0300
Subject: [PATCH 165/215] Step 18.9: Add the
 planettraining:material-design-icons package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 70f2fee..8c40bdc 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -29,3 +29,4 @@ angularui:angular-google-maps
 less
 angularui:angular-ui-bootstrap
 angular:angular-material
+planettraining:material-design-icons
diff --git a/.meteor/versions b/.meteor/versions
index 2c5dfcc..ddc3766 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -71,6 +71,7 @@ oauth1@1.1.5
 oauth2@1.1.5
 observe-sequence@1.0.7
 ordered-dict@1.0.4
+planettraining:material-design-icons@2.0.0
 promise@0.4.8
 random@1.0.4
 rate-limit@1.0.0
-- 
2.3.2 (Apple Git-55)


From faf2e83cc47cb6254c78948f1f177eab4805e363 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:56:15 +0300
Subject: [PATCH 166/215] Step 18.10: Add angular material icons definitions

---
 client/lib/app.ng.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
index 2ca6523..44c8b9b 100644
--- a/client/lib/app.ng.js
+++ b/client/lib/app.ng.js
@@ -5,6 +5,23 @@ angular.module('socially',[
   'uiGmapgoogle-maps',
   'ngMaterial'
 ]);
+
+var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
+
+  $mdIconProvider
+    .iconSet("social", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-social.svg")
+    .iconSet("action", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-action.svg")
+    .iconSet("communication", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-communication.svg")
+    .iconSet("content", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-content.svg")
+    .iconSet("toggle", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-toggle.svg")
+    .iconSet("navigation", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-navigation.svg")
+    .iconSet("image", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-image.svg");
+
+}];
+
+angular.module('socially')
+  .config(themeIcons);
+
 function onReady() {
   angular.bootstrap(document, ['socially'], {
     strictDi: true
-- 
2.3.2 (Apple Git-55)


From eec8d447f83a0203146b78c20f12b81cb2f9029d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:58:59 +0300
Subject: [PATCH 167/215] Step 18.11: Update party details view to use
 angular-material

---
 client/parties/views/party-details.ng.html | 82 ++++++++++++++----------------
 1 file changed, 37 insertions(+), 45 deletions(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 104a657..a1d808c 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -1,54 +1,46 @@
-<div class="row ma-party-details-container">
-  <div class="col-sm-6 col-sm-offset-3">
-    <legend>
-      View and Edit Your Party Details:
+<div layout="row" flex class="ma-party-details">
+  <div flex="33" offset="33">
+    <legend style="margin:20px 0;">
+      Here you will see and change the details of the party:
     </legend>
-    <form class="form-horizontal">
-      <div class="form-group">
+    <form layout="column">
+      <md-input-container>
         <label>Party Name</label>
-        <input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id" type="text"
-               class="form-control">
-      </div>
-      <div class="form-group">
-        <label>Party Name</label>
-        <input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id" type="text"
-               class="form-control">
-      </div>
-      <div class="form-group">
-        <label>Is public</label>
-        <input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
-      </div>
-    </form>
+        <input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id" type="text" aria-label="Name">
+      </md-input-container>
+      <md-input-container>
+        <label>Party Description</label>
+        <input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id" type="text" aria-label="Description">
+      </md-input-container>
+      <md-checkbox ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id" aria-label="Public">
+        Is public
+      </md-checkbox>
 
-    <div class="ma-invite-list" ng-show="canInvite()">
-      <h3>
-        Users to invite:
-      </h3>
-      <ul>
+      <div layout="row" layout-align="left">
+        <md-button ng-click="save()">Save</md-button>
+        <md-button ng-click="reset()">Reset form</md-button>
+        <md-button ng-href="/parties">Cancel</md-button>
+      </div>
 
-        <li ng-repeat="user in users | uninvited:party">
+      <md-list ng-show="canInvite()">
+        <md-subheader class="md-no-sticky">Users to invite:</md-subheader>
+        <md-list-item ng-repeat="user in users | uninvited:party">
           <div>{{ user | displayName }}</div>
-          <button ng-click="invite(user)">Invite</button>
-        </li>
-        <li ng-if="(users | uninvited:party).length <= 0">
+          <md-button ng-click="invite(user)">Invite</md-button>
+        </md-list-item>
+        <md-list-item ng-if="(users | uninvited:party).length <= 0">
           Everyone are already invited.
-        </li>
-      </ul>
-    </div>
+        </md-list-item>
+      </md-list>
 
-
-    <h3 class="ma-map-title">
-      Click the map to set the party location
-    </h3>
-
-    <div class="angular-google-map-container">
-      <ui-gmap-google-map center="party.location || map.center" 
-                          events="map.events" zoom="map.zoom">
-        <ui-gmap-marker coords="party.location" options="map.marker.options" 
-                        events="map.marker.events" idkey="party._id">
-        </ui-gmap-marker>
-      </ui-gmap-google-map>
-    </div>
+      <div class="angular-google-map-container">
+        <ui-gmap-google-map center="party.location || map.center" 
+                            events="map.events" zoom="map.zoom">
+          <ui-gmap-marker coords="party.location" options="map.marker.options" 
+                          events="map.marker.events" idkey="party._id">
+          </ui-gmap-marker>
+        </ui-gmap-google-map>
+      </div>
+    </form>
   </div>
-
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4782288f5e3e5ecab715bfda92f81aae58082408 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 23:01:12 +0300
Subject: [PATCH 168/215] Step 18.12: Update new party modal view to use
 angular-material

---
 client/parties/views/add-new-party-modal.ng.html | 54 ++++++++++++++----------
 1 file changed, 32 insertions(+), 22 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 5fd3485..464d006 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -1,24 +1,34 @@
-<div class="container-fluid ma-add-new-party-container">
-  <div class="alert alert-info" ng-hide="$root.currentUser || $root.loggingIn">
-    Please log in to create a party!
-  </div>
-
-  <form ng-show="$root.currentUser || $root.loggingIn">
-    <h2>Create a new party</h2>
-
-    <div class="form-group">
-      <label for="nameInput">Name</label>
-      <input ng-model="newParty.name" id="nameInput" type="text" class="form-control">
+<md-dialog aria-label="Mango (Fruit)">
+  <form>
+    <md-toolbar>
+      <div class="md-toolbar-tools">
+        <h2> Create a new party</h2>
+        <span flex></span>
+      </div>
+    </md-toolbar>
+    <md-dialog-content style="min-width:300px;max-width:800px;max-height:810px; ">
+      <div  ng-show="$root.currentUser">
+        <md-input-container>
+          <label>Name</label>
+          <input ng-model="newParty.name" id="nameInput" type="text" aria-label="Name">
+        </md-input-container>
+        <md-input-container>
+          <label>Description</label>
+          <input ng-model="newParty.description" id="description" type="text" aria-label="Description">
+        </md-input-container>
+        <md-checkbox ng-model="newParty.public" id="public" aria-label="Public">
+          Public
+        </md-checkbox>
+      </div>
+    </md-dialog-content>
+    <div class="md-actions" layout="row">
+      <span flex></span>
+      <md-button ng-click="close()">
+        Close
+      </md-button>
+      <md-button ng-click="addNewParty()" style="margin-right:20px;">
+        Add
+      </md-button>
     </div>
-    <div class="form-group">
-      <label for="description">Description</label>
-      <input ng-model="newParty.description" id="description" type="text" class="form-control">
-    </div>
-    <div class="form-group">
-      <label for="public">
-        <input type="checkbox" ng-model="newParty.public" id="public"> Public
-      </label>
-    </div>
-    <button ng-click="addNewParty()" class="btn">Add</button>
   </form>
-</div>
\ No newline at end of file
+</md-dialog>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From f9ea40e4236cea9b67edf8a0a335909666736c57 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:57:59 +0300
Subject: [PATCH 169/215] Step 18.13: Custom auth buttons

---
 client/index.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index a5d537e..44093aa 100644
--- a/client/index.html
+++ b/client/index.html
@@ -10,7 +10,10 @@
   </h2>
   <span flex></span>
   <div class="navbar-right navbar-text">
-    <blaze-template name="loginButtons"></blaze-template>
+    <md-button ng-href="/login" ng-hide="$root.currentUser">Login</md-button>
+    <md-button ng-href="/register" ng-hide="$root.currentUser">Sign up</md-button>
+    <div ng-show="$root.currentUser" ng-bind="$root.currentUser"></div>
+    <md-button ng-href="/logout" ng-show="$root.currentUser">Logout</md-button>
   </div>
 </md-toolbar>
 <div ui-view flex-gt-sm layout-gt-sm="row"></div>
-- 
2.3.2 (Apple Git-55)


From 9a6c71266ee2174e3d8247c73975e7d0d45be5d2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:58:20 +0300
Subject: [PATCH 170/215] Step 18.14: Add custom auth routes

---
 client/routes.ng.js | 32 +++++++++++++++++++++++++++++++-
 1 file changed, 31 insertions(+), 1 deletion(-)

diff --git a/client/routes.ng.js b/client/routes.ng.js
index 66296a4..930c9f0 100644
--- a/client/routes.ng.js
+++ b/client/routes.ng.js
@@ -22,10 +22,40 @@ angular.module("socially").config(function ($urlRouterProvider, $stateProvider,
       templateUrl: 'client/parties/views/party-details.ng.html',
       controller: 'PartyDetailsCtrl',
       resolve: {
-        "currentUser": function ($meteor) {
+        "currentUser": function($meteor){
           return $meteor.requireUser();
         }
       }
+    })
+    .state('login', {
+      url: '/login',
+      templateUrl: 'client/users/views/login.ng.html',
+      controller: 'LoginCtrl',
+      controllerAs: 'lc'
+    })
+    .state('register',{
+      url: '/register',
+      templateUrl: 'client/users/views/register.ng.html',
+      controller: 'RegisterCtrl',
+      controllerAs: 'rc'
+    })
+    .state('resetpw', {
+      url: '/resetpw',
+      templateUrl: 'client/users/views/reset-password.ng.html',
+      controller: 'ResetCtrl',
+      controllerAs: 'rpc'
+    })
+    .state('logout', {
+      url: '/logout',
+      resolve: {
+        "logout": function($meteor, $state) {
+          return $meteor.logout().then(function(){
+            $state.go('parties');
+          }, function(err){
+            console.log('logout error - ', err);
+          });
+        }
+      }
     });
 
   $urlRouterProvider.otherwise("/parties");
-- 
2.3.2 (Apple Git-55)


From 789b8566167ce621c428d6d2354aa28997b8b93c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:51:12 +0300
Subject: [PATCH 171/215] Step 18.15: Create login controller

---
 client/users/controllers/login.ng.js | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 client/users/controllers/login.ng.js

diff --git a/client/users/controllers/login.ng.js b/client/users/controllers/login.ng.js
new file mode 100644
index 0000000..d1e4664
--- /dev/null
+++ b/client/users/controllers/login.ng.js
@@ -0,0 +1,23 @@
+angular.module("socially").controller("LoginCtrl", ['$meteor', '$state',
+  function ($meteor, $state) {
+    var vm = this;
+
+    vm.credentials = {
+      email: '',
+      password: ''
+    };
+
+    vm.error = '';
+
+    vm.login = function () {
+      $meteor.loginWithPassword(vm.credentials.email, vm.credentials.password).then(
+        function () {
+          $state.go('parties');
+        },
+        function (err) {
+          vm.error = 'Login error - ' + err;
+        }
+      );
+    };
+  }
+]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 43e782477c02bcac17418204fc29c51bed88e0e7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:51:31 +0300
Subject: [PATCH 172/215] Step 18.16: Create login view

---
 client/users/views/login.ng.html | 33 +++++++++++++++++++++++++++++++++
 1 file changed, 33 insertions(+)
 create mode 100644 client/users/views/login.ng.html

diff --git a/client/users/views/login.ng.html b/client/users/views/login.ng.html
new file mode 100644
index 0000000..2ad8a07
--- /dev/null
+++ b/client/users/views/login.ng.html
@@ -0,0 +1,33 @@
+<md-content layout="row">
+  <span flex></span>
+  <md-whiteframe layout="column" flex="50">
+    <div layout="row" layout-align="space-around center">
+      <div>Login with:</div>
+      <md-button>Twitter</md-button>
+      <md-button>Facebook</md-button>
+    </div>
+    <div ng-show="lc.error" class="md-warn">
+      <small>{{ lc.error }}</small>
+    </div>
+    <form layout="column">
+      <md-input-container>
+        <md-icon md-svg-icon="content:ic_mail_24px"></md-icon>
+        <input type="text" ng-model="lc.credentials.email"
+               placeholder="email" aria-label="email"/>
+      </md-input-container>
+      <md-input-container>
+        <md-icon md-svg-icon="action:ic_lock_open_24px"></md-icon>
+        <input type="password" ng-model="lc.credentials.password"
+               placeholder="password" aria-label="password"/>
+      </md-input-container>
+      <md-button class="md-raised md-primary" ng-click="lc.login()"
+                 aria-label="login">Sign In
+      </md-button>
+    </form>
+    <div layout="row" layout-align="space-around center">
+      <a href="/resetpw">Forgot password?</a>
+      <a href="/register">Create an account</a>
+    </div>
+  </md-whiteframe>
+  <span flex></span>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c8df5277dd9a3031f1f71a54ca7554173bf45092 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:53:17 +0300
Subject: [PATCH 173/215] Step 18.17: Create register controller

---
 client/users/controllers/register.ng.js | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 client/users/controllers/register.ng.js

diff --git a/client/users/controllers/register.ng.js b/client/users/controllers/register.ng.js
new file mode 100644
index 0000000..f21b5f5
--- /dev/null
+++ b/client/users/controllers/register.ng.js
@@ -0,0 +1,23 @@
+angular.module("socially").controller("RegisterCtrl", ['$meteor', '$state',
+  function ($meteor, $state) {
+    var vm = this;
+
+    vm.credentials = {
+      email: '',
+      password: ''
+    };
+
+    vm.error = '';
+
+    vm.register = function () {
+      $meteor.createUser(vm.credentials).then(
+        function () {
+          $state.go('parties');
+        },
+        function (err) {
+          vm.error = 'Registration error - ' + err;
+        }
+      );
+    };
+  }
+]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d816d33aa43473affd79e0293621f824a4df47bd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:53:37 +0300
Subject: [PATCH 174/215] Step 18.18: Create register view

---
 client/users/views/register.ng.html | 32 ++++++++++++++++++++++++++++++++
 1 file changed, 32 insertions(+)
 create mode 100644 client/users/views/register.ng.html

diff --git a/client/users/views/register.ng.html b/client/users/views/register.ng.html
new file mode 100644
index 0000000..2278c2f
--- /dev/null
+++ b/client/users/views/register.ng.html
@@ -0,0 +1,32 @@
+<md-content layout="row">
+  <span flex></span>
+  <md-whiteframe layout="column" flex="50">
+    <div layout="row" layout-align="space-around center">
+      <div>Register</div>
+      <md-button>Twitter</md-button>
+      <md-button>Facebook</md-button>
+    </div>
+    <div ng-show="rc.error" class="md-warn">
+      <small>{{ rc.error }}</small>
+    </div>
+    <form layout="column">
+      <md-input-container>
+        <md-icon md-svg-icon="content:ic_mail_24px"></md-icon>
+        <input type="text" ng-model="rc.credentials.email"
+               placeholder="email" aria-label="email"/>
+      </md-input-container>
+      <md-input-container>
+        <md-icon md-svg-icon="action:ic_lock_open_24px"></md-icon>
+        <input type="password" ng-model="rc.credentials.password"
+               placeholder="password" aria-label="password"/>
+      </md-input-container>
+      <md-button class="md-raised md-primary"
+                 ng-click="rc.register()">Create Account
+      </md-button>
+    </form>
+    <div layout="row" layout-align="end center">
+      <a href="/login">Login</a>
+    </div>
+  </md-whiteframe>
+  <span flex></span>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 19776dcdb48523d1e653015bee0ca4f5bad5bdcd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:54:24 +0300
Subject: [PATCH 175/215] Step 18.19: Create reset controller

---
 client/users/controllers/reset.ng.js | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
 create mode 100644 client/users/controllers/reset.ng.js

diff --git a/client/users/controllers/reset.ng.js b/client/users/controllers/reset.ng.js
new file mode 100644
index 0000000..56be12f
--- /dev/null
+++ b/client/users/controllers/reset.ng.js
@@ -0,0 +1,22 @@
+angular.module("socially").controller("ResetCtrl", ['$meteor', '$state',
+  function ($meteor, $state) {
+    var vm = this;
+
+    vm.credentials = {
+      email: ''
+    };
+
+    vm.error = '';
+
+    vm.reset = function () {
+      $meteor.forgotPassword(vm.credentials).then(
+        function () {
+          $state.go('parties');
+        },
+        function (err) {
+          vm.error = 'Error sending forgot password email - ' + err;
+        }
+      );
+    };
+  }
+]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d4a079d165eda9a2387df40e8401f6bfdd7ba6ec Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Tue, 18 Aug 2015 17:02:39 +0300
Subject: [PATCH 176/215] Step 18.20: Create reset view

---
 client/users/views/reset-password.ng.html | 27 +++++++++++++++++++++++++++
 1 file changed, 27 insertions(+)
 create mode 100644 client/users/views/reset-password.ng.html

diff --git a/client/users/views/reset-password.ng.html b/client/users/views/reset-password.ng.html
new file mode 100644
index 0000000..f365b52
--- /dev/null
+++ b/client/users/views/reset-password.ng.html
@@ -0,0 +1,27 @@
+<md-content layout="row">
+  <span flex></span>
+  <md-whiteframe layout="column" flex="50">
+    <div layout="row" layout-align="space-around center">
+      <div>Login with:</div>
+      <md-button>Twitter</md-button>
+      <md-button>Facebook</md-button>
+    </div>
+    <div ng-show="rpc.error" class="md-warn">
+      <small>{{ rpc.error }}</small>
+    </div>
+    <form layout="column">
+      <md-input-container>
+        <md-icon md-svg-icon="content:ic_mail_24px"></md-icon>
+        <input type="text" ng-model="rpc.credentials.email"
+               placeholder="email" aria-label="email"/>
+      </md-input-container>
+      <md-button class="md-raised md-primary"
+                 ng-click="rpc.reset()" aria-label="login">Reset password
+      </md-button>
+    </form>
+    <div layout="row" layout-align="end center">
+      <a href="/login">Login</a>
+    </div>
+  </md-whiteframe>
+  <span flex></span>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From adbd472fa79eec3be3cbf84d307def6c654498e5 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:48:03 +0300
Subject: [PATCH 177/215] Step 20.1: Add the cfs:standard-packages package

---
 .meteor/packages |  1 +
 .meteor/versions | 18 ++++++++++++++++++
 2 files changed, 19 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 8c40bdc..bf797be 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -30,3 +30,4 @@ less
 angularui:angular-ui-bootstrap
 angular:angular-material
 planettraining:material-design-icons
+cfs:standard-packages
diff --git a/.meteor/versions b/.meteor/versions
index ddc3766..881087f 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -26,6 +26,22 @@ boilerplate-generator@1.0.4
 caching-compiler@1.0.0
 caching-html-compiler@1.0.1
 callback-hook@1.0.4
+cfs:access-point@0.1.49
+cfs:base-package@0.0.30
+cfs:collection@0.5.5
+cfs:collection-filters@0.2.4
+cfs:data-man@0.0.6
+cfs:file@0.1.17
+cfs:http-methods@0.0.30
+cfs:http-publish@0.0.13
+cfs:power-queue@0.9.11
+cfs:reactive-list@0.0.9
+cfs:reactive-property@0.0.4
+cfs:standard-packages@0.5.9
+cfs:storage-adapter@0.2.2
+cfs:tempstore@0.1.5
+cfs:upload-http@0.0.20
+cfs:worker@0.1.4
 check@1.0.6
 dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
@@ -63,6 +79,7 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.1
 mongo-id@1.0.1
+mongo-livedata@1.0.9
 nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
@@ -73,6 +90,7 @@ observe-sequence@1.0.7
 ordered-dict@1.0.4
 planettraining:material-design-icons@2.0.0
 promise@0.4.8
+raix:eventemitter@0.1.3
 random@1.0.4
 rate-limit@1.0.0
 reactive-dict@1.1.1
-- 
2.3.2 (Apple Git-55)


From 0541edf897ffe8b2fb88d6cf80410202d922e10c Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:53:05 +0300
Subject: [PATCH 178/215] Step 20.2: Add the cfs:gridfs package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index bf797be..a6831b4 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -31,3 +31,4 @@ angularui:angular-ui-bootstrap
 angular:angular-material
 planettraining:material-design-icons
 cfs:standard-packages
+cfs:gridfs
diff --git a/.meteor/versions b/.meteor/versions
index 881087f..b7160e5 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -32,6 +32,7 @@ cfs:collection@0.5.5
 cfs:collection-filters@0.2.4
 cfs:data-man@0.0.6
 cfs:file@0.1.17
+cfs:gridfs@0.0.33
 cfs:http-methods@0.0.30
 cfs:http-publish@0.0.13
 cfs:power-queue@0.9.11
-- 
2.3.2 (Apple Git-55)


From 64e616301ccdf52f42f0bba4c17b6b35c09948cd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:59:57 +0300
Subject: [PATCH 179/215] Step 20.3: Create the Images collection and publish
 it

---
 model/images.js | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)
 create mode 100644 model/images.js

diff --git a/model/images.js b/model/images.js
new file mode 100644
index 0000000..5cec451
--- /dev/null
+++ b/model/images.js
@@ -0,0 +1,31 @@
+Images = new FS.Collection("images", {
+  stores: [
+    new FS.Store.GridFS("original")
+  ],
+  filter: {
+    allow: {
+      contentTypes: ['image/*']
+    }
+  }
+});
+
+if (Meteor.isServer) {
+  Images.allow({
+    insert: function (userId) {
+      return (userId ? true : false);
+    },
+    remove: function (userId) {
+      return (userId ? true : false);
+    },
+    download: function () {
+      return true;
+    },
+    update: function (userId) {
+      return (userId ? true : false);
+    }
+  });
+
+  Meteor.publish('images', function() {
+    return Images.find({});
+  });
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d08129894925687c3975309f78b768f7bb404bac Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 20:00:22 +0300
Subject: [PATCH 180/215] Step 20.4: Add the collectionFS to the controller

---
 client/parties/controllers/partiesList.ng.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 9498791..469c299 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -5,6 +5,7 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.orderProperty = '1';
 
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
+  $scope.images = $meteor.collectionFS(Images, false, Images).subscribe('images');
 
   $scope.parties = $meteor.collection(function() {
     return Parties.find({}, {
-- 
2.3.2 (Apple Git-55)


From bae2152be40cb092f38a889c144cf67602cc34f5 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:56:10 +0300
Subject: [PATCH 181/215] Step 20.5: Add the danialfarid:ng-file-upload package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index a6831b4..f10fe75 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -32,3 +32,4 @@ angular:angular-material
 planettraining:material-design-icons
 cfs:standard-packages
 cfs:gridfs
+danialfarid:ng-file-upload
diff --git a/.meteor/versions b/.meteor/versions
index b7160e5..7f03d8b 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -44,6 +44,7 @@ cfs:tempstore@0.1.5
 cfs:upload-http@0.0.20
 cfs:worker@0.1.4
 check@1.0.6
+danialfarid:ng-file-upload@5.0.9
 dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
-- 
2.3.2 (Apple Git-55)


From 4402ed29700b96e444cf8f825cf55110a875973b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:10:51 +0300
Subject: [PATCH 182/215] Step 20.6: Add dependency for 'ngFileUpload' to the
 module

---
 client/lib/app.ng.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
index 44c8b9b..c60b893 100644
--- a/client/lib/app.ng.js
+++ b/client/lib/app.ng.js
@@ -3,7 +3,8 @@ angular.module('socially',[
   'ui.router',
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
-  'ngMaterial'
+  'ngMaterial',
+  'ngFileUpload'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From 1ce3545918dcb78eb5fe7b6935efe828428249b7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:35:57 +0300
Subject: [PATCH 183/215] Step 20.7: Add usage of file uploader

---
 client/parties/views/add-new-party-modal.ng.html | 24 ++++++++++++++++++++++--
 1 file changed, 22 insertions(+), 2 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 464d006..e27ba83 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -1,4 +1,4 @@
-<md-dialog aria-label="Mango (Fruit)">
+<md-dialog>
   <form>
     <md-toolbar>
       <div class="md-toolbar-tools">
@@ -6,7 +6,7 @@
         <span flex></span>
       </div>
     </md-toolbar>
-    <md-dialog-content style="min-width:300px;max-width:800px;max-height:810px; ">
+    <md-dialog-content style="min-width:800px;max-width:800px;max-height:100%; ">
       <div  ng-show="$root.currentUser">
         <md-input-container>
           <label>Name</label>
@@ -16,6 +16,26 @@
           <label>Description</label>
           <input ng-model="newParty.description" id="description" type="text" aria-label="Description">
         </md-input-container>
+        <md-whiteframe class="md-whiteframe-z1" layout="column">
+          <div layout="row" class="images-container-title">
+            <div flex>
+              <h3>Add photos to your party!</h3>
+              <div ng-controller="AddPhotoCtrl">
+                <div ngf-drop ngf-select
+                     ngf-change="addImages($files)"
+                     ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}" class="drop-box"
+                     ngf-multiple="false" ngf-allow-dir="false" ngf-accept="'image/*'"
+                     ngf-drop-available="dropAvailable">
+                  <div>Click here to select image</div>
+                  <div>
+                    <strong>OR</strong>
+                  </div>
+                  <div ng-show="dropAvailable">You can also drop image to here</div>
+                </div>
+              </div>
+            </div>
+          </div>
+        </md-whiteframe>
         <md-checkbox ng-model="newParty.public" id="public" aria-label="Public">
           Public
         </md-checkbox>
-- 
2.3.2 (Apple Git-55)


From de1b692bc93266b88f948252ae538373776a3945 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:36:17 +0300
Subject: [PATCH 184/215] Step 20.8: Create the file upload controller

---
 client/parties/controllers/addPhoto.ng.js | 10 ++++++++++
 1 file changed, 10 insertions(+)
 create mode 100644 client/parties/controllers/addPhoto.ng.js

diff --git a/client/parties/controllers/addPhoto.ng.js b/client/parties/controllers/addPhoto.ng.js
new file mode 100644
index 0000000..072392f
--- /dev/null
+++ b/client/parties/controllers/addPhoto.ng.js
@@ -0,0 +1,10 @@
+angular.module("socially").controller("AddPhotoCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog',
+  function($scope, $meteor, $rootScope, $state, $mdDialog) {
+    $scope.addImages = function (files) {
+      if (files.length > 0) {
+        $scope.images.save(files[0]);
+      }
+    };
+
+    $scope.close = $mdDialog.hide;
+  }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ed04b0da9293e62e85f7516aacd8daae8015ecba Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:36:56 +0300
Subject: [PATCH 185/215] Step 20.9: Add the images collection to the new party
 modal

---
 client/parties/controllers/addNewParty.ng.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/addNewParty.ng.js b/client/parties/controllers/addNewParty.ng.js
index af25c36..25e890f 100644
--- a/client/parties/controllers/addNewParty.ng.js
+++ b/client/parties/controllers/addNewParty.ng.js
@@ -1,6 +1,8 @@
 angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog', 'parties',
   function ($scope, $meteor, $rootScope, $state, $mdDialog, parties) {
     $scope.newParty = {};
+    $scope.images = $meteor.collectionFS(Images, false, Images);
+
     $scope.addNewParty = function () {
       if($scope.newParty.name){
         $scope.newParty.owner = $rootScope.currentUser._id;
-- 
2.3.2 (Apple Git-55)


From 1897b63effe6b9078e5cdd473b74faaa4ed279a9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:04:27 +0300
Subject: [PATCH 186/215] Step 20.10: Add some style to the upload component

---
 client/parties/styles/parties.import.less | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 0f7beb6..31cc3d1 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -59,4 +59,23 @@
 
         }
     }
+}
+
+.drop-box {
+    background: #F8F8F8;
+    border: 5px dashed #DDD;
+    width: 230px;
+    height: 120px;
+    text-align: center;
+    padding-top: 25px;
+    margin-left: 10px;
+    margin-bottom: 20px;
+}
+
+.drop-box.dragover {
+    border: 5px dashed blue;
+}
+
+.drop-box.dragover-err {
+    border: 5px dashed red;
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 07d33d76e6bc5245dbf8bbfe35792916edf46662 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:58:20 +0300
Subject: [PATCH 187/215] Step 20.11: Add the alexk111:ng-img-crop package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index f10fe75..79e67a2 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -33,3 +33,4 @@ planettraining:material-design-icons
 cfs:standard-packages
 cfs:gridfs
 danialfarid:ng-file-upload
+alexk111:ng-img-crop
diff --git a/.meteor/versions b/.meteor/versions
index 7f03d8b..9e672a5 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -5,6 +5,7 @@ accounts-password@1.1.3
 accounts-twitter@1.0.6
 accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
+alexk111:ng-img-crop@0.3.2
 angular@1.0.2
 angular:angular@1.4.6
 angular:angular-animate@1.4.6
-- 
2.3.2 (Apple Git-55)


From 7d30103ac7a19b441219748f2335d591670daec2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:08:27 +0300
Subject: [PATCH 188/215] Step 20.12: Add dependency for ngImgCrop

---
 client/lib/app.ng.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
index c60b893..4fc1690 100644
--- a/client/lib/app.ng.js
+++ b/client/lib/app.ng.js
@@ -4,7 +4,8 @@ angular.module('socially',[
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
   'ngMaterial',
-  'ngFileUpload'
+  'ngFileUpload',
+  'ngImgCrop'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From 95c79d330bd773eca39234cdb4cc27103f86148a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:10:28 +0300
Subject: [PATCH 189/215] Step 20.13: Update the image upload logic

---
 client/parties/controllers/addPhoto.ng.js | 20 +++++++++++++++-----
 1 file changed, 15 insertions(+), 5 deletions(-)

diff --git a/client/parties/controllers/addPhoto.ng.js b/client/parties/controllers/addPhoto.ng.js
index 072392f..1df211d 100644
--- a/client/parties/controllers/addPhoto.ng.js
+++ b/client/parties/controllers/addPhoto.ng.js
@@ -1,10 +1,20 @@
-angular.module("socially").controller("AddPhotoCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog',
-  function($scope, $meteor, $rootScope, $state, $mdDialog) {
+angular.module("socially").controller("AddPhotoCtrl", ['$scope',
+  function($scope) {
     $scope.addImages = function (files) {
       if (files.length > 0) {
-        $scope.images.save(files[0]);
+        var reader = new FileReader();
+
+        reader.onload = function (e) {
+          $scope.$apply(function() {
+            $scope.imgSrc = e.target.result;
+            $scope.myCroppedImage = '';
+          });
+        };
+
+        reader.readAsDataURL(files[0]);
+      }
+      else {
+        $scope.imgSrc = undefined;
       }
     };
-
-    $scope.close = $mdDialog.hide;
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From bd81593727d70a00b73e7ace66239a416d0ed196 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:10:42 +0300
Subject: [PATCH 190/215] Step 20.14: Add usage of ngImgCrop

---
 client/parties/views/add-new-party-modal.ng.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index e27ba83..ff647a9 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -32,6 +32,10 @@
                   </div>
                   <div ng-show="dropAvailable">You can also drop image to here</div>
                 </div>
+                <div ng-show="imgSrc" class="ng-crop-container">
+                  <h3>Great! Now edit & crop your image...</h3><br />
+                  <img-crop image="imgSrc" result-image="myCroppedImage" area-type="square"></img-crop>
+                </div>
               </div>
             </div>
           </div>
-- 
2.3.2 (Apple Git-55)


From 5b87609dd57f1071550d8120d08d4ada63518291 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:10:57 +0300
Subject: [PATCH 191/215] Step 20.15: Add ng-hide to the uploader

---
 client/parties/views/add-new-party-modal.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index ff647a9..75cd7da 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -21,7 +21,7 @@
             <div flex>
               <h3>Add photos to your party!</h3>
               <div ng-controller="AddPhotoCtrl">
-                <div ngf-drop ngf-select
+                <div ng-hide="imgSrc" ngf-drop ngf-select
                      ngf-change="addImages($files)"
                      ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}" class="drop-box"
                      ngf-multiple="false" ngf-allow-dir="false" ngf-accept="'image/*'"
-- 
2.3.2 (Apple Git-55)


From 4d318e742d81b1d29e8e7c2c1413142c4e624c81 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:17:35 +0300
Subject: [PATCH 192/215] Step 20.16: Add some CSS to make the crop look better

---
 client/parties/styles/parties.import.less | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 31cc3d1..facbb89 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -78,4 +78,13 @@
 
 .drop-box.dragover-err {
     border: 5px dashed red;
-}
\ No newline at end of file
+}
+
+.uploaded-image {
+    max-height: 100px;
+    max-width: 200px;
+}
+
+.ng-crop-container {
+    height: 350px;
+}
-- 
2.3.2 (Apple Git-55)


From 41cf5fb791a0a845a6584f6af509f8337326017c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:17:47 +0300
Subject: [PATCH 193/215] Step 20.17: Add save button for the cropped image

---
 client/parties/views/add-new-party-modal.ng.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 75cd7da..e3b3983 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -33,7 +33,10 @@
                   <div ng-show="dropAvailable">You can also drop image to here</div>
                 </div>
                 <div ng-show="imgSrc" class="ng-crop-container">
-                  <h3>Great! Now edit & crop your image...</h3><br />
+                  <h3>Great! Now edit & crop your image...</h3>
+                  <md-button ng-click="saveCroppedImage()" ng-disabled="!imgSrc" class="md-primary">
+                    Save Image
+                  </md-button>
                   <img-crop image="imgSrc" result-image="myCroppedImage" area-type="square"></img-crop>
                 </div>
               </div>
-- 
2.3.2 (Apple Git-55)


From 480d58b6f59093f423ea6559eafa5eafa45eef9e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:21:30 +0300
Subject: [PATCH 194/215] Step 20.18: Add logic to save the cropped image

---
 client/parties/controllers/addPhoto.ng.js | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/parties/controllers/addPhoto.ng.js b/client/parties/controllers/addPhoto.ng.js
index 1df211d..f13361f 100644
--- a/client/parties/controllers/addPhoto.ng.js
+++ b/client/parties/controllers/addPhoto.ng.js
@@ -17,4 +17,14 @@ angular.module("socially").controller("AddPhotoCtrl", ['$scope',
         $scope.imgSrc = undefined;
       }
     };
+
+    $scope.saveCroppedImage = function() {
+      if ($scope.myCroppedImage !== '') {
+        $scope.images.save($scope.myCroppedImage).then(function(result) {
+          $scope.newPartyImages.push(result[0]._id);
+          $scope.imgSrc = undefined;
+          $scope.myCroppedImage = '';
+        });
+      }
+    };
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 04fbd25ff0ba07e82ba906ae51b4e3f699c61c55 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:21:49 +0300
Subject: [PATCH 195/215] Step 20.19: Add an array to hold all the new images

---
 client/parties/controllers/addNewParty.ng.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/addNewParty.ng.js b/client/parties/controllers/addNewParty.ng.js
index 25e890f..b4642a7 100644
--- a/client/parties/controllers/addNewParty.ng.js
+++ b/client/parties/controllers/addNewParty.ng.js
@@ -2,6 +2,7 @@ angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '
   function ($scope, $meteor, $rootScope, $state, $mdDialog, parties) {
     $scope.newParty = {};
     $scope.images = $meteor.collectionFS(Images, false, Images);
+    $scope.newPartyImages = [];
 
     $scope.addNewParty = function () {
       if($scope.newParty.name){
-- 
2.3.2 (Apple Git-55)


From c65133dbe321995d4897c92b7b1a81f0899011b5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:29:01 +0300
Subject: [PATCH 196/215] Step 20.20: Add the display of uploaded images

---
 client/parties/views/add-new-party-modal.ng.html | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index e3b3983..ae8f7fd 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -40,6 +40,12 @@
                   <img-crop image="imgSrc" result-image="myCroppedImage" area-type="square"></img-crop>
                 </div>
               </div>
+              <br />
+              <div layout="row" class="images-container-title">
+                <div class="party-image-container" ng-repeat="image in newPartyImages">
+                  <img ng-src="{{ image.url() }}"/><br/>
+                </div>
+              </div>
             </div>
           </div>
         </md-whiteframe>
-- 
2.3.2 (Apple Git-55)


From 43ff95909fafcd0dfd2e1502d39cd8bf497787b3 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 05:00:34 +0300
Subject: [PATCH 197/215] Step 20.21: Add the vitalets:angular-xeditable
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 79e67a2..719f912 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -34,3 +34,4 @@ cfs:standard-packages
 cfs:gridfs
 danialfarid:ng-file-upload
 alexk111:ng-img-crop
+vitalets:angular-xeditable
diff --git a/.meteor/versions b/.meteor/versions
index 9e672a5..0950f1f 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -118,5 +118,6 @@ ui@1.0.8
 underscore@1.0.4
 urigo:angular-blaze-template@0.0.1
 url@1.0.5
+vitalets:angular-xeditable@0.1.9
 webapp@1.2.2
 webapp-hashing@1.0.5
-- 
2.3.2 (Apple Git-55)


From e23f4e820c1618f05ff4b5fdd915f28cef8938fc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:30:58 +0300
Subject: [PATCH 198/215] Step 20.22: Add xeditable dependency

---
 client/lib/app.ng.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
index 4fc1690..2a02121 100644
--- a/client/lib/app.ng.js
+++ b/client/lib/app.ng.js
@@ -5,7 +5,8 @@ angular.module('socially',[
   'uiGmapgoogle-maps',
   'ngMaterial',
   'ngFileUpload',
-  'ngImgCrop'
+  'ngImgCrop',
+  'xeditable'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From 228f3c345f30226a6925592227f767a083448620 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:32:23 +0300
Subject: [PATCH 199/215] Step 20.23: Add usage of angular-xeditable

---
 client/parties/views/add-new-party-modal.ng.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index ae8f7fd..b7abd11 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -1,5 +1,4 @@
 <md-dialog>
-  <form>
     <md-toolbar>
       <div class="md-toolbar-tools">
         <h2> Create a new party</h2>
@@ -44,6 +43,8 @@
               <div layout="row" class="images-container-title">
                 <div class="party-image-container" ng-repeat="image in newPartyImages">
                   <img ng-src="{{ image.url() }}"/><br/>
+                  <a href="#" editable-text="image.metadata.description"
+                     onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
                 </div>
               </div>
             </div>
@@ -63,5 +64,4 @@
         Add
       </md-button>
     </div>
-  </form>
 </md-dialog>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6eea7b0f2a76fff5b32b3e44594fa75274e0c487 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:33:12 +0300
Subject: [PATCH 200/215] Step 20.24: Add the logic to update the description

---
 client/parties/controllers/addNewParty.ng.js | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/client/parties/controllers/addNewParty.ng.js b/client/parties/controllers/addNewParty.ng.js
index b4642a7..761dcc5 100644
--- a/client/parties/controllers/addNewParty.ng.js
+++ b/client/parties/controllers/addNewParty.ng.js
@@ -11,8 +11,13 @@ angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '
         $scope.newParty = '';
         $mdDialog.hide();
       }
-    }
+    };
+
     $scope.close = function () {
       $mdDialog.hide();
-    }
+    };
+
+    $scope.updateDescription = function($data, image) {
+      image.update({$set: {'metadata.description': $data}});
+    };
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 066fafd45e3e0188e8645620f423071359d17b9a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:38:38 +0300
Subject: [PATCH 201/215] Step 20.25: Use div instead of form

---
 client/parties/views/add-new-party-modal.ng.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index b7abd11..3c8347b 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -1,4 +1,5 @@
 <md-dialog>
+  <div class="like-form">
     <md-toolbar>
       <div class="md-toolbar-tools">
         <h2> Create a new party</h2>
@@ -64,4 +65,5 @@
         Add
       </md-button>
     </div>
+  </div>
 </md-dialog>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From de295cb345ac7a602d37274aaaa7a7f2b861e3b6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:38:57 +0300
Subject: [PATCH 202/215] Step 20.26: Add form-layout to the div

---
 client/styles/main.less | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/styles/main.less b/client/styles/main.less
index 438dc59..a964692 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,6 +1,16 @@
 html, body {
 }
 
+.like-form {
+  display: -webkit-flex;
+  display: -ms-flexbox;
+  display: flex;
+  -webkit-flex-direction: column;
+  -ms-flex-direction: column;
+  flex-direction: column;
+  overflow: auto;
+}
+
 @import "../parties/styles/parties.import.less";
 @import "../parties/styles/party.details.import.less";
 @import "../parties/styles/navbar.import.less";
-- 
2.3.2 (Apple Git-55)


From 88621711a246327b574a68f4173577d5c12fd83c Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 05:03:47 +0300
Subject: [PATCH 203/215] Step 20.27: Add the
 netanelgilad:angular-sortable-view package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 719f912..96f4516 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -35,3 +35,4 @@ cfs:gridfs
 danialfarid:ng-file-upload
 alexk111:ng-img-crop
 vitalets:angular-xeditable
+netanelgilad:angular-sortable-view
diff --git a/.meteor/versions b/.meteor/versions
index 0950f1f..6476773 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -83,6 +83,7 @@ mobile-status-bar@1.0.6
 mongo@1.1.1
 mongo-id@1.0.1
 mongo-livedata@1.0.9
+netanelgilad:angular-sortable-view@0.0.13_1
 nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
-- 
2.3.2 (Apple Git-55)


From 1785a2f85167c98b0e3c9729468ca7e6132c35eb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:40:59 +0300
Subject: [PATCH 204/215] Step 20.28: Add dependency for
 'angular-sortable-view'

---
 client/lib/app.ng.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.ng.js b/client/lib/app.ng.js
index 2a02121..ac6e9ef 100644
--- a/client/lib/app.ng.js
+++ b/client/lib/app.ng.js
@@ -6,7 +6,8 @@ angular.module('socially',[
   'ngMaterial',
   'ngFileUpload',
   'ngImgCrop',
-  'xeditable'
+  'xeditable',
+  'angular-sortable-view'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From 510238ceeecf2d5b70a51f8602f203d6d3b6a219 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:41:57 +0300
Subject: [PATCH 205/215] Step 20.29: Add usage for angular-sortable

---
 client/parties/views/add-new-party-modal.ng.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 3c8347b..51f6c0f 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -41,9 +41,9 @@
                 </div>
               </div>
               <br />
-              <div layout="row" class="images-container-title">
-                <div class="party-image-container" ng-repeat="image in newPartyImages">
-                  <img ng-src="{{ image.url() }}"/><br/>
+              <div layout="row" class="images-container-title" sv-root sv-part="newPartyImages">
+                <div sv-element class="party-image-container" ng-repeat="image in newPartyImages">
+                  <img draggable="false" ng-src="{{ image.url() }}"/><br/>
                   <a href="#" editable-text="image.metadata.description"
                      onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
                 </div>
-- 
2.3.2 (Apple Git-55)


From e58a4e385d0f407c85cc252f8fe5a69e20db04bf Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:42:21 +0300
Subject: [PATCH 206/215] Step 20.30: Add indication for main image in the view

---
 client/parties/views/add-new-party-modal.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 51f6c0f..70d0469 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -43,6 +43,7 @@
               <br />
               <div layout="row" class="images-container-title" sv-root sv-part="newPartyImages">
                 <div sv-element class="party-image-container" ng-repeat="image in newPartyImages">
+                  <div class="main-image" ng-show="$index === 0">Main Image</div>
                   <img draggable="false" ng-src="{{ image.url() }}"/><br/>
                   <a href="#" editable-text="image.metadata.description"
                      onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
-- 
2.3.2 (Apple Git-55)


From 8d029a64aea0de207b9098d3d5cc4ee6a6882e77 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:00:20 +0300
Subject: [PATCH 207/215] Step 20.31: Add some css to the image gallery

---
 client/parties/styles/parties.import.less | 25 +++++++++++++++++++++++++
 1 file changed, 25 insertions(+)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index facbb89..4470813 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -88,3 +88,28 @@
 .ng-crop-container {
     height: 350px;
 }
+
+.images-container-title {
+    padding-bottom: 30px;
+}
+
+.party-image-container {
+    position: relative;
+    margin-right: 10px;
+    max-height: 200px;
+    max-width: 200px;
+
+    img {
+        max-height: 100%;
+        max-width: 100%;
+    }
+}
+
+.main-image {
+    position: absolute;
+    top: 0;
+    left: 0;
+    width: 100%;
+    text-align: center;
+    background-color: #f8f8f8;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 786e8fe7a8d176c94e551a56ce1177a0f3d250d5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:03:34 +0300
Subject: [PATCH 208/215] Step 20.32: Save the party with the images

---
 client/parties/controllers/addNewParty.ng.js | 16 +++++++++++++++-
 1 file changed, 15 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/addNewParty.ng.js b/client/parties/controllers/addNewParty.ng.js
index 761dcc5..7c82ada 100644
--- a/client/parties/controllers/addNewParty.ng.js
+++ b/client/parties/controllers/addNewParty.ng.js
@@ -7,8 +7,22 @@ angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '
     $scope.addNewParty = function () {
       if($scope.newParty.name){
         $scope.newParty.owner = $rootScope.currentUser._id;
+
+        // Link the images and the order to the new party
+        if ($scope.newPartyImages && $scope.newPartyImages.length > 0) {
+          $scope.newParty.images = [];
+
+          angular.forEach($scope.newPartyImages, function(image) {
+            $scope.newParty.images.push({id: image._id});
+          });
+        }
+
+        // Save the party
         parties.push($scope.newParty);
-        $scope.newParty = '';
+
+        // Reset the form
+        $scope.newPartyImages = [];
+        $scope.newParty = {};
         $mdDialog.hide();
       }
     };
-- 
2.3.2 (Apple Git-55)


From c31f911d66a239b8e2d6f5adeceade527e8de5b5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 20:01:47 +0300
Subject: [PATCH 209/215] Step 20.33: Display the party's main image

---
 client/parties/views/parties-list.ng.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index a389551..ea83c45 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -20,6 +20,10 @@
         <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
         <div  dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count" class="ma-party">
           <md-card>
+            <div ng-if="party.images && party.images.length > 0"
+                 ng-style="getMainImage(party.images)"
+                 class="party-image">
+            </div>
             <md-card-content>
               <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
               <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
-- 
2.3.2 (Apple Git-55)


From 9b9cf337aa3e6c23cd9e23ed1530027eaef6f1c3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 20:02:05 +0300
Subject: [PATCH 210/215] Step 20.34: Add the logic to get the main image

---
 client/parties/controllers/partiesList.ng.js | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.ng.js b/client/parties/controllers/partiesList.ng.js
index 469c299..18209c0 100644
--- a/client/parties/controllers/partiesList.ng.js
+++ b/client/parties/controllers/partiesList.ng.js
@@ -1,4 +1,4 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $mdDialog) {
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $mdDialog, $filter) {
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
@@ -13,6 +13,16 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     });
   });
 
+  $scope.getMainImage = function(images) {
+    if (images && images.length && images[0] && images[0].id) {
+      var url = $filter('filter')($scope.images, {_id: images[0].id})[0].url();
+
+      return {
+        'background-image': 'url("' + url + '")'
+      }
+    }
+  };
+
   $meteor.autorun($scope, function() {
     $meteor.subscribe('parties', {
       limit: parseInt($scope.getReactively('perPage')),
-- 
2.3.2 (Apple Git-55)


From 958e74849b5bca3d3cc097f805fe53064ee83b93 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:11:42 +0300
Subject: [PATCH 211/215] Step 20.35: Add style to the main image

---
 client/parties/styles/parties.import.less | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 4470813..0e73444 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -112,4 +112,10 @@
     width: 100%;
     text-align: center;
     background-color: #f8f8f8;
+}
+
+.party-image {
+    background-size: cover;
+    width: 100%;
+    height: 200px;
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d502457535940fdb93b19b63070388f14a230822 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 05:06:19 +0300
Subject: [PATCH 212/215] Step 20.36: Add the cfs:graphicsmagick package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 96f4516..cac0607 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -36,3 +36,4 @@ danialfarid:ng-file-upload
 alexk111:ng-img-crop
 vitalets:angular-xeditable
 netanelgilad:angular-sortable-view
+cfs:graphicsmagick
diff --git a/.meteor/versions b/.meteor/versions
index 6476773..be3b665 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -33,6 +33,7 @@ cfs:collection@0.5.5
 cfs:collection-filters@0.2.4
 cfs:data-man@0.0.6
 cfs:file@0.1.17
+cfs:graphicsmagick@0.0.18
 cfs:gridfs@0.0.33
 cfs:http-methods@0.0.30
 cfs:http-publish@0.0.13
-- 
2.3.2 (Apple Git-55)


From a3f387f1c8e9a000b7b76cb0bc9db44f922e9f37 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:13:15 +0300
Subject: [PATCH 213/215] Step 20.37: Add another store for the thumbnails

---
 model/images.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/model/images.js b/model/images.js
index 5cec451..3b06d5f 100644
--- a/model/images.js
+++ b/model/images.js
@@ -1,6 +1,11 @@
 Images = new FS.Collection("images", {
   stores: [
-    new FS.Store.GridFS("original")
+    new FS.Store.GridFS("original"),
+    new FS.Store.GridFS("thumbnail", {
+      transformWrite: function(fileObj, readStream, writeStream) {
+        gm(readStream, fileObj.name()).resize('32', '32', '!').stream().pipe(writeStream);
+      }
+    })
   ],
   filter: {
     allow: {
-- 
2.3.2 (Apple Git-55)


From b387adf40be19db62f9f9175535a68ba0f393029 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:13:50 +0300
Subject: [PATCH 214/215] Step 20.38: Add thumbnails usage

---
 client/parties/views/add-new-party-modal.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 70d0469..eed885c 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -44,7 +44,7 @@
               <div layout="row" class="images-container-title" sv-root sv-part="newPartyImages">
                 <div sv-element class="party-image-container" ng-repeat="image in newPartyImages">
                   <div class="main-image" ng-show="$index === 0">Main Image</div>
-                  <img draggable="false" ng-src="{{ image.url() }}"/><br/>
+                  <img draggable="false" ng-src="{{ image.url({store: 'thumbnail'}) }}"/><br/>
                   <a href="#" editable-text="image.metadata.description"
                      onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
                 </div>
-- 
2.3.2 (Apple Git-55)


From 3d08750e3710fc95bc629b92062937fdfa209b7d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:09:22 +0300
Subject: [PATCH 215/215] Add README

---
 .gitignore |  1 +
 COC.md     | 21 +++++++++++++++++++++
 README.md  | 64 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 86 insertions(+)
 create mode 100644 .gitignore
 create mode 100644 COC.md
 create mode 100644 README.md

diff --git a/.gitignore b/.gitignore
new file mode 100644
index 0000000..485dee6
--- /dev/null
+++ b/.gitignore
@@ -0,0 +1 @@
+.idea
diff --git a/COC.md b/COC.md
new file mode 100644
index 0000000..4748e55
--- /dev/null
+++ b/COC.md
@@ -0,0 +1,21 @@
+# Code of Conduct
+
+Learning in plain sight can be an intimidating experience. Your code, mistakes, and community feedback are all publically displayed for everyone to see. While this is true for any open source project, course participants are here to learn and can feel a lot more vulnerable.
+
+It is absolutely crucial that any interaction is done with respect, care, and without judgment, and that any feedback is provided gently. We want to teach and learn from each other, and for that to happen, we must treat each other with care.
+
+This course is dedicated to providing a harassment-free learning experience for everyone, regardless of gender, age, sexual orientation, disability, physical appearance, body size, race, or religion (or lack thereof). We do not tolerate harassment of participants in any form. Sexual language and imagery is not appropriate in any material posted to this repository or in other venues discussing it (e.g. Twitter and other online media). Participants violating these rules may be sanctioned or expelled from the course at the discretion of the maintainers as well as reported to GitHub for abuse.
+
+Harassment includes offensive verbal comments related to gender, age, sexual orientation, disability, physical appearance, body size, race, religion, sexual images in public spaces, deliberate intimidation, stalking, following, harassing photography or recording, sustained disruption of others, inappropriate physical contact, and unwelcome sexual attention.
+
+Participants asked to stop any harassing behavior are expected to comply immediately.
+
+Teachers and maintainers are also subject to the anti-harassment policy. In particular, they should not use sexualized images, activities, or other material.
+
+If a participant engages in harassing behavior, the maintainers may take any action they deem appropriate, including warning the offender or expulsion from the course.
+
+If you are being harassed, notice that someone else is being harassed, or have any other concerns, please contact a member of course team immediately. The list of maintainers can be found at the top of the [README document](https://github.com/hueniverse/hueniversity/blob/master/README.md).
+
+We expect participants to follow these rules at any related social events.
+
+(Adapted from http://confcodeofconduct.com/)
diff --git a/README.md b/README.md
new file mode 100644
index 0000000..9c9c1bd
--- /dev/null
+++ b/README.md
@@ -0,0 +1,64 @@
+# meteor-angular-socially - [Tutorial's site](http://angularjs.meteor.com/tutorial)
+angular-meteor example and tutorial app.
+
+The tutorial starts at branch 'step_00' till the last step.
+
+The master branch is always equal to the last step.
+
+Here is the deployed final version - http://socially-step18.meteor.com/
+
+Please contribute to the tutorial.
+Pull request the master branch to add new features or pull request specific step to improve that step.
+
+Our goal in this tutorial is to add more steps as we go along, to cover as many use cases as possible.
+
+Thanks @MilosStanic for writing step 18 on angular-material
+
+An example with the `controller as` syntax can be found in [this branch](https://github.com/Urigo/meteor-angular-socially/tree/step_12_controller_as_vm).
+
+# angular-meteor University! <a href="http://angularjs.meteor.com/"><img src="http://angularjs.meteor.com/images/logo-large.png" width="60" height="60" /></a>  
+
+The angular-meteor university is a community learning experiment, we would like to create a similar experience to the [hueniversity](https://github.com/hueniverse/hueniversity)
+
+
+[![Join the chat at https://gitter.im/Urigo/angular-meteor](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/Urigo/angular-meteor?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)
+
+The first assignments will be to rewrite the tutorial steps, and follow the latest angular-meteor API , in a more [consistent style](https://github.com/johnpapa/angular-styleguide).
+We also hope the community will propose better solutions than the current ones.
+When we will catch up with the latest steps we will create new steps.
+
+### What am I going to learn?
+You will learn how to build a full stack application using meteor and angular. It will start with the basics and move on to the more advanced topic such as users and authentication, application architecture, reactivity, mobile app, ionic, working with files, Angular Server, ES6 and more.
+
+
+### What do I need to know?
+You should feel comfortable writing simple functions in JavaScript, working with GitHub, using basic git commands, have a basic familiarity with mongoDB, and be able to pick up new subjects by reading tutorials and documentation.
+
+### How advanced is this course?
+We'll start from the basics and make our way to the most advanced topics. The way this course is structured, you can choose which assignments to participate in, so more experienced developers can "sit out" or help others during the basic assignments and participate when it gets to areas they are not as strong in. However, since teaching is one of the most effective ways to learn, we believe that participating early will improve the existing skills of advanced developers.
+The assignment will include just enough information to get you going, but you will need to do most of the learning on your own by using the wide range of online resources available. However, the real benefit of this process will come from the code review of your Pull Request. This is where expert developers will review your work and provide you specific and actionable feedback.
+
+### How does it work?
+First, read the [Code of Conduct](https://github.com/Urigo/meteor-angular-socially/blob/master/COC.md) !
+
+Simple, you start by forking this repo.
+Every few days a new issue will be posted with an [`assignment` label](https://github.com/Urigo/meteor-angular-socially/labels/assignment)
+. If you would like to participate in the assignment, try to solve it and when you are done, submit a Pull Request back to this repo to the `step_NUMBER_u` branch. Make sure your code complies with the [john papa angular style guid](https://github.com/johnpapa/angular-styleguide).
+While you wait for the assignment to close, take a look at what others are submitting and see if you can improve your own solution (borrow ideas, add tests, write examples, update the documentation). If you see ways in which others can improve their solution, please dont hesitate to comment on their Pull Request.
+Each assignment will have a final submission date. When the issue expires, one of the Pull Requests submitted will be picked and merged and published as the new tutorial step. Any follow up assignments will be based on the merged code.
+Before starting the next assignment, make sure [your fork matches the current](https://github.com/Urigo/meteor-angular-socially/blob/master/guides/git.md ) assignment step branch (`step_NUMBER_u`) since only one Pull Request can be accepted.
+
+### How can I help?
+
+There are lots of way you can help make this experiment succeed and help shape a new format for teaching development skills:
+Submit Pull Requests to improve this readme, add examples, write quick tutorials on how to work with git, etc.
+Add new steps to angular-meteor-socially tutorial.
+Look for issues with a [help wanted label](https://github.com/Urigo/meteor-angular-socially/labels/help%20wanted) and help with those.
+Randomly pick submitted Pull Request and review them, offering advice and helping others improve their skills.
+Submit Pull Request or open issues with proposals for [angular-meteor](https://github.com/Urigo/angular-meteor) 
+
+### Anything else?
+[Open an issue](https://github.com/Urigo/meteor-angular-socially/issues/new), it's free.
+
+
+
-- 
2.3.2 (Apple Git-55)

