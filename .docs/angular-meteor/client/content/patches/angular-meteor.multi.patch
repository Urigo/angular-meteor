From cfd2d90ca109d4fb1822ebc8ce815500093d25c8 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 00:46:56 +0300
Subject: [PATCH 001/212] Step 0.2: Remove all starter files

---
 socially.css  |  1 -
 socially.html | 14 --------------
 socially.js   | 23 -----------------------
 3 files changed, 38 deletions(-)
 delete mode 100644 socially.css
 delete mode 100644 socially.html
 delete mode 100644 socially.js

diff --git a/socially.css b/socially.css
deleted file mode 100644
index b6b4052..0000000
--- a/socially.css
+++ /dev/null
@@ -1 +0,0 @@
-/* CSS declarations go here */
diff --git a/socially.html b/socially.html
deleted file mode 100644
index cea01d7..0000000
--- a/socially.html
+++ /dev/null
@@ -1,14 +0,0 @@
-<head>
-  <title>socially</title>
-</head>
-
-<body>
-  <h1>Welcome to Meteor!</h1>
-
-  {{> hello}}
-</body>
-
-<template name="hello">
-  <button>Click Me</button>
-  <p>You've pressed the button {{counter}} times.</p>
-</template>
diff --git a/socially.js b/socially.js
deleted file mode 100644
index 4f8c65d..0000000
--- a/socially.js
+++ /dev/null
@@ -1,23 +0,0 @@
-if (Meteor.isClient) {
-  // counter starts at 0
-  Session.setDefault('counter', 0);
-
-  Template.hello.helpers({
-    counter: function () {
-      return Session.get('counter');
-    }
-  });
-
-  Template.hello.events({
-    'click button': function () {
-      // increment the counter when button is clicked
-      Session.set('counter', Session.get('counter') + 1);
-    }
-  });
-}
-
-if (Meteor.isServer) {
-  Meteor.startup(function () {
-    // code to run on server at startup
-  });
-}
-- 
2.3.2 (Apple Git-55)


From bba602748940ab7f1fde31753b7ced6b6db2e0d1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 14:23:47 +0300
Subject: [PATCH 002/212] Step 0.3: Create empty index.html file

---
 index.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 index.html

diff --git a/index.html b/index.html
new file mode 100644
index 0000000..ef412ef
--- /dev/null
+++ b/index.html
@@ -0,0 +1,3 @@
+<body>
+  <p>Nothing here</p>
+</body>
-- 
2.3.2 (Apple Git-55)


From 92b96645c6ec53784857802f45d94b9beecd3770 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 00:50:28 +0300
Subject: [PATCH 003/212] Step 0.4: Add the Angular package

---
 .meteor/packages | 1 +
 .meteor/versions | 4 ++++
 2 files changed, 5 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index a9f8340..03949b6 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,3 +18,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
+angular
diff --git a/.meteor/versions b/.meteor/versions
index e378b68..a702ca4 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,5 @@
+angular@1.0.0-rc.11
+angular:angular@1.4.6
 autopublish@1.0.4
 autoupdate@1.2.3
 babel-compiler@5.8.24_1
@@ -12,6 +14,7 @@ caching-compiler@1.0.0
 caching-html-compiler@1.0.1
 callback-hook@1.0.4
 check@1.0.6
+dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
 ddp-common@1.2.1
@@ -31,6 +34,7 @@ http@1.1.1
 id-map@1.0.4
 insecure@1.0.4
 jquery@1.11.4
+lai:collection-extensions@0.1.4
 launch-screen@1.0.4
 livedata@1.0.15
 logging@1.0.8
-- 
2.3.2 (Apple Git-55)


From 4452672987846e1fbdd744902001fbd6bfb36f94 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 16:47:59 +0300
Subject: [PATCH 004/212] Step 0.5: Move the main HTML content into
 index.ng.html

---
 index.ng.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 index.ng.html

diff --git a/index.ng.html b/index.ng.html
new file mode 100644
index 0000000..79ed426
--- /dev/null
+++ b/index.ng.html
@@ -0,0 +1 @@
+<p>Nothing here</p>
-- 
2.3.2 (Apple Git-55)


From d0d8deba471dbdf1de20598cdf09cd09e8a0ebf7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 16:49:45 +0300
Subject: [PATCH 005/212] Step 0.6: Include the angular main file inside the
 index.html file

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index ef412ef..bf21494 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
 <body>
-  <p>Nothing here</p>
+  <div ng-include="'index.ng.html'"></div>
 </body>
-- 
2.3.2 (Apple Git-55)


From 434fd37878721644e07f54b00b878a9194dafb18 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:14:56 +0300
Subject: [PATCH 006/212] Step 0.7: Create app.js file to contain the AngularJS
 application

---
 app.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 app.js

diff --git a/app.js b/app.js
new file mode 100644
index 0000000..2465ea1
--- /dev/null
+++ b/app.js
@@ -0,0 +1,3 @@
+if (Meteor.isClient) {
+
+}
-- 
2.3.2 (Apple Git-55)


From 3a69df01ea9e1799a3cfbacbd3002daff8fd0ac3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:16:03 +0300
Subject: [PATCH 007/212] Step 0.8: Create AngularJS module and add
 angular-meteor dependency

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index 2465ea1..987f384 100644
--- a/app.js
+++ b/app.js
@@ -1,3 +1,3 @@
 if (Meteor.isClient) {
-
+  angular.module('socially',['angular-meteor']);
 }
-- 
2.3.2 (Apple Git-55)


From bbfd83570475010601c86f8f66d22d683cab310e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:25:28 +0300
Subject: [PATCH 008/212] Step 0.9: Add ng-app

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index bf21494..963f4fa 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
-<body>
+<body ng-app="socially">
   <div ng-include="'index.ng.html'"></div>
 </body>
-- 
2.3.2 (Apple Git-55)


From 7d27905397e541cbbea3feac63405fa8a8c5b686 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:31:28 +0300
Subject: [PATCH 009/212] Step 0.10: Add AngularJS code!

---
 index.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.ng.html b/index.ng.html
index 79ed426..a9c8ddc 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -1 +1 @@
-<p>Nothing here</p>
+<p>Nothing here {{ 'yet' + '!' }}</p>
-- 
2.3.2 (Apple Git-55)


From bb060e6c16bc4cdb412b31a3af95ef81dd589714 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:18:08 +0300
Subject: [PATCH 010/212] Step 1.1: Add some static HTML the to main page

---
 index.ng.html | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/index.ng.html b/index.ng.html
index a9c8ddc..dd1ef68 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -1 +1,14 @@
-<p>Nothing here {{ 'yet' + '!' }}</p>
+<ul>
+  <li>
+    <span>Dubstep-Free Zone</span>
+    <p>
+      Can we please just for an evening not listen to dubstep.
+    </p>
+  </li>
+  <li>
+    <span>All dubstep all the time</span>
+    <p>
+      Get it on!
+    </p>
+  </li>
+</ul>
-- 
2.3.2 (Apple Git-55)


From 28d54221f062f8f953dd6177ee81c1c7dd9baa26 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:20:42 +0300
Subject: [PATCH 011/212] Step 2.1: Use dynamic template instead of static

---
 index.ng.html | 22 ++++++++--------------
 1 file changed, 8 insertions(+), 14 deletions(-)

diff --git a/index.ng.html b/index.ng.html
index dd1ef68..7f8c6d9 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -1,14 +1,8 @@
-<ul>
-  <li>
-    <span>Dubstep-Free Zone</span>
-    <p>
-      Can we please just for an evening not listen to dubstep.
-    </p>
-  </li>
-  <li>
-    <span>All dubstep all the time</span>
-    <p>
-      Get it on!
-    </p>
-  </li>
-</ul>
+<div ng-controller="PartiesListCtrl">
+  <ul>
+    <li ng-repeat="party in parties">
+      {{party.name}}
+      <p>{{party.description}}</p>
+    </li>
+  </ul>
+</div>
-- 
2.3.2 (Apple Git-55)


From 856b8893da8c1fc5412b8249d274032399465469 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:22:53 +0300
Subject: [PATCH 012/212] Step 2.2: Add the parties controller

---
 app.js | 21 +++++++++++++++++++--
 1 file changed, 19 insertions(+), 2 deletions(-)

diff --git a/app.js b/app.js
index 987f384..9cbfb86 100644
--- a/app.js
+++ b/app.js
@@ -1,3 +1,20 @@
 if (Meteor.isClient) {
-  angular.module('socially',['angular-meteor']);
-}
+  angular.module('socially', ['angular-meteor']);
+
+  angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
+    $scope.parties = [
+      {
+        'name': 'Dubstep-Free Zone',
+        'description': 'Can we please just for an evening not listen to dubstep.'
+      },
+      {
+        'name': 'All dubstep all the time',
+        'description': 'Get it on!'
+      },
+      {
+        'name': 'Savage lounging',
+        'description': 'Leisure suit required. And only fiercest manners.'
+      }
+    ];
+  }]);
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 507e4abeb252b8a64255da0f72c566b572c5b5b8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:27:33 +0300
Subject: [PATCH 013/212] Step 3.1: Add the parties collection

---
 app.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/app.js b/app.js
index 9cbfb86..c280708 100644
--- a/app.js
+++ b/app.js
@@ -1,3 +1,5 @@
+Parties = new Mongo.Collection("parties");
+
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-- 
2.3.2 (Apple Git-55)


From d4119593dfad8eda2b0cba799594da6a1f250682 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:39:33 +0300
Subject: [PATCH 014/212] Step 3.2: Add the $meteor.collection to the $scope

---
 app.js | 15 +--------------
 1 file changed, 1 insertion(+), 14 deletions(-)

diff --git a/app.js b/app.js
index c280708..b67154d 100644
--- a/app.js
+++ b/app.js
@@ -4,19 +4,6 @@ if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
   angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
-    $scope.parties = [
-      {
-        'name': 'Dubstep-Free Zone',
-        'description': 'Can we please just for an evening not listen to dubstep.'
-      },
-      {
-        'name': 'All dubstep all the time',
-        'description': 'Get it on!'
-      },
-      {
-        'name': 'Savage lounging',
-        'description': 'Leisure suit required. And only fiercest manners.'
-      }
-    ];
+    $scope.parties = $meteor.collection(Parties);
   }]);
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2379b3d5908029823f657d3c8b2450fdea127a1f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:40:05 +0300
Subject: [PATCH 015/212] Step 3.3: Add a dependency to $meteor

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index b67154d..698ceb5 100644
--- a/app.js
+++ b/app.js
@@ -3,7 +3,7 @@ Parties = new Mongo.Collection("parties");
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-  angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
+  angular.module('socially').controller('PartiesListCtrl', ['$scope', '$meteor', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
   }]);
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From bbb487ca5874210eccf3182ca950626ad94a489b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:43:17 +0300
Subject: [PATCH 016/212] Step 3.4: Add some data to the parties collection

---
 app.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/app.js b/app.js
index 698ceb5..5fcad11 100644
--- a/app.js
+++ b/app.js
@@ -6,4 +6,21 @@ if (Meteor.isClient) {
   angular.module('socially').controller('PartiesListCtrl', ['$scope', '$meteor', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
   }]);
+}
+
+if (Meteor.isServer) {
+  Meteor.startup(function () {
+    if (Parties.find().count() === 0) {
+      var parties = [
+        {'name': 'Dubstep-Free Zone',
+          'description': 'Fast just got faster with Nexus S.'},
+        {'name': 'All dubstep all the time',
+          'description': 'Get it on!'},
+        {'name': 'Savage lounging',
+          'description': 'Leisure suit required. And only fiercest manners.'}
+      ];
+      for (var i = 0; i < parties.length; i++)
+        Parties.insert(parties[i]);
+    }
+  });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5ce2abcf681b3d07c1392ec34c0592df359af773 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:49:37 +0300
Subject: [PATCH 017/212] Step 4.1: Add basic form to the view

---
 index.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/index.ng.html b/index.ng.html
index 7f8c6d9..4880315 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -1,4 +1,11 @@
 <div ng-controller="PartiesListCtrl">
+  <form>
+    <label>Name</label>
+    <input>
+    <label>Description</label>
+    <input>
+    <button>Add</button>
+  </form>
   <ul>
     <li ng-repeat="party in parties">
       {{party.name}}
-- 
2.3.2 (Apple Git-55)


From 528522c30145417f80ee3dddc75303c4cc520547 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:50:38 +0300
Subject: [PATCH 018/212] Step 4.2: Add ng-model to the form's inputs

---
 index.ng.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/index.ng.html b/index.ng.html
index 4880315..ea6dc8f 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -1,9 +1,9 @@
 <div ng-controller="PartiesListCtrl">
   <form>
     <label>Name</label>
-    <input>
+    <input ng-model="newParty.name">
     <label>Description</label>
-    <input>
+    <input ng-model="newParty.description">
     <button>Add</button>
   </form>
   <ul>
-- 
2.3.2 (Apple Git-55)


From c184dc6f345fc639f4e9fe28d39d4d3e6d4c100f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:51:15 +0300
Subject: [PATCH 019/212] Step 4.3: Add ng-click logic to the "Add" button

---
 index.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.ng.html b/index.ng.html
index ea6dc8f..d39fd36 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -4,7 +4,7 @@
     <input ng-model="newParty.name">
     <label>Description</label>
     <input ng-model="newParty.description">
-    <button>Add</button>
+    <button ng-click="parties.push(newParty); newParty='';">Add</button>
   </form>
   <ul>
     <li ng-repeat="party in parties">
-- 
2.3.2 (Apple Git-55)


From 8f7859eb150b744356edc5326c6691c3eedb9e23 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:52:46 +0300
Subject: [PATCH 020/212] Step 4.4: Add delete button to the parties list

---
 index.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/index.ng.html b/index.ng.html
index d39fd36..614c3a0 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -10,6 +10,7 @@
     <li ng-repeat="party in parties">
       {{party.name}}
       <p>{{party.description}}</p>
+      <button ng-click="remove(party)">X</button>
     </li>
   </ul>
 </div>
-- 
2.3.2 (Apple Git-55)


From 252f8fec4f665792ebad42dcd2b89428efda71ab Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:53:55 +0300
Subject: [PATCH 021/212] Step 4.5: Add remove logic to the controller

---
 app.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/app.js b/app.js
index 5fcad11..fbe73ca 100644
--- a/app.js
+++ b/app.js
@@ -5,6 +5,10 @@ if (Meteor.isClient) {
 
   angular.module('socially').controller('PartiesListCtrl', ['$scope', '$meteor', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
+
+    $scope.remove = function(party){
+      $scope.parties.splice($scope.parties.indexOf(party), 1);
+    };
   }]);
 }
 
-- 
2.3.2 (Apple Git-55)


From 2e19c103ed702ce78f2f26b8a51285cbd2e0ead3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:55:39 +0300
Subject: [PATCH 022/212] Step 4.6: Replace push with save

---
 index.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.ng.html b/index.ng.html
index 614c3a0..68ec2ac 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -4,7 +4,7 @@
     <input ng-model="newParty.name">
     <label>Description</label>
     <input ng-model="newParty.description">
-    <button ng-click="parties.push(newParty); newParty='';">Add</button>
+    <button ng-click="parties.save(newParty); newParty='';">Add</button>
   </form>
   <ul>
     <li ng-repeat="party in parties">
-- 
2.3.2 (Apple Git-55)


From 08d7527e90407eec7ed23e424d50bd618392a348 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:56:41 +0300
Subject: [PATCH 023/212] Step 4.7: Use remove function instead of splice

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index fbe73ca..a0119e6 100644
--- a/app.js
+++ b/app.js
@@ -7,7 +7,7 @@ if (Meteor.isClient) {
     $scope.parties = $meteor.collection(Parties);
 
     $scope.remove = function(party){
-      $scope.parties.splice($scope.parties.indexOf(party), 1);
+      $scope.parties.remove(party);
     };
   }]);
 }
-- 
2.3.2 (Apple Git-55)


From e187e31373b6ac87020cf1abc823c9c78ed1e05d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:57:38 +0300
Subject: [PATCH 024/212] Step 4.8: Add Remove All button

---
 index.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/index.ng.html b/index.ng.html
index 68ec2ac..5c567a8 100644
--- a/index.ng.html
+++ b/index.ng.html
@@ -5,6 +5,7 @@
     <label>Description</label>
     <input ng-model="newParty.description">
     <button ng-click="parties.save(newParty); newParty='';">Add</button>
+    <button ng-click="removeAll()">Remove All</button>
   </form>
   <ul>
     <li ng-repeat="party in parties">
-- 
2.3.2 (Apple Git-55)


From d455dae2fbc26e05c77b9908fd30395b31fd63ec Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:58:20 +0300
Subject: [PATCH 025/212] Step 4.9: Add Remove All logic to the controller

---
 app.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/app.js b/app.js
index a0119e6..f2ea8fd 100644
--- a/app.js
+++ b/app.js
@@ -9,6 +9,10 @@ if (Meteor.isClient) {
     $scope.remove = function(party){
       $scope.parties.remove(party);
     };
+
+    $scope.removeAll = function(){
+      $scope.parties.remove();
+    };
   }]);
 }
 
-- 
2.3.2 (Apple Git-55)


From 1ac94830138c037554390695790a4ba9dadecf14 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 01:24:43 +0300
Subject: [PATCH 026/212] Step 5.1: Add the angularui:angular-ui-router package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 03949b6..1c23a75 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
 angular
+angularui:angular-ui-router
diff --git a/.meteor/versions b/.meteor/versions
index a702ca4..02f8c3e 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,6 @@
 angular@1.0.0-rc.11
 angular:angular@1.4.6
+angularui:angular-ui-router@0.2.15
 autopublish@1.0.4
 autoupdate@1.2.3
 babel-compiler@5.8.24_1
-- 
2.3.2 (Apple Git-55)


From c5391801f65ed66c1af51c6490f60fc86b4234cb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:03:28 +0300
Subject: [PATCH 027/212] Step 5.2: Add angular-ui-router dependency

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index f2ea8fd..c68e970 100644
--- a/app.js
+++ b/app.js
@@ -1,7 +1,7 @@
 Parties = new Mongo.Collection("parties");
 
 if (Meteor.isClient) {
-  angular.module('socially', ['angular-meteor']);
+  angular.module('socially', ['angular-meteor', 'ui.router']);
 
   angular.module('socially').controller('PartiesListCtrl', ['$scope', '$meteor', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
-- 
2.3.2 (Apple Git-55)


From 0338eca75b12c200a9510c6cc9c3a7878c292944 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:08:18 +0300
Subject: [PATCH 028/212] Step 5.3: Create parties list page

---
 parties-list.ng.html | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 parties-list.ng.html

diff --git a/parties-list.ng.html b/parties-list.ng.html
new file mode 100644
index 0000000..28a1881
--- /dev/null
+++ b/parties-list.ng.html
@@ -0,0 +1,15 @@
+<form>
+  <label>Name</label>
+  <input ng-model="newParty.name">
+  <label>Description</label>
+  <input ng-model="newParty.description">
+  <button ng-click="parties.push(newParty)">Add</button>
+  <button ng-click="removeAll()">Remove All</button>
+</form>
+<ul>
+  <li ng-repeat="party in parties">
+    <a href="/parties/{{party._id}}">{{party.name}}</a>
+    <p>{{party.description}}</p>
+    <button ng-click="remove(party)">X</button>
+  </li>
+</ul>
-- 
2.3.2 (Apple Git-55)


From d778bb9e1c07a5e06ce5a43ba593144a584bb6ac Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:09:27 +0300
Subject: [PATCH 029/212] Step 5.4: Update index.html

---
 index.html | 17 ++++++++++++++---
 1 file changed, 14 insertions(+), 3 deletions(-)

diff --git a/index.html b/index.html
index 963f4fa..0fcd817 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,14 @@
-<body ng-app="socially">
-  <div ng-include="'index.ng.html'"></div>
-</body>
+<head>
+  <base href="/">
+</head>
+<body>
+
+<div ng-app="socially">
+  <h1>
+    <a href="/parties">Home</a>
+  </h1>
+
+  <div ui-view></div>
+</div>
+
+</body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 410a6dcc3530e9c3bf251b1ccb611ebfd9bc8336 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:12:39 +0300
Subject: [PATCH 030/212] Step 5.5: Remove index.ng.html

---
 index.ng.html | 17 -----------------
 1 file changed, 17 deletions(-)
 delete mode 100644 index.ng.html

diff --git a/index.ng.html b/index.ng.html
deleted file mode 100644
index 5c567a8..0000000
--- a/index.ng.html
+++ /dev/null
@@ -1,17 +0,0 @@
-<div ng-controller="PartiesListCtrl">
-  <form>
-    <label>Name</label>
-    <input ng-model="newParty.name">
-    <label>Description</label>
-    <input ng-model="newParty.description">
-    <button ng-click="parties.save(newParty); newParty='';">Add</button>
-    <button ng-click="removeAll()">Remove All</button>
-  </form>
-  <ul>
-    <li ng-repeat="party in parties">
-      {{party.name}}
-      <p>{{party.description}}</p>
-      <button ng-click="remove(party)">X</button>
-    </li>
-  </ul>
-</div>
-- 
2.3.2 (Apple Git-55)


From f38ab16fe8a116cf0b5c229e0b0c969b8ad043ff Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:12:51 +0300
Subject: [PATCH 031/212] Step 5.6: Create party details page

---
 party-details.ng.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 party-details.ng.html

diff --git a/party-details.ng.html b/party-details.ng.html
new file mode 100644
index 0000000..68fe7fe
--- /dev/null
+++ b/party-details.ng.html
@@ -0,0 +1 @@
+Here you will see the details of party number: {{ partyId }}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9a3643a43b6c6a9df1c9915eb7521f48218f9912 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:16:01 +0300
Subject: [PATCH 032/212] Step 5.7: Add routes definitions

---
 app.js | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

diff --git a/app.js b/app.js
index c68e970..af141a9 100644
--- a/app.js
+++ b/app.js
@@ -3,6 +3,26 @@ Parties = new Mongo.Collection("parties");
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor', 'ui.router']);
 
+  angular.module('socially').config(['$urlRouterProvider', '$stateProvider', '$locationProvider',
+    function($urlRouterProvider, $stateProvider, $locationProvider){
+
+      $locationProvider.html5Mode(true);
+
+      $stateProvider
+        .state('parties', {
+          url: '/parties',
+          templateUrl: 'parties-list.ng.html',
+          controller: 'PartiesListCtrl'
+        })
+        .state('partyDetails', {
+          url: '/parties/:partyId',
+          templateUrl: 'party-details.ng.html',
+          controller: 'PartyDetailsCtrl'
+        });
+
+      $urlRouterProvider.otherwise("/parties");
+    }]);
+
   angular.module('socially').controller('PartiesListCtrl', ['$scope', '$meteor', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
 
-- 
2.3.2 (Apple Git-55)


From 72c018308f31001dfd63f0dd60af528d584ad9c2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:17:00 +0300
Subject: [PATCH 033/212] Step 5.8: Add party details controller

---
 app.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/app.js b/app.js
index af141a9..6b55a29 100644
--- a/app.js
+++ b/app.js
@@ -34,6 +34,13 @@ if (Meteor.isClient) {
       $scope.parties.remove();
     };
   }]);
+
+  angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$stateParams',
+    function($scope, $stateParams){
+
+      $scope.partyId = $stateParams.partyId;
+
+    }]);
 }
 
 if (Meteor.isServer) {
-- 
2.3.2 (Apple Git-55)


From 7b48c39e5f793483ecdef25de45e9085a1ca975b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:41:12 +0300
Subject: [PATCH 034/212] Step 6.1: Add $meteor.object to the controller

---
 app.js | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

diff --git a/app.js b/app.js
index 6b55a29..49a49da 100644
--- a/app.js
+++ b/app.js
@@ -35,11 +35,9 @@ if (Meteor.isClient) {
     };
   }]);
 
-  angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$stateParams',
-    function($scope, $stateParams){
-
-      $scope.partyId = $stateParams.partyId;
-
+  angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$stateParams', '$meteor',
+    function($scope, $stateParams, $meteor){
+      $scope.party = $meteor.object(Parties, $stateParams.partyId);
     }]);
 }
 
-- 
2.3.2 (Apple Git-55)


From bbcc3c81efaa73eee9a746191c911c053f5d4c50 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:44:09 +0300
Subject: [PATCH 035/212] Step 6.2: Add binding to the party details

---
 party-details.ng.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/party-details.ng.html b/party-details.ng.html
index 68fe7fe..31f8472 100644
--- a/party-details.ng.html
+++ b/party-details.ng.html
@@ -1 +1,4 @@
-Here you will see the details of party number: {{ partyId }}
\ No newline at end of file
+Here you will see and change the details of the party:
+
+<input ng-model="party.name">
+<input ng-model="party.description">
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5caf95ed3a15ae74f2543d90af620d98b28d3882 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:46:20 +0300
Subject: [PATCH 036/212] Step 6.3: Add some buttons to the form

---
 party-details.ng.html | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/party-details.ng.html b/party-details.ng.html
index 31f8472..52e92e7 100644
--- a/party-details.ng.html
+++ b/party-details.ng.html
@@ -1,4 +1,8 @@
 Here you will see and change the details of the party:
 
 <input ng-model="party.name">
-<input ng-model="party.description">
\ No newline at end of file
+<input ng-model="party.description">
+
+<button ng-click="save()">Save</button>
+<button ng-click="reset()">Reset form</button>
+<button ui-sref="parties">Cancel</button>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 99e0b52c249a14762be8abf80e5894b9c5268ef9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:46:51 +0300
Subject: [PATCH 037/212] Step 6.4: Update the usage of $meteor.object

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index 49a49da..98446ad 100644
--- a/app.js
+++ b/app.js
@@ -37,7 +37,7 @@ if (Meteor.isClient) {
 
   angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$stateParams', '$meteor',
     function($scope, $stateParams, $meteor){
-      $scope.party = $meteor.object(Parties, $stateParams.partyId);
+      $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
     }]);
 }
 
-- 
2.3.2 (Apple Git-55)


From 727ba2a2775fd9c4ea33b5636e58d087511e349f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:47:13 +0300
Subject: [PATCH 038/212] Step 6.5: Add logic to the controller

---
 app.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/app.js b/app.js
index 98446ad..8d196ef 100644
--- a/app.js
+++ b/app.js
@@ -38,6 +38,14 @@ if (Meteor.isClient) {
   angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$stateParams', '$meteor',
     function($scope, $stateParams, $meteor){
       $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
+
+      $scope.save = function() {
+        $scope.party.save();
+      };
+
+      $scope.reset = function() {
+        $scope.party.reset();
+      };
     }]);
 }
 
-- 
2.3.2 (Apple Git-55)


From 0ced5db9d21d41cb560d9413e9c6373a3d9c8e46 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:48:18 +0300
Subject: [PATCH 039/212] Step 6.6: Full implementation of the controller logic

---
 app.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/app.js b/app.js
index 8d196ef..9534a19 100644
--- a/app.js
+++ b/app.js
@@ -40,7 +40,11 @@ if (Meteor.isClient) {
       $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
 
       $scope.save = function() {
-        $scope.party.save();
+        $scope.party.save().then(function(numberOfDocs){
+          console.log('save success doc affected ', numberOfDocs);
+        }, function(error){
+          console.log('save error', error);
+        });
       };
 
       $scope.reset = function() {
-- 
2.3.2 (Apple Git-55)


From 74d8bcd16a19de1cf2f00898f499ab971e5b852b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:54:24 +0300
Subject: [PATCH 040/212] Step 7.1: client/lib/app.js

---
 client/lib/app.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/lib/app.js

diff --git a/client/lib/app.js b/client/lib/app.js
new file mode 100644
index 0000000..999bdc1
--- /dev/null
+++ b/client/lib/app.js
@@ -0,0 +1 @@
+angular.module('socially',['angular-meteor', 'ui.router']);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1ecf859f6034a75f070109fa898b1c6b6f093869 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:00:58 +0300
Subject: [PATCH 041/212] Step 7.2: model/parties.js

---
 model/parties.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 model/parties.js

diff --git a/model/parties.js b/model/parties.js
new file mode 100644
index 0000000..dc0ccc3
--- /dev/null
+++ b/model/parties.js
@@ -0,0 +1 @@
+Parties = new Mongo.Collection("parties");
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From fb6d0ebbe10b45c6c31580644172ac1cbaa5f19a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:04:29 +0300
Subject: [PATCH 042/212] Step 7.3: server/startup/loadParties.js

---
 server/startup/loadParties.js | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 create mode 100644 server/startup/loadParties.js

diff --git a/server/startup/loadParties.js b/server/startup/loadParties.js
new file mode 100644
index 0000000..8d3780e
--- /dev/null
+++ b/server/startup/loadParties.js
@@ -0,0 +1,14 @@
+Meteor.startup(function () {
+  if (Parties.find().count() === 0) {
+    var parties = [
+      {'name': 'Dubstep-Free Zone',
+        'description': 'Fast just got faster with Nexus S.'},
+      {'name': 'All dubstep all the time',
+        'description': 'Get it on!'},
+      {'name': 'Savage lounging',
+        'description': 'Leisure suit required. And only fiercest manners.'}
+    ];
+    for (var i = 0; i < parties.length; i++)
+      Parties.insert({name: parties[i].name, description: parties[i].description});
+  }
+});
-- 
2.3.2 (Apple Git-55)


From bfa4117b3c317dc294830b3f93210e9aa0275189 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:06:09 +0300
Subject: [PATCH 043/212] Step 7.4: client/routes.js

---
 client/routes.js | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)
 create mode 100644 client/routes.js

diff --git a/client/routes.js b/client/routes.js
new file mode 100644
index 0000000..0c8d7a3
--- /dev/null
+++ b/client/routes.js
@@ -0,0 +1,19 @@
+angular.module("socially").config(['$urlRouterProvider', '$stateProvider', '$locationProvider',
+  function ($urlRouterProvider, $stateProvider, $locationProvider) {
+
+    $locationProvider.html5Mode(true);
+
+    $stateProvider
+      .state('parties', {
+        url: '/parties',
+        templateUrl: 'parties-list.ng.html',
+        controller: 'PartiesListCtrl'
+      })
+      .state('partyDetails', {
+        url: '/parties/:partyId',
+        templateUrl: 'party-details.ng.html',
+        controller: 'PartyDetailsCtrl'
+      });
+
+    $urlRouterProvider.otherwise("/parties");
+  }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d80c9a4115ac3059f7dccad2226e6d7eb5e4266d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:07:25 +0300
Subject: [PATCH 044/212] Step 7.5: client/parties/controllers/partiesList.js

---
 client/parties/controllers/partiesList.js | 13 +++++++++++++
 1 file changed, 13 insertions(+)
 create mode 100644 client/parties/controllers/partiesList.js

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
new file mode 100644
index 0000000..888df64
--- /dev/null
+++ b/client/parties/controllers/partiesList.js
@@ -0,0 +1,13 @@
+angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
+  function($scope, $meteor){
+
+    $scope.parties = $meteor.collection(Parties);
+
+    $scope.remove = function(party){
+      $scope.parties.splice( $scope.parties.indexOf(party), 1 );
+    };
+
+    $scope.removeAll = function(){
+      $scope.parties.remove();
+    };
+  }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b5f98fd09b555e49a5dda16f3d6d6d3b7e100a7e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:08:05 +0300
Subject: [PATCH 045/212] Step 7.6: client/parties/controllers/partyDetails.js

---
 client/parties/controllers/partyDetails.js | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 client/parties/controllers/partyDetails.js

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
new file mode 100644
index 0000000..0503dab
--- /dev/null
+++ b/client/parties/controllers/partyDetails.js
@@ -0,0 +1,4 @@
+angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$stateParams', '$meteor',
+  function ($scope, $stateParams, $meteor) {
+    $scope.party = $meteor.object(Parties, $stateParams.partyId);
+  }]);
-- 
2.3.2 (Apple Git-55)


From 33a9b0c7bb356a43d5cbccaf2a0efad82e13d756 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:10:21 +0300
Subject: [PATCH 046/212] Step 7.7: Move index.html

---
 client/index.html | 14 ++++++++++++++
 index.html        | 14 --------------
 2 files changed, 14 insertions(+), 14 deletions(-)
 create mode 100644 client/index.html
 delete mode 100644 index.html

diff --git a/client/index.html b/client/index.html
new file mode 100644
index 0000000..0fcd817
--- /dev/null
+++ b/client/index.html
@@ -0,0 +1,14 @@
+<head>
+  <base href="/">
+</head>
+<body>
+
+<div ng-app="socially">
+  <h1>
+    <a href="/parties">Home</a>
+  </h1>
+
+  <div ui-view></div>
+</div>
+
+</body>
\ No newline at end of file
diff --git a/index.html b/index.html
deleted file mode 100644
index 0fcd817..0000000
--- a/index.html
+++ /dev/null
@@ -1,14 +0,0 @@
-<head>
-  <base href="/">
-</head>
-<body>
-
-<div ng-app="socially">
-  <h1>
-    <a href="/parties">Home</a>
-  </h1>
-
-  <div ui-view></div>
-</div>
-
-</body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ee7c2a0a19d6a3b4775a83327bf5ce6c31304626 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:11:30 +0300
Subject: [PATCH 047/212] Step 7.8: Move to
 client/parties/views/parties-list.ng.html

---
 client/parties/views/parties-list.ng.html | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 client/parties/views/parties-list.ng.html

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
new file mode 100644
index 0000000..2b64715
--- /dev/null
+++ b/client/parties/views/parties-list.ng.html
@@ -0,0 +1,15 @@
+<form>
+  <label>Name</label>
+  <input ng-model="newParty.name">
+  <label>Description</label>
+  <input ng-model="newParty.description">
+  <button ng-click="parties.push(newParty)">Add</button>
+  <button ng-click="removeAll()">Remove All</button>
+</form>
+<ul>
+  <li ng-repeat="party in parties">
+    <a href="/parties/{{party._id}}">{{party.name}}</a>
+    <p>{{party.description}}</p>
+    <button ng-click="remove(party)">X</button>
+  </li>
+</ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From aa7fd43e7cd8ee7d2dedbdd636d0f6882af67fc7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:12:05 +0300
Subject: [PATCH 048/212] Step 7.9: Move to
 client/parties/views/party-details.ng.html

---
 client/parties/views/party-details.ng.html | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 client/parties/views/party-details.ng.html

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
new file mode 100644
index 0000000..31f8472
--- /dev/null
+++ b/client/parties/views/party-details.ng.html
@@ -0,0 +1,4 @@
+Here you will see and change the details of the party:
+
+<input ng-model="party.name">
+<input ng-model="party.description">
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0bab96f6bf76d4d511d58cfb859b1da002eb5735 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:13:46 +0300
Subject: [PATCH 049/212] Step 7.10: Update templateUrl for routes

---
 client/routes.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/routes.js b/client/routes.js
index 0c8d7a3..1c6fcc3 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -6,12 +6,12 @@ angular.module("socially").config(['$urlRouterProvider', '$stateProvider', '$loc
     $stateProvider
       .state('parties', {
         url: '/parties',
-        templateUrl: 'parties-list.ng.html',
+        templateUrl: 'client/parties/views/parties-list.ng.html',
         controller: 'PartiesListCtrl'
       })
       .state('partyDetails', {
         url: '/parties/:partyId',
-        templateUrl: 'party-details.ng.html',
+        templateUrl: 'client/parties/views/party-details.ng.html',
         controller: 'PartyDetailsCtrl'
       });
 
-- 
2.3.2 (Apple Git-55)


From 9a5c6e829130fe343599e105607d18ad9338c5c6 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 01:58:45 +0300
Subject: [PATCH 050/212] Step 7.11: Delete remaining files

---
 app.js                | 71 ---------------------------------------------------
 parties-list.ng.html  | 15 -----------
 party-details.ng.html |  8 ------
 3 files changed, 94 deletions(-)
 delete mode 100644 app.js
 delete mode 100644 parties-list.ng.html
 delete mode 100644 party-details.ng.html

diff --git a/app.js b/app.js
deleted file mode 100644
index 9534a19..0000000
--- a/app.js
+++ /dev/null
@@ -1,71 +0,0 @@
-Parties = new Mongo.Collection("parties");
-
-if (Meteor.isClient) {
-  angular.module('socially', ['angular-meteor', 'ui.router']);
-
-  angular.module('socially').config(['$urlRouterProvider', '$stateProvider', '$locationProvider',
-    function($urlRouterProvider, $stateProvider, $locationProvider){
-
-      $locationProvider.html5Mode(true);
-
-      $stateProvider
-        .state('parties', {
-          url: '/parties',
-          templateUrl: 'parties-list.ng.html',
-          controller: 'PartiesListCtrl'
-        })
-        .state('partyDetails', {
-          url: '/parties/:partyId',
-          templateUrl: 'party-details.ng.html',
-          controller: 'PartyDetailsCtrl'
-        });
-
-      $urlRouterProvider.otherwise("/parties");
-    }]);
-
-  angular.module('socially').controller('PartiesListCtrl', ['$scope', '$meteor', function ($scope, $meteor) {
-    $scope.parties = $meteor.collection(Parties);
-
-    $scope.remove = function(party){
-      $scope.parties.remove(party);
-    };
-
-    $scope.removeAll = function(){
-      $scope.parties.remove();
-    };
-  }]);
-
-  angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$stateParams', '$meteor',
-    function($scope, $stateParams, $meteor){
-      $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
-
-      $scope.save = function() {
-        $scope.party.save().then(function(numberOfDocs){
-          console.log('save success doc affected ', numberOfDocs);
-        }, function(error){
-          console.log('save error', error);
-        });
-      };
-
-      $scope.reset = function() {
-        $scope.party.reset();
-      };
-    }]);
-}
-
-if (Meteor.isServer) {
-  Meteor.startup(function () {
-    if (Parties.find().count() === 0) {
-      var parties = [
-        {'name': 'Dubstep-Free Zone',
-          'description': 'Fast just got faster with Nexus S.'},
-        {'name': 'All dubstep all the time',
-          'description': 'Get it on!'},
-        {'name': 'Savage lounging',
-          'description': 'Leisure suit required. And only fiercest manners.'}
-      ];
-      for (var i = 0; i < parties.length; i++)
-        Parties.insert(parties[i]);
-    }
-  });
-}
\ No newline at end of file
diff --git a/parties-list.ng.html b/parties-list.ng.html
deleted file mode 100644
index 28a1881..0000000
--- a/parties-list.ng.html
+++ /dev/null
@@ -1,15 +0,0 @@
-<form>
-  <label>Name</label>
-  <input ng-model="newParty.name">
-  <label>Description</label>
-  <input ng-model="newParty.description">
-  <button ng-click="parties.push(newParty)">Add</button>
-  <button ng-click="removeAll()">Remove All</button>
-</form>
-<ul>
-  <li ng-repeat="party in parties">
-    <a href="/parties/{{party._id}}">{{party.name}}</a>
-    <p>{{party.description}}</p>
-    <button ng-click="remove(party)">X</button>
-  </li>
-</ul>
diff --git a/party-details.ng.html b/party-details.ng.html
deleted file mode 100644
index 52e92e7..0000000
--- a/party-details.ng.html
+++ /dev/null
@@ -1,8 +0,0 @@
-Here you will see and change the details of the party:
-
-<input ng-model="party.name">
-<input ng-model="party.description">
-
-<button ng-click="save()">Save</button>
-<button ng-click="reset()">Reset form</button>
-<button ui-sref="parties">Cancel</button>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2e08996715491f76a39039fc5abbaa5cd2d40cb2 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:08:39 +0300
Subject: [PATCH 051/212] Step 8.1: Remove the insecure package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 1c23a75..7ea0928 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -17,6 +17,5 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
-insecure                # Allow all DB writes from clients (for prototyping)
 angular
 angularui:angular-ui-router
diff --git a/.meteor/versions b/.meteor/versions
index 02f8c3e..b82db53 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -33,7 +33,6 @@ html-tools@1.0.5
 htmljs@1.0.5
 http@1.1.1
 id-map@1.0.4
-insecure@1.0.4
 jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
-- 
2.3.2 (Apple Git-55)


From 93f67be70fb92356d76f100e06ddde1ccebb9989 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:09:42 +0300
Subject: [PATCH 052/212] Step 8.2: Add the accounts-password package

---
 .meteor/packages |  1 +
 .meteor/versions | 10 ++++++++++
 2 files changed, 11 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 7ea0928..943cd73 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 autopublish             # Publish all data to the clients (for prototyping)
 angular
 angularui:angular-ui-router
+accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index b82db53..f39416e 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,5 @@
+accounts-base@1.2.1
+accounts-password@1.1.3
 angular@1.0.0-rc.11
 angular:angular@1.4.6
 angularui:angular-ui-router@0.2.15
@@ -19,12 +21,14 @@ dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
 ddp-common@1.2.1
+ddp-rate-limiter@1.0.0
 ddp-server@1.2.1
 deps@1.0.9
 diff-sequence@1.0.1
 ecmascript@0.1.4
 ecmascript-collections@0.1.6
 ejson@1.0.7
+email@1.0.7
 es5-shim@4.1.13
 fastclick@1.0.7
 geojson-utils@1.0.4
@@ -37,6 +41,7 @@ jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
 livedata@1.0.15
+localstorage@1.0.5
 logging@1.0.8
 meteor@1.1.7
 meteor-base@1.0.1
@@ -46,19 +51,24 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.1
 mongo-id@1.0.1
+npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 promise@0.4.8
 random@1.0.4
+rate-limit@1.0.0
 reactive-dict@1.1.1
 reactive-var@1.0.6
 reload@1.1.4
 retry@1.0.4
 routepolicy@1.0.6
+service-configuration@1.0.5
 session@1.1.1
+sha@1.0.4
 spacebars@1.0.7
 spacebars-compiler@1.0.7
+srp@1.0.4
 standard-minifiers@1.0.0
 templating@1.1.3
 templating-tools@1.0.0
-- 
2.3.2 (Apple Git-55)


From 183921b079b4b0e6ff8fc9bbc6016312dd1ade28 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:10:30 +0300
Subject: [PATCH 053/212] Step 8.3: Add the accounts-ui package

---
 .meteor/packages | 1 +
 .meteor/versions | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 943cd73..967f421 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -20,3 +20,4 @@ autopublish             # Publish all data to the clients (for prototyping)
 angular
 angularui:angular-ui-router
 accounts-password
+accounts-ui
diff --git a/.meteor/versions b/.meteor/versions
index f39416e..339747b 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,7 @@
 accounts-base@1.2.1
 accounts-password@1.1.3
+accounts-ui@1.1.6
+accounts-ui-unstyled@1.1.8
 angular@1.0.0-rc.11
 angular:angular@1.4.6
 angularui:angular-ui-router@0.2.15
@@ -40,6 +42,7 @@ id-map@1.0.4
 jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
+less@2.5.0_2
 livedata@1.0.15
 localstorage@1.0.5
 logging@1.0.8
-- 
2.3.2 (Apple Git-55)


From 7c4fef9f936d74d6214e1945f9fbedec1b33132e Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:11:49 +0300
Subject: [PATCH 054/212] Step 8.4: Add the urigo:angular-blaze-template
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 967f421..5c44cbe 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -21,3 +21,4 @@ angular
 angularui:angular-ui-router
 accounts-password
 accounts-ui
+urigo:angular-blaze-template
diff --git a/.meteor/versions b/.meteor/versions
index 339747b..93c847f 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -78,6 +78,7 @@ templating-tools@1.0.0
 tracker@1.0.8
 ui@1.0.8
 underscore@1.0.4
+urigo:angular-blaze-template@0.0.1
 url@1.0.5
 webapp@1.2.2
 webapp-hashing@1.0.5
-- 
2.3.2 (Apple Git-55)


From 5502f0910a59f4de6b244bfc9c8aeadcba7dd322 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:14:04 +0300
Subject: [PATCH 055/212] Step 8.5: Use blaze-template directive to load the
 loginButtons Blaze template

---
 client/index.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/index.html b/client/index.html
index 0fcd817..cfc3aeb 100644
--- a/client/index.html
+++ b/client/index.html
@@ -4,6 +4,7 @@
 <body>
 
 <div ng-app="socially">
+  <blaze-template name="loginButtons"></blaze-template>
   <h1>
     <a href="/parties">Home</a>
   </h1>
-- 
2.3.2 (Apple Git-55)


From f87947bf93a690d950256378644dbc90aaff4d9b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:29:32 +0300
Subject: [PATCH 056/212] Step 8.6:  Add allow logic to the model

---
 model/parties.js | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/model/parties.js b/model/parties.js
index dc0ccc3..b793c1f 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -1 +1,13 @@
-Parties = new Mongo.Collection("parties");
\ No newline at end of file
+Parties = new Mongo.Collection("parties");
+
+Parties.allow({
+  insert: function (userId, party) {
+    return userId && party.owner === userId;
+  },
+  update: function (userId, party, fields, modifier) {
+    return userId && party.owner === userId;
+  },
+  remove: function (userId, party) {
+    return userId && party.owner === userId;
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 974835c793364770238f3a8d7190683a26578e77 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:34:30 +0300
Subject: [PATCH 057/212] Step 8.7: Add current user to the new party

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 2b64715..afbe90d 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -3,7 +3,7 @@
   <input ng-model="newParty.name">
   <label>Description</label>
   <input ng-model="newParty.description">
-  <button ng-click="parties.push(newParty)">Add</button>
+  <button ng-click="newParty.owner=$root.currentUser._id; parties.push(newParty)">Add</button>
   <button ng-click="removeAll()">Remove All</button>
 </form>
 <ul>
-- 
2.3.2 (Apple Git-55)


From d45fa9816b73c627503a2aa688bdd5e0837035e6 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:17:17 +0300
Subject: [PATCH 058/212] Step 8.8: Add accounts-facebook accounts-twitter
 packages

---
 .meteor/packages | 2 ++
 .meteor/versions | 8 ++++++++
 2 files changed, 10 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 5c44cbe..71d8a4d 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -22,3 +22,5 @@ angularui:angular-ui-router
 accounts-password
 accounts-ui
 urigo:angular-blaze-template
+accounts-facebook
+accounts-twitter
diff --git a/.meteor/versions b/.meteor/versions
index 93c847f..739c87b 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,8 @@
 accounts-base@1.2.1
+accounts-facebook@1.0.6
+accounts-oauth@1.1.7
 accounts-password@1.1.3
+accounts-twitter@1.0.6
 accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
 angular@1.0.0-rc.11
@@ -32,6 +35,7 @@ ecmascript-collections@0.1.6
 ejson@1.0.7
 email@1.0.7
 es5-shim@4.1.13
+facebook@1.2.2
 fastclick@1.0.7
 geojson-utils@1.0.4
 hot-code-push@1.0.0
@@ -56,6 +60,9 @@ mongo@1.1.1
 mongo-id@1.0.1
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
+oauth@1.1.6
+oauth1@1.1.5
+oauth2@1.1.5
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 promise@0.4.8
@@ -76,6 +83,7 @@ standard-minifiers@1.0.0
 templating@1.1.3
 templating-tools@1.0.0
 tracker@1.0.8
+twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
 urigo:angular-blaze-template@0.0.1
-- 
2.3.2 (Apple Git-55)


From f3cb2fd0c1a52ab6ddaf94bfee5acd57944177a9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:37:17 +0300
Subject: [PATCH 059/212] Step 8.9: Update route

---
 client/routes.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/client/routes.js b/client/routes.js
index 1c6fcc3..412a40d 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -12,7 +12,12 @@ angular.module("socially").config(['$urlRouterProvider', '$stateProvider', '$loc
       .state('partyDetails', {
         url: '/parties/:partyId',
         templateUrl: 'client/parties/views/party-details.ng.html',
-        controller: 'PartyDetailsCtrl'
+        controller: 'PartyDetailsCtrl',
+        resolve: {
+          "currentUser": ["$meteor", function($meteor){
+            return $meteor.requireUser();
+          }]
+        }
       });
 
     $urlRouterProvider.otherwise("/parties");
-- 
2.3.2 (Apple Git-55)


From 093be506f35f0bf8b5291c0bb4704b33c0a23ce5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:41:38 +0300
Subject: [PATCH 060/212] Step 8.10: Handle case that user is not logged in

---
 client/routes.js | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/routes.js b/client/routes.js
index 412a40d..e88ad92 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -1,3 +1,13 @@
+angular.module("socially").run(['$rootScope', '$state', function($rootScope, $state) {
+  $rootScope.$on('$stateChangeError', function(event, toState, toParams, fromState, fromParams, error) {
+    // We can catch the error thrown when the $requireUser promise is rejected
+    // and redirect the user back to the main page
+    if (error === 'AUTH_REQUIRED') {
+      $state.go('parties');
+    }
+  });
+}]);
+
 angular.module("socially").config(['$urlRouterProvider', '$stateProvider', '$locationProvider',
   function ($urlRouterProvider, $stateProvider, $locationProvider) {
 
-- 
2.3.2 (Apple Git-55)


From 23686777b26736748a49a1f6ced70b9ab22aafdf Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:27:21 +0300
Subject: [PATCH 061/212] Step 9.1: Remove the autopublish package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 71d8a4d..72e7e22 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -16,7 +16,6 @@ standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 ecmascript              # Enable ECMAScript2015+ syntax in app code
 
-autopublish             # Publish all data to the clients (for prototyping)
 angular
 angularui:angular-ui-router
 accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index 739c87b..ad16cab 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -8,7 +8,6 @@ accounts-ui-unstyled@1.1.8
 angular@1.0.0-rc.11
 angular:angular@1.4.6
 angularui:angular-ui-router@0.2.15
-autopublish@1.0.4
 autoupdate@1.2.3
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
-- 
2.3.2 (Apple Git-55)


From 8a92ee97baf9615eab40063fae25b4498beb820c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:50:23 +0300
Subject: [PATCH 062/212] Step 9.2: Usage of publish method

---
 server/parties.js | 13 +++++++++++++
 1 file changed, 13 insertions(+)
 create mode 100644 server/parties.js

diff --git a/server/parties.js b/server/parties.js
new file mode 100644
index 0000000..277f09a
--- /dev/null
+++ b/server/parties.js
@@ -0,0 +1,13 @@
+Meteor.publish("parties", function () {
+  return Parties.find({
+    $or:[
+      {$and:[
+        {"public": true},
+        {"public": {$exists: true}}
+      ]},
+      {$and:[
+        {owner: this.userId},
+        {owner: {$exists: true}}
+      ]}
+    ]});
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0d9d4bee404823cd0b82148c787a0dc8044325b4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:53:15 +0300
Subject: [PATCH 063/212] Step 9.3: Use "subscribe" function on the scope

---
 client/parties/controllers/partiesList.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 888df64..e0f806b 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,7 +1,7 @@
 angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
   function($scope, $meteor){
 
-    $scope.parties = $meteor.collection(Parties);
+    $scope.parties = $meteor.collection(Parties).subscribe('parties');
 
     $scope.remove = function(party){
       $scope.parties.splice( $scope.parties.indexOf(party), 1 );
-- 
2.3.2 (Apple Git-55)


From d65f7b6005ed606b3a40bf5217509d9552f80b78 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:00:41 +0300
Subject: [PATCH 064/212] Step 9.4: Add checkbox for public party

---
 client/parties/views/parties-list.ng.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index afbe90d..ca956ea 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -3,6 +3,8 @@
   <input ng-model="newParty.name">
   <label>Description</label>
   <input ng-model="newParty.description">
+  <label>Public</label>
+  <input type="checkbox" ng-model="newParty.public">
   <button ng-click="newParty.owner=$root.currentUser._id; parties.push(newParty)">Add</button>
   <button ng-click="removeAll()">Remove All</button>
 </form>
-- 
2.3.2 (Apple Git-55)


From f9025878c97cf0c418480b2f5c83d20757a4db9b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:03:38 +0300
Subject: [PATCH 065/212] Step 9.5: Add checkbox for public party in the
 details

---
 client/parties/views/party-details.ng.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 31f8472..f798477 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -1,4 +1,6 @@
 Here you will see and change the details of the party:
 
 <input ng-model="party.name">
-<input ng-model="party.description">
\ No newline at end of file
+<input ng-model="party.description">
+<label>Is public</label>
+<input type="checkbox" ng-model="party.public">
-- 
2.3.2 (Apple Git-55)


From 0b0b55522c163872cb9fb4d8757747d8b9eb1fa6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:04:57 +0300
Subject: [PATCH 066/212] Step 9.6: Publish the users collection

---
 server/users.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 server/users.js

diff --git a/server/users.js b/server/users.js
new file mode 100644
index 0000000..f5becea
--- /dev/null
+++ b/server/users.js
@@ -0,0 +1,3 @@
+Meteor.publish("users", function () {
+  return Meteor.users.find({}, {fields: {emails: 1, profile: 1}});
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 574b81ee2c566ba5198622b3f8362a7c6e38bec5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:06:51 +0300
Subject: [PATCH 067/212] Step 9.7: Subscribe to the users collection

---
 client/parties/controllers/partyDetails.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 0503dab..7ac734b 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -1,4 +1,5 @@
 angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$stateParams', '$meteor',
   function ($scope, $stateParams, $meteor) {
     $scope.party = $meteor.object(Parties, $stateParams.partyId);
+    $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
   }]);
-- 
2.3.2 (Apple Git-55)


From 491e00f53484d3e271975b5c050949b6be12731f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:08:09 +0300
Subject: [PATCH 068/212] Step 9.8: Subscribe to the parties collection

---
 client/parties/controllers/partyDetails.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 7ac734b..a65cabc 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -1,5 +1,5 @@
 angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$stateParams', '$meteor',
   function ($scope, $stateParams, $meteor) {
-    $scope.party = $meteor.object(Parties, $stateParams.partyId);
+    $scope.party = $meteor.object(Parties, $stateParams.partyId).subscribe('parties');
     $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
   }]);
-- 
2.3.2 (Apple Git-55)


From 27e6c89c5360c2bba1bc051c1bf59329ff461985 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:09:09 +0300
Subject: [PATCH 069/212] Step 9.9: Add the user details

---
 client/parties/views/party-details.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index f798477..a640092 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -4,3 +4,10 @@ Here you will see and change the details of the party:
 <input ng-model="party.description">
 <label>Is public</label>
 <input type="checkbox" ng-model="party.public">
+
+<ul>
+  Users:
+  <li ng-repeat="user in users">
+    <div>{{ user.emails[0].address }}</div>
+  </li>
+</ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1fa205ba3a5a1d44344aa12e991c3f142b94663a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:13:54 +0300
Subject: [PATCH 070/212] Step 11.1: Update the module initialization

---
 client/lib/app.js | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 999bdc1..436212a 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1 +1,10 @@
-angular.module('socially',['angular-meteor', 'ui.router']);
\ No newline at end of file
+angular.module('socially',['angular-meteor', 'ui.router']);
+
+function onReady() {
+  angular.bootstrap(document, ['socially']);
+}
+
+if (Meteor.isCordova)
+  angular.element(document).on("deviceready", onReady);
+else
+  angular.element(document).ready(onReady);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 30eb45a8d1270dabf727c727208d84327d40d6eb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:16:29 +0300
Subject: [PATCH 071/212] Step 11.2: Remove the ng-app directive

---
 client/index.html | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/client/index.html b/client/index.html
index cfc3aeb..b42b266 100644
--- a/client/index.html
+++ b/client/index.html
@@ -3,12 +3,11 @@
 </head>
 <body>
 
-<div ng-app="socially">
+<div>
   <blaze-template name="loginButtons"></blaze-template>
   <h1>
     <a href="/parties">Home</a>
   </h1>
-
   <div ui-view></div>
 </div>
 
-- 
2.3.2 (Apple Git-55)


From b91959596bfad7741a3e79f261c459bef78862b2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:20:14 +0300
Subject: [PATCH 072/212] Step 12.1: Add options to the parties publish

---
 server/parties.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/server/parties.js b/server/parties.js
index 277f09a..663bcd8 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,4 @@
-Meteor.publish("parties", function () {
+Meteor.publish("parties", function (options) {
   return Parties.find({
     $or:[
       {$and:[
@@ -9,5 +9,5 @@ Meteor.publish("parties", function () {
         {owner: this.userId},
         {owner: {$exists: true}}
       ]}
-    ]});
+    ]}, options);
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 25c40a78328a95465e629528333fafae171944ec Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:23:07 +0300
Subject: [PATCH 073/212] Step 12.2: Add the sorting params to the scope

---
 client/parties/controllers/partiesList.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index e0f806b..c2c8136 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,6 +1,10 @@
 angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
   function($scope, $meteor){
 
+    $scope.page = 1;
+    $scope.perPage = 3;
+    $scope.sort = { name: 1 };
+
     $scope.parties = $meteor.collection(Parties).subscribe('parties');
 
     $scope.remove = function(party){
-- 
2.3.2 (Apple Git-55)


From fc47a08df63ebf9658e14665512b92fa7b28ef1f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:25:07 +0300
Subject: [PATCH 074/212] Step 12.3: Separate the collection and the subscribe

---
 client/parties/controllers/partiesList.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index c2c8136..30e37d9 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -5,7 +5,8 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
     $scope.perPage = 3;
     $scope.sort = { name: 1 };
 
-    $scope.parties = $meteor.collection(Parties).subscribe('parties');
+    $scope.parties = $meteor.collection(Parties);
+    $meteor.subscribe('parties');
 
     $scope.remove = function(party){
       $scope.parties.splice( $scope.parties.indexOf(party), 1 );
-- 
2.3.2 (Apple Git-55)


From 79a811fec4101da97782cacd74d7c2f41f582b0f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:25:32 +0300
Subject: [PATCH 075/212] Step 12.4: Add the params to the subscribe

---
 client/parties/controllers/partiesList.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 30e37d9..311ed73 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -6,7 +6,11 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
     $scope.sort = { name: 1 };
 
     $scope.parties = $meteor.collection(Parties);
-    $meteor.subscribe('parties');
+    $meteor.subscribe('parties', {
+      limit: parseInt($scope.perPage),
+      skip: parseInt(($scope.page - 1) * $scope.perPage),
+      sort: $scope.sort
+    });
 
     $scope.remove = function(party){
       $scope.parties.splice( $scope.parties.indexOf(party), 1 );
-- 
2.3.2 (Apple Git-55)


From cddf8e87ff5418a4ac71af60e7677e961feb1d47 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:26:26 +0300
Subject: [PATCH 076/212] Step 12.5: Replace the Parties collection with cursor

---
 client/parties/controllers/partiesList.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 311ed73..54727b6 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -5,7 +5,12 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
     $scope.perPage = 3;
     $scope.sort = { name: 1 };
 
-    $scope.parties = $meteor.collection(Parties);
+    $scope.parties = $meteor.collection(function() {
+      return Parties.find({}, {
+        sort : $scope.sort
+      });
+    });
+
     $meteor.subscribe('parties', {
       limit: parseInt($scope.perPage),
       skip: parseInt(($scope.page - 1) * $scope.perPage),
-- 
2.3.2 (Apple Git-55)


From e195dbc9ef123b87376b78d59c3de4de9a14fbe1 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:48:28 +0300
Subject: [PATCH 077/212] Step 12.6: Add the angularutils:pagination package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 72e7e22..a44d838 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -23,3 +23,4 @@ accounts-ui
 urigo:angular-blaze-template
 accounts-facebook
 accounts-twitter
+angularutils:pagination
diff --git a/.meteor/versions b/.meteor/versions
index ad16cab..9f46671 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -8,6 +8,7 @@ accounts-ui-unstyled@1.1.8
 angular@1.0.0-rc.11
 angular:angular@1.4.6
 angularui:angular-ui-router@0.2.15
+angularutils:pagination@0.7.0
 autoupdate@1.2.3
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
-- 
2.3.2 (Apple Git-55)


From 167f7d38438e885659464d6a460fcd514a201086 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:32:41 +0300
Subject: [PATCH 078/212] Step 12.7: Add the pagination module

---
 client/lib/app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 436212a..79b962b 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1,4 +1,4 @@
-angular.module('socially',['angular-meteor', 'ui.router']);
+angular.module('socially',['angular-meteor', 'ui.router', 'angularUtils.directives.dirPagination']);
 
 function onReady() {
   angular.bootstrap(document, ['socially']);
-- 
2.3.2 (Apple Git-55)


From 034e9168094e7d0ca4b14493dd9ac5bb45f9662c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:33:26 +0300
Subject: [PATCH 079/212] Step 12.8: Use the pagination directive

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index ca956ea..806534f 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -9,7 +9,7 @@
   <button ng-click="removeAll()">Remove All</button>
 </form>
 <ul>
-  <li ng-repeat="party in parties">
+  <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
-- 
2.3.2 (Apple Git-55)


From 0dc688a7fc15de43e855e4437b4fe331b9f93766 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:33:51 +0300
Subject: [PATCH 080/212] Step 12.9: Add the pagination controls

---
 client/parties/views/parties-list.ng.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 806534f..1041916 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -14,4 +14,5 @@
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
   </li>
-</ul>
\ No newline at end of file
+</ul>
+<dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a1c8462c39efc1401b8af8ae649933da16cf4223 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:35:01 +0300
Subject: [PATCH 081/212] Step 12.10: Add function to handle the page change

---
 client/parties/controllers/partiesList.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 54727b6..7549424 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -24,4 +24,8 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
     $scope.removeAll = function(){
       $scope.parties.remove();
     };
+
+    $scope.pageChanged = function(newPage) {
+      $scope.page = newPage;
+    };
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cd4d36be85ed22465c9bf78742015807a3853c04 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:50:32 +0300
Subject: [PATCH 082/212] Step 12.11: Add the tmeasday:publish-counts package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index a44d838..7abcbd4 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -24,3 +24,4 @@ urigo:angular-blaze-template
 accounts-facebook
 accounts-twitter
 angularutils:pagination
+tmeasday:publish-counts
diff --git a/.meteor/versions b/.meteor/versions
index 9f46671..5d2ed86 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -82,6 +82,7 @@ srp@1.0.4
 standard-minifiers@1.0.0
 templating@1.1.3
 templating-tools@1.0.0
+tmeasday:publish-counts@0.7.2
 tracker@1.0.8
 twitter@1.1.5
 ui@1.0.8
-- 
2.3.2 (Apple Git-55)


From 5df6d520d53908f3c1b3d6490a3b398c8274f773 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:38:00 +0300
Subject: [PATCH 083/212] Step 12.12: Add parties count publish

---
 server/parties.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index 663bcd8..9622905 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,16 @@
 Meteor.publish("parties", function (options) {
+  Counts.publish(this, 'numberOfParties', Parties.find({
+    $or:[
+      {$and:[
+        {'public': true},
+        {'public': {$exists: true}}
+      ]},
+      {$and:[
+        {owner: this.userId},
+        {owner: {$exists: true}}
+      ]}
+    ]}), { noReady: true });
+
   return Parties.find({
     $or:[
       {$and:[
-- 
2.3.2 (Apple Git-55)


From 3b8464c4d17bb1a8aa61982fe3593eefda333aa6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:40:14 +0300
Subject: [PATCH 084/212] Step 12.13: Add parties count to the client

---
 client/parties/controllers/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 7549424..8251b94 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -15,6 +15,8 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
       limit: parseInt($scope.perPage),
       skip: parseInt(($scope.page - 1) * $scope.perPage),
       sort: $scope.sort
+    }).then(function(){
+      $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
     });
 
     $scope.remove = function(party){
-- 
2.3.2 (Apple Git-55)


From 795070dc0a3b204cce042897568b6d362d624b16 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:41:19 +0300
Subject: [PATCH 085/212] Step 12.14: Add autorun to wrap the subscribe

---
 client/parties/controllers/partiesList.js | 14 ++++++++------
 1 file changed, 8 insertions(+), 6 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 8251b94..251320d 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -11,12 +11,14 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
       });
     });
 
-    $meteor.subscribe('parties', {
-      limit: parseInt($scope.perPage),
-      skip: parseInt(($scope.page - 1) * $scope.perPage),
-      sort: $scope.sort
-    }).then(function(){
-      $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
+    $meteor.autorun($scope, function() {
+      $meteor.subscribe('parties', {
+        limit: parseInt($scope.perPage),
+        skip: parseInt(($scope.page - 1) * $scope.perPage),
+        sort: $scope.sort
+      }).then(function(){
+        $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
+      });
     });
 
     $scope.remove = function(party){
-- 
2.3.2 (Apple Git-55)


From e0ff2f68a5df45ffe0843c8261f94473d9432048 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:41:47 +0300
Subject: [PATCH 086/212] Step 12.15: Added usage of getReactivly

---
 client/parties/controllers/partiesList.js | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 251320d..51dd62d 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -13,9 +13,9 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
 
     $meteor.autorun($scope, function() {
       $meteor.subscribe('parties', {
-        limit: parseInt($scope.perPage),
-        skip: parseInt(($scope.page - 1) * $scope.perPage),
-        sort: $scope.sort
+        limit: parseInt($scope.getReactively('perPage')),
+        skip: (parseInt($scope.getReactively('page')) - 1) * parseInt($scope.getReactively('perPage')),
+        sort: $scope.getReactively('sort')
       }).then(function(){
         $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
       });
-- 
2.3.2 (Apple Git-55)


From c29d7d237eb335332b88ff5b5a5baf3aaea9c0d6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:43:10 +0300
Subject: [PATCH 087/212] Step 12.16: Added usage of getReactivly to the
 collection

---
 client/parties/controllers/partiesList.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 51dd62d..6df313b 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -7,7 +7,7 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
 
     $scope.parties = $meteor.collection(function() {
       return Parties.find({}, {
-        sort : $scope.sort
+        sort : $scope.getReactively('sort')
       });
     });
 
-- 
2.3.2 (Apple Git-55)


From 8028d65ba433b27cf5517b87c98f39317cba0083 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:43:45 +0300
Subject: [PATCH 088/212] Step 12.17: Add sort controls to the view

---
 client/parties/views/parties-list.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 1041916..3d39e49 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -9,6 +9,13 @@
   <button ng-click="removeAll()">Remove All</button>
 </form>
 <ul>
+  <h1>Parties:</h1>
+  <div>
+    <select ng-model="orderProperty">
+      <option value="1">Ascending</option>
+      <option value="-1">Descending</option>
+    </select>
+  </div>
   <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
-- 
2.3.2 (Apple Git-55)


From 6a6ef93d7444e582fe322c64e6dd168178518901 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:44:25 +0300
Subject: [PATCH 089/212] Step 12.18: Add order logic to the client

---
 client/parties/controllers/partiesList.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 6df313b..d3ba0ae 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -32,4 +32,9 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
     $scope.pageChanged = function(newPage) {
       $scope.page = newPage;
     };
+
+    $scope.$watch('orderProperty', function(){
+      if ($scope.orderProperty)
+        $scope.sort = {name: parseInt($scope.orderProperty)};
+    });
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 21cede108198f4754f6c77cf0d09c260255f64d9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:46:02 +0300
Subject: [PATCH 090/212] Step 12.19: Add default sort definition

---
 client/parties/controllers/partiesList.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index d3ba0ae..c375d15 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -4,6 +4,7 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
     $scope.page = 1;
     $scope.perPage = 3;
     $scope.sort = { name: 1 };
+    $scope.orderProperty = '1';
 
     $scope.parties = $meteor.collection(function() {
       return Parties.find({}, {
-- 
2.3.2 (Apple Git-55)


From d435dd01ada5fbfcc5aeeb1f997d6994dd8a68c4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:48:55 +0300
Subject: [PATCH 091/212] Step 12.20: Add search string to the collection

---
 server/parties.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/server/parties.js b/server/parties.js
index 9622905..5366910 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,4 @@
-Meteor.publish("parties", function (options) {
+Meteor.publish("parties", function (options, searchString) {
   Counts.publish(this, 'numberOfParties', Parties.find({
     $or:[
       {$and:[
-- 
2.3.2 (Apple Git-55)


From d8612cc73ab6dca875bc985b463b95ffd63aedf2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:50:07 +0300
Subject: [PATCH 092/212] Step 12.21: Add the search logic

---
 server/parties.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index 5366910..c2dc88b 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,5 +1,9 @@
 Meteor.publish("parties", function (options, searchString) {
+  if (searchString == null)
+    searchString = '';
+
   Counts.publish(this, 'numberOfParties', Parties.find({
+    'name' : { '$regex' : '.*' + searchString || '' + '.*', '$options' : 'i' },
     $or:[
       {$and:[
         {'public': true},
@@ -12,6 +16,7 @@ Meteor.publish("parties", function (options, searchString) {
     ]}), { noReady: true });
 
   return Parties.find({
+    'name' : { '$regex' : '.*' + searchString || '' + '.*', '$options' : 'i' },
     $or:[
       {$and:[
         {"public": true},
-- 
2.3.2 (Apple Git-55)


From 39236e0cb5dda4c81254b668841534b890ff3b89 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:51:56 +0300
Subject: [PATCH 093/212] Step 12.22: Add the search input

---
 client/parties/views/parties-list.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 3d39e49..e5fd486 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -11,6 +11,7 @@
 <ul>
   <h1>Parties:</h1>
   <div>
+    <input type="search" ng-model="search" placeholder="Search">
     <select ng-model="orderProperty">
       <option value="1">Ascending</option>
       <option value="-1">Descending</option>
-- 
2.3.2 (Apple Git-55)


From 6eb12782c33adc4b2d78b195ac78b3b3ffda9b91 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:52:39 +0300
Subject: [PATCH 094/212] Step 12.23: Add the search param to the subscribe

---
 client/parties/controllers/partiesList.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index c375d15..2423087 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -17,7 +17,7 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
         limit: parseInt($scope.getReactively('perPage')),
         skip: (parseInt($scope.getReactively('page')) - 1) * parseInt($scope.getReactively('perPage')),
         sort: $scope.getReactively('sort')
-      }).then(function(){
+      }, $scope.getReactively('search')).then(function() {
         $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
       });
     });
-- 
2.3.2 (Apple Git-55)


From 38e4ab696218c29feef381908b830a5cc2963ea2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:55:28 +0300
Subject: [PATCH 095/212] Step 12.24: Remove the subscription from the object

---
 client/parties/controllers/partyDetails.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index a65cabc..7ac734b 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -1,5 +1,5 @@
 angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$stateParams', '$meteor',
   function ($scope, $stateParams, $meteor) {
-    $scope.party = $meteor.object(Parties, $stateParams.partyId).subscribe('parties');
+    $scope.party = $meteor.object(Parties, $stateParams.partyId);
     $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
   }]);
-- 
2.3.2 (Apple Git-55)


From 85a7fb22e83932f5dc520f64bb83d04630e3f023 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:56:02 +0300
Subject: [PATCH 096/212] Step 12.25: Add $scope subscription to the collection

---
 client/parties/controllers/partyDetails.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 7ac734b..4cfb48d 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -2,4 +2,5 @@ angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$statePara
   function ($scope, $stateParams, $meteor) {
     $scope.party = $meteor.object(Parties, $stateParams.partyId);
     $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
+    $scope.$meteorSubscribe('parties');
   }]);
-- 
2.3.2 (Apple Git-55)


From d0444849356bcd1d6c1f4c405913bba5697f5abf Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:57:59 +0300
Subject: [PATCH 097/212] Step 13.1: Create the filter

---
 client/parties/filters/uninvited.js | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 create mode 100644 client/parties/filters/uninvited.js

diff --git a/client/parties/filters/uninvited.js b/client/parties/filters/uninvited.js
new file mode 100644
index 0000000..9166e47
--- /dev/null
+++ b/client/parties/filters/uninvited.js
@@ -0,0 +1,14 @@
+angular.module('socially').filter('uninvited', function () {
+  return function (users, party) {
+    if (!party)
+      return false;
+
+    return _.filter(users, function (user) {
+      if (user._id == party.owner ||
+        _.contains(party.invited, user._id))
+        return false;
+      else
+        return true;
+    });
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7a48d14deda840b4b626fe18a75c8f88e9f45666 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:59:45 +0300
Subject: [PATCH 098/212] Step 13.2: Use the filter

---
 client/parties/views/party-details.ng.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index a640092..5ab9471 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -6,8 +6,8 @@ Here you will see and change the details of the party:
 <input type="checkbox" ng-model="party.public">
 
 <ul>
-  Users:
-  <li ng-repeat="user in users">
+  Users to invite:
+  <li ng-repeat="user in users | uninvited:party">
     <div>{{ user.emails[0].address }}</div>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5a9e1a6c52db8cd11c4a4f25662122541ae0a107 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:00:48 +0300
Subject: [PATCH 099/212] Step 13.3: Use filter to display user details

---
 client/parties/views/party-details.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 5ab9471..4642f74 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -8,6 +8,6 @@ Here you will see and change the details of the party:
 <ul>
   Users to invite:
   <li ng-repeat="user in users | uninvited:party">
-    <div>{{ user.emails[0].address }}</div>
+    <div>{{ user | displayName }}</div>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ad43e31433400ab4eeddaa54eddcbdff22dfa437 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:01:22 +0300
Subject: [PATCH 100/212] Step 13.4: Create the displayName filter

---
 client/parties/filters/displayName.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 client/parties/filters/displayName.js

diff --git a/client/parties/filters/displayName.js b/client/parties/filters/displayName.js
new file mode 100644
index 0000000..162f496
--- /dev/null
+++ b/client/parties/filters/displayName.js
@@ -0,0 +1,12 @@
+angular.module('socially').filter('displayName', function () {
+  return function (user) {
+    if (!user)
+      return;
+    if (user.profile && user.profile.name)
+      return user.profile.name;
+    else if (user.emails)
+      return user.emails[0].address;
+    else
+      return user;
+  }
+});
-- 
2.3.2 (Apple Git-55)


From 599c12aa0d9359d6c3afdb77bf35dc8b65ec8673 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:05:24 +0300
Subject: [PATCH 101/212] Step 13.5: Added user details

---
 client/parties/views/parties-list.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index e5fd486..d3cc5e0 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -21,6 +21,7 @@
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
+    <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
 </ul>
 <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 32f414a3c5f8b9045e994e92717aed455ca7f6b9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:07:30 +0300
Subject: [PATCH 102/212] Step 13.6: Added the logic to the controller

---
 client/parties/controllers/partiesList.js | 23 +++++++++++++++++++++--
 1 file changed, 21 insertions(+), 2 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 2423087..00852a7 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,5 +1,5 @@
-angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
-  function($scope, $meteor){
+angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '$rootScope',
+  function($scope, $meteor, $rootScope){
 
     $scope.page = 1;
     $scope.perPage = 3;
@@ -38,4 +38,23 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor',
       if ($scope.orderProperty)
         $scope.sort = {name: parseInt($scope.orderProperty)};
     });
+
+    $scope.getUserById = function(userId){
+      return Meteor.users.findOne(userId);
+    };
+
+    $scope.creator = function(party){
+      if (!party)
+        return;
+      var owner = $scope.getUserById(party.owner);
+      if (!owner)
+        return 'nobody';
+
+      if ($rootScope.currentUser)
+        if ($rootScope.currentUser._id)
+          if (owner._id === $rootScope.currentUser._id)
+            return 'me';
+
+      return owner;
+    };
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 47e3df557d573d9c6d4c71c88008105d6bbb391e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:12:01 +0300
Subject: [PATCH 103/212] Step 13.5: Added user details

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index d3cc5e0..3d05a0e 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -21,7 +21,7 @@
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
-    <p><small>Posted by {{ creator(party) | displayName }}</small></p>
+    <p><small>Posted by {{ creator(party) }}</small></p>
   </li>
 </ul>
 <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a06193ac8e62d3afa9da33e81da7d9dd6b136ba0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:13:18 +0300
Subject: [PATCH 104/212] Step 13.7: Added subscribe to the users collection

---
 client/parties/controllers/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 00852a7..afdef32 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -6,6 +6,8 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '
     $scope.sort = { name: 1 };
     $scope.orderProperty = '1';
 
+    $scope.$meteorSubscribe('users');
+
     $scope.parties = $meteor.collection(function() {
       return Parties.find({}, {
         sort : $scope.getReactively('sort')
-- 
2.3.2 (Apple Git-55)


From 975a4b7c78f12ed5b5865638a1a26c299bf739a3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:13:48 +0300
Subject: [PATCH 105/212] Step 13.8: Use filter to display the user info

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 3d05a0e..d3cc5e0 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -21,7 +21,7 @@
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
-    <p><small>Posted by {{ creator(party) }}</small></p>
+    <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
 </ul>
 <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 3260f4b920e595d58357cb02e94a0c86b5198745 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:23:03 +0300
Subject: [PATCH 106/212] Step 14.1: Add meteor method to the model

---
 model/parties.js | 46 +++++++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 45 insertions(+), 1 deletion(-)

diff --git a/model/parties.js b/model/parties.js
index b793c1f..8998b5e 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -10,4 +10,48 @@ Parties.allow({
   remove: function (userId, party) {
     return userId && party.owner === userId;
   }
-});
\ No newline at end of file
+});
+
+Meteor.methods({
+  invite: function (partyId, userId) {
+    check(partyId, String);
+    check(userId, String);
+    var party = Parties.findOne(partyId);
+    if (!party)
+      throw new Meteor.Error(404, "No such party");
+    if (party.owner !== this.userId)
+      throw new Meteor.Error(404, "No such party");
+    if (party.public)
+      throw new Meteor.Error(400,
+        "That party is public. No need to invite people.");
+
+    if (userId !== party.owner && ! _.contains(party.invited, userId)) {
+      Parties.update(partyId, { $addToSet: { invited: userId } });
+
+      var from = contactEmail(Meteor.users.findOne(this.userId));
+      var to = contactEmail(Meteor.users.findOne(userId));
+
+      if (Meteor.isServer && to) {
+        // This code only runs on the server. If you didn't want clients
+        // to be able to see it, you could move it to a separate file.
+        Email.send({
+          from: "noreply@socially.com",
+          to: to,
+          replyTo: from || undefined,
+          subject: "PARTY: " + party.title,
+          text:
+          "Hey, I just invited you to '" + party.title + "' on Socially." +
+          "\n\nCome check it out: " + Meteor.absoluteUrl() + "\n"
+        });
+      }
+    }
+  }
+});
+
+var contactEmail = function (user) {
+  if (user.emails && user.emails.length)
+    return user.emails[0].address;
+  if (user.services && user.services.facebook && user.services.facebook.email)
+    return user.services.facebook.email;
+  return null;
+};
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2e9fea70cb9d767111f20c31f3f338fb2e2dfe1e Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:01:09 +0300
Subject: [PATCH 107/212] Step 14.2: Add the email package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 7abcbd4..7264ae6 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -25,3 +25,4 @@ accounts-facebook
 accounts-twitter
 angularutils:pagination
 tmeasday:publish-counts
+email
-- 
2.3.2 (Apple Git-55)


From c8cb9630b63db405fc9c5e1f3fc58bb549b5eb1d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:25:19 +0300
Subject: [PATCH 108/212] Step 14.3: Add invite method to the client

---
 client/parties/controllers/partyDetails.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 4cfb48d..045ea9d 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -3,4 +3,15 @@ angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$statePara
     $scope.party = $meteor.object(Parties, $stateParams.partyId);
     $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
     $scope.$meteorSubscribe('parties');
+
+    $scope.invite = function(user){
+      $meteor.call('invite', $scope.party._id, user._id).then(
+        function(data){
+          console.log('success inviting', data);
+        },
+        function(err){
+          console.log('failed', err);
+        }
+      );
+    };
   }]);
-- 
2.3.2 (Apple Git-55)


From 6219bed6ab328d4b4de94bd4619eeda828d621eb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:26:39 +0300
Subject: [PATCH 109/212] Step 14.4: Add invite button to the view

---
 client/parties/views/party-details.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 4642f74..609a4ba 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -9,5 +9,6 @@ Here you will see and change the details of the party:
   Users to invite:
   <li ng-repeat="user in users | uninvited:party">
     <div>{{ user | displayName }}</div>
+    <button ng-click="invite(user)">Invite</button>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 917e8415bd539f1a5adad9c80f63352c661bc32d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:27:54 +0300
Subject: [PATCH 110/212] Step 14.5: Add invited logic to the publish

---
 server/parties.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index c2dc88b..b691e30 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -12,6 +12,10 @@ Meteor.publish("parties", function (options, searchString) {
       {$and:[
         {owner: this.userId},
         {owner: {$exists: true}}
+      ]},
+      {$and:[
+        {invited: this.userId},
+        {invited: {$exists: true}}
       ]}
     ]}), { noReady: true });
 
@@ -25,6 +29,10 @@ Meteor.publish("parties", function (options, searchString) {
       {$and:[
         {owner: this.userId},
         {owner: {$exists: true}}
+      ]},
+      {$and:[
+        {invited: this.userId},
+        {invited: {$exists: true}}
       ]}
     ]}, options);
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d1eb505be90cd39552e8386369b6b448290e2085 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:30:21 +0300
Subject: [PATCH 111/212] Step 14.6: Add RSVP function to the server

---
 model/parties.js | 40 ++++++++++++++++++++++++++++++++++++++++
 1 file changed, 40 insertions(+)

diff --git a/model/parties.js b/model/parties.js
index 8998b5e..37b10e5 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -45,6 +45,46 @@ Meteor.methods({
         });
       }
     }
+  },
+  rsvp: function (partyId, rsvp) {
+    check(partyId, String);
+    check(rsvp, String);
+    if (! this.userId)
+      throw new Meteor.Error(403, "You must be logged in to RSVP");
+    if (! _.contains(['yes', 'no', 'maybe'], rsvp))
+      throw new Meteor.Error(400, "Invalid RSVP");
+    var party = Parties.findOne(partyId);
+    if (! party)
+      throw new Meteor.Error(404, "No such party");
+    if (! party.public && party.owner !== this.userId &&
+      !_.contains(party.invited, this.userId))
+    // private, but let's not tell this to the user
+      throw new Meteor.Error(403, "No such party");
+
+    var rsvpIndex = _.indexOf(_.pluck(party.rsvps, 'user'), this.userId);
+    if (rsvpIndex !== -1) {
+      // update existing rsvp entry
+
+      if (Meteor.isServer) {
+        // update the appropriate rsvp entry with $
+        Parties.update(
+          {_id: partyId, "rsvps.user": this.userId},
+          {$set: {"rsvps.$.rsvp": rsvp}});
+      } else {
+        // minimongo doesn't yet support $ in modifier. as a temporary
+        // workaround, make a modifier that uses an index. this is
+        // safe on the client since there's only one thread.
+        var modifier = {$set: {}};
+        modifier.$set["rsvps." + rsvpIndex + ".rsvp"] = rsvp;
+        Parties.update(partyId, modifier);
+      }
+      // Possible improvement: send email to the other people that are
+      // coming to the party.
+    } else {
+      // add new rsvp entry
+      Parties.update(partyId,
+        {$push: {rsvps: {user: this.userId, rsvp: rsvp}}});
+    }
   }
 });
 
-- 
2.3.2 (Apple Git-55)


From 085a9280651636f7b3f6b3b1f2844967b4421177 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:31:14 +0300
Subject: [PATCH 112/212] Step 14.7: Add RSVP function to the client

---
 client/parties/controllers/partiesList.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index afdef32..ea7eb56 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -41,6 +41,17 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '
         $scope.sort = {name: parseInt($scope.orderProperty)};
     });
 
+    $scope.rsvp = function(partyId, rsvp){
+      $meteor.call('rsvp', partyId, rsvp).then(
+        function(data){
+          console.log('success responding', data);
+        },
+        function(err){
+          console.log('failed', err);
+        }
+      );
+    };
+
     $scope.getUserById = function(userId){
       return Meteor.users.findOne(userId);
     };
-- 
2.3.2 (Apple Git-55)


From 865821d1f4226ce6d716ea78fd6b1f2586143f22 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:33:05 +0300
Subject: [PATCH 113/212] Step 14.8: Add RSVP control to the view

---
 client/parties/views/parties-list.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index d3cc5e0..451835f 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -21,6 +21,13 @@
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
+
+    <div>
+      <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
+      <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
+      <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
+    </div>
+
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From 2fea80771a0aef3abc8e99ac155b52b8bb56fd36 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:33:44 +0300
Subject: [PATCH 114/212] Step 14.9: Add RSVP list to the view

---
 client/parties/views/parties-list.ng.html | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 451835f..98e33e5 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -27,6 +27,21 @@
       <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
     </div>
+    <div>
+      Who is coming:
+      Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
+      Maybe - {{ (party.rsvps | filter:{rsvp:'maybe'}).length }}
+      No - {{ (party.rsvps | filter:{rsvp:'no'}).length }}
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'yes'}">
+        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'maybe'}">
+        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'no'}">
+        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+    </div>
 
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
-- 
2.3.2 (Apple Git-55)


From e936f224abe02f130da89c8849f943441fc426bb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:34:19 +0300
Subject: [PATCH 115/212] Step 14.10: Add RSVP list to the view of users who
 not responded

---
 client/parties/views/parties-list.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 98e33e5..e4660f1 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -43,6 +43,13 @@
       </div>
     </div>
 
+    <ul>
+      Users who not responded:
+      <li ng-repeat="invitedUser in outstandingInvitations(party)">
+        {{dstache}} invitedUser | displayName }}
+      </li>
+    </ul>
+
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From 433a690e33cb26fc7ce90770a678fe672feb1a1a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:34:54 +0300
Subject: [PATCH 116/212] Step 14.11: Added logic to the controller

---
 client/parties/controllers/partiesList.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index ea7eb56..57d1f52 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -52,6 +52,13 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '
       );
     };
 
+    $scope.outstandingInvitations = function (party) {
+      return _.filter($scope.users, function (user) {
+        return (_.contains(party.invited, user._id) &&
+        !_.findWhere(party.rsvps, {user: user._id}));
+      });
+    };
+
     $scope.getUserById = function(userId){
       return Meteor.users.findOne(userId);
     };
-- 
2.3.2 (Apple Git-55)


From b7d32e8ac699a751e7e47b34da3413e8145dfe8d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:35:37 +0300
Subject: [PATCH 117/212] Step 14.12: Add users collection

---
 client/parties/controllers/partiesList.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 57d1f52..2273fb3 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -6,7 +6,7 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '
     $scope.sort = { name: 1 };
     $scope.orderProperty = '1';
 
-    $scope.$meteorSubscribe('users');
+    $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
 
     $scope.parties = $meteor.collection(function() {
       return Parties.find({}, {
-- 
2.3.2 (Apple Git-55)


From 68f9fd4d1851fd696d81740f6eb5ec91fffedc78 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:39:54 +0300
Subject: [PATCH 118/212] Step 15.1: Add ng-show to the directive

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index e4660f1..f3a0f85 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -1,4 +1,4 @@
-<form>
+<form ng-show="$root.currentUser">
   <label>Name</label>
   <input ng-model="newParty.name">
   <label>Description</label>
-- 
2.3.2 (Apple Git-55)


From d22a94502b6dc9160cef1fdc2c83cd671f7adf32 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:40:35 +0300
Subject: [PATCH 119/212] Step 15.2: Add message to users that not logged in

---
 client/parties/views/parties-list.ng.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index f3a0f85..d15876f 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -8,6 +8,9 @@
   <button ng-click="newParty.owner=$root.currentUser._id; parties.push(newParty)">Add</button>
   <button ng-click="removeAll()">Remove All</button>
 </form>
+<div ng-hide="$root.currentUser || $root.loggingIn">
+  Log in to create a party!
+</div>
 <ul>
   <h1>Parties:</h1>
   <div>
-- 
2.3.2 (Apple Git-55)


From a43bb6b14bbc38ee00b82c9a9f872f7e4926f3b8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:41:09 +0300
Subject: [PATCH 120/212] Step 15.3: Add ng-show to the RSVP buttons

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index d15876f..f3c8063 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -25,7 +25,7 @@
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
 
-    <div>
+    <div ng-show="$root.currentUser">
       <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
       <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
-- 
2.3.2 (Apple Git-55)


From a04a33977b3555dbfa9ec9daea814b4dbbd957f9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:41:46 +0300
Subject: [PATCH 121/212] Step 15.4: Add message for not-logged in users on the
 RSVP buttons

---
 client/parties/views/parties-list.ng.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index f3c8063..19a43f9 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -30,6 +30,10 @@
       <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
     </div>
+    <div ng-hide="$root.currentUser">
+      <i>Sign in to RSVP for this party.</i>
+    </div>
+
     <div>
       Who is coming:
       Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
-- 
2.3.2 (Apple Git-55)


From 1c00e7ca3fabc68fdb1bb5924d9d5852e9718cf9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:42:52 +0300
Subject: [PATCH 122/212] Step 15.5: Add ng-show to delete button

---
 client/parties/views/parties-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 19a43f9..c1c5752 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -23,7 +23,7 @@
   <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
-    <button ng-click="remove(party)">X</button>
+    <button ng-click="remove(party)" ng-show="$root.currentUser && $root.currentUser._id == party.owner">X</button>
 
     <div ng-show="$root.currentUser">
       <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
-- 
2.3.2 (Apple Git-55)


From 05fb5474cd4a8644db4ac62e481f01ae1220d797 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:43:59 +0300
Subject: [PATCH 123/212] Step 15.6: Add ng-if to outstanding RSVP

---
 client/parties/views/parties-list.ng.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index c1c5752..58652c8 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -50,12 +50,15 @@
       </div>
     </div>
 
-    <ul>
+    <ul ng-if="!party.public">
       Users who not responded:
       <li ng-repeat="invitedUser in outstandingInvitations(party)">
         {{dstache}} invitedUser | displayName }}
       </li>
     </ul>
+    <div ng-if="party.public">
+      Everyone is invited
+    </div>
 
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
-- 
2.3.2 (Apple Git-55)


From 81400b07d5878acd0660dc06430537f5fc900b36 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:46:41 +0300
Subject: [PATCH 124/212] Step 15.7: Add canInvite logic

---
 client/parties/controllers/partyDetails.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 045ea9d..0c27c6e 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -14,4 +14,12 @@ angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$statePara
         }
       );
     };
+
+    $scope.canInvite = function (){
+      if (!$scope.party)
+        return false;
+
+      return !$scope.party.public &&
+        $scope.party.owner === Meteor.userId();
+    };
   }]);
-- 
2.3.2 (Apple Git-55)


From fd0e1dc63c9fc0571cb4a9bc94792b825988cc58 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:47:19 +0300
Subject: [PATCH 125/212] Step 15.8: Add usage for ng-show with canInvite

---
 client/parties/views/party-details.ng.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 609a4ba..a695811 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -5,10 +5,13 @@ Here you will see and change the details of the party:
 <label>Is public</label>
 <input type="checkbox" ng-model="party.public">
 
-<ul>
+<ul ng-show="canInvite()">
   Users to invite:
   <li ng-repeat="user in users | uninvited:party">
     <div>{{ user | displayName }}</div>
     <button ng-click="invite(user)">Invite</button>
   </li>
+  <li ng-if="(users | uninvited:party).length <= 0">
+    Everyone are already invited.
+  </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6c7ff2e98c4bc4f305c1ce6ae458c45efe86d0a9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:49:32 +0300
Subject: [PATCH 126/212] Step 15.9: Example of ng-disabled

---
 client/parties/views/party-details.ng.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index a695811..f17a8f2 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -1,9 +1,9 @@
 Here you will see and change the details of the party:
 
-<input ng-model="party.name">
-<input ng-model="party.description">
+<input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id">
+<input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id">
 <label>Is public</label>
-<input type="checkbox" ng-model="party.public">
+<input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
 
 <ul ng-show="canInvite()">
   Users to invite:
-- 
2.3.2 (Apple Git-55)


From 370882f30f4dc10cee6ded27f712c6258a1c1579 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:07:46 +0300
Subject: [PATCH 127/212] Step 16.1: Add the angularui:angular-google-maps
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 7264ae6..2780df8 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -26,3 +26,4 @@ accounts-twitter
 angularutils:pagination
 tmeasday:publish-counts
 email
+angularui:angular-google-maps
diff --git a/.meteor/versions b/.meteor/versions
index 5d2ed86..92307e4 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -7,6 +7,7 @@ accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
 angular@1.0.0-rc.11
 angular:angular@1.4.6
+angularui:angular-google-maps@2.2.1
 angularui:angular-ui-router@0.2.15
 angularutils:pagination@0.7.0
 autoupdate@1.2.3
@@ -58,6 +59,7 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.1
 mongo-id@1.0.1
+nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
 oauth@1.1.6
@@ -80,6 +82,7 @@ spacebars@1.0.7
 spacebars-compiler@1.0.7
 srp@1.0.4
 standard-minifiers@1.0.0
+stevezhu:lodash@1.0.2
 templating@1.1.3
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
-- 
2.3.2 (Apple Git-55)


From 8f13767ee6afbd8b7a2dc1ef2a60ecb1befc93e2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:54:08 +0300
Subject: [PATCH 128/212] Step 16.1: Add google maps module dependency

---
 client/lib/app.js | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 79b962b..980e7c3 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1,5 +1,9 @@
-angular.module('socially',['angular-meteor', 'ui.router', 'angularUtils.directives.dirPagination']);
-
+angular.module('socially',[
+  'angular-meteor',
+  'ui.router',
+  'angularUtils.directives.dirPagination',
+  'uiGmapgoogle-maps'
+]);
 function onReady() {
   angular.bootstrap(document, ['socially']);
 }
-- 
2.3.2 (Apple Git-55)


From 9bc24d58c833875f864d5a1644e0abf3cc5c93b6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:54:54 +0300
Subject: [PATCH 129/212] Step 16.2: Add basic map to the view

---
 client/parties/views/party-details.ng.html | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index f17a8f2..73c4640 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -14,4 +14,12 @@ Here you will see and change the details of the party:
   <li ng-if="(users | uninvited:party).length <= 0">
     Everyone are already invited.
   </li>
-</ul>
\ No newline at end of file
+</ul>
+
+<div class="party-details-maps">
+  <div class="angular-google-map-container">
+    <ui-gmap-google-map center="party.location || map.center"
+                        events="map.events" zoom="map.zoom">
+    </ui-gmap-google-map>
+  </div>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4f254e1109d2f2f5d9ec047fec255ff9060dde26 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:55:24 +0300
Subject: [PATCH 130/212] Step 16.3: Add map params to the controller

---
 client/parties/controllers/partyDetails.js | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 0c27c6e..75e12f2 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -22,4 +22,13 @@ angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$statePara
       return !$scope.party.public &&
         $scope.party.owner === Meteor.userId();
     };
+
+    $scope.map = {
+      center: {
+        latitude: 45,
+        longitude: -73
+      },
+      zoom: 8,
+      events: {}
+    };
   }]);
-- 
2.3.2 (Apple Git-55)


From 70a30b939a54dd1fb09506cb6ee1df46682f2491 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:56:18 +0300
Subject: [PATCH 131/212] Step 16.4: Create basic CSS style with google map
 style

---
 client/parties/styles/parties.css | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 client/parties/styles/parties.css

diff --git a/client/parties/styles/parties.css b/client/parties/styles/parties.css
new file mode 100644
index 0000000..219ff39
--- /dev/null
+++ b/client/parties/styles/parties.css
@@ -0,0 +1,4 @@
+.angular-google-map-container {
+    height: 400px;
+    width: 400px;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5338ab2bcbd3d1372b465a633a0d4f0e940ca5dd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:57:43 +0300
Subject: [PATCH 132/212] Step 16.5: Add party marker to the map

---
 client/parties/views/party-details.ng.html | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 73c4640..7ef1f8d 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -16,10 +16,11 @@ Here you will see and change the details of the party:
   </li>
 </ul>
 
-<div class="party-details-maps">
-  <div class="angular-google-map-container">
-    <ui-gmap-google-map center="party.location || map.center"
-                        events="map.events" zoom="map.zoom">
-    </ui-gmap-google-map>
-  </div>
+<div class="angular-google-map-container">
+  <ui-gmap-google-map center="party.location || map.center"
+                      events="map.events" zoom="map.zoom">
+    <ui-gmap-marker coords="party.location" options="map.marker.options"
+                    events="map.marker.events" idkey="party._id">
+    </ui-gmap-marker>
+  </ui-gmap-google-map>
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0eb9acefcc8f6442b14348feee23d48f8902763c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:58:32 +0300
Subject: [PATCH 133/212] Step 16.6: Add the marker creation logic to the
 controller

---
 client/parties/controllers/partyDetails.js | 27 ++++++++++++++++++++++++++-
 1 file changed, 26 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 75e12f2..b6209e5 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -29,6 +29,31 @@ angular.module("socially").controller("PartyDetailsCtrl", ['$scope', '$statePara
         longitude: -73
       },
       zoom: 8,
-      events: {}
+      events: {
+        click: function (mapModel, eventName, originalEventArgs) {
+          if (!$scope.party)
+            return;
+
+          if (!$scope.party.location)
+            $scope.party.location = {};
+
+          $scope.party.location.latitude = originalEventArgs[0].latLng.lat();
+          $scope.party.location.longitude = originalEventArgs[0].latLng.lng();
+          //scope apply required because this event handler is outside of the angular domain
+          $scope.$apply();
+        }
+      },
+      marker: {
+        options: { draggable: true },
+        events: {
+          dragend: function (marker, eventName, args) {
+            if (!$scope.party.location)
+              $scope.party.location = {};
+
+            $scope.party.location.latitude = marker.getPosition().lat();
+            $scope.party.location.longitude = marker.getPosition().lng();
+          }
+        }
+      }
     };
   }]);
-- 
2.3.2 (Apple Git-55)


From d6fe95ab9bf77e69d18b9ffccbd984d010b4bb0d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:59:21 +0300
Subject: [PATCH 134/212] Step 16.7: Add map to the parties list

---
 client/parties/views/parties-list.ng.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index 58652c8..e0e9d47 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -20,6 +20,13 @@
       <option value="-1">Descending</option>
     </select>
   </div>
+  <div class="angular-google-map-container">
+    <ui-gmap-google-map center="party.location || map.center" zoom="map.zoom">
+      <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
+                       fit="true" idkey="'_id'" doRebuildAll="true">
+      </ui-gmap-markers>
+    </ui-gmap-google-map>
+  </div>
   <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
-- 
2.3.2 (Apple Git-55)


From dc62f6cca7d9020d6018618172ecc9541cb6f643 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:00:02 +0300
Subject: [PATCH 135/212] Step 16.8: Add map logic to the parties list
 controller

---
 client/parties/controllers/partiesList.js | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 2273fb3..4c3255e 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -21,6 +21,21 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '
         sort: $scope.getReactively('sort')
       }, $scope.getReactively('search')).then(function() {
         $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
+
+        $scope.parties.forEach( function (party) {
+          party.onClicked = function () {
+            $state.go('partyDetails', {partyId: party._id});
+          };
+        });
+
+        $scope.map = {
+          center: {
+            latitude: 45,
+            longitude: -73
+          },
+          zoom: 8
+        };
+
       });
     });
 
-- 
2.3.2 (Apple Git-55)


From 9ea7424d14cb9838d2f9c4f41a8ab4f65afb67c2 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:39:52 +0300
Subject: [PATCH 136/212] Step 16.9: Add $state dependency to controller

---
 client/parties/controllers/partiesList.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 4c3255e..f2ed290 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,5 +1,5 @@
-angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '$rootScope',
-  function($scope, $meteor, $rootScope){
+angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '$rootScope', '$state',
+  function($scope, $meteor, $rootScope, $state){
 
     $scope.page = 1;
     $scope.perPage = 3;
-- 
2.3.2 (Apple Git-55)


From e3dd3dd6c26192a6e824e40e0db22e12d566fdcc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:08:21 +0300
Subject: [PATCH 137/212] Step 17.1: Add main CSS file

---
 client/styles/main.css | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 client/styles/main.css

diff --git a/client/styles/main.css b/client/styles/main.css
new file mode 100644
index 0000000..4397047
--- /dev/null
+++ b/client/styles/main.css
@@ -0,0 +1,3 @@
+body {
+    background-color: rgba(0,0,0,.04);
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From f46760ca6275a4537c68e93195fcd18cf49840f1 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:27:28 +0300
Subject: [PATCH 138/212] Step 17.2: Add the twbs:bootstrap package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 2780df8..7974098 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -27,3 +27,4 @@ angularutils:pagination
 tmeasday:publish-counts
 email
 angularui:angular-google-maps
+twbs:bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index 92307e4..06df8f6 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -87,6 +87,7 @@ templating@1.1.3
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
 tracker@1.0.8
+twbs:bootstrap@3.3.5
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
-- 
2.3.2 (Apple Git-55)


From 3747f5304c651d827f6d5a93d5f33c20c9799089 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:09:03 +0300
Subject: [PATCH 139/212] Step 17.3: Add navbar and style to the login button

---
 client/index.html | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)

diff --git a/client/index.html b/client/index.html
index b42b266..ceefe3a 100644
--- a/client/index.html
+++ b/client/index.html
@@ -4,11 +4,17 @@
 <body>
 
 <div>
-  <blaze-template name="loginButtons"></blaze-template>
-  <h1>
-    <a href="/parties">Home</a>
-  </h1>
-  <div ui-view></div>
+  <header class="navbar navbar-fixed-top">
+    <div class="container-fluid">
+      <div class="navbar-header">
+        <h1>
+          <a href="/parties">Home</a>
+        </h1>
+      </div>
+      <blaze-template name="loginButtons"></blaze-template>
+    </div>
+  </header>
+  <div ui-view class="container-fluid"></div>
 </div>
 
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 882d84fde2b84e29376752ae3f74a34d5cba7341 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:48:29 +0300
Subject: [PATCH 140/212] Step 17.4: Add the less package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 7974098..445c0dc 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -28,3 +28,4 @@ tmeasday:publish-counts
 email
 angularui:angular-google-maps
 twbs:bootstrap
+less
-- 
2.3.2 (Apple Git-55)


From b0f130a994e74ee472d4941b2486d2f046e096a5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:09:43 +0300
Subject: [PATCH 141/212] Step 17.5: Basic usage of LESS

---
 client/styles/main.css  | 3 ---
 client/styles/main.less | 8 ++++++++
 2 files changed, 8 insertions(+), 3 deletions(-)
 delete mode 100644 client/styles/main.css
 create mode 100644 client/styles/main.less

diff --git a/client/styles/main.css b/client/styles/main.css
deleted file mode 100644
index 4397047..0000000
--- a/client/styles/main.css
+++ /dev/null
@@ -1,3 +0,0 @@
-body {
-    background-color: rgba(0,0,0,.04);
-}
\ No newline at end of file
diff --git a/client/styles/main.less b/client/styles/main.less
new file mode 100644
index 0000000..6acada4
--- /dev/null
+++ b/client/styles/main.less
@@ -0,0 +1,8 @@
+body {
+    background-color: rgba(0,0,0,.2);
+    padding-top: 70px;
+
+    .navbar {
+        background-color: #ffffff;
+    }
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b6f3e16cca056ec119a9aa4af6c9e557029d1dcb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:10:22 +0300
Subject: [PATCH 142/212] Step 17.6: Change the name of parties css

---
 client/parties/styles/parties.css         | 4 ----
 client/parties/styles/parties.import.less | 4 ++++
 2 files changed, 4 insertions(+), 4 deletions(-)
 delete mode 100644 client/parties/styles/parties.css
 create mode 100644 client/parties/styles/parties.import.less

diff --git a/client/parties/styles/parties.css b/client/parties/styles/parties.css
deleted file mode 100644
index 219ff39..0000000
--- a/client/parties/styles/parties.css
+++ /dev/null
@@ -1,4 +0,0 @@
-.angular-google-map-container {
-    height: 400px;
-    width: 400px;
-}
\ No newline at end of file
diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
new file mode 100644
index 0000000..219ff39
--- /dev/null
+++ b/client/parties/styles/parties.import.less
@@ -0,0 +1,4 @@
+.angular-google-map-container {
+    height: 400px;
+    width: 400px;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6d896d8ed54bb02088aecae75cc4f7910f505742 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:10:50 +0300
Subject: [PATCH 143/212] Step 17.7: Add import to parties LESS file

---
 client/styles/main.less | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/styles/main.less b/client/styles/main.less
index 6acada4..87c5240 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -5,4 +5,7 @@ body {
     .navbar {
         background-color: #ffffff;
     }
-}
\ No newline at end of file
+}
+
+
+@import "../parties/styles/parties.import.less";
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 03099d109170ffdd07e80e2d02ff44621f666903 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:55:47 +0300
Subject: [PATCH 144/212] Step 17.8: Add the angularui:angular-ui-bootstrap
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 445c0dc..05ab64a 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -29,3 +29,4 @@ email
 angularui:angular-google-maps
 twbs:bootstrap
 less
+angularui:angular-ui-bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index 06df8f6..3f033df 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -8,6 +8,7 @@ accounts-ui-unstyled@1.1.8
 angular@1.0.0-rc.11
 angular:angular@1.4.6
 angularui:angular-google-maps@2.2.1
+angularui:angular-ui-bootstrap@0.13.0
 angularui:angular-ui-router@0.2.15
 angularutils:pagination@0.7.0
 autoupdate@1.2.3
-- 
2.3.2 (Apple Git-55)


From 49bacb032771ca7ac2fbe6c309c51cca0c8d23fc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:45:31 +0300
Subject: [PATCH 145/212] Step 17.9: Update the index.html style and tags

---
 client/index.html | 25 ++++++++++++++-----------
 1 file changed, 14 insertions(+), 11 deletions(-)

diff --git a/client/index.html b/client/index.html
index ceefe3a..4ac712e 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,20 +1,23 @@
 <head>
+  <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
+  <link href='http://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
+  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
 </head>
 <body>
 
-<div>
-  <header class="navbar navbar-fixed-top">
-    <div class="container-fluid">
-      <div class="navbar-header">
-        <h1>
-          <a href="/parties">Home</a>
-        </h1>
-      </div>
+<nav class="navbar navbar-default navbar-fixed-top">
+  <div class="container">
+    <div class="navbar-header">
+      <a class="navbar-brand" href="/">socially</a>
+    </div>
+    <div class="navbar-right-container">
       <blaze-template name="loginButtons"></blaze-template>
     </div>
-  </header>
-  <div ui-view class="container-fluid"></div>
-</div>
+  </div>
+</nav>
 
+<div class="h100">
+  <div ui-view class="ma-main-container container-fluid h100"></div>
+</div>
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 53a4f7a927be04cc7902b48b70fabd5d80589fd1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:47:43 +0300
Subject: [PATCH 146/212] Step 17.10: Add dependency for ui-bootstrap

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 980e7c3..c970d99 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -2,7 +2,8 @@ angular.module('socially',[
   'angular-meteor',
   'ui.router',
   'angularUtils.directives.dirPagination',
-  'uiGmapgoogle-maps'
+  'uiGmapgoogle-maps',
+  'ui.bootstrap'
 ]);
 function onReady() {
   angular.bootstrap(document, ['socially']);
-- 
2.3.2 (Apple Git-55)


From df577897d34240e7d63fe010a3b199e40f6ced00 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:49:19 +0300
Subject: [PATCH 147/212] Step 17.11: Move the logic of add new party to
 separated controller

---
 client/parties/controllers/addNewParty.js | 10 ++++++++++
 1 file changed, 10 insertions(+)
 create mode 100644 client/parties/controllers/addNewParty.js

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
new file mode 100644
index 0000000..f2d0d1a
--- /dev/null
+++ b/client/parties/controllers/addNewParty.js
@@ -0,0 +1,10 @@
+angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$modalInstance', 'parties',
+  function ($scope, $meteor, $rootScope, $state, $modalInstance, parties) {
+
+    $scope.addNewParty = function () {
+      $scope.newParty.owner = $rootScope.currentUser._id;
+      parties.push($scope.newParty);
+      $scope.newParty = '';
+      $modalInstance.close();
+    }
+  }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 70011d900e738cfddbf6a38c2136fca8b1b45a4f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:57:13 +0300
Subject: [PATCH 148/212] Step 17.12: Create the view of new party modal

---
 client/parties/views/add-new-party-modal.ng.html | 24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 client/parties/views/add-new-party-modal.ng.html

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
new file mode 100644
index 0000000..5fd3485
--- /dev/null
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -0,0 +1,24 @@
+<div class="container-fluid ma-add-new-party-container">
+  <div class="alert alert-info" ng-hide="$root.currentUser || $root.loggingIn">
+    Please log in to create a party!
+  </div>
+
+  <form ng-show="$root.currentUser || $root.loggingIn">
+    <h2>Create a new party</h2>
+
+    <div class="form-group">
+      <label for="nameInput">Name</label>
+      <input ng-model="newParty.name" id="nameInput" type="text" class="form-control">
+    </div>
+    <div class="form-group">
+      <label for="description">Description</label>
+      <input ng-model="newParty.description" id="description" type="text" class="form-control">
+    </div>
+    <div class="form-group">
+      <label for="public">
+        <input type="checkbox" ng-model="newParty.public" id="public"> Public
+      </label>
+    </div>
+    <button ng-click="addNewParty()" class="btn">Add</button>
+  </form>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 288ba1ce72cd341837ccf2339b341a59d2910c12 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:58:55 +0300
Subject: [PATCH 149/212] Step 17.13: Update the parties list HTML

---
 client/parties/views/parties-list.ng.html | 175 +++++++++++++++++++-----------
 1 file changed, 110 insertions(+), 65 deletions(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index e0e9d47..c66ae56 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -1,73 +1,118 @@
-<form ng-show="$root.currentUser">
-  <label>Name</label>
-  <input ng-model="newParty.name">
-  <label>Description</label>
-  <input ng-model="newParty.description">
-  <label>Public</label>
-  <input type="checkbox" ng-model="newParty.public">
-  <button ng-click="newParty.owner=$root.currentUser._id; parties.push(newParty)">Add</button>
-  <button ng-click="removeAll()">Remove All</button>
-</form>
-<div ng-hide="$root.currentUser || $root.loggingIn">
-  Log in to create a party!
-</div>
-<ul>
-  <h1>Parties:</h1>
-  <div>
-    <input type="search" ng-model="search" placeholder="Search">
-    <select ng-model="orderProperty">
-      <option value="1">Ascending</option>
-      <option value="-1">Descending</option>
-    </select>
-  </div>
-  <div class="angular-google-map-container">
-    <ui-gmap-google-map center="party.location || map.center" zoom="map.zoom">
-      <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
-                       fit="true" idkey="'_id'" doRebuildAll="true">
-      </ui-gmap-markers>
-    </ui-gmap-google-map>
-  </div>
-  <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
-    <a href="/parties/{{party._id}}">{{party.name}}</a>
-    <p>{{party.description}}</p>
-    <button ng-click="remove(party)" ng-show="$root.currentUser && $root.currentUser._id == party.owner">X</button>
-
-    <div ng-show="$root.currentUser">
-      <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
-      <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
-      <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
-    </div>
-    <div ng-hide="$root.currentUser">
-      <i>Sign in to RSVP for this party.</i>
-    </div>
+<div class="row h100">
+  <div class="col-md-6 ma-parties-col">
+    <div class="row">
+      <div class="col-xs-8">
+        <form class="form-inline search-form">
+          <div class="form-group">
+            <label class="sr-only" for="search">Search</label>
 
-    <div>
-      Who is coming:
-      Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
-      Maybe - {{ (party.rsvps | filter:{rsvp:'maybe'}).length }}
-      No - {{ (party.rsvps | filter:{rsvp:'no'}).length }}
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'yes'}">
-        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
-      </div>
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'maybe'}">
-        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+            <div class="input-group">
+              <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div>
+              <input type="text" ng-model="search" placeholder="Search" id="search" class="form-control">
+            </div>
+          </div>
+          <div class="form-group">
+            <label class="sr-only" for="sort-order">Sort Order</label>
+            <select ng-model="orderProperty" class="form-control">
+              <option value="1">Ascending</option>
+              <option value="-1">Descending</option>
+            </select>
+          </div>
+        </form>
       </div>
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'no'}">
-        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      <div class="col-xs-4 ma-add-button-container">
+        <button class="btn" ng-click="openAddNewPartyModal()"><i class="fa fa-plus"></i></button>
       </div>
     </div>
+    <ul class="list-group">
+      <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count"
+          class="list-group-item ma-party-item">
+
+        <i ng-click="remove(party)" class="ma-remove fa fa-times"
+           ng-show="$root.currentUser && $root.currentUser._id == party.owner"></i>
+
+
+        <div class="row">
+          <div class="col-sm-8">
+            <h2 class="ma-party-name"><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
+
+            <p class="ma-party-description">{{party.description}}</p>
+          </div>
+        </div>
+
+        <div class="row ma-party-item-bottom">
+          <div class="col-sm-8 ma-posted-by-col">
+            <span class="ma-posted-by">Posted by {{ creator(party) | displayName }}  </span>
+
+            <span ng-if="party.public" class="ma-everyone-invited"><i class="fa fa-male"></i> Everyone is invited</span>
+
+                        <span ng-if="!party.public" class="ma-everyone-invited">
+                             <i class="fa fa-user-secret"></i>  This is a private event
+                        </span>
+
+            <div ng-show="$root.currentUser" class="ma-rsvp-buttons">
+              <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')" class="btn"
+                     ng-class="{'btn-primary' : isRSVP('yes', party)}">
+              <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')" class="btn"
+                     ng-class="{'btn-primary' : isRSVP('maybe', party)}">
+              <input type="button" value="No" ng-click="rsvp(party._id, 'no')" class="btn"
+                     ng-class="{'btn-primary' : isRSVP('no', party)}">
+            </div>
+            <div ng-hide="$root.currentUser">
+              <i>Sign in to RSVP for this party.</i>
+            </div>
+
+
+          </div>
+          <div class="col-sm-4">
+            <div class="ma-rsvp-sum">
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'yes'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  YES
+                </div>
+              </div>
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  MAYBE
+                </div>
+              </div>
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'no'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  NO
+                </div>
+              </div>
+            </div>
+
+            <ul ng-if="!party.public">
+              <li ng-repeat="invitedUser in outstandingInvitations(party)">
+                {{ invitedUser | displayName }}
+              </li>
+            </ul>
+
+          </div>
+        </div>
 
-    <ul ng-if="!party.public">
-      Users who not responded:
-      <li ng-repeat="invitedUser in outstandingInvitations(party)">
-        {{dstache}} invitedUser | displayName }}
       </li>
     </ul>
-    <div ng-if="party.public">
-      Everyone is invited
-    </div>
+    <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
 
-    <p><small>Posted by {{ creator(party) | displayName }}</small></p>
-  </li>
-</ul>
-<dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
+  </div>
+  <div class="col-md-6 h100 ma-angular-map-col">
+    <div class="angular-google-map-container h100">
+      <ui-gmap-google-map center="map.center" zoom="map.zoom" options="map.options">
+        <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
+                         fit="true" idkey="'_id'" doRebuildAll="true">
+        </ui-gmap-markers>
+      </ui-gmap-google-map>
+    </div>
+  </div>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 61c4ed4afff2af910808aaf95f09e3c8b912e0c6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:59:12 +0300
Subject: [PATCH 150/212] Step 17.14: Update the logic of the parties list

---
 client/parties/controllers/partiesList.js | 93 ++++++++++++++++++++++++++++++-
 1 file changed, 90 insertions(+), 3 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index f2ed290..b1da50c 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,5 +1,5 @@
-angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '$rootScope', '$state',
-  function($scope, $meteor, $rootScope, $state){
+angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$modal',
+  function($scope, $meteor, $rootScope, $state, $modal){
 
     $scope.page = 1;
     $scope.perPage = 3;
@@ -28,14 +28,73 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '
           };
         });
 
+        var styles1 = [{
+          "featureType": "landscape.natural",
+          "elementType": "geometry.fill",
+          "stylers": [{"visibility": "on"}, {"color": "#e0efef"}]
+        }, {
+          "featureType": "poi",
+          "elementType": "geometry.fill",
+          "stylers": [{"visibility": "on"}, {"hue": "#1900ff"}, {"color": "#c0e8e8"}]
+        }, {
+          "featureType": "road",
+          "elementType": "geometry",
+          "stylers": [{"lightness": 100}, {"visibility": "simplified"}]
+        }, {
+          "featureType": "road",
+          "elementType": "labels",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "transit.line",
+          "elementType": "geometry",
+          "stylers": [{"visibility": "on"}, {"lightness": 700}]
+        }, {"featureType": "water", "elementType": "all", "stylers": [{"color": "#7dcdcd"}]}];
+        var styles2 = [{
+          "featureType": "administrative",
+          "elementType": "labels.text.fill",
+          "stylers": [{"color": "#444444"}]
+        }, {
+          "featureType": "landscape",
+          "elementType": "all",
+          "stylers": [{"color": "#f2f2f2"}]
+        }, {
+          "featureType": "poi",
+          "elementType": "all",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "road",
+          "elementType": "all",
+          "stylers": [{"saturation": -100}, {"lightness": 45}]
+        }, {
+          "featureType": "road.highway",
+          "elementType": "all",
+          "stylers": [{"visibility": "simplified"}]
+        }, {
+          "featureType": "road.arterial",
+          "elementType": "labels.icon",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "transit",
+          "elementType": "all",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "water",
+          "elementType": "all",
+          "stylers": [{"color": "#46bcec"}, {"visibility": "on"}]
+        }];
+
+
         $scope.map = {
           center: {
             latitude: 45,
             longitude: -73
           },
+          options: {
+            styles: styles2,
+            maxZoom: 10
+          },
           zoom: 8
         };
-
       });
     });
 
@@ -92,4 +151,32 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '
 
       return owner;
     };
+
+    $scope.openAddNewPartyModal = function () {
+      var modalInstance = $modal.open({
+        animation: true,
+        templateUrl: 'client/parties/views/add-new-party-modal.ng.html',
+        controller: 'AddNewPartyCtrl',
+        resolve: {
+          parties: function () {
+            return $scope.parties;
+          }
+        }
+      });
+
+      modalInstance.result.then(function () {
+      }, function () {
+      });
+    };
+
+    $scope.isRSVP = function (rsvp, party) {
+      if (!$rootScope.currentUser._id) return false;
+      var rsvpIndex = party.myRsvpIndex;
+      rsvpIndex = rsvpIndex || _.indexOf(_.pluck(party.rsvps, 'user'), $rootScope.currentUser._id);
+
+      if (rsvpIndex !== -1) {
+        party.myRsvpIndex = rsvpIndex;
+        return party.rsvps[rsvpIndex].rsvp === rsvp;
+      }
+    }
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 77616489e3243c6d39b66dc550c48f3ab2c5e875 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 15:03:57 +0300
Subject: [PATCH 151/212] Step 17.15: Create less file for each component and
 update the CSS rules

---
 client/parties/styles/navbar.import.less        |  35 +++++++
 client/parties/styles/new.party.import.less     |  19 ++++
 client/parties/styles/parties.import.less       | 123 +++++++++++++++++++++++-
 client/parties/styles/party.details.import.less |  26 +++++
 4 files changed, 200 insertions(+), 3 deletions(-)
 create mode 100644 client/parties/styles/navbar.import.less
 create mode 100644 client/parties/styles/new.party.import.less
 create mode 100644 client/parties/styles/party.details.import.less

diff --git a/client/parties/styles/navbar.import.less b/client/parties/styles/navbar.import.less
new file mode 100644
index 0000000..96a6b49
--- /dev/null
+++ b/client/parties/styles/navbar.import.less
@@ -0,0 +1,35 @@
+// Override Bootstrap navbar
+.navbar {
+  background-color: #ffffff;
+  border-bottom: #eee 1px solid;
+  color: @color3;
+  font-family: 'Muli', sans-serif;
+  a {
+    color: @color3;
+    text-decoration: none !important;
+  }
+
+  .navbar-right-container {
+    position: absolute;
+    top: 17px;
+    right: 17px;
+  }
+}
+
+// Overrise Meteor Login Buttons
+#login-dropdown-list.accounts-dialog {
+  right: 14px;
+  left: auto;
+}
+
+#login-buttons .login-button,
+.accounts-dialog .login-button {
+  background: @color3;
+  color: white;
+  border: none;
+
+  &:hover {
+    background: @color3;
+    color: white;
+  }
+}
\ No newline at end of file
diff --git a/client/parties/styles/new.party.import.less b/client/parties/styles/new.party.import.less
new file mode 100644
index 0000000..6c678fe
--- /dev/null
+++ b/client/parties/styles/new.party.import.less
@@ -0,0 +1,19 @@
+.ma-add-new-party-container {
+  padding: 20px;
+  > form {
+    > h2 {
+      font-siz: 15px;
+      margin-bottom: 20px;
+    }
+    button {
+      background: @color3;
+      color: @color5;
+    }
+  }
+
+  .alert.alert-info {
+    background: @color3;
+    color: @color5;
+    margin-bottom: 0;
+  }
+}
\ No newline at end of file
diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 219ff39..e863737 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -1,4 +1,121 @@
-.angular-google-map-container {
-    height: 400px;
-    width: 400px;
+.ma-add-button-container {
+    button.btn {
+        background: @color3;
+        float: right;
+        margin-right: 5px;
+        outline: none;
+        i {
+            color: @color5;
+        }
+    }
+}
+
+.ma-parties-col {
+    padding-top: 20px;
+}
+
+.ma-party-item {
+    .ma-party-name {
+        margin-bottom: 20px;
+        a {
+            color: @color6;
+            text-decoration: none !important;
+            font-weight: 400;
+        }
+    }
+    .ma-party-description {
+        color: @color6;
+        font-weight: 300;
+        padding-left: 18px;
+        font-size: 14px;
+    }
+
+    .ma-remove {
+        color: lighten(@color7, 20%);
+        position: absolute;
+        right: 20px;
+        top: 20px;
+        &:hover {
+            color: @color7;
+        }
+    }
+
+    .ma-party-item-bottom {
+        padding-top: 10px;
+        .ma-posted-by-col {
+            .ma-posted-by {
+                color: darken(@color4, 30%);
+                font-size: 12px;
+            }
+            .ma-everyone-invited {
+                @media (max-width: 400px) {
+                    display: block;
+                    i {
+                        margin-left: 0px !important;
+                    }
+                }
+                font-size: 12px;
+                color: darken(@color4, 10%);
+                i {
+                    color: darken(@color4, 10%);
+                    margin-left: 5px;
+                }
+            }
+        }
+
+        .ma-rsvp-buttons {
+            input.btn {
+                color: darken(@color3, 20%);
+                background: transparent !important;
+                outline: none;
+                padding-left: 0;
+                &:active {
+                    box-shadow: none;
+                }
+                &:hover {
+                    color: darken(@color3, 30%);
+                }
+                &.btn-primary {
+                    color: lighten(@color3, 10%);
+                    border: 0;
+                    background: transparent !important;
+                }
+            }
+        }
+
+        .ma-rsvp-sum {
+            width: 160px;
+            @media (min-width: 400px) {
+                float: right;
+            }
+            @media (max-width: 400px) {
+                margin: 0 auto;
+            }
+        }
+        .ma-rsvp-amount {
+            display: inline-block;
+            text-align: center;
+            width: 50px;
+            .ma-amount {
+                font-weight: bold;
+                font-size: 20px;
+            }
+            .ma-rsvp-title {
+                font-size: 11px;
+                color: #aaa;
+                text-transform: uppercase;
+            }
+        }
+    }
+}
+
+.ma-angular-map-col {
+    .angular-google-map-container, .angular-google-map {
+        height: 100%;
+        width: 100%;
+    }
+}
+
+.search-form {
+    margin-bottom: 1em;
 }
\ No newline at end of file
diff --git a/client/parties/styles/party.details.import.less b/client/parties/styles/party.details.import.less
new file mode 100644
index 0000000..4f19b98
--- /dev/null
+++ b/client/parties/styles/party.details.import.less
@@ -0,0 +1,26 @@
+.ma-party-details-container {
+  padding: 20px;
+  .angular-google-map-container {
+    width: 100%;
+    height: 100%;
+  }
+  .angular-google-map {
+    width: 100%;
+    height: 400px;
+  }
+  .ma-map-title {
+    font-size: 16px;
+    font-weight: bolder;
+  }
+  .ma-invite-list {
+    margin-top: 20px;
+    margin-bottom: 20px;
+    h3 {
+      font-size: 16px;
+      font-weight: bolder;
+    }
+    ul {
+      padding: 0;
+    }
+  }
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5ca34ec9cc7e34695aa66b98e3106548bf8638ae Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 15:04:28 +0300
Subject: [PATCH 152/212] Step 17.16: Update the main less file to use the new
 files

---
 client/styles/main.less | 38 ++++++++++++++++++++++++++++++++------
 1 file changed, 32 insertions(+), 6 deletions(-)

diff --git a/client/styles/main.less b/client/styles/main.less
index 87c5240..e75ad09 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,11 +1,37 @@
+@color1 : #2F2933;
+@color2 : #01A2A6;
+@color3 : #29D9C2;
+@color4 : #BDF271;
+@color5 : #FFFFA6;
+@color6 : #2F2933;
+@color7 : #FF6F69;
+
+html,body{
+    height:100%;
+}
+
 body {
-    background-color: rgba(0,0,0,.2);
-    padding-top: 70px;
+    background-color: #f8f8f8;
+    padding-top: 50px;
+    font-family: 'Muli', sans-serif;
+}
 
-    .navbar {
-        background-color: #ffffff;
-    }
+.h100{
+    height : 100%;
 }
 
+.w100{
+    width:100%;
+}
+
+
+.ma-main-container{
+    @media (min-width: 400px) {
+        padding-right : 0;
+    }
+}
 
-@import "../parties/styles/parties.import.less";
\ No newline at end of file
+@import "../parties/styles/parties.import.less";
+@import "../parties/styles/navbar.import.less";
+@import "../parties/styles/new.party.import.less";
+@import "../parties/styles/party.details.import.less";
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 44986ded2cb0b52c0e1cb12cc0e19bfd4ab1f6b7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 15:05:35 +0300
Subject: [PATCH 153/212] Step 17.17: Update the view of party details page

---
 client/parties/views/party-details.ng.html | 72 +++++++++++++++++++++---------
 1 file changed, 50 insertions(+), 22 deletions(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 7ef1f8d..104a657 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -1,26 +1,54 @@
-Here you will see and change the details of the party:
+<div class="row ma-party-details-container">
+  <div class="col-sm-6 col-sm-offset-3">
+    <legend>
+      View and Edit Your Party Details:
+    </legend>
+    <form class="form-horizontal">
+      <div class="form-group">
+        <label>Party Name</label>
+        <input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id" type="text"
+               class="form-control">
+      </div>
+      <div class="form-group">
+        <label>Party Name</label>
+        <input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id" type="text"
+               class="form-control">
+      </div>
+      <div class="form-group">
+        <label>Is public</label>
+        <input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
+      </div>
+    </form>
 
-<input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id">
-<input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id">
-<label>Is public</label>
-<input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
+    <div class="ma-invite-list" ng-show="canInvite()">
+      <h3>
+        Users to invite:
+      </h3>
+      <ul>
 
-<ul ng-show="canInvite()">
-  Users to invite:
-  <li ng-repeat="user in users | uninvited:party">
-    <div>{{ user | displayName }}</div>
-    <button ng-click="invite(user)">Invite</button>
-  </li>
-  <li ng-if="(users | uninvited:party).length <= 0">
-    Everyone are already invited.
-  </li>
-</ul>
+        <li ng-repeat="user in users | uninvited:party">
+          <div>{{ user | displayName }}</div>
+          <button ng-click="invite(user)">Invite</button>
+        </li>
+        <li ng-if="(users | uninvited:party).length <= 0">
+          Everyone are already invited.
+        </li>
+      </ul>
+    </div>
+
+
+    <h3 class="ma-map-title">
+      Click the map to set the party location
+    </h3>
+
+    <div class="angular-google-map-container">
+      <ui-gmap-google-map center="party.location || map.center" 
+                          events="map.events" zoom="map.zoom">
+        <ui-gmap-marker coords="party.location" options="map.marker.options" 
+                        events="map.marker.events" idkey="party._id">
+        </ui-gmap-marker>
+      </ui-gmap-google-map>
+    </div>
+  </div>
 
-<div class="angular-google-map-container">
-  <ui-gmap-google-map center="party.location || map.center"
-                      events="map.events" zoom="map.zoom">
-    <ui-gmap-marker coords="party.location" options="map.marker.options"
-                    events="map.marker.events" idkey="party._id">
-    </ui-gmap-marker>
-  </ui-gmap-google-map>
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5979f207e5d186f11bf3e4c24b0c9c2bdc05dcbc Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:17:21 +0300
Subject: [PATCH 154/212] Step 18.1: Remove the twbs:bootstrap package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 05ab64a..586c573 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -27,6 +27,5 @@ angularutils:pagination
 tmeasday:publish-counts
 email
 angularui:angular-google-maps
-twbs:bootstrap
 less
 angularui:angular-ui-bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index 3f033df..c9c8d8b 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -88,7 +88,6 @@ templating@1.1.3
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
 tracker@1.0.8
-twbs:bootstrap@3.3.5
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
-- 
2.3.2 (Apple Git-55)


From 576bcc337d51060ee31ace4c0f3e48b45bc1f184 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:20:39 +0300
Subject: [PATCH 155/212] Step 18.2: Add the angular:angular-material package

---
 .meteor/packages | 1 +
 .meteor/versions | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 586c573..36e41b8 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -29,3 +29,4 @@ email
 angularui:angular-google-maps
 less
 angularui:angular-ui-bootstrap
+angular:angular-material
diff --git a/.meteor/versions b/.meteor/versions
index c9c8d8b..f186ec7 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -7,6 +7,9 @@ accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
 angular@1.0.0-rc.11
 angular:angular@1.4.6
+angular:angular-animate@1.4.6
+angular:angular-aria@1.4.6
+angular:angular-material@0.11.0
 angularui:angular-google-maps@2.2.1
 angularui:angular-ui-bootstrap@0.13.0
 angularui:angular-ui-router@0.2.15
-- 
2.3.2 (Apple Git-55)


From 6bb506638ca620b945b3805b7043f66e1a1f183d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Tue, 18 Aug 2015 16:38:35 +0300
Subject: [PATCH 156/212] Step 18.3: Add the ngMaterial dependency

---
 client/lib/app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index c970d99..d4e8b68 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -3,7 +3,7 @@ angular.module('socially',[
   'ui.router',
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
-  'ui.bootstrap'
+  'ngMaterial'
 ]);
 function onReady() {
   angular.bootstrap(document, ['socially']);
-- 
2.3.2 (Apple Git-55)


From 85a78d75299b9bc52d415a46268f8e49f829abae Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:34:04 +0300
Subject: [PATCH 157/212] Step 18.4: Remove $modal and use $mdDialog instead

---
 client/parties/controllers/partiesList.js | 23 ++++++++++++-----------
 1 file changed, 12 insertions(+), 11 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index b1da50c..686706f 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,5 +1,5 @@
-angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$modal',
-  function($scope, $meteor, $rootScope, $state, $modal){
+angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog',
+  function($scope, $meteor, $rootScope, $state, $mdDialog){
 
     $scope.page = 1;
     $scope.perPage = 3;
@@ -152,21 +152,22 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '
       return owner;
     };
 
-    $scope.openAddNewPartyModal = function () {
-      var modalInstance = $modal.open({
-        animation: true,
-        templateUrl: 'client/parties/views/add-new-party-modal.ng.html',
+    $scope.openAddNewPartyModal = function(){
+      $mdDialog.show({
         controller: 'AddNewPartyCtrl',
+        templateUrl: 'client/parties/views/add-new-party-modal.ng.html',
+        clickOutsideToClose:true,
         resolve: {
           parties: function () {
             return $scope.parties;
           }
         }
-      });
-
-      modalInstance.result.then(function () {
-      }, function () {
-      });
+      })
+        .then(function(answer) {
+          $scope.status = 'You said the information was "' + answer + '".';
+        }, function() {
+          $scope.status = 'You cancelled the dialog.';
+        });
     };
 
     $scope.isRSVP = function (rsvp, party) {
-- 
2.3.2 (Apple Git-55)


From af556a998967f90000e38312ff19e5f3993b87aa Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:34:26 +0300
Subject: [PATCH 158/212] Step 18.5: Update usage in the modal controller

---
 client/parties/controllers/addNewParty.js | 19 ++++++++++++-------
 1 file changed, 12 insertions(+), 7 deletions(-)

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
index f2d0d1a..af25c36 100644
--- a/client/parties/controllers/addNewParty.js
+++ b/client/parties/controllers/addNewParty.js
@@ -1,10 +1,15 @@
-angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$modalInstance', 'parties',
-  function ($scope, $meteor, $rootScope, $state, $modalInstance, parties) {
-
+angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog', 'parties',
+  function ($scope, $meteor, $rootScope, $state, $mdDialog, parties) {
+    $scope.newParty = {};
     $scope.addNewParty = function () {
-      $scope.newParty.owner = $rootScope.currentUser._id;
-      parties.push($scope.newParty);
-      $scope.newParty = '';
-      $modalInstance.close();
+      if($scope.newParty.name){
+        $scope.newParty.owner = $rootScope.currentUser._id;
+        parties.push($scope.newParty);
+        $scope.newParty = '';
+        $mdDialog.hide();
+      }
+    }
+    $scope.close = function () {
+      $mdDialog.hide();
     }
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 57c6619f1b07d44ab23d5406dd6a4924ad76f0b3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:46:47 +0300
Subject: [PATCH 159/212] Step 18.6: Update the LESS files to match
 angular-material

---
 client/parties/styles/navbar.import.less        |  36 +-----
 client/parties/styles/new.party.import.less     |  19 ---
 client/parties/styles/parties.import.less       | 151 ++++++++----------------
 client/parties/styles/party.details.import.less |  28 +----
 client/styles/main.less                         |  35 +-----
 5 files changed, 55 insertions(+), 214 deletions(-)
 delete mode 100644 client/parties/styles/new.party.import.less

diff --git a/client/parties/styles/navbar.import.less b/client/parties/styles/navbar.import.less
index 96a6b49..f42291d 100644
--- a/client/parties/styles/navbar.import.less
+++ b/client/parties/styles/navbar.import.less
@@ -1,35 +1,5 @@
-// Override Bootstrap navbar
-.navbar {
-  background-color: #ffffff;
-  border-bottom: #eee 1px solid;
-  color: @color3;
-  font-family: 'Muli', sans-serif;
-  a {
-    color: @color3;
-    text-decoration: none !important;
-  }
-
-  .navbar-right-container {
-    position: absolute;
-    top: 17px;
-    right: 17px;
-  }
-}
-
-// Overrise Meteor Login Buttons
-#login-dropdown-list.accounts-dialog {
-  right: 14px;
-  left: auto;
-}
-
-#login-buttons .login-button,
-.accounts-dialog .login-button {
-  background: @color3;
-  color: white;
-  border: none;
-
-  &:hover {
-    background: @color3;
-    color: white;
+md-toolbar {
+  h2{
+    margin : 0;
   }
 }
\ No newline at end of file
diff --git a/client/parties/styles/new.party.import.less b/client/parties/styles/new.party.import.less
deleted file mode 100644
index 6c678fe..0000000
--- a/client/parties/styles/new.party.import.less
+++ /dev/null
@@ -1,19 +0,0 @@
-.ma-add-new-party-container {
-  padding: 20px;
-  > form {
-    > h2 {
-      font-siz: 15px;
-      margin-bottom: 20px;
-    }
-    button {
-      background: @color3;
-      color: @color5;
-    }
-  }
-
-  .alert.alert-info {
-    background: @color3;
-    color: @color5;
-    margin-bottom: 0;
-  }
-}
\ No newline at end of file
diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index e863737..0f7beb6 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -1,121 +1,62 @@
-.ma-add-button-container {
-    button.btn {
-        background: @color3;
-        float: right;
-        margin-right: 5px;
-        outline: none;
-        i {
-            color: @color5;
-        }
-    }
+
+.navbar-text {
+    margin-right: 0;
 }
 
-.ma-parties-col {
-    padding-top: 20px;
+#login-dropdown-list.accounts-dialog {
+    right: 14px;
+    left: auto;
 }
 
-.ma-party-item {
-    .ma-party-name {
-        margin-bottom: 20px;
-        a {
-            color: @color6;
-            text-decoration: none !important;
-            font-weight: 400;
-        }
-    }
-    .ma-party-description {
-        color: @color6;
-        font-weight: 300;
-        padding-left: 18px;
-        font-size: 14px;
+.search-form {
+    margin-bottom: 1em;
+}
+
+.ma-parties-list{
+    .angular-google-map{
+        box-sizing: border-box;
+        -webkit-flex: 1;
+        -ms-flex: 1;
+        flex: 1;
+        -webkit-flex-direction: row;
+        -ms-flex-direction: row;
+        flex-direction: row;
+        box-sizing: border-box;
+        display: -webkit-flex;
+        display: -moz-flex;
+        display: -ms-flexbox;
+        display: flex;
     }
 
-    .ma-remove {
-        color: lighten(@color7, 20%);
-        position: absolute;
-        right: 20px;
-        top: 20px;
-        &:hover {
-            color: @color7;
-        }
+    .angular-google-map-container{
+        box-sizing: border-box;
+        -webkit-flex: 1;
+        -ms-flex: 1;
+        flex: 1;
     }
 
-    .ma-party-item-bottom {
-        padding-top: 10px;
-        .ma-posted-by-col {
-            .ma-posted-by {
-                color: darken(@color4, 30%);
-                font-size: 12px;
-            }
-            .ma-everyone-invited {
-                @media (max-width: 400px) {
-                    display: block;
-                    i {
-                        margin-left: 0px !important;
-                    }
-                }
-                font-size: 12px;
-                color: darken(@color4, 10%);
-                i {
-                    color: darken(@color4, 10%);
-                    margin-left: 5px;
-                }
-            }
+    .rsvps-sum{
+        float:left;
+        width:50px;
+        text-align: center;
+        .rsvps-amount{
+            font-size:24px;
         }
-
-        .ma-rsvp-buttons {
-            input.btn {
-                color: darken(@color3, 20%);
-                background: transparent !important;
-                outline: none;
-                padding-left: 0;
-                &:active {
-                    box-shadow: none;
-                }
-                &:hover {
-                    color: darken(@color3, 30%);
-                }
-                &.btn-primary {
-                    color: lighten(@color3, 10%);
-                    border: 0;
-                    background: transparent !important;
-                }
-            }
+        .rsvps-title{
+            font-size:13px;
+            color:#aaa;
         }
+    }
 
-        .ma-rsvp-sum {
-            width: 160px;
-            @media (min-width: 400px) {
-                float: right;
-            }
-            @media (max-width: 400px) {
-                margin: 0 auto;
+    .ma-party{
+        .ma-name{
+            a{
+                text-decoration: none;
+                color : #333;
             }
         }
-        .ma-rsvp-amount {
-            display: inline-block;
-            text-align: center;
-            width: 50px;
-            .ma-amount {
-                font-weight: bold;
-                font-size: 20px;
-            }
-            .ma-rsvp-title {
-                font-size: 11px;
-                color: #aaa;
-                text-transform: uppercase;
-            }
-        }
-    }
-}
+        .ma-description{
 
-.ma-angular-map-col {
-    .angular-google-map-container, .angular-google-map {
-        height: 100%;
-        width: 100%;
+        }
     }
-}
-
-.search-form {
-    margin-bottom: 1em;
 }
\ No newline at end of file
diff --git a/client/parties/styles/party.details.import.less b/client/parties/styles/party.details.import.less
index 4f19b98..6011e87 100644
--- a/client/parties/styles/party.details.import.less
+++ b/client/parties/styles/party.details.import.less
@@ -1,26 +1,6 @@
-.ma-party-details-container {
-  padding: 20px;
-  .angular-google-map-container {
-    width: 100%;
-    height: 100%;
-  }
-  .angular-google-map {
-    width: 100%;
-    height: 400px;
-  }
-  .ma-map-title {
-    font-size: 16px;
-    font-weight: bolder;
-  }
-  .ma-invite-list {
-    margin-top: 20px;
-    margin-bottom: 20px;
-    h3 {
-      font-size: 16px;
-      font-weight: bolder;
-    }
-    ul {
-      padding: 0;
-    }
+.ma-party-details{
+  .angular-google-map-container, .angular-google-map{
+    width:100%;
+    height:400px;
   }
 }
\ No newline at end of file
diff --git a/client/styles/main.less b/client/styles/main.less
index e75ad09..438dc59 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,37 +1,6 @@
-@color1 : #2F2933;
-@color2 : #01A2A6;
-@color3 : #29D9C2;
-@color4 : #BDF271;
-@color5 : #FFFFA6;
-@color6 : #2F2933;
-@color7 : #FF6F69;
-
-html,body{
-    height:100%;
-}
-
-body {
-    background-color: #f8f8f8;
-    padding-top: 50px;
-    font-family: 'Muli', sans-serif;
-}
-
-.h100{
-    height : 100%;
-}
-
-.w100{
-    width:100%;
-}
-
-
-.ma-main-container{
-    @media (min-width: 400px) {
-        padding-right : 0;
-    }
+html, body {
 }
 
 @import "../parties/styles/parties.import.less";
+@import "../parties/styles/party.details.import.less";
 @import "../parties/styles/navbar.import.less";
-@import "../parties/styles/new.party.import.less";
-@import "../parties/styles/party.details.import.less";
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6283db972963084146d5fdd5a72224445b07cd98 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:49:04 +0300
Subject: [PATCH 160/212] Step 18.7: Update the index.html to use
 angular-material

---
 client/index.html | 28 +++++++++++-----------------
 1 file changed, 11 insertions(+), 17 deletions(-)

diff --git a/client/index.html b/client/index.html
index 4ac712e..a5d537e 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,23 +1,17 @@
 <head>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
-  <link href='http://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
-  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
+  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
 </head>
-<body>
-
-<nav class="navbar navbar-default navbar-fixed-top">
-  <div class="container">
-    <div class="navbar-header">
-      <a class="navbar-brand" href="/">socially</a>
-    </div>
-    <div class="navbar-right-container">
-      <blaze-template name="loginButtons"></blaze-template>
-    </div>
+<body layout="column">
+<md-toolbar md-scroll-shrink layout="row" layout-align="start center" layout-padding>
+  <h2>
+    <a ui-sref="parties"><span class="md-title">Socially</span></a>
+  </h2>
+  <span flex></span>
+  <div class="navbar-right navbar-text">
+    <blaze-template name="loginButtons"></blaze-template>
   </div>
-</nav>
-
-<div class="h100">
-  <div ui-view class="ma-main-container container-fluid h100"></div>
-</div>
+</md-toolbar>
+<div ui-view flex-gt-sm layout-gt-sm="row"></div>
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e640305bc7d55f44d786d66a6138d0e5bcc090db Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:51:31 +0300
Subject: [PATCH 161/212] Step 18.8: Update parties list to use material's
 directives

---
 client/parties/views/parties-list.ng.html | 163 +++++++++++-------------------
 1 file changed, 60 insertions(+), 103 deletions(-)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index c66ae56..a389551 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -1,118 +1,75 @@
-<div class="row h100">
-  <div class="col-md-6 ma-parties-col">
-    <div class="row">
-      <div class="col-xs-8">
-        <form class="form-inline search-form">
-          <div class="form-group">
-            <label class="sr-only" for="search">Search</label>
-
-            <div class="input-group">
-              <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div>
-              <input type="text" ng-model="search" placeholder="Search" id="search" class="form-control">
-            </div>
-          </div>
-          <div class="form-group">
-            <label class="sr-only" for="sort-order">Sort Order</label>
-            <select ng-model="orderProperty" class="form-control">
-              <option value="1">Ascending</option>
-              <option value="-1">Descending</option>
-            </select>
-          </div>
-        </form>
-      </div>
-      <div class="col-xs-4 ma-add-button-container">
-        <button class="btn" ng-click="openAddNewPartyModal()"><i class="fa fa-plus"></i></button>
-      </div>
-    </div>
-    <ul class="list-group">
-      <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count"
-          class="list-group-item ma-party-item">
-
-        <i ng-click="remove(party)" class="ma-remove fa fa-times"
-           ng-show="$root.currentUser && $root.currentUser._id == party.owner"></i>
-
-
-        <div class="row">
-          <div class="col-sm-8">
-            <h2 class="ma-party-name"><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
-
-            <p class="ma-party-description">{{party.description}}</p>
-          </div>
+<md-content flex-gt-sm layout-gt-sm="row" class="ma-parties-list">
+  <div layout-gt-sm="row" flex-gt-sm>
+    <div flex-gt-sm="50" flex-sm>
+      <div>
+        <div layout-padding layout="row">
+          <md-input-container style="width:50%;margin-right:10px;">
+            <label>Search</label>
+            <input type="text" ng-model="search"/>
+          </md-input-container>
+          <md-select ng-model="orderProperty" placeholder="Sort Order" >
+            <md-option value="1">Ascending</md-option>
+            <md-option value="-1">Descending</md-option>
+          </md-select>
+          <md-button class="md-fab" aria-label="Eat cake" ng-click="openAddNewPartyModal()">
+            <md-icon md-font-set="material-icons"> add </md-icon>
+          </md-button>
         </div>
+      </div>
+      <md-content class="md-padding" style="padding-top:0;">
+        <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
+        <div  dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count" class="ma-party">
+          <md-card>
+            <md-card-content>
+              <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
+              <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
 
-        <div class="row ma-party-item-bottom">
-          <div class="col-sm-8 ma-posted-by-col">
-            <span class="ma-posted-by">Posted by {{ creator(party) | displayName }}  </span>
-
-            <span ng-if="party.public" class="ma-everyone-invited"><i class="fa fa-male"></i> Everyone is invited</span>
-
-                        <span ng-if="!party.public" class="ma-everyone-invited">
-                             <i class="fa fa-user-secret"></i>  This is a private event
-                        </span>
-
-            <div ng-show="$root.currentUser" class="ma-rsvp-buttons">
-              <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')" class="btn"
-                     ng-class="{'btn-primary' : isRSVP('yes', party)}">
-              <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')" class="btn"
-                     ng-class="{'btn-primary' : isRSVP('maybe', party)}">
-              <input type="button" value="No" ng-click="rsvp(party._id, 'no')" class="btn"
-                     ng-class="{'btn-primary' : isRSVP('no', party)}">
-            </div>
-            <div ng-hide="$root.currentUser">
-              <i>Sign in to RSVP for this party.</i>
-            </div>
 
+              <div layout="row">
+                <div flex="1">
+                  <p style="margin-top:0px;margin-bottom:3px;font-size:14px;color:#aaa;">
+                    <small>Posted by {{ creator(party) | displayName }}</small>
+                    <span ng-if="party.public" style="font-size:12px;color:#999;">| Everyone is invited</span>
+                  </p>
 
-          </div>
-          <div class="col-sm-4">
-            <div class="ma-rsvp-sum">
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'yes'}).length || "0"}}
+                  <div ng-show="$root.currentUser" class="md-actions" layout="row">
+                    <md-button ng-click="rsvp(party._id, 'yes')">I'm going!</md-button>
+                    <md-button ng-click="rsvp(party._id, 'maybe')">Maybe</md-button>
+                    <md-button ng-click="rsvp(party._id, 'no')">No</md-button>
+                  </div>
                 </div>
-                <div class="ma-rsvp-title">
-                  YES
+                <div  layout="row" layout-align="end end">
+                  <div ng-hide="$root.currentUser" style="font-size:13px;margin-bottom:10px;">
+                    Sign in to RSVP for this party
+                  </div>
+                  <div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'yes'}).length || "0" }}</div>
+                      <div class="rsvps-title">Yes</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0" }}</div>
+                      <div class="rsvps-title">Maybe</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'no'}).length || "0" }}</div>
+                      <div class="rsvps-title">No</div>
+                    </div>
+                  </div>
                 </div>
               </div>
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0"}}
-                </div>
-                <div class="ma-rsvp-title">
-                  MAYBE
-                </div>
-              </div>
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'no'}).length || "0"}}
-                </div>
-                <div class="ma-rsvp-title">
-                  NO
-                </div>
-              </div>
-            </div>
-
-            <ul ng-if="!party.public">
-              <li ng-repeat="invitedUser in outstandingInvitations(party)">
-                {{ invitedUser | displayName }}
-              </li>
-            </ul>
-
-          </div>
+            </md-card-content>
+          </md-card>
         </div>
+      </md-content>
 
-      </li>
-    </ul>
-    <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
-
-  </div>
-  <div class="col-md-6 h100 ma-angular-map-col">
-    <div class="angular-google-map-container h100">
-      <ui-gmap-google-map center="map.center" zoom="map.zoom" options="map.options">
+    </div>
+    <div flex-gt-sm="50" flex-sm layout="row" style="min-height:300px;">
+      <ui-gmap-google-map options="map.options" center="map.center" zoom="map.zoom" flex layout="row">
         <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
                          fit="true" idkey="'_id'" doRebuildAll="true">
         </ui-gmap-markers>
       </ui-gmap-google-map>
     </div>
   </div>
-</div>
\ No newline at end of file
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 094e7f5eb2fa2923e8eb90a7897aee7fcdd2cccd Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:34:12 +0300
Subject: [PATCH 162/212] Step 18.9: Add the
 planettraining:material-design-icons package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 36e41b8..b8679d5 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -30,3 +30,4 @@ angularui:angular-google-maps
 less
 angularui:angular-ui-bootstrap
 angular:angular-material
+planettraining:material-design-icons
diff --git a/.meteor/versions b/.meteor/versions
index f186ec7..fcc9ad5 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -71,6 +71,7 @@ oauth1@1.1.5
 oauth2@1.1.5
 observe-sequence@1.0.7
 ordered-dict@1.0.4
+planettraining:material-design-icons@2.0.0
 promise@0.4.8
 random@1.0.4
 rate-limit@1.0.0
-- 
2.3.2 (Apple Git-55)


From 63edef2a58896e2191ba84500d31e6e0378c304c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:56:15 +0300
Subject: [PATCH 163/212] Step 18.10: Add angular material icons definitions

---
 client/lib/app.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/client/lib/app.js b/client/lib/app.js
index d4e8b68..a350404 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -5,6 +5,23 @@ angular.module('socially',[
   'uiGmapgoogle-maps',
   'ngMaterial'
 ]);
+
+var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
+
+  $mdIconProvider
+    .iconSet("social", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-social.svg")
+    .iconSet("action", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-action.svg")
+    .iconSet("communication", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-communication.svg")
+    .iconSet("content", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-content.svg")
+    .iconSet("toggle", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-toggle.svg")
+    .iconSet("navigation", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-navigation.svg")
+    .iconSet("image", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-image.svg");
+
+}];
+
+angular.module('socially')
+  .config(themeIcons);
+
 function onReady() {
   angular.bootstrap(document, ['socially']);
 }
-- 
2.3.2 (Apple Git-55)


From 7adf0878e7df1c1e032b5048f5b40a6af6189138 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:58:59 +0300
Subject: [PATCH 164/212] Step 18.11: Update party details view to use
 angular-material

---
 client/parties/views/party-details.ng.html | 82 ++++++++++++++----------------
 1 file changed, 37 insertions(+), 45 deletions(-)

diff --git a/client/parties/views/party-details.ng.html b/client/parties/views/party-details.ng.html
index 104a657..a1d808c 100644
--- a/client/parties/views/party-details.ng.html
+++ b/client/parties/views/party-details.ng.html
@@ -1,54 +1,46 @@
-<div class="row ma-party-details-container">
-  <div class="col-sm-6 col-sm-offset-3">
-    <legend>
-      View and Edit Your Party Details:
+<div layout="row" flex class="ma-party-details">
+  <div flex="33" offset="33">
+    <legend style="margin:20px 0;">
+      Here you will see and change the details of the party:
     </legend>
-    <form class="form-horizontal">
-      <div class="form-group">
+    <form layout="column">
+      <md-input-container>
         <label>Party Name</label>
-        <input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id" type="text"
-               class="form-control">
-      </div>
-      <div class="form-group">
-        <label>Party Name</label>
-        <input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id" type="text"
-               class="form-control">
-      </div>
-      <div class="form-group">
-        <label>Is public</label>
-        <input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
-      </div>
-    </form>
+        <input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id" type="text" aria-label="Name">
+      </md-input-container>
+      <md-input-container>
+        <label>Party Description</label>
+        <input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id" type="text" aria-label="Description">
+      </md-input-container>
+      <md-checkbox ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id" aria-label="Public">
+        Is public
+      </md-checkbox>
 
-    <div class="ma-invite-list" ng-show="canInvite()">
-      <h3>
-        Users to invite:
-      </h3>
-      <ul>
+      <div layout="row" layout-align="left">
+        <md-button ng-click="save()">Save</md-button>
+        <md-button ng-click="reset()">Reset form</md-button>
+        <md-button ng-href="/parties">Cancel</md-button>
+      </div>
 
-        <li ng-repeat="user in users | uninvited:party">
+      <md-list ng-show="canInvite()">
+        <md-subheader class="md-no-sticky">Users to invite:</md-subheader>
+        <md-list-item ng-repeat="user in users | uninvited:party">
           <div>{{ user | displayName }}</div>
-          <button ng-click="invite(user)">Invite</button>
-        </li>
-        <li ng-if="(users | uninvited:party).length <= 0">
+          <md-button ng-click="invite(user)">Invite</md-button>
+        </md-list-item>
+        <md-list-item ng-if="(users | uninvited:party).length <= 0">
           Everyone are already invited.
-        </li>
-      </ul>
-    </div>
+        </md-list-item>
+      </md-list>
 
-
-    <h3 class="ma-map-title">
-      Click the map to set the party location
-    </h3>
-
-    <div class="angular-google-map-container">
-      <ui-gmap-google-map center="party.location || map.center" 
-                          events="map.events" zoom="map.zoom">
-        <ui-gmap-marker coords="party.location" options="map.marker.options" 
-                        events="map.marker.events" idkey="party._id">
-        </ui-gmap-marker>
-      </ui-gmap-google-map>
-    </div>
+      <div class="angular-google-map-container">
+        <ui-gmap-google-map center="party.location || map.center" 
+                            events="map.events" zoom="map.zoom">
+          <ui-gmap-marker coords="party.location" options="map.marker.options" 
+                          events="map.marker.events" idkey="party._id">
+          </ui-gmap-marker>
+        </ui-gmap-google-map>
+      </div>
+    </form>
   </div>
-
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7b40a0367170582c2ac8bcbba5dc7fe1a08a17e4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 23:01:12 +0300
Subject: [PATCH 165/212] Step 18.12: Update new party modal view to use
 angular-material

---
 client/parties/views/add-new-party-modal.ng.html | 54 ++++++++++++++----------
 1 file changed, 32 insertions(+), 22 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 5fd3485..464d006 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -1,24 +1,34 @@
-<div class="container-fluid ma-add-new-party-container">
-  <div class="alert alert-info" ng-hide="$root.currentUser || $root.loggingIn">
-    Please log in to create a party!
-  </div>
-
-  <form ng-show="$root.currentUser || $root.loggingIn">
-    <h2>Create a new party</h2>
-
-    <div class="form-group">
-      <label for="nameInput">Name</label>
-      <input ng-model="newParty.name" id="nameInput" type="text" class="form-control">
+<md-dialog aria-label="Mango (Fruit)">
+  <form>
+    <md-toolbar>
+      <div class="md-toolbar-tools">
+        <h2> Create a new party</h2>
+        <span flex></span>
+      </div>
+    </md-toolbar>
+    <md-dialog-content style="min-width:300px;max-width:800px;max-height:810px; ">
+      <div  ng-show="$root.currentUser">
+        <md-input-container>
+          <label>Name</label>
+          <input ng-model="newParty.name" id="nameInput" type="text" aria-label="Name">
+        </md-input-container>
+        <md-input-container>
+          <label>Description</label>
+          <input ng-model="newParty.description" id="description" type="text" aria-label="Description">
+        </md-input-container>
+        <md-checkbox ng-model="newParty.public" id="public" aria-label="Public">
+          Public
+        </md-checkbox>
+      </div>
+    </md-dialog-content>
+    <div class="md-actions" layout="row">
+      <span flex></span>
+      <md-button ng-click="close()">
+        Close
+      </md-button>
+      <md-button ng-click="addNewParty()" style="margin-right:20px;">
+        Add
+      </md-button>
     </div>
-    <div class="form-group">
-      <label for="description">Description</label>
-      <input ng-model="newParty.description" id="description" type="text" class="form-control">
-    </div>
-    <div class="form-group">
-      <label for="public">
-        <input type="checkbox" ng-model="newParty.public" id="public"> Public
-      </label>
-    </div>
-    <button ng-click="addNewParty()" class="btn">Add</button>
   </form>
-</div>
\ No newline at end of file
+</md-dialog>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 81fb809f46d630e56bb5d3628dd578070a31ce01 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:44:55 +0300
Subject: [PATCH 166/212] Step 18.13: Custom auth buttons

---
 client/index.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index a5d537e..d7d5937 100644
--- a/client/index.html
+++ b/client/index.html
@@ -10,7 +10,10 @@
   </h2>
   <span flex></span>
   <div class="navbar-right navbar-text">
-    <blaze-template name="loginButtons"></blaze-template>
+    <md-button ng-href="/login" ng-hide="$root.currentUser">Login</md-button>
+    <md-button ng-href="/register" ng-hide="$root.currentUser">Sign up</md-button>
+    <div ng-show="$root.currentUser">{{ $root.currentUser }}</div>
+    <md-button ng-href="/logout" ng-show="$root.currentUser">Logout</md-button>
   </div>
 </md-toolbar>
 <div ui-view flex-gt-sm layout-gt-sm="row"></div>
-- 
2.3.2 (Apple Git-55)


From 6352f69edb9c4ee1f2afbb53bd2ba2722a9e781f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:45:56 +0300
Subject: [PATCH 167/212] Step 18.14: Add custom auth routes

---
 client/routes.js | 30 ++++++++++++++++++++++++++++++
 1 file changed, 30 insertions(+)

diff --git a/client/routes.js b/client/routes.js
index e88ad92..13f33e6 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -28,6 +28,36 @@ angular.module("socially").config(['$urlRouterProvider', '$stateProvider', '$loc
             return $meteor.requireUser();
           }]
         }
+      })
+      .state('login', {
+        url: '/login',
+        templateUrl: 'client/users/views/login.ng.html',
+        controller: 'LoginCtrl',
+        controllerAs: 'lc'
+      })
+      .state('register',{
+        url: '/register',
+        templateUrl: 'client/users/views/register.ng.html',
+        controller: 'RegisterCtrl',
+        controllerAs: 'rc'
+      })
+      .state('resetpw', {
+        url: '/resetpw',
+        templateUrl: 'client/users/views/reset-password.ng.html',
+        controller: 'ResetCtrl',
+        controllerAs: 'rpc'
+      })
+      .state('logout', {
+        url: '/logout',
+        resolve: {
+          "logout": ['$meteor', '$state', function($meteor, $state) {
+            return $meteor.logout().then(function(){
+              $state.go('parties');
+            }, function(err){
+              console.log('logout error - ', err);
+            });
+          }]
+        }
       });
 
     $urlRouterProvider.otherwise("/parties");
-- 
2.3.2 (Apple Git-55)


From aac252c04967186e2d11a2d8e1b6546220f9bc69 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:51:12 +0300
Subject: [PATCH 168/212] Step 18.15: Create login controller

---
 client/users/controllers/login.js | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 client/users/controllers/login.js

diff --git a/client/users/controllers/login.js b/client/users/controllers/login.js
new file mode 100644
index 0000000..d1e4664
--- /dev/null
+++ b/client/users/controllers/login.js
@@ -0,0 +1,23 @@
+angular.module("socially").controller("LoginCtrl", ['$meteor', '$state',
+  function ($meteor, $state) {
+    var vm = this;
+
+    vm.credentials = {
+      email: '',
+      password: ''
+    };
+
+    vm.error = '';
+
+    vm.login = function () {
+      $meteor.loginWithPassword(vm.credentials.email, vm.credentials.password).then(
+        function () {
+          $state.go('parties');
+        },
+        function (err) {
+          vm.error = 'Login error - ' + err;
+        }
+      );
+    };
+  }
+]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9ebfd4d22d565c72b1506213d8ea6dd2f2888775 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:51:31 +0300
Subject: [PATCH 169/212] Step 18.16: Create login view

---
 client/users/views/login.ng.html | 33 +++++++++++++++++++++++++++++++++
 1 file changed, 33 insertions(+)
 create mode 100644 client/users/views/login.ng.html

diff --git a/client/users/views/login.ng.html b/client/users/views/login.ng.html
new file mode 100644
index 0000000..2ad8a07
--- /dev/null
+++ b/client/users/views/login.ng.html
@@ -0,0 +1,33 @@
+<md-content layout="row">
+  <span flex></span>
+  <md-whiteframe layout="column" flex="50">
+    <div layout="row" layout-align="space-around center">
+      <div>Login with:</div>
+      <md-button>Twitter</md-button>
+      <md-button>Facebook</md-button>
+    </div>
+    <div ng-show="lc.error" class="md-warn">
+      <small>{{ lc.error }}</small>
+    </div>
+    <form layout="column">
+      <md-input-container>
+        <md-icon md-svg-icon="content:ic_mail_24px"></md-icon>
+        <input type="text" ng-model="lc.credentials.email"
+               placeholder="email" aria-label="email"/>
+      </md-input-container>
+      <md-input-container>
+        <md-icon md-svg-icon="action:ic_lock_open_24px"></md-icon>
+        <input type="password" ng-model="lc.credentials.password"
+               placeholder="password" aria-label="password"/>
+      </md-input-container>
+      <md-button class="md-raised md-primary" ng-click="lc.login()"
+                 aria-label="login">Sign In
+      </md-button>
+    </form>
+    <div layout="row" layout-align="space-around center">
+      <a href="/resetpw">Forgot password?</a>
+      <a href="/register">Create an account</a>
+    </div>
+  </md-whiteframe>
+  <span flex></span>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 94e7fe7c9b46559ac3869fb694004d02c9818e04 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:53:17 +0300
Subject: [PATCH 170/212] Step 18.17: Create register controller

---
 client/users/controllers/register.js | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 client/users/controllers/register.js

diff --git a/client/users/controllers/register.js b/client/users/controllers/register.js
new file mode 100644
index 0000000..f21b5f5
--- /dev/null
+++ b/client/users/controllers/register.js
@@ -0,0 +1,23 @@
+angular.module("socially").controller("RegisterCtrl", ['$meteor', '$state',
+  function ($meteor, $state) {
+    var vm = this;
+
+    vm.credentials = {
+      email: '',
+      password: ''
+    };
+
+    vm.error = '';
+
+    vm.register = function () {
+      $meteor.createUser(vm.credentials).then(
+        function () {
+          $state.go('parties');
+        },
+        function (err) {
+          vm.error = 'Registration error - ' + err;
+        }
+      );
+    };
+  }
+]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 624f7dc1eec36f1ab503d924ed2a33a67ee94e0d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:53:37 +0300
Subject: [PATCH 171/212] Step 18.18: Create login view

---
 client/users/views/register.ng.html | 32 ++++++++++++++++++++++++++++++++
 1 file changed, 32 insertions(+)
 create mode 100644 client/users/views/register.ng.html

diff --git a/client/users/views/register.ng.html b/client/users/views/register.ng.html
new file mode 100644
index 0000000..2278c2f
--- /dev/null
+++ b/client/users/views/register.ng.html
@@ -0,0 +1,32 @@
+<md-content layout="row">
+  <span flex></span>
+  <md-whiteframe layout="column" flex="50">
+    <div layout="row" layout-align="space-around center">
+      <div>Register</div>
+      <md-button>Twitter</md-button>
+      <md-button>Facebook</md-button>
+    </div>
+    <div ng-show="rc.error" class="md-warn">
+      <small>{{ rc.error }}</small>
+    </div>
+    <form layout="column">
+      <md-input-container>
+        <md-icon md-svg-icon="content:ic_mail_24px"></md-icon>
+        <input type="text" ng-model="rc.credentials.email"
+               placeholder="email" aria-label="email"/>
+      </md-input-container>
+      <md-input-container>
+        <md-icon md-svg-icon="action:ic_lock_open_24px"></md-icon>
+        <input type="password" ng-model="rc.credentials.password"
+               placeholder="password" aria-label="password"/>
+      </md-input-container>
+      <md-button class="md-raised md-primary"
+                 ng-click="rc.register()">Create Account
+      </md-button>
+    </form>
+    <div layout="row" layout-align="end center">
+      <a href="/login">Login</a>
+    </div>
+  </md-whiteframe>
+  <span flex></span>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a4ecd3e59daae6a65e1c3a39713dac80219edc31 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:54:24 +0300
Subject: [PATCH 172/212] Step 18.19: Create reset controller

---
 client/users/controllers/reset.js | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
 create mode 100644 client/users/controllers/reset.js

diff --git a/client/users/controllers/reset.js b/client/users/controllers/reset.js
new file mode 100644
index 0000000..2c40b6b
--- /dev/null
+++ b/client/users/controllers/reset.js
@@ -0,0 +1,22 @@
+angular.module("socially").controller("ResetCtrl", ['$meteor', '$state',
+  function ($meteor, $state) {
+    var vm = this;
+
+    vm.credentials = {
+      email: ''
+    };
+
+    vm.error = '';
+
+    vm.reset = function () {
+      $meteor.forgotPassword(vm.credentials.email).then(
+        function () {
+          $state.go('parties');
+        },
+        function (err) {
+          vm.error = 'Error sending forgot password email - ' + err;
+        }
+      );
+    };
+  }
+]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 3dd46c2b09e4e359f2757c6b4f54db5f636a74e5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Tue, 18 Aug 2015 17:02:39 +0300
Subject: [PATCH 173/212] Step 18.20: Create reset view

---
 client/users/views/reset-password.ng.html | 27 +++++++++++++++++++++++++++
 1 file changed, 27 insertions(+)
 create mode 100644 client/users/views/reset-password.ng.html

diff --git a/client/users/views/reset-password.ng.html b/client/users/views/reset-password.ng.html
new file mode 100644
index 0000000..f365b52
--- /dev/null
+++ b/client/users/views/reset-password.ng.html
@@ -0,0 +1,27 @@
+<md-content layout="row">
+  <span flex></span>
+  <md-whiteframe layout="column" flex="50">
+    <div layout="row" layout-align="space-around center">
+      <div>Login with:</div>
+      <md-button>Twitter</md-button>
+      <md-button>Facebook</md-button>
+    </div>
+    <div ng-show="rpc.error" class="md-warn">
+      <small>{{ rpc.error }}</small>
+    </div>
+    <form layout="column">
+      <md-input-container>
+        <md-icon md-svg-icon="content:ic_mail_24px"></md-icon>
+        <input type="text" ng-model="rpc.credentials.email"
+               placeholder="email" aria-label="email"/>
+      </md-input-container>
+      <md-button class="md-raised md-primary"
+                 ng-click="rpc.reset()" aria-label="login">Reset password
+      </md-button>
+    </form>
+    <div layout="row" layout-align="end center">
+      <a href="/login">Login</a>
+    </div>
+  </md-whiteframe>
+  <span flex></span>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1c69da0b0fa50e1290217b683b334b183de6ce96 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:48:03 +0300
Subject: [PATCH 174/212] Step 20.1: Add the cfs:standard-packages package

---
 .meteor/packages |  1 +
 .meteor/versions | 18 ++++++++++++++++++
 2 files changed, 19 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index b8679d5..5ea8a84 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -31,3 +31,4 @@ less
 angularui:angular-ui-bootstrap
 angular:angular-material
 planettraining:material-design-icons
+cfs:standard-packages
diff --git a/.meteor/versions b/.meteor/versions
index fcc9ad5..bd2f530 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -26,6 +26,22 @@ boilerplate-generator@1.0.4
 caching-compiler@1.0.0
 caching-html-compiler@1.0.1
 callback-hook@1.0.4
+cfs:access-point@0.1.49
+cfs:base-package@0.0.30
+cfs:collection@0.5.5
+cfs:collection-filters@0.2.4
+cfs:data-man@0.0.6
+cfs:file@0.1.17
+cfs:http-methods@0.0.30
+cfs:http-publish@0.0.13
+cfs:power-queue@0.9.11
+cfs:reactive-list@0.0.9
+cfs:reactive-property@0.0.4
+cfs:standard-packages@0.5.9
+cfs:storage-adapter@0.2.2
+cfs:tempstore@0.1.5
+cfs:upload-http@0.0.20
+cfs:worker@0.1.4
 check@1.0.6
 dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
@@ -63,6 +79,7 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.1
 mongo-id@1.0.1
+mongo-livedata@1.0.9
 nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
@@ -73,6 +90,7 @@ observe-sequence@1.0.7
 ordered-dict@1.0.4
 planettraining:material-design-icons@2.0.0
 promise@0.4.8
+raix:eventemitter@0.1.3
 random@1.0.4
 rate-limit@1.0.0
 reactive-dict@1.1.1
-- 
2.3.2 (Apple Git-55)


From 05f1e62fcdacf948b3eb49055ff3a2f22af30956 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:53:05 +0300
Subject: [PATCH 175/212] Step 20.2: Add the cfs:gridfs package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 5ea8a84..4796e44 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -32,3 +32,4 @@ angularui:angular-ui-bootstrap
 angular:angular-material
 planettraining:material-design-icons
 cfs:standard-packages
+cfs:gridfs
diff --git a/.meteor/versions b/.meteor/versions
index bd2f530..0f10faf 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -32,6 +32,7 @@ cfs:collection@0.5.5
 cfs:collection-filters@0.2.4
 cfs:data-man@0.0.6
 cfs:file@0.1.17
+cfs:gridfs@0.0.33
 cfs:http-methods@0.0.30
 cfs:http-publish@0.0.13
 cfs:power-queue@0.9.11
-- 
2.3.2 (Apple Git-55)


From e763b7bbe808341ae06733d276cc0ceeaaa74532 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Tue, 18 Aug 2015 17:44:26 +0300
Subject: [PATCH 176/212] Step 20.3: Create the Images collection and publish
 it

---
 model/images.js | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)
 create mode 100644 model/images.js

diff --git a/model/images.js b/model/images.js
new file mode 100644
index 0000000..5cec451
--- /dev/null
+++ b/model/images.js
@@ -0,0 +1,31 @@
+Images = new FS.Collection("images", {
+  stores: [
+    new FS.Store.GridFS("original")
+  ],
+  filter: {
+    allow: {
+      contentTypes: ['image/*']
+    }
+  }
+});
+
+if (Meteor.isServer) {
+  Images.allow({
+    insert: function (userId) {
+      return (userId ? true : false);
+    },
+    remove: function (userId) {
+      return (userId ? true : false);
+    },
+    download: function () {
+      return true;
+    },
+    update: function (userId) {
+      return (userId ? true : false);
+    }
+  });
+
+  Meteor.publish('images', function() {
+    return Images.find({});
+  });
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a99184845253bac4c1c5f0e97272bf004d0b159c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:09:03 +0300
Subject: [PATCH 177/212] Step 20.4: Add the collectionFs to the controller

---
 client/parties/controllers/partiesList.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 686706f..c484d72 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -7,6 +7,7 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '
     $scope.orderProperty = '1';
 
     $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
+    $scope.images = $meteor.collectionFS(Images, false, Images).subscribe('images');
 
     $scope.parties = $meteor.collection(function() {
       return Parties.find({}, {
-- 
2.3.2 (Apple Git-55)


From d20de20e790d36257938b568b26b6ac75c6d5cb9 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:56:10 +0300
Subject: [PATCH 178/212] Step 20.5: Add the danialfarid:ng-file-upload package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 4796e44..5ffdd5b 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -33,3 +33,4 @@ angular:angular-material
 planettraining:material-design-icons
 cfs:standard-packages
 cfs:gridfs
+danialfarid:ng-file-upload
diff --git a/.meteor/versions b/.meteor/versions
index 0f10faf..e836442 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -44,6 +44,7 @@ cfs:tempstore@0.1.5
 cfs:upload-http@0.0.20
 cfs:worker@0.1.4
 check@1.0.6
+danialfarid:ng-file-upload@5.0.9
 dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
-- 
2.3.2 (Apple Git-55)


From dcee03d56d963064e369d173331ee02321857c1d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:10:51 +0300
Subject: [PATCH 179/212] Step 20.6: Add dependency for 'ngFileUpload' to the
 module

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index a350404..58f45d6 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -3,7 +3,8 @@ angular.module('socially',[
   'ui.router',
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
-  'ngMaterial'
+  'ngMaterial',
+  'ngFileUpload'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From 25e0f0db86628f63f686508aacac11e09235d2da Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:35:57 +0300
Subject: [PATCH 180/212] Step 20.7: Add usage of file uploader

---
 client/parties/views/add-new-party-modal.ng.html | 24 ++++++++++++++++++++++--
 1 file changed, 22 insertions(+), 2 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 464d006..e27ba83 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -1,4 +1,4 @@
-<md-dialog aria-label="Mango (Fruit)">
+<md-dialog>
   <form>
     <md-toolbar>
       <div class="md-toolbar-tools">
@@ -6,7 +6,7 @@
         <span flex></span>
       </div>
     </md-toolbar>
-    <md-dialog-content style="min-width:300px;max-width:800px;max-height:810px; ">
+    <md-dialog-content style="min-width:800px;max-width:800px;max-height:100%; ">
       <div  ng-show="$root.currentUser">
         <md-input-container>
           <label>Name</label>
@@ -16,6 +16,26 @@
           <label>Description</label>
           <input ng-model="newParty.description" id="description" type="text" aria-label="Description">
         </md-input-container>
+        <md-whiteframe class="md-whiteframe-z1" layout="column">
+          <div layout="row" class="images-container-title">
+            <div flex>
+              <h3>Add photos to your party!</h3>
+              <div ng-controller="AddPhotoCtrl">
+                <div ngf-drop ngf-select
+                     ngf-change="addImages($files)"
+                     ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}" class="drop-box"
+                     ngf-multiple="false" ngf-allow-dir="false" ngf-accept="'image/*'"
+                     ngf-drop-available="dropAvailable">
+                  <div>Click here to select image</div>
+                  <div>
+                    <strong>OR</strong>
+                  </div>
+                  <div ng-show="dropAvailable">You can also drop image to here</div>
+                </div>
+              </div>
+            </div>
+          </div>
+        </md-whiteframe>
         <md-checkbox ng-model="newParty.public" id="public" aria-label="Public">
           Public
         </md-checkbox>
-- 
2.3.2 (Apple Git-55)


From 6391beacf48e219d126786bc1b38e1bd25858b4f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:36:17 +0300
Subject: [PATCH 181/212] Step 20.8: Create the file upload controller

---
 client/parties/controllers/addPhoto.js | 10 ++++++++++
 1 file changed, 10 insertions(+)
 create mode 100644 client/parties/controllers/addPhoto.js

diff --git a/client/parties/controllers/addPhoto.js b/client/parties/controllers/addPhoto.js
new file mode 100644
index 0000000..072392f
--- /dev/null
+++ b/client/parties/controllers/addPhoto.js
@@ -0,0 +1,10 @@
+angular.module("socially").controller("AddPhotoCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog',
+  function($scope, $meteor, $rootScope, $state, $mdDialog) {
+    $scope.addImages = function (files) {
+      if (files.length > 0) {
+        $scope.images.save(files[0]);
+      }
+    };
+
+    $scope.close = $mdDialog.hide;
+  }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 90f55d52b93fae6ac6d14f62cdfc0c4732c25958 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:36:56 +0300
Subject: [PATCH 182/212] Step 20.9: Add the images collection to the new party
 modal

---
 client/parties/controllers/addNewParty.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
index af25c36..25e890f 100644
--- a/client/parties/controllers/addNewParty.js
+++ b/client/parties/controllers/addNewParty.js
@@ -1,6 +1,8 @@
 angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog', 'parties',
   function ($scope, $meteor, $rootScope, $state, $mdDialog, parties) {
     $scope.newParty = {};
+    $scope.images = $meteor.collectionFS(Images, false, Images);
+
     $scope.addNewParty = function () {
       if($scope.newParty.name){
         $scope.newParty.owner = $rootScope.currentUser._id;
-- 
2.3.2 (Apple Git-55)


From 1325de946addb17bc41db95278adbe3381650fff Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:04:27 +0300
Subject: [PATCH 183/212] Step 20.10: Add some style to the upload component

---
 client/parties/styles/parties.import.less | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 0f7beb6..31cc3d1 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -59,4 +59,23 @@
 
         }
     }
+}
+
+.drop-box {
+    background: #F8F8F8;
+    border: 5px dashed #DDD;
+    width: 230px;
+    height: 120px;
+    text-align: center;
+    padding-top: 25px;
+    margin-left: 10px;
+    margin-bottom: 20px;
+}
+
+.drop-box.dragover {
+    border: 5px dashed blue;
+}
+
+.drop-box.dragover-err {
+    border: 5px dashed red;
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ae8f6dcf5570e626d3919644ed2112607aaca198 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:58:20 +0300
Subject: [PATCH 184/212] Step 20.11: Add the alexk111:ng-img-crop package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 5ffdd5b..cc2c2db 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -34,3 +34,4 @@ planettraining:material-design-icons
 cfs:standard-packages
 cfs:gridfs
 danialfarid:ng-file-upload
+alexk111:ng-img-crop
diff --git a/.meteor/versions b/.meteor/versions
index e836442..2269045 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -5,6 +5,7 @@ accounts-password@1.1.3
 accounts-twitter@1.0.6
 accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
+alexk111:ng-img-crop@0.3.2
 angular@1.0.0-rc.11
 angular:angular@1.4.6
 angular:angular-animate@1.4.6
-- 
2.3.2 (Apple Git-55)


From cdfd40e97639367baa397ed5e857d78001caff0e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:08:27 +0300
Subject: [PATCH 185/212] Step 20.12: Add dependency for ngImgCrop

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 58f45d6..559741a 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -4,7 +4,8 @@ angular.module('socially',[
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
   'ngMaterial',
-  'ngFileUpload'
+  'ngFileUpload',
+  'ngImgCrop'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From 94690e08de963d1aaea35873be61acf7efdcfb29 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:10:28 +0300
Subject: [PATCH 186/212] Step 20.13: Update the image upload logic

---
 client/parties/controllers/addPhoto.js | 20 +++++++++++++++-----
 1 file changed, 15 insertions(+), 5 deletions(-)

diff --git a/client/parties/controllers/addPhoto.js b/client/parties/controllers/addPhoto.js
index 072392f..1df211d 100644
--- a/client/parties/controllers/addPhoto.js
+++ b/client/parties/controllers/addPhoto.js
@@ -1,10 +1,20 @@
-angular.module("socially").controller("AddPhotoCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog',
-  function($scope, $meteor, $rootScope, $state, $mdDialog) {
+angular.module("socially").controller("AddPhotoCtrl", ['$scope',
+  function($scope) {
     $scope.addImages = function (files) {
       if (files.length > 0) {
-        $scope.images.save(files[0]);
+        var reader = new FileReader();
+
+        reader.onload = function (e) {
+          $scope.$apply(function() {
+            $scope.imgSrc = e.target.result;
+            $scope.myCroppedImage = '';
+          });
+        };
+
+        reader.readAsDataURL(files[0]);
+      }
+      else {
+        $scope.imgSrc = undefined;
       }
     };
-
-    $scope.close = $mdDialog.hide;
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 24f931d30beaf60b573444d0c6d5e3d68d1c7152 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:10:42 +0300
Subject: [PATCH 187/212] Step 20.14: Add usage of ngImgCrop

---
 client/parties/views/add-new-party-modal.ng.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index e27ba83..ff647a9 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -32,6 +32,10 @@
                   </div>
                   <div ng-show="dropAvailable">You can also drop image to here</div>
                 </div>
+                <div ng-show="imgSrc" class="ng-crop-container">
+                  <h3>Great! Now edit & crop your image...</h3><br />
+                  <img-crop image="imgSrc" result-image="myCroppedImage" area-type="square"></img-crop>
+                </div>
               </div>
             </div>
           </div>
-- 
2.3.2 (Apple Git-55)


From 859e96ea07ef31d86228d9d04f7fd0f2c15b28b6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:10:57 +0300
Subject: [PATCH 188/212] Step 20.15: Add ng-hide to the uploader

---
 client/parties/views/add-new-party-modal.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index ff647a9..75cd7da 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -21,7 +21,7 @@
             <div flex>
               <h3>Add photos to your party!</h3>
               <div ng-controller="AddPhotoCtrl">
-                <div ngf-drop ngf-select
+                <div ng-hide="imgSrc" ngf-drop ngf-select
                      ngf-change="addImages($files)"
                      ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}" class="drop-box"
                      ngf-multiple="false" ngf-allow-dir="false" ngf-accept="'image/*'"
-- 
2.3.2 (Apple Git-55)


From b46ce97045c499f130d1f6323871c7601b976e03 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:17:35 +0300
Subject: [PATCH 189/212] Step 20.16: Add some CSS to make the crop look better

---
 client/parties/styles/parties.import.less | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 31cc3d1..facbb89 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -78,4 +78,13 @@
 
 .drop-box.dragover-err {
     border: 5px dashed red;
-}
\ No newline at end of file
+}
+
+.uploaded-image {
+    max-height: 100px;
+    max-width: 200px;
+}
+
+.ng-crop-container {
+    height: 350px;
+}
-- 
2.3.2 (Apple Git-55)


From 37259c1aa1692286ca792e6241b59b09a3ed4383 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:17:47 +0300
Subject: [PATCH 190/212] Step 20.17: Add save button for the cropped image

---
 client/parties/views/add-new-party-modal.ng.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 75cd7da..e3b3983 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -33,7 +33,10 @@
                   <div ng-show="dropAvailable">You can also drop image to here</div>
                 </div>
                 <div ng-show="imgSrc" class="ng-crop-container">
-                  <h3>Great! Now edit & crop your image...</h3><br />
+                  <h3>Great! Now edit & crop your image...</h3>
+                  <md-button ng-click="saveCroppedImage()" ng-disabled="!imgSrc" class="md-primary">
+                    Save Image
+                  </md-button>
                   <img-crop image="imgSrc" result-image="myCroppedImage" area-type="square"></img-crop>
                 </div>
               </div>
-- 
2.3.2 (Apple Git-55)


From b61b63a1e2cdde40ea1456ced9ca083e791635d8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:21:30 +0300
Subject: [PATCH 191/212] Step 20.18: Add logic to save the cropped image

---
 client/parties/controllers/addPhoto.js | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/parties/controllers/addPhoto.js b/client/parties/controllers/addPhoto.js
index 1df211d..f13361f 100644
--- a/client/parties/controllers/addPhoto.js
+++ b/client/parties/controllers/addPhoto.js
@@ -17,4 +17,14 @@ angular.module("socially").controller("AddPhotoCtrl", ['$scope',
         $scope.imgSrc = undefined;
       }
     };
+
+    $scope.saveCroppedImage = function() {
+      if ($scope.myCroppedImage !== '') {
+        $scope.images.save($scope.myCroppedImage).then(function(result) {
+          $scope.newPartyImages.push(result[0]._id);
+          $scope.imgSrc = undefined;
+          $scope.myCroppedImage = '';
+        });
+      }
+    };
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 73d8d7fbee0bf5edb60c8c0f65abaa3c861ef174 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:21:49 +0300
Subject: [PATCH 192/212] Step 20.19: Add an array to hold all the new images

---
 client/parties/controllers/addNewParty.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
index 25e890f..b4642a7 100644
--- a/client/parties/controllers/addNewParty.js
+++ b/client/parties/controllers/addNewParty.js
@@ -2,6 +2,7 @@ angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '
   function ($scope, $meteor, $rootScope, $state, $mdDialog, parties) {
     $scope.newParty = {};
     $scope.images = $meteor.collectionFS(Images, false, Images);
+    $scope.newPartyImages = [];
 
     $scope.addNewParty = function () {
       if($scope.newParty.name){
-- 
2.3.2 (Apple Git-55)


From 1c17ca7bd6f85bf2b9c5f3e7fcb6f2938c4404ab Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:29:01 +0300
Subject: [PATCH 193/212] Step 20.20: Add the display of uploaded images

---
 client/parties/views/add-new-party-modal.ng.html | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index e3b3983..ae8f7fd 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -40,6 +40,12 @@
                   <img-crop image="imgSrc" result-image="myCroppedImage" area-type="square"></img-crop>
                 </div>
               </div>
+              <br />
+              <div layout="row" class="images-container-title">
+                <div class="party-image-container" ng-repeat="image in newPartyImages">
+                  <img ng-src="{{ image.url() }}"/><br/>
+                </div>
+              </div>
             </div>
           </div>
         </md-whiteframe>
-- 
2.3.2 (Apple Git-55)


From 3a3526c4de8a3f1962cccb8ea64965add0ec9eef Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 05:00:34 +0300
Subject: [PATCH 194/212] Step 20.21: Add the vitalets:angular-xeditable
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index cc2c2db..fb01433 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -35,3 +35,4 @@ cfs:standard-packages
 cfs:gridfs
 danialfarid:ng-file-upload
 alexk111:ng-img-crop
+vitalets:angular-xeditable
diff --git a/.meteor/versions b/.meteor/versions
index 2269045..7e1eaef 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -118,5 +118,6 @@ ui@1.0.8
 underscore@1.0.4
 urigo:angular-blaze-template@0.0.1
 url@1.0.5
+vitalets:angular-xeditable@0.1.9
 webapp@1.2.2
 webapp-hashing@1.0.5
-- 
2.3.2 (Apple Git-55)


From 7d1ba52508faed555574f691221220732c3d81b0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:30:58 +0300
Subject: [PATCH 195/212] Step 20.22: Add xeditable dependency

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 559741a..b24da29 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -5,7 +5,8 @@ angular.module('socially',[
   'uiGmapgoogle-maps',
   'ngMaterial',
   'ngFileUpload',
-  'ngImgCrop'
+  'ngImgCrop',
+  'xeditable'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From e822bbd67c53d1123e0239137dc5f20c639e27ea Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:32:23 +0300
Subject: [PATCH 196/212] Step 20.23: Add usage of angular-xeditable

---
 client/parties/views/add-new-party-modal.ng.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index ae8f7fd..b7abd11 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -1,5 +1,4 @@
 <md-dialog>
-  <form>
     <md-toolbar>
       <div class="md-toolbar-tools">
         <h2> Create a new party</h2>
@@ -44,6 +43,8 @@
               <div layout="row" class="images-container-title">
                 <div class="party-image-container" ng-repeat="image in newPartyImages">
                   <img ng-src="{{ image.url() }}"/><br/>
+                  <a href="#" editable-text="image.metadata.description"
+                     onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
                 </div>
               </div>
             </div>
@@ -63,5 +64,4 @@
         Add
       </md-button>
     </div>
-  </form>
 </md-dialog>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6eb7ff4ea373242d50395a0ca3014b44aec084bc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:33:12 +0300
Subject: [PATCH 197/212] Step 20.24: Add the logic to update the description

---
 client/parties/controllers/addNewParty.js | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
index b4642a7..761dcc5 100644
--- a/client/parties/controllers/addNewParty.js
+++ b/client/parties/controllers/addNewParty.js
@@ -11,8 +11,13 @@ angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '
         $scope.newParty = '';
         $mdDialog.hide();
       }
-    }
+    };
+
     $scope.close = function () {
       $mdDialog.hide();
-    }
+    };
+
+    $scope.updateDescription = function($data, image) {
+      image.update({$set: {'metadata.description': $data}});
+    };
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2002d97106cd940ed104773678cfa513c7c967fa Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:38:38 +0300
Subject: [PATCH 198/212] Step 20.25: Use div instead of form

---
 client/parties/views/add-new-party-modal.ng.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index b7abd11..3c8347b 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -1,4 +1,5 @@
 <md-dialog>
+  <div class="like-form">
     <md-toolbar>
       <div class="md-toolbar-tools">
         <h2> Create a new party</h2>
@@ -64,4 +65,5 @@
         Add
       </md-button>
     </div>
+  </div>
 </md-dialog>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1ea8b48d3ca3e7268ac6f05c68f4665778c3bc6c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:38:57 +0300
Subject: [PATCH 199/212] Step 20.26: Add form-layout to the div

---
 client/styles/main.less | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/styles/main.less b/client/styles/main.less
index 438dc59..a964692 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,6 +1,16 @@
 html, body {
 }
 
+.like-form {
+  display: -webkit-flex;
+  display: -ms-flexbox;
+  display: flex;
+  -webkit-flex-direction: column;
+  -ms-flex-direction: column;
+  flex-direction: column;
+  overflow: auto;
+}
+
 @import "../parties/styles/parties.import.less";
 @import "../parties/styles/party.details.import.less";
 @import "../parties/styles/navbar.import.less";
-- 
2.3.2 (Apple Git-55)


From c329443f9d745e2846e36b22edcd2493f5a58333 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 05:03:47 +0300
Subject: [PATCH 200/212] Step 20.27: Add the
 netanelgilad:angular-sortable-view package

---
 .meteor/packages | 1 +
 .meteor/versions | 2 ++
 2 files changed, 3 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index fb01433..f729e61 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -36,3 +36,4 @@ cfs:gridfs
 danialfarid:ng-file-upload
 alexk111:ng-img-crop
 vitalets:angular-xeditable
+netanelgilad:angular-sortable-view
diff --git a/.meteor/versions b/.meteor/versions
index 7e1eaef..aeef4e3 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -83,6 +83,7 @@ mobile-status-bar@1.0.6
 mongo@1.1.1
 mongo-id@1.0.1
 mongo-livedata@1.0.9
+netanelgilad:angular-sortable-view@0.0.13
 nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
@@ -116,6 +117,7 @@ tracker@1.0.8
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
+urigo:angular@0.8.14
 urigo:angular-blaze-template@0.0.1
 url@1.0.5
 vitalets:angular-xeditable@0.1.9
-- 
2.3.2 (Apple Git-55)


From 11b61ca2e389cd428e47a7b5d9b927e2d101145e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:40:59 +0300
Subject: [PATCH 201/212] Step 20.28: Add dependency for
 'angular-sortable-view'

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index b24da29..1a5d6dd 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -6,7 +6,8 @@ angular.module('socially',[
   'ngMaterial',
   'ngFileUpload',
   'ngImgCrop',
-  'xeditable'
+  'xeditable',
+  'angular-sortable-view'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From f126edfeb984c06ec983d4a552de2a53c35e26bf Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:41:57 +0300
Subject: [PATCH 202/212] Step 20.29: Add usage for angular-sortable

---
 client/parties/views/add-new-party-modal.ng.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 3c8347b..51f6c0f 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -41,9 +41,9 @@
                 </div>
               </div>
               <br />
-              <div layout="row" class="images-container-title">
-                <div class="party-image-container" ng-repeat="image in newPartyImages">
-                  <img ng-src="{{ image.url() }}"/><br/>
+              <div layout="row" class="images-container-title" sv-root sv-part="newPartyImages">
+                <div sv-element class="party-image-container" ng-repeat="image in newPartyImages">
+                  <img draggable="false" ng-src="{{ image.url() }}"/><br/>
                   <a href="#" editable-text="image.metadata.description"
                      onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
                 </div>
-- 
2.3.2 (Apple Git-55)


From 4b62eff4c2e4810d030a7519b16b8844ec72dbf0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:42:21 +0300
Subject: [PATCH 203/212] Step 20.30: Add indication for main image in the view

---
 client/parties/views/add-new-party-modal.ng.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 51f6c0f..70d0469 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -43,6 +43,7 @@
               <br />
               <div layout="row" class="images-container-title" sv-root sv-part="newPartyImages">
                 <div sv-element class="party-image-container" ng-repeat="image in newPartyImages">
+                  <div class="main-image" ng-show="$index === 0">Main Image</div>
                   <img draggable="false" ng-src="{{ image.url() }}"/><br/>
                   <a href="#" editable-text="image.metadata.description"
                      onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
-- 
2.3.2 (Apple Git-55)


From dce4830a55e155703660ed20f0ea2617bbcce4ba Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:00:20 +0300
Subject: [PATCH 204/212] Step 20.31: Add some css to the image gallery

---
 client/parties/styles/parties.import.less | 25 +++++++++++++++++++++++++
 1 file changed, 25 insertions(+)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index facbb89..4470813 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -88,3 +88,28 @@
 .ng-crop-container {
     height: 350px;
 }
+
+.images-container-title {
+    padding-bottom: 30px;
+}
+
+.party-image-container {
+    position: relative;
+    margin-right: 10px;
+    max-height: 200px;
+    max-width: 200px;
+
+    img {
+        max-height: 100%;
+        max-width: 100%;
+    }
+}
+
+.main-image {
+    position: absolute;
+    top: 0;
+    left: 0;
+    width: 100%;
+    text-align: center;
+    background-color: #f8f8f8;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5e21df825600d1b3ad118530252b1de8ede29cd3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:03:34 +0300
Subject: [PATCH 205/212] Step 20.32: Save the party with the images

---
 client/parties/controllers/addNewParty.js | 16 +++++++++++++++-
 1 file changed, 15 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
index 761dcc5..7c82ada 100644
--- a/client/parties/controllers/addNewParty.js
+++ b/client/parties/controllers/addNewParty.js
@@ -7,8 +7,22 @@ angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '
     $scope.addNewParty = function () {
       if($scope.newParty.name){
         $scope.newParty.owner = $rootScope.currentUser._id;
+
+        // Link the images and the order to the new party
+        if ($scope.newPartyImages && $scope.newPartyImages.length > 0) {
+          $scope.newParty.images = [];
+
+          angular.forEach($scope.newPartyImages, function(image) {
+            $scope.newParty.images.push({id: image._id});
+          });
+        }
+
+        // Save the party
         parties.push($scope.newParty);
-        $scope.newParty = '';
+
+        // Reset the form
+        $scope.newPartyImages = [];
+        $scope.newParty = {};
         $mdDialog.hide();
       }
     };
-- 
2.3.2 (Apple Git-55)


From 2b3e27e63f5c12e013280a0d1df325ff7a64eb26 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:11:14 +0300
Subject: [PATCH 206/212] Step 20.33: Display the party's main image

---
 client/parties/views/parties-list.ng.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/views/parties-list.ng.html b/client/parties/views/parties-list.ng.html
index a389551..ea83c45 100644
--- a/client/parties/views/parties-list.ng.html
+++ b/client/parties/views/parties-list.ng.html
@@ -20,6 +20,10 @@
         <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
         <div  dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count" class="ma-party">
           <md-card>
+            <div ng-if="party.images && party.images.length > 0"
+                 ng-style="getMainImage(party.images)"
+                 class="party-image">
+            </div>
             <md-card-content>
               <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
               <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
-- 
2.3.2 (Apple Git-55)


From 0dabe9708ec2eed4eeb11f5ae020228596b58c9c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:11:30 +0300
Subject: [PATCH 207/212] Step 20.34: Add the logic to get the main image

---
 client/parties/controllers/partiesList.js | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index c484d72..21838b5 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,5 +1,5 @@
-angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog',
-  function($scope, $meteor, $rootScope, $state, $mdDialog){
+angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog', '$filter',
+  function($scope, $meteor, $rootScope, $state, $mdDialog, $filter){
 
     $scope.page = 1;
     $scope.perPage = 3;
@@ -15,6 +15,16 @@ angular.module("socially").controller("PartiesListCtrl", ['$scope', '$meteor', '
       });
     });
 
+    $scope.getMainImage = function(images) {
+      if (images && images.length && images[0] && images[0].id) {
+        var url = $filter('filter')($scope.images, {_id: images[0].id})[0].url();
+
+        return {
+          'background-image': 'url("' + url + '")'
+        }
+      }
+    };
+
     $meteor.autorun($scope, function() {
       $meteor.subscribe('parties', {
         limit: parseInt($scope.getReactively('perPage')),
-- 
2.3.2 (Apple Git-55)


From 4f2c73693cf49ab9b6a4683c3feb1a9ed1e28bec Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:11:42 +0300
Subject: [PATCH 208/212] Step 20.35: Add style to the main image

---
 client/parties/styles/parties.import.less | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 4470813..0e73444 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -112,4 +112,10 @@
     width: 100%;
     text-align: center;
     background-color: #f8f8f8;
+}
+
+.party-image {
+    background-size: cover;
+    width: 100%;
+    height: 200px;
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 99da78b87b81ddca76b6d83a254650618b4d4245 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 05:06:19 +0300
Subject: [PATCH 209/212] Step 20.36: Add the cfs:graphicsmagick package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index f729e61..dea8b0e 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -37,3 +37,4 @@ danialfarid:ng-file-upload
 alexk111:ng-img-crop
 vitalets:angular-xeditable
 netanelgilad:angular-sortable-view
+cfs:graphicsmagick
diff --git a/.meteor/versions b/.meteor/versions
index aeef4e3..02f6146 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -33,6 +33,7 @@ cfs:collection@0.5.5
 cfs:collection-filters@0.2.4
 cfs:data-man@0.0.6
 cfs:file@0.1.17
+cfs:graphicsmagick@0.0.18
 cfs:gridfs@0.0.33
 cfs:http-methods@0.0.30
 cfs:http-publish@0.0.13
-- 
2.3.2 (Apple Git-55)


From e5031d2531cd924b1552f88a6cbf49990920a6fd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:13:15 +0300
Subject: [PATCH 210/212] Step 20.37: Add another store for the thumbnails

---
 model/images.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/model/images.js b/model/images.js
index 5cec451..3b06d5f 100644
--- a/model/images.js
+++ b/model/images.js
@@ -1,6 +1,11 @@
 Images = new FS.Collection("images", {
   stores: [
-    new FS.Store.GridFS("original")
+    new FS.Store.GridFS("original"),
+    new FS.Store.GridFS("thumbnail", {
+      transformWrite: function(fileObj, readStream, writeStream) {
+        gm(readStream, fileObj.name()).resize('32', '32', '!').stream().pipe(writeStream);
+      }
+    })
   ],
   filter: {
     allow: {
-- 
2.3.2 (Apple Git-55)


From 16ad5f9ba984e66cdf1dd8933f715f7a49d7c6d0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:13:50 +0300
Subject: [PATCH 211/212] Step 20.38: Add thumbnails usage

---
 client/parties/views/add-new-party-modal.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/add-new-party-modal.ng.html b/client/parties/views/add-new-party-modal.ng.html
index 70d0469..eed885c 100644
--- a/client/parties/views/add-new-party-modal.ng.html
+++ b/client/parties/views/add-new-party-modal.ng.html
@@ -44,7 +44,7 @@
               <div layout="row" class="images-container-title" sv-root sv-part="newPartyImages">
                 <div sv-element class="party-image-container" ng-repeat="image in newPartyImages">
                   <div class="main-image" ng-show="$index === 0">Main Image</div>
-                  <img draggable="false" ng-src="{{ image.url() }}"/><br/>
+                  <img draggable="false" ng-src="{{ image.url({store: 'thumbnail'}) }}"/><br/>
                   <a href="#" editable-text="image.metadata.description"
                      onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
                 </div>
-- 
2.3.2 (Apple Git-55)


From 8995417e4400da901b132508beca842486b64dc1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 22 Aug 2015 22:11:09 +0300
Subject: [PATCH 212/212] README and screenshot

---
 .gitignore |  1 +
 COC.md     | 21 +++++++++++++++++++++
 README.md  | 64 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 86 insertions(+)
 create mode 100644 .gitignore
 create mode 100644 COC.md
 create mode 100644 README.md

diff --git a/.gitignore b/.gitignore
new file mode 100644
index 0000000..485dee6
--- /dev/null
+++ b/.gitignore
@@ -0,0 +1 @@
+.idea
diff --git a/COC.md b/COC.md
new file mode 100644
index 0000000..4748e55
--- /dev/null
+++ b/COC.md
@@ -0,0 +1,21 @@
+# Code of Conduct
+
+Learning in plain sight can be an intimidating experience. Your code, mistakes, and community feedback are all publically displayed for everyone to see. While this is true for any open source project, course participants are here to learn and can feel a lot more vulnerable.
+
+It is absolutely crucial that any interaction is done with respect, care, and without judgment, and that any feedback is provided gently. We want to teach and learn from each other, and for that to happen, we must treat each other with care.
+
+This course is dedicated to providing a harassment-free learning experience for everyone, regardless of gender, age, sexual orientation, disability, physical appearance, body size, race, or religion (or lack thereof). We do not tolerate harassment of participants in any form. Sexual language and imagery is not appropriate in any material posted to this repository or in other venues discussing it (e.g. Twitter and other online media). Participants violating these rules may be sanctioned or expelled from the course at the discretion of the maintainers as well as reported to GitHub for abuse.
+
+Harassment includes offensive verbal comments related to gender, age, sexual orientation, disability, physical appearance, body size, race, religion, sexual images in public spaces, deliberate intimidation, stalking, following, harassing photography or recording, sustained disruption of others, inappropriate physical contact, and unwelcome sexual attention.
+
+Participants asked to stop any harassing behavior are expected to comply immediately.
+
+Teachers and maintainers are also subject to the anti-harassment policy. In particular, they should not use sexualized images, activities, or other material.
+
+If a participant engages in harassing behavior, the maintainers may take any action they deem appropriate, including warning the offender or expulsion from the course.
+
+If you are being harassed, notice that someone else is being harassed, or have any other concerns, please contact a member of course team immediately. The list of maintainers can be found at the top of the [README document](https://github.com/hueniverse/hueniversity/blob/master/README.md).
+
+We expect participants to follow these rules at any related social events.
+
+(Adapted from http://confcodeofconduct.com/)
diff --git a/README.md b/README.md
new file mode 100644
index 0000000..9c9c1bd
--- /dev/null
+++ b/README.md
@@ -0,0 +1,64 @@
+# meteor-angular-socially - [Tutorial's site](http://angularjs.meteor.com/tutorial)
+angular-meteor example and tutorial app.
+
+The tutorial starts at branch 'step_00' till the last step.
+
+The master branch is always equal to the last step.
+
+Here is the deployed final version - http://socially-step18.meteor.com/
+
+Please contribute to the tutorial.
+Pull request the master branch to add new features or pull request specific step to improve that step.
+
+Our goal in this tutorial is to add more steps as we go along, to cover as many use cases as possible.
+
+Thanks @MilosStanic for writing step 18 on angular-material
+
+An example with the `controller as` syntax can be found in [this branch](https://github.com/Urigo/meteor-angular-socially/tree/step_12_controller_as_vm).
+
+# angular-meteor University! <a href="http://angularjs.meteor.com/"><img src="http://angularjs.meteor.com/images/logo-large.png" width="60" height="60" /></a>  
+
+The angular-meteor university is a community learning experiment, we would like to create a similar experience to the [hueniversity](https://github.com/hueniverse/hueniversity)
+
+
+[![Join the chat at https://gitter.im/Urigo/angular-meteor](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/Urigo/angular-meteor?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)
+
+The first assignments will be to rewrite the tutorial steps, and follow the latest angular-meteor API , in a more [consistent style](https://github.com/johnpapa/angular-styleguide).
+We also hope the community will propose better solutions than the current ones.
+When we will catch up with the latest steps we will create new steps.
+
+### What am I going to learn?
+You will learn how to build a full stack application using meteor and angular. It will start with the basics and move on to the more advanced topic such as users and authentication, application architecture, reactivity, mobile app, ionic, working with files, Angular Server, ES6 and more.
+
+
+### What do I need to know?
+You should feel comfortable writing simple functions in JavaScript, working with GitHub, using basic git commands, have a basic familiarity with mongoDB, and be able to pick up new subjects by reading tutorials and documentation.
+
+### How advanced is this course?
+We'll start from the basics and make our way to the most advanced topics. The way this course is structured, you can choose which assignments to participate in, so more experienced developers can "sit out" or help others during the basic assignments and participate when it gets to areas they are not as strong in. However, since teaching is one of the most effective ways to learn, we believe that participating early will improve the existing skills of advanced developers.
+The assignment will include just enough information to get you going, but you will need to do most of the learning on your own by using the wide range of online resources available. However, the real benefit of this process will come from the code review of your Pull Request. This is where expert developers will review your work and provide you specific and actionable feedback.
+
+### How does it work?
+First, read the [Code of Conduct](https://github.com/Urigo/meteor-angular-socially/blob/master/COC.md) !
+
+Simple, you start by forking this repo.
+Every few days a new issue will be posted with an [`assignment` label](https://github.com/Urigo/meteor-angular-socially/labels/assignment)
+. If you would like to participate in the assignment, try to solve it and when you are done, submit a Pull Request back to this repo to the `step_NUMBER_u` branch. Make sure your code complies with the [john papa angular style guid](https://github.com/johnpapa/angular-styleguide).
+While you wait for the assignment to close, take a look at what others are submitting and see if you can improve your own solution (borrow ideas, add tests, write examples, update the documentation). If you see ways in which others can improve their solution, please dont hesitate to comment on their Pull Request.
+Each assignment will have a final submission date. When the issue expires, one of the Pull Requests submitted will be picked and merged and published as the new tutorial step. Any follow up assignments will be based on the merged code.
+Before starting the next assignment, make sure [your fork matches the current](https://github.com/Urigo/meteor-angular-socially/blob/master/guides/git.md ) assignment step branch (`step_NUMBER_u`) since only one Pull Request can be accepted.
+
+### How can I help?
+
+There are lots of way you can help make this experiment succeed and help shape a new format for teaching development skills:
+Submit Pull Requests to improve this readme, add examples, write quick tutorials on how to work with git, etc.
+Add new steps to angular-meteor-socially tutorial.
+Look for issues with a [help wanted label](https://github.com/Urigo/meteor-angular-socially/labels/help%20wanted) and help with those.
+Randomly pick submitted Pull Request and review them, offering advice and helping others improve their skills.
+Submit Pull Request or open issues with proposals for [angular-meteor](https://github.com/Urigo/angular-meteor) 
+
+### Anything else?
+[Open an issue](https://github.com/Urigo/meteor-angular-socially/issues/new), it's free.
+
+
+
-- 
2.3.2 (Apple Git-55)

