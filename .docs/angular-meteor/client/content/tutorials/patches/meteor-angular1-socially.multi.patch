From 1c39e179d06f28651198f3cf15717f6911b74a24 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 5 Nov 2015 22:52:57 +0200
Subject: [PATCH 001/262] Step 0.2: Remove conflicting packages from the
 project base

---
 .meteor/packages | 2 --
 1 file changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index a9f8340..2f62174 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -7,14 +7,12 @@
 meteor-base             # Packages every Meteor app needs to have
 mobile-experience       # Packages for a great mobile UX
 mongo                   # The database Meteor supports right now
-blaze-html-templates    # Compile .html files into Meteor Blaze views
 session                 # Client-side reactive dictionary for your app
 jquery                  # Helpful client-side library
 tracker                 # Meteor's client-side reactive programming library
 
 standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
-ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
-- 
2.3.2 (Apple Git-55)


From 110460332e1364256325efd1e91c25630ff85bac Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 00:46:56 +0300
Subject: [PATCH 002/262] Step 0.3: Remove all starter files

---
 socially.css  |  1 -
 socially.html | 14 --------------
 socially.js   | 23 -----------------------
 3 files changed, 38 deletions(-)
 delete mode 100644 socially.css
 delete mode 100644 socially.html
 delete mode 100644 socially.js

diff --git a/socially.css b/socially.css
deleted file mode 100644
index b6b4052..0000000
--- a/socially.css
+++ /dev/null
@@ -1 +0,0 @@
-/* CSS declarations go here */
diff --git a/socially.html b/socially.html
deleted file mode 100644
index cea01d7..0000000
--- a/socially.html
+++ /dev/null
@@ -1,14 +0,0 @@
-<head>
-  <title>socially</title>
-</head>
-
-<body>
-  <h1>Welcome to Meteor!</h1>
-
-  {{> hello}}
-</body>
-
-<template name="hello">
-  <button>Click Me</button>
-  <p>You've pressed the button {{counter}} times.</p>
-</template>
diff --git a/socially.js b/socially.js
deleted file mode 100644
index 4f8c65d..0000000
--- a/socially.js
+++ /dev/null
@@ -1,23 +0,0 @@
-if (Meteor.isClient) {
-  // counter starts at 0
-  Session.setDefault('counter', 0);
-
-  Template.hello.helpers({
-    counter: function () {
-      return Session.get('counter');
-    }
-  });
-
-  Template.hello.events({
-    'click button': function () {
-      // increment the counter when button is clicked
-      Session.set('counter', Session.get('counter') + 1);
-    }
-  });
-}
-
-if (Meteor.isServer) {
-  Meteor.startup(function () {
-    // code to run on server at startup
-  });
-}
-- 
2.3.2 (Apple Git-55)


From 5d22fc2a3bfda528dfa4dbcf8dcde9b4ee6f2980 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 14:23:47 +0300
Subject: [PATCH 003/262] Step 0.4: Create empty index.html file

---
 index.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 index.html

diff --git a/index.html b/index.html
new file mode 100644
index 0000000..ef412ef
--- /dev/null
+++ b/index.html
@@ -0,0 +1,3 @@
+<body>
+  <p>Nothing here</p>
+</body>
-- 
2.3.2 (Apple Git-55)


From 751fb02e71594e0a10b4bcb667c7c7647680156c Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 00:50:28 +0300
Subject: [PATCH 004/262] Step 0.5: Add the Angular package

---
 .meteor/packages |  1 +
 .meteor/release  |  2 +-
 .meteor/versions | 43 ++++++++++++++++++++++++-------------------
 3 files changed, 26 insertions(+), 20 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 2f62174..e1df899 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -16,3 +16,4 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
+angular@1.2.0-rc.3
diff --git a/.meteor/release b/.meteor/release
index 238bbcc..3a05e0a 100644
--- a/.meteor/release
+++ b/.meteor/release
@@ -1 +1 @@
-METEOR@1.2.0.1
+METEOR@1.2.1
diff --git a/.meteor/versions b/.meteor/versions
index e378b68..2225294 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,27 +1,31 @@
+angular@1.2.0-rc.3
+angular-meteor-data@0.0.1
+angular-templates@0.0.1
+angular:angular@1.4.7
 autopublish@1.0.4
-autoupdate@1.2.3
+autoupdate@1.2.4
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
 base64@1.0.4
 binary-heap@1.0.4
 blaze@2.1.3
-blaze-html-templates@1.0.1
 blaze-tools@1.0.4
 boilerplate-generator@1.0.4
 caching-compiler@1.0.0
-caching-html-compiler@1.0.1
+caching-html-compiler@1.0.2
 callback-hook@1.0.4
-check@1.0.6
+check@1.1.0
+dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
-ddp-common@1.2.1
-ddp-server@1.2.1
+ddp-common@1.2.2
+ddp-server@1.2.2
 deps@1.0.9
 diff-sequence@1.0.1
-ecmascript@0.1.4
-ecmascript-collections@0.1.6
+ecmascript@0.1.6
+ecmascript-runtime@0.2.6
 ejson@1.0.7
-es5-shim@4.1.13
+es5-shim@4.1.14
 fastclick@1.0.7
 geojson-utils@1.0.4
 hot-code-push@1.0.0
@@ -31,23 +35,25 @@ http@1.1.1
 id-map@1.0.4
 insecure@1.0.4
 jquery@1.11.4
+lai:collection-extensions@0.1.4
 launch-screen@1.0.4
 livedata@1.0.15
 logging@1.0.8
-meteor@1.1.7
+meteor@1.1.10
 meteor-base@1.0.1
 minifiers@1.1.7
-minimongo@1.0.9
+minimongo@1.0.10
 mobile-experience@1.0.1
 mobile-status-bar@1.0.6
-mongo@1.1.1
+mongo@1.1.3
 mongo-id@1.0.1
 npm-mongo@1.4.39_1
 observe-sequence@1.0.7
 ordered-dict@1.0.4
-promise@0.4.8
-random@1.0.4
-reactive-dict@1.1.1
+pbastowski:angular-babel@1.0.2
+promise@0.5.1
+random@1.0.5
+reactive-dict@1.1.3
 reactive-var@1.0.6
 reload@1.1.4
 retry@1.0.4
@@ -55,12 +61,11 @@ routepolicy@1.0.6
 session@1.1.1
 spacebars@1.0.7
 spacebars-compiler@1.0.7
-standard-minifiers@1.0.0
-templating@1.1.3
+standard-minifiers@1.0.2
 templating-tools@1.0.0
-tracker@1.0.8
+tracker@1.0.9
 ui@1.0.8
 underscore@1.0.4
 url@1.0.5
-webapp@1.2.2
+webapp@1.2.3
 webapp-hashing@1.0.5
-- 
2.3.2 (Apple Git-55)


From 9506565ee6a4f8dcef10fcc137b29e287429f66a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 16:47:59 +0300
Subject: [PATCH 005/262] Step 0.6: Move the main HTML content into main.html

---
 main.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 main.html

diff --git a/main.html b/main.html
new file mode 100644
index 0000000..79ed426
--- /dev/null
+++ b/main.html
@@ -0,0 +1 @@
+<p>Nothing here</p>
-- 
2.3.2 (Apple Git-55)


From 8065bc25cffd5d95bc83de2c4edea8bf72b5c1f2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 16:49:45 +0300
Subject: [PATCH 006/262] Step 0.7: Include the angular main file inside the
 index.html file

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index ef412ef..bd9a5a9 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
 <body>
-  <p>Nothing here</p>
+  <div ng-include="'main.html'"></div>
 </body>
-- 
2.3.2 (Apple Git-55)


From edce85e46e5d2e7147d0fa258d943901a44714ce Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:14:56 +0300
Subject: [PATCH 007/262] Step 0.8: Create app.js file to contain the AngularJS
 application

---
 app.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 app.js

diff --git a/app.js b/app.js
new file mode 100644
index 0000000..2465ea1
--- /dev/null
+++ b/app.js
@@ -0,0 +1,3 @@
+if (Meteor.isClient) {
+
+}
-- 
2.3.2 (Apple Git-55)


From 30c7cb6c713bfd7a2fa6c4ac4bda8f393d0cc4fc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:16:03 +0300
Subject: [PATCH 008/262] Step 0.9: Create AngularJS module and add
 angular-meteor dependency

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index 2465ea1..987f384 100644
--- a/app.js
+++ b/app.js
@@ -1,3 +1,3 @@
 if (Meteor.isClient) {
-
+  angular.module('socially',['angular-meteor']);
 }
-- 
2.3.2 (Apple Git-55)


From 11fb4297a61860a50927630b04855cf0fb144644 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:25:28 +0300
Subject: [PATCH 009/262] Step 0.10: Add ng-app

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index bd9a5a9..20c3218 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
-<body>
+<body ng-app="socially">
   <div ng-include="'main.html'"></div>
 </body>
-- 
2.3.2 (Apple Git-55)


From c054846898ef9f2067bb7992673e44315c4b243e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 17:31:28 +0300
Subject: [PATCH 010/262] Step 0.11: Add AngularJS code!

---
 main.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/main.html b/main.html
index 79ed426..a9c8ddc 100644
--- a/main.html
+++ b/main.html
@@ -1 +1 @@
-<p>Nothing here</p>
+<p>Nothing here {{ 'yet' + '!' }}</p>
-- 
2.3.2 (Apple Git-55)


From 0c3accc943409b2adf864e42b9f9f2377188fba4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:18:08 +0300
Subject: [PATCH 011/262] Step 1.1: Add some static HTML the to main page

---
 main.html | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/main.html b/main.html
index a9c8ddc..dd1ef68 100644
--- a/main.html
+++ b/main.html
@@ -1 +1,14 @@
-<p>Nothing here {{ 'yet' + '!' }}</p>
+<ul>
+  <li>
+    <span>Dubstep-Free Zone</span>
+    <p>
+      Can we please just for an evening not listen to dubstep.
+    </p>
+  </li>
+  <li>
+    <span>All dubstep all the time</span>
+    <p>
+      Get it on!
+    </p>
+  </li>
+</ul>
-- 
2.3.2 (Apple Git-55)


From a4a3a7e913c1fec3e656893052a996713ede703e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:20:42 +0300
Subject: [PATCH 012/262] Step 2.1: Use dynamic template instead of static

---
 main.html | 22 ++++++++--------------
 1 file changed, 8 insertions(+), 14 deletions(-)

diff --git a/main.html b/main.html
index dd1ef68..7f8c6d9 100644
--- a/main.html
+++ b/main.html
@@ -1,14 +1,8 @@
-<ul>
-  <li>
-    <span>Dubstep-Free Zone</span>
-    <p>
-      Can we please just for an evening not listen to dubstep.
-    </p>
-  </li>
-  <li>
-    <span>All dubstep all the time</span>
-    <p>
-      Get it on!
-    </p>
-  </li>
-</ul>
+<div ng-controller="PartiesListCtrl">
+  <ul>
+    <li ng-repeat="party in parties">
+      {{party.name}}
+      <p>{{party.description}}</p>
+    </li>
+  </ul>
+</div>
-- 
2.3.2 (Apple Git-55)


From 8775f0101ad1f81095517b3dc1930d76c7445960 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:22:53 +0300
Subject: [PATCH 013/262] Step 2.2: Add the parties controller

---
 app.js | 21 +++++++++++++++++++--
 1 file changed, 19 insertions(+), 2 deletions(-)

diff --git a/app.js b/app.js
index 987f384..9cbfb86 100644
--- a/app.js
+++ b/app.js
@@ -1,3 +1,20 @@
 if (Meteor.isClient) {
-  angular.module('socially',['angular-meteor']);
-}
+  angular.module('socially', ['angular-meteor']);
+
+  angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
+    $scope.parties = [
+      {
+        'name': 'Dubstep-Free Zone',
+        'description': 'Can we please just for an evening not listen to dubstep.'
+      },
+      {
+        'name': 'All dubstep all the time',
+        'description': 'Get it on!'
+      },
+      {
+        'name': 'Savage lounging',
+        'description': 'Leisure suit required. And only fiercest manners.'
+      }
+    ];
+  }]);
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 381e90bf2fa3bd2ae2a45d6eaa85f1d6d30b8a62 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 16 Oct 2015 18:32:53 +0300
Subject: [PATCH 014/262] Step 2.4: Remove the DI double decleration

---
 app.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/app.js b/app.js
index 9cbfb86..eaef6a3 100644
--- a/app.js
+++ b/app.js
@@ -1,7 +1,7 @@
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-  angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
+  angular.module('socially').controller('PartiesListCtrl', function ($scope) {
     $scope.parties = [
       {
         'name': 'Dubstep-Free Zone',
@@ -16,5 +16,5 @@ if (Meteor.isClient) {
         'description': 'Leisure suit required. And only fiercest manners.'
       }
     ];
-  }]);
+  });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1e52c5e6172b521658f77f65e1556fd3ffb9a31b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 22:15:32 +0300
Subject: [PATCH 015/262] Step 2.5: Add ng-strict-di directive to the ng-app

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index 20c3218..75c9100 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
-<body ng-app="socially">
+<body ng-app="socially" ng-strict-di="">
   <div ng-include="'main.html'"></div>
 </body>
-- 
2.3.2 (Apple Git-55)


From 24572f2f5620380032bb3d63f81ed046a91bafc1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:27:33 +0300
Subject: [PATCH 016/262] Step 3.1: Add the parties collection

---
 app.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/app.js b/app.js
index eaef6a3..89788bb 100644
--- a/app.js
+++ b/app.js
@@ -1,3 +1,5 @@
+Parties = new Mongo.Collection("parties");
+
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-- 
2.3.2 (Apple Git-55)


From 78f6e8d836e1de7fbc550e23f737a32af4aabaa0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:39:33 +0300
Subject: [PATCH 017/262] Step 3.2: Add the $meteor.collection to the $scope

---
 app.js | 17 ++---------------
 1 file changed, 2 insertions(+), 15 deletions(-)

diff --git a/app.js b/app.js
index 89788bb..5c2763d 100644
--- a/app.js
+++ b/app.js
@@ -3,20 +3,7 @@ Parties = new Mongo.Collection("parties");
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-  angular.module('socially').controller('PartiesListCtrl', function ($scope) {
-    $scope.parties = [
-      {
-        'name': 'Dubstep-Free Zone',
-        'description': 'Can we please just for an evening not listen to dubstep.'
-      },
-      {
-        'name': 'All dubstep all the time',
-        'description': 'Get it on!'
-      },
-      {
-        'name': 'Savage lounging',
-        'description': 'Leisure suit required. And only fiercest manners.'
-      }
-    ];
+  angular.module('socially').controller('PartiesListCtrl',function ($scope) {
+    $scope.parties = $meteor.collection(Parties);
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0e9e6c47030787fa5f2995f7ab05940f50b826f3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:40:05 +0300
Subject: [PATCH 018/262] Step 3.3: Add a dependency to $meteor

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index 5c2763d..89bb0f2 100644
--- a/app.js
+++ b/app.js
@@ -3,7 +3,7 @@ Parties = new Mongo.Collection("parties");
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-  angular.module('socially').controller('PartiesListCtrl',function ($scope) {
+  angular.module('socially').controller('PartiesListCtrl', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 3baba441318ad404508f6b0237faaa3c826ab335 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:43:17 +0300
Subject: [PATCH 019/262] Step 3.4: Add some data to the parties collection

---
 app.js    |  2 --
 server.js | 18 ++++++++++++++++++
 2 files changed, 18 insertions(+), 2 deletions(-)
 create mode 100644 server.js

diff --git a/app.js b/app.js
index 89bb0f2..da36506 100644
--- a/app.js
+++ b/app.js
@@ -1,5 +1,3 @@
-Parties = new Mongo.Collection("parties");
-
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
diff --git a/server.js b/server.js
new file mode 100644
index 0000000..3ce2ef4
--- /dev/null
+++ b/server.js
@@ -0,0 +1,18 @@
+Parties = new Mongo.Collection("parties");
+
+if (Meteor.isServer) {
+  Meteor.startup(function () {
+    if (Parties.find().count() === 0) {
+      var parties = [
+        {'name': 'Dubstep-Free Zone',
+          'description': 'Fast just got faster with Nexus S.'},
+        {'name': 'All dubstep all the time',
+          'description': 'Get it on!'},
+        {'name': 'Savage lounging',
+          'description': 'Leisure suit required. And only fiercest manners.'}
+      ];
+      for (var i = 0; i < parties.length; i++)
+        Parties.insert(parties[i]);
+    }
+  });
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 53aec84aad9f7e072845c8afd3e10e20a049a0a4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:49:37 +0300
Subject: [PATCH 020/262] Step 4.1: Add basic form to the view

---
 main.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/main.html b/main.html
index 7f8c6d9..4880315 100644
--- a/main.html
+++ b/main.html
@@ -1,4 +1,11 @@
 <div ng-controller="PartiesListCtrl">
+  <form>
+    <label>Name</label>
+    <input>
+    <label>Description</label>
+    <input>
+    <button>Add</button>
+  </form>
   <ul>
     <li ng-repeat="party in parties">
       {{party.name}}
-- 
2.3.2 (Apple Git-55)


From 5c78a3022acf7ef9e7e06af6cd146fd63baf1a5d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:50:38 +0300
Subject: [PATCH 021/262] Step 4.2: Add ng-model to the form's inputs

---
 main.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/main.html b/main.html
index 4880315..ea6dc8f 100644
--- a/main.html
+++ b/main.html
@@ -1,9 +1,9 @@
 <div ng-controller="PartiesListCtrl">
   <form>
     <label>Name</label>
-    <input>
+    <input ng-model="newParty.name">
     <label>Description</label>
-    <input>
+    <input ng-model="newParty.description">
     <button>Add</button>
   </form>
   <ul>
-- 
2.3.2 (Apple Git-55)


From 54aac1a4d2a58b440ba39751a1f97369eb53dadc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:51:15 +0300
Subject: [PATCH 022/262] Step 4.3: Add ng-click logic to the "Add" button

---
 main.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/main.html b/main.html
index ea6dc8f..d39fd36 100644
--- a/main.html
+++ b/main.html
@@ -4,7 +4,7 @@
     <input ng-model="newParty.name">
     <label>Description</label>
     <input ng-model="newParty.description">
-    <button>Add</button>
+    <button ng-click="parties.push(newParty); newParty='';">Add</button>
   </form>
   <ul>
     <li ng-repeat="party in parties">
-- 
2.3.2 (Apple Git-55)


From c1f0b5b0b03f635433eb908d17a610b6bd2595f1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:52:46 +0300
Subject: [PATCH 023/262] Step 4.4: Add delete button to the parties list

---
 main.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/main.html b/main.html
index d39fd36..614c3a0 100644
--- a/main.html
+++ b/main.html
@@ -10,6 +10,7 @@
     <li ng-repeat="party in parties">
       {{party.name}}
       <p>{{party.description}}</p>
+      <button ng-click="remove(party)">X</button>
     </li>
   </ul>
 </div>
-- 
2.3.2 (Apple Git-55)


From 8ccaa62b52d78e168bba36108be213285d332f80 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:53:55 +0300
Subject: [PATCH 024/262] Step 4.5: Add remove logic to the controller

---
 app.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/app.js b/app.js
index da36506..994968f 100644
--- a/app.js
+++ b/app.js
@@ -3,5 +3,9 @@ if (Meteor.isClient) {
 
   angular.module('socially').controller('PartiesListCtrl', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
+
+    $scope.remove = function(party){
+      $scope.parties.splice($scope.parties.indexOf(party), 1);
+    };
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From bcae010721d709a6b6d6d3620cf599b001b3e410 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:55:39 +0300
Subject: [PATCH 025/262] Step 4.6: Replace push with save

---
 main.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/main.html b/main.html
index 614c3a0..68ec2ac 100644
--- a/main.html
+++ b/main.html
@@ -4,7 +4,7 @@
     <input ng-model="newParty.name">
     <label>Description</label>
     <input ng-model="newParty.description">
-    <button ng-click="parties.push(newParty); newParty='';">Add</button>
+    <button ng-click="parties.save(newParty); newParty='';">Add</button>
   </form>
   <ul>
     <li ng-repeat="party in parties">
-- 
2.3.2 (Apple Git-55)


From a7b47ab022c6936164f3303dc912ae50f68ab9c4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 18:56:41 +0300
Subject: [PATCH 026/262] Step 4.7: Use remove function instead of splice

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index 994968f..30a428e 100644
--- a/app.js
+++ b/app.js
@@ -5,7 +5,7 @@ if (Meteor.isClient) {
     $scope.parties = $meteor.collection(Parties);
 
     $scope.remove = function(party){
-      $scope.parties.splice($scope.parties.indexOf(party), 1);
+      $scope.parties.remove(party);
     };
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From abd4a4ec5ad900c24c3df940951c7be529f0b3ca Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 00:37:46 +0200
Subject: [PATCH 027/262] Step 4.8: Add Remove All button

---
 main.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/main.html b/main.html
index 68ec2ac..5c567a8 100644
--- a/main.html
+++ b/main.html
@@ -5,6 +5,7 @@
     <label>Description</label>
     <input ng-model="newParty.description">
     <button ng-click="parties.save(newParty); newParty='';">Add</button>
+    <button ng-click="removeAll()">Remove All</button>
   </form>
   <ul>
     <li ng-repeat="party in parties">
-- 
2.3.2 (Apple Git-55)


From a58f5bcc770db5abec5d610ca9cc1550f6d6f953 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 00:38:03 +0200
Subject: [PATCH 028/262] Step 4.9: Add Remove All logic to the controller

---
 app.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/app.js b/app.js
index 30a428e..6ea7dce 100644
--- a/app.js
+++ b/app.js
@@ -7,5 +7,9 @@ if (Meteor.isClient) {
     $scope.remove = function(party){
       $scope.parties.remove(party);
     };
+
+    $scope.removeAll = function(){
+      $scope.parties.remove();
+    };
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c649cdf483ed9edfb10e3c786dd39726864320aa Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 5 Nov 2015 23:30:54 +0200
Subject: [PATCH 029/262] Step 5.1: Add angular-ui-router to the project

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index e1df899..421cc1c 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -17,3 +17,4 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
 angular@1.2.0-rc.3
+angularui:angular-ui-router
\ No newline at end of file
diff --git a/.meteor/versions b/.meteor/versions
index 2225294..8cab817 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -2,6 +2,7 @@ angular@1.2.0-rc.3
 angular-meteor-data@0.0.1
 angular-templates@0.0.1
 angular:angular@1.4.7
+angularui:angular-ui-router@0.2.15
 autopublish@1.0.4
 autoupdate@1.2.4
 babel-compiler@5.8.24_1
-- 
2.3.2 (Apple Git-55)


From 31e856ec905d28cf4797c1514107f325b5c1fb47 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:03:28 +0300
Subject: [PATCH 030/262] Step 5.2: Add angular-ui-router dependency

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index 6ea7dce..ce8c242 100644
--- a/app.js
+++ b/app.js
@@ -1,5 +1,5 @@
 if (Meteor.isClient) {
-  angular.module('socially', ['angular-meteor']);
+  angular.module('socially', ['angular-meteor', 'ui.router']);
 
   angular.module('socially').controller('PartiesListCtrl', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
-- 
2.3.2 (Apple Git-55)


From bc83ae008e84ffbf129f5eea5e4402c03ded049a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:08:18 +0300
Subject: [PATCH 031/262] Step 5.3: Create parties list page

---
 parties-list.html | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 parties-list.html

diff --git a/parties-list.html b/parties-list.html
new file mode 100644
index 0000000..28a1881
--- /dev/null
+++ b/parties-list.html
@@ -0,0 +1,15 @@
+<form>
+  <label>Name</label>
+  <input ng-model="newParty.name">
+  <label>Description</label>
+  <input ng-model="newParty.description">
+  <button ng-click="parties.push(newParty)">Add</button>
+  <button ng-click="removeAll()">Remove All</button>
+</form>
+<ul>
+  <li ng-repeat="party in parties">
+    <a href="/parties/{{party._id}}">{{party.name}}</a>
+    <p>{{party.description}}</p>
+    <button ng-click="remove(party)">X</button>
+  </li>
+</ul>
-- 
2.3.2 (Apple Git-55)


From 48a10df290b388302a03305b178a0ead3b8debe7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:09:27 +0300
Subject: [PATCH 032/262] Step 5.4: Update index.html

---
 index.html | 15 +++++++++++++--
 1 file changed, 13 insertions(+), 2 deletions(-)

diff --git a/index.html b/index.html
index 75c9100..5e2a395 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,14 @@
-<body ng-app="socially" ng-strict-di="">
-  <div ng-include="'main.html'"></div>
+<head>
+  <base href="/">
+</head>
+<body>
+
+<div ng-app="socially" ng-strict-di="">
+  <h1>
+    <a href="/parties">Home</a>
+  </h1>
+
+  <div ui-view></div>
+</div>
+
 </body>
-- 
2.3.2 (Apple Git-55)


From c64eb478da24024b5d0671d3bb4db1d9f25f07b3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:12:39 +0300
Subject: [PATCH 033/262] Step 5.5: Remove index.ng.html

---
 main.html | 17 -----------------
 1 file changed, 17 deletions(-)
 delete mode 100644 main.html

diff --git a/main.html b/main.html
deleted file mode 100644
index 5c567a8..0000000
--- a/main.html
+++ /dev/null
@@ -1,17 +0,0 @@
-<div ng-controller="PartiesListCtrl">
-  <form>
-    <label>Name</label>
-    <input ng-model="newParty.name">
-    <label>Description</label>
-    <input ng-model="newParty.description">
-    <button ng-click="parties.save(newParty); newParty='';">Add</button>
-    <button ng-click="removeAll()">Remove All</button>
-  </form>
-  <ul>
-    <li ng-repeat="party in parties">
-      {{party.name}}
-      <p>{{party.description}}</p>
-      <button ng-click="remove(party)">X</button>
-    </li>
-  </ul>
-</div>
-- 
2.3.2 (Apple Git-55)


From a21b901dd044f84db860013d2bac4d132990a741 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:12:51 +0300
Subject: [PATCH 034/262] Step 5.6: Create party details page

---
 party-details.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 party-details.html

diff --git a/party-details.html b/party-details.html
new file mode 100644
index 0000000..68fe7fe
--- /dev/null
+++ b/party-details.html
@@ -0,0 +1 @@
+Here you will see the details of party number: {{ partyId }}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0db1959ca546623797a181b6f21c14706ebef8f0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:16:01 +0300
Subject: [PATCH 035/262] Step 5.7: Add routes definitions

---
 app.js | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

diff --git a/app.js b/app.js
index ce8c242..7111d9a 100644
--- a/app.js
+++ b/app.js
@@ -1,6 +1,25 @@
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor', 'ui.router']);
 
+  angular.module('socially').config(function($urlRouterProvider, $stateProvider, $locationProvider){
+
+      $locationProvider.html5Mode(true);
+
+      $stateProvider
+        .state('parties', {
+          url: '/parties',
+          templateUrl: 'parties-list.html',
+          controller: 'PartiesListCtrl'
+        })
+        .state('partyDetails', {
+          url: '/parties/:partyId',
+          templateUrl: 'party-details.html',
+          controller: 'PartyDetailsCtrl'
+        });
+
+      $urlRouterProvider.otherwise("/parties");
+    });
+  
   angular.module('socially').controller('PartiesListCtrl', function ($scope, $meteor) {
     $scope.parties = $meteor.collection(Parties);
 
-- 
2.3.2 (Apple Git-55)


From 9249a50edec6946734f75dbed1ee51ee494fdfab Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:17:00 +0300
Subject: [PATCH 036/262] Step 5.8: Add party details controller

---
 app.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/app.js b/app.js
index 7111d9a..5bb75b5 100644
--- a/app.js
+++ b/app.js
@@ -31,4 +31,8 @@ if (Meteor.isClient) {
       $scope.parties.remove();
     };
   });
+
+  angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams) {
+    $scope.partyId = $stateParams.partyId;
+  });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 91e827dc5794ad1fb6f7f2cba2587f1bf3f67fb1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:41:12 +0300
Subject: [PATCH 037/262] Step 6.1: Add $meteor.object to the controller

---
 app.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/app.js b/app.js
index 5bb75b5..fab7d4d 100644
--- a/app.js
+++ b/app.js
@@ -32,7 +32,7 @@ if (Meteor.isClient) {
     };
   });
 
-  angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams) {
-    $scope.partyId = $stateParams.partyId;
+  angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams, $meteor) {
+    $scope.party = $meteor.object(Parties, $stateParams.partyId);
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From abb5a8504a43e6d6cb2d2bd3c5f65330f382eaba Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:44:09 +0300
Subject: [PATCH 038/262] Step 6.2: Add binding to the party details

---
 party-details.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/party-details.html b/party-details.html
index 68fe7fe..31f8472 100644
--- a/party-details.html
+++ b/party-details.html
@@ -1 +1,4 @@
-Here you will see the details of party number: {{ partyId }}
\ No newline at end of file
+Here you will see and change the details of the party:
+
+<input ng-model="party.name">
+<input ng-model="party.description">
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5943983e468fb20fac8e1cf43c618667111f5d6d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:46:20 +0300
Subject: [PATCH 039/262] Step 6.3: Add some buttons to the form

---
 party-details.html | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/party-details.html b/party-details.html
index 31f8472..52e92e7 100644
--- a/party-details.html
+++ b/party-details.html
@@ -1,4 +1,8 @@
 Here you will see and change the details of the party:
 
 <input ng-model="party.name">
-<input ng-model="party.description">
\ No newline at end of file
+<input ng-model="party.description">
+
+<button ng-click="save()">Save</button>
+<button ng-click="reset()">Reset form</button>
+<button ui-sref="parties">Cancel</button>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e1a69b4fd5581fd99a510f152bf8e61b6700e759 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:46:51 +0300
Subject: [PATCH 040/262] Step 6.4: Update the usage of $meteor.object

---
 app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.js b/app.js
index fab7d4d..a0ccc5c 100644
--- a/app.js
+++ b/app.js
@@ -33,6 +33,6 @@ if (Meteor.isClient) {
   });
 
   angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams, $meteor) {
-    $scope.party = $meteor.object(Parties, $stateParams.partyId);
+    $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 225c34fdfc7ba8afdda4b5f8a8dd571654d9a754 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:47:13 +0300
Subject: [PATCH 041/262] Step 6.5: Add logic to the controller

---
 app.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/app.js b/app.js
index a0ccc5c..630899d 100644
--- a/app.js
+++ b/app.js
@@ -34,5 +34,13 @@ if (Meteor.isClient) {
 
   angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams, $meteor) {
     $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
+
+    $scope.save = function() {
+      $scope.party.save();
+    };
+
+    $scope.reset = function() {
+      $scope.party.reset();
+    };
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 747fd19df6917244191f35e3dcebabd620ea9b5d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:48:18 +0300
Subject: [PATCH 042/262] Step 6.6: Full implementation of the controller logic

---
 app.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/app.js b/app.js
index 630899d..24bcff6 100644
--- a/app.js
+++ b/app.js
@@ -36,7 +36,11 @@ if (Meteor.isClient) {
     $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
 
     $scope.save = function() {
-      $scope.party.save();
+      $scope.party.save().then(function(numberOfDocs){
+        console.log('save success doc affected ', numberOfDocs);
+      }, function(error){
+        console.log('save error', error);
+      });
     };
 
     $scope.reset = function() {
-- 
2.3.2 (Apple Git-55)


From c7cd3405a9d54a9aa8c91248bdf73a2375f54b86 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 19:54:24 +0300
Subject: [PATCH 043/262] Step 7.1: client/lib/app.js

---
 client/lib/app.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/lib/app.js

diff --git a/client/lib/app.js b/client/lib/app.js
new file mode 100644
index 0000000..999bdc1
--- /dev/null
+++ b/client/lib/app.js
@@ -0,0 +1 @@
+angular.module('socially',['angular-meteor', 'ui.router']);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9a1cb3de33225aa032b352683d02ea8983bdd7a7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:00:58 +0300
Subject: [PATCH 044/262] Step 7.2: model/parties.js

---
 model/parties.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 model/parties.js

diff --git a/model/parties.js b/model/parties.js
new file mode 100644
index 0000000..dc0ccc3
--- /dev/null
+++ b/model/parties.js
@@ -0,0 +1 @@
+Parties = new Mongo.Collection("parties");
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cfbe8fd56a23b2bd1ad9bb3baa5767ba2d601e85 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:04:29 +0300
Subject: [PATCH 045/262] Step 7.3: server/startup/loadParties.js

---
 server/startup/loadParties.js | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 create mode 100644 server/startup/loadParties.js

diff --git a/server/startup/loadParties.js b/server/startup/loadParties.js
new file mode 100644
index 0000000..8d3780e
--- /dev/null
+++ b/server/startup/loadParties.js
@@ -0,0 +1,14 @@
+Meteor.startup(function () {
+  if (Parties.find().count() === 0) {
+    var parties = [
+      {'name': 'Dubstep-Free Zone',
+        'description': 'Fast just got faster with Nexus S.'},
+      {'name': 'All dubstep all the time',
+        'description': 'Get it on!'},
+      {'name': 'Savage lounging',
+        'description': 'Leisure suit required. And only fiercest manners.'}
+    ];
+    for (var i = 0; i < parties.length; i++)
+      Parties.insert({name: parties[i].name, description: parties[i].description});
+  }
+});
-- 
2.3.2 (Apple Git-55)


From 98de8e5593aec9fb70a46430b9f3e25427eab779 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:06:09 +0300
Subject: [PATCH 046/262] Step 7.4: client/routes.js

---
 client/routes.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
 create mode 100644 client/routes.js

diff --git a/client/routes.js b/client/routes.js
new file mode 100644
index 0000000..cb5bd31
--- /dev/null
+++ b/client/routes.js
@@ -0,0 +1,17 @@
+angular.module("socially").config(function ($urlRouterProvider, $stateProvider, $locationProvider) {
+  $locationProvider.html5Mode(true);
+
+  $stateProvider
+    .state('parties', {
+      url: '/parties',
+      templateUrl: 'parties-list.html',
+      controller: 'PartiesListCtrl'
+    })
+    .state('partyDetails', {
+      url: '/parties/:partyId',
+      templateUrl: 'party-details.html',
+      controller: 'PartyDetailsCtrl'
+    });
+
+  $urlRouterProvider.otherwise("/parties");
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b08f33e219e4a7c7871ce2f8fab1e371f8b6ec82 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:07:25 +0300
Subject: [PATCH 047/262] Step 7.5: client/parties/controllers/partiesList.js

---
 client/parties/controllers/partiesList.js | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 client/parties/controllers/partiesList.js

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
new file mode 100644
index 0000000..ef2c64f
--- /dev/null
+++ b/client/parties/controllers/partiesList.js
@@ -0,0 +1,11 @@
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor) {
+  $scope.parties = $meteor.collection(Parties);
+
+  $scope.remove = function (party) {
+    $scope.parties.splice($scope.parties.indexOf(party), 1);
+  };
+
+  $scope.removeAll = function () {
+    $scope.parties.remove();
+  };
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 766f999ba5e75a223fd3ef40758dd1c152fc1935 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:08:05 +0300
Subject: [PATCH 048/262] Step 7.6: client/parties/controllers/partyDetails.js

---
 client/parties/controllers/partyDetails.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 client/parties/controllers/partyDetails.js

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
new file mode 100644
index 0000000..a46e036
--- /dev/null
+++ b/client/parties/controllers/partyDetails.js
@@ -0,0 +1,3 @@
+angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $stateParams, $meteor) {
+  $scope.party = $meteor.object(Parties, $stateParams.partyId);
+});
-- 
2.3.2 (Apple Git-55)


From 317f0d065ab194466976d0df6e981cbd25d26919 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:10:21 +0300
Subject: [PATCH 049/262] Step 7.7: Move index.html

---
 client/index.html | 14 ++++++++++++++
 index.html        | 14 --------------
 2 files changed, 14 insertions(+), 14 deletions(-)
 create mode 100644 client/index.html
 delete mode 100644 index.html

diff --git a/client/index.html b/client/index.html
new file mode 100644
index 0000000..5e2a395
--- /dev/null
+++ b/client/index.html
@@ -0,0 +1,14 @@
+<head>
+  <base href="/">
+</head>
+<body>
+
+<div ng-app="socially" ng-strict-di="">
+  <h1>
+    <a href="/parties">Home</a>
+  </h1>
+
+  <div ui-view></div>
+</div>
+
+</body>
diff --git a/index.html b/index.html
deleted file mode 100644
index 5e2a395..0000000
--- a/index.html
+++ /dev/null
@@ -1,14 +0,0 @@
-<head>
-  <base href="/">
-</head>
-<body>
-
-<div ng-app="socially" ng-strict-di="">
-  <h1>
-    <a href="/parties">Home</a>
-  </h1>
-
-  <div ui-view></div>
-</div>
-
-</body>
-- 
2.3.2 (Apple Git-55)


From baef348c809d7ccef15b790981887c54dce08618 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:11:30 +0300
Subject: [PATCH 050/262] Step 7.8: Move to
 client/parties/views/parties-list.html

---
 client/parties/views/parties-list.html | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 client/parties/views/parties-list.html

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
new file mode 100644
index 0000000..2b64715
--- /dev/null
+++ b/client/parties/views/parties-list.html
@@ -0,0 +1,15 @@
+<form>
+  <label>Name</label>
+  <input ng-model="newParty.name">
+  <label>Description</label>
+  <input ng-model="newParty.description">
+  <button ng-click="parties.push(newParty)">Add</button>
+  <button ng-click="removeAll()">Remove All</button>
+</form>
+<ul>
+  <li ng-repeat="party in parties">
+    <a href="/parties/{{party._id}}">{{party.name}}</a>
+    <p>{{party.description}}</p>
+    <button ng-click="remove(party)">X</button>
+  </li>
+</ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d06536b8b59867b6697351189454476cf16efc07 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:09:03 +0300
Subject: [PATCH 051/262] Step 7.9: Move party-details.html view

---
 client/parties/views/party-details.html | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 client/parties/views/party-details.html

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
new file mode 100644
index 0000000..31f8472
--- /dev/null
+++ b/client/parties/views/party-details.html
@@ -0,0 +1,4 @@
+Here you will see and change the details of the party:
+
+<input ng-model="party.name">
+<input ng-model="party.description">
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 469d7f2c34a7adfa31faa8ab2139124dd414bd26 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:09:22 +0300
Subject: [PATCH 052/262] Step 7.10: Update routes file

---
 client/routes.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/routes.js b/client/routes.js
index cb5bd31..aa2824f 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -4,12 +4,12 @@ angular.module("socially").config(function ($urlRouterProvider, $stateProvider,
   $stateProvider
     .state('parties', {
       url: '/parties',
-      templateUrl: 'parties-list.html',
+      templateUrl: 'client/parties/views/parties-list.html',
       controller: 'PartiesListCtrl'
     })
     .state('partyDetails', {
       url: '/parties/:partyId',
-      templateUrl: 'party-details.html',
+      templateUrl: 'client/parties/views/party-details.html',
       controller: 'PartyDetailsCtrl'
     });
 
-- 
2.3.2 (Apple Git-55)


From e238ae20896ef83b13f0e303999c59654e1ffb64 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 5 Nov 2015 23:32:44 +0200
Subject: [PATCH 053/262] Step 7.11: Delete remaining files

---
 app.js             | 50 --------------------------------------------------
 parties-list.html  | 15 ---------------
 party-details.html |  8 --------
 server.js          | 18 ------------------
 4 files changed, 91 deletions(-)
 delete mode 100644 app.js
 delete mode 100644 parties-list.html
 delete mode 100644 party-details.html
 delete mode 100644 server.js

diff --git a/app.js b/app.js
deleted file mode 100644
index 24bcff6..0000000
--- a/app.js
+++ /dev/null
@@ -1,50 +0,0 @@
-if (Meteor.isClient) {
-  angular.module('socially', ['angular-meteor', 'ui.router']);
-
-  angular.module('socially').config(function($urlRouterProvider, $stateProvider, $locationProvider){
-
-      $locationProvider.html5Mode(true);
-
-      $stateProvider
-        .state('parties', {
-          url: '/parties',
-          templateUrl: 'parties-list.html',
-          controller: 'PartiesListCtrl'
-        })
-        .state('partyDetails', {
-          url: '/parties/:partyId',
-          templateUrl: 'party-details.html',
-          controller: 'PartyDetailsCtrl'
-        });
-
-      $urlRouterProvider.otherwise("/parties");
-    });
-  
-  angular.module('socially').controller('PartiesListCtrl', function ($scope, $meteor) {
-    $scope.parties = $meteor.collection(Parties);
-
-    $scope.remove = function(party){
-      $scope.parties.remove(party);
-    };
-
-    $scope.removeAll = function(){
-      $scope.parties.remove();
-    };
-  });
-
-  angular.module("socially").controller("PartyDetailsCtrl", function($scope, $stateParams, $meteor) {
-    $scope.party = $meteor.object(Parties, $stateParams.partyId, false);
-
-    $scope.save = function() {
-      $scope.party.save().then(function(numberOfDocs){
-        console.log('save success doc affected ', numberOfDocs);
-      }, function(error){
-        console.log('save error', error);
-      });
-    };
-
-    $scope.reset = function() {
-      $scope.party.reset();
-    };
-  });
-}
\ No newline at end of file
diff --git a/parties-list.html b/parties-list.html
deleted file mode 100644
index 28a1881..0000000
--- a/parties-list.html
+++ /dev/null
@@ -1,15 +0,0 @@
-<form>
-  <label>Name</label>
-  <input ng-model="newParty.name">
-  <label>Description</label>
-  <input ng-model="newParty.description">
-  <button ng-click="parties.push(newParty)">Add</button>
-  <button ng-click="removeAll()">Remove All</button>
-</form>
-<ul>
-  <li ng-repeat="party in parties">
-    <a href="/parties/{{party._id}}">{{party.name}}</a>
-    <p>{{party.description}}</p>
-    <button ng-click="remove(party)">X</button>
-  </li>
-</ul>
diff --git a/party-details.html b/party-details.html
deleted file mode 100644
index 52e92e7..0000000
--- a/party-details.html
+++ /dev/null
@@ -1,8 +0,0 @@
-Here you will see and change the details of the party:
-
-<input ng-model="party.name">
-<input ng-model="party.description">
-
-<button ng-click="save()">Save</button>
-<button ng-click="reset()">Reset form</button>
-<button ui-sref="parties">Cancel</button>
\ No newline at end of file
diff --git a/server.js b/server.js
deleted file mode 100644
index 3ce2ef4..0000000
--- a/server.js
+++ /dev/null
@@ -1,18 +0,0 @@
-Parties = new Mongo.Collection("parties");
-
-if (Meteor.isServer) {
-  Meteor.startup(function () {
-    if (Parties.find().count() === 0) {
-      var parties = [
-        {'name': 'Dubstep-Free Zone',
-          'description': 'Fast just got faster with Nexus S.'},
-        {'name': 'All dubstep all the time',
-          'description': 'Get it on!'},
-        {'name': 'Savage lounging',
-          'description': 'Leisure suit required. And only fiercest manners.'}
-      ];
-      for (var i = 0; i < parties.length; i++)
-        Parties.insert(parties[i]);
-    }
-  });
-}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e2b3b657758852bd01d1a9673a21e3b67cbfb708 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 5 Nov 2015 23:34:29 +0200
Subject: [PATCH 054/262] Step 8.1: Remove insecure package

---
 .meteor/packages | 3 +--
 .meteor/versions | 1 -
 2 files changed, 1 insertion(+), 3 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 421cc1c..6a70cbc 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -15,6 +15,5 @@ standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 
 autopublish             # Publish all data to the clients (for prototyping)
-insecure                # Allow all DB writes from clients (for prototyping)
 angular@1.2.0-rc.3
-angularui:angular-ui-router
\ No newline at end of file
+angularui:angular-ui-router
diff --git a/.meteor/versions b/.meteor/versions
index 8cab817..3a77ec7 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -34,7 +34,6 @@ html-tools@1.0.5
 htmljs@1.0.5
 http@1.1.1
 id-map@1.0.4
-insecure@1.0.4
 jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
-- 
2.3.2 (Apple Git-55)


From e579a3a11b1d9d868d0dc7003d67790c4468b464 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 5 Nov 2015 23:35:01 +0200
Subject: [PATCH 055/262] Step 8.2: Add accounts-password package

---
 .meteor/packages |  1 +
 .meteor/versions | 10 ++++++++++
 2 files changed, 11 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 6a70cbc..7160c13 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -17,3 +17,4 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 autopublish             # Publish all data to the clients (for prototyping)
 angular@1.2.0-rc.3
 angularui:angular-ui-router
+accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index 3a77ec7..f1ff243 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,5 @@
+accounts-base@1.2.2
+accounts-password@1.1.4
 angular@1.2.0-rc.3
 angular-meteor-data@0.0.1
 angular-templates@0.0.1
@@ -20,12 +22,14 @@ dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
 ddp-common@1.2.2
+ddp-rate-limiter@1.0.0
 ddp-server@1.2.2
 deps@1.0.9
 diff-sequence@1.0.1
 ecmascript@0.1.6
 ecmascript-runtime@0.2.6
 ejson@1.0.7
+email@1.0.8
 es5-shim@4.1.14
 fastclick@1.0.7
 geojson-utils@1.0.4
@@ -38,6 +42,7 @@ jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
 livedata@1.0.15
+localstorage@1.0.5
 logging@1.0.8
 meteor@1.1.10
 meteor-base@1.0.1
@@ -47,20 +52,25 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.3
 mongo-id@1.0.1
+npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.2
 promise@0.5.1
 random@1.0.5
+rate-limit@1.0.0
 reactive-dict@1.1.3
 reactive-var@1.0.6
 reload@1.1.4
 retry@1.0.4
 routepolicy@1.0.6
+service-configuration@1.0.5
 session@1.1.1
+sha@1.0.4
 spacebars@1.0.7
 spacebars-compiler@1.0.7
+srp@1.0.4
 standard-minifiers@1.0.2
 templating-tools@1.0.0
 tracker@1.0.9
-- 
2.3.2 (Apple Git-55)


From fb9f66f9a98bbcbc4f24870b9cbc710ebc02daf0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 5 Nov 2015 23:08:17 +0200
Subject: [PATCH 056/262] Step 8.3: Add accounts-ui-angular package to the
 project

---
 .meteor/packages | 1 +
 .meteor/versions | 6 ++++++
 2 files changed, 7 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 7160c13..31a15ce 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,3 +18,4 @@ autopublish             # Publish all data to the clients (for prototyping)
 angular@1.2.0-rc.3
 angularui:angular-ui-router
 accounts-password
+dotansimha:accounts-ui-angular
diff --git a/.meteor/versions b/.meteor/versions
index f1ff243..02be783 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,7 @@
 accounts-base@1.2.2
 accounts-password@1.1.4
+accounts-ui@1.1.6
+accounts-ui-unstyled@1.1.8
 angular@1.2.0-rc.3
 angular-meteor-data@0.0.1
 angular-templates@0.0.1
@@ -12,6 +14,7 @@ babel-runtime@0.1.4
 base64@1.0.4
 binary-heap@1.0.4
 blaze@2.1.3
+blaze-html-templates@1.0.1
 blaze-tools@1.0.4
 boilerplate-generator@1.0.4
 caching-compiler@1.0.0
@@ -26,6 +29,7 @@ ddp-rate-limiter@1.0.0
 ddp-server@1.2.2
 deps@1.0.9
 diff-sequence@1.0.1
+dotansimha:accounts-ui-angular@0.0.1
 ecmascript@0.1.6
 ecmascript-runtime@0.2.6
 ejson@1.0.7
@@ -41,6 +45,7 @@ id-map@1.0.4
 jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
+less@2.5.1
 livedata@1.0.15
 localstorage@1.0.5
 logging@1.0.8
@@ -72,6 +77,7 @@ spacebars@1.0.7
 spacebars-compiler@1.0.7
 srp@1.0.4
 standard-minifiers@1.0.2
+templating@1.1.5
 templating-tools@1.0.0
 tracker@1.0.9
 ui@1.0.8
-- 
2.3.2 (Apple Git-55)


From aafb66a329eca9eb18666e1f6fcef5b95af8edd5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 5 Nov 2015 22:34:41 +0200
Subject: [PATCH 057/262] Step 8.4: Add a dependency to accounts.ui module

---
 client/lib/app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 999bdc1..6d0ace5 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1 +1 @@
-angular.module('socially',['angular-meteor', 'ui.router']);
\ No newline at end of file
+angular.module('socially',['angular-meteor', 'ui.router', 'accounts.ui']);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a0fb3933ca84b0168bc1437a7c3aa0ae78a04d47 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 5 Nov 2015 22:35:15 +0200
Subject: [PATCH 058/262] Step 8.5: Add usage of the login-buttons directive

---
 client/index.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/index.html b/client/index.html
index 5e2a395..9d3ee8a 100644
--- a/client/index.html
+++ b/client/index.html
@@ -4,6 +4,7 @@
 <body>
 
 <div ng-app="socially" ng-strict-di="">
+  <login-buttons></login-buttons>
   <h1>
     <a href="/parties">Home</a>
   </h1>
-- 
2.3.2 (Apple Git-55)


From 470a6f225154cd3d17ce235baba15701d089bba0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:29:32 +0300
Subject: [PATCH 059/262] Step 8.6: Add allow logic to the model

---
 model/parties.js | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/model/parties.js b/model/parties.js
index dc0ccc3..b793c1f 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -1 +1,13 @@
-Parties = new Mongo.Collection("parties");
\ No newline at end of file
+Parties = new Mongo.Collection("parties");
+
+Parties.allow({
+  insert: function (userId, party) {
+    return userId && party.owner === userId;
+  },
+  update: function (userId, party, fields, modifier) {
+    return userId && party.owner === userId;
+  },
+  remove: function (userId, party) {
+    return userId && party.owner === userId;
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4c82bd4799772581bde9fb9fbbe3b8d0d87e0080 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:34:30 +0300
Subject: [PATCH 060/262] Step 8.7: Add current user to the new party

---
 client/parties/views/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 2b64715..9453b78 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -3,7 +3,7 @@
   <input ng-model="newParty.name">
   <label>Description</label>
   <input ng-model="newParty.description">
-  <button ng-click="parties.push(newParty)">Add</button>
+  <button ng-click="newParty.owner=$root.currentUser._id; parties.save(newParty)">Add</button>
   <button ng-click="removeAll()">Remove All</button>
 </form>
 <ul>
-- 
2.3.2 (Apple Git-55)


From 0637e60cdf2f9de0142d3673e18b9e771bf0ab2a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:15:06 +0300
Subject: [PATCH 061/262] Step 8.8: Add accounts-facebook accounts-twitter
 packages

---
 .meteor/packages | 2 ++
 .meteor/versions | 8 ++++++++
 2 files changed, 10 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 31a15ce..2c41414 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,5 @@ angular@1.2.0-rc.3
 angularui:angular-ui-router
 accounts-password
 dotansimha:accounts-ui-angular
+accounts-facebook
+accounts-twitter
diff --git a/.meteor/versions b/.meteor/versions
index 02be783..7c88f93 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,8 @@
 accounts-base@1.2.2
+accounts-facebook@1.0.6
+accounts-oauth@1.1.8
 accounts-password@1.1.4
+accounts-twitter@1.0.6
 accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
 angular@1.2.0-rc.3
@@ -35,6 +38,7 @@ ecmascript-runtime@0.2.6
 ejson@1.0.7
 email@1.0.8
 es5-shim@4.1.14
+facebook@1.2.2
 fastclick@1.0.7
 geojson-utils@1.0.4
 hot-code-push@1.0.0
@@ -59,6 +63,9 @@ mongo@1.1.3
 mongo-id@1.0.1
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
+oauth@1.1.6
+oauth1@1.1.5
+oauth2@1.1.5
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.2
@@ -80,6 +87,7 @@ standard-minifiers@1.0.2
 templating@1.1.5
 templating-tools@1.0.0
 tracker@1.0.9
+twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
 url@1.0.5
-- 
2.3.2 (Apple Git-55)


From 71390b27c3813f6c4cac2e684814cedd76f012f8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:18:06 +0300
Subject: [PATCH 062/262] Step 8.9: Add resolve logic to the routes

---
 client/routes.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/client/routes.js b/client/routes.js
index aa2824f..21cb9d0 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -10,7 +10,12 @@ angular.module("socially").config(function ($urlRouterProvider, $stateProvider,
     .state('partyDetails', {
       url: '/parties/:partyId',
       templateUrl: 'client/parties/views/party-details.html',
-      controller: 'PartyDetailsCtrl'
+      controller: 'PartyDetailsCtrl',
+      resolve: {
+        "currentUser": function ($meteor) {
+          return $meteor.requireUser();
+        }
+      }
     });
 
   $urlRouterProvider.otherwise("/parties");
-- 
2.3.2 (Apple Git-55)


From 0d0e4df37818c0bedf302c87eea943d0c023f14b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:18:27 +0300
Subject: [PATCH 063/262] Step 8.10: Add authentication logic to the routes

---
 client/routes.js | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/routes.js b/client/routes.js
index 21cb9d0..b48fe70 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -1,3 +1,13 @@
+angular.module("socially").run(function ($rootScope, $state) {
+  $rootScope.$on('$stateChangeError', function (event, toState, toParams, fromState, fromParams, error) {
+    // We can catch the error thrown when the $requireUser promise is rejected
+    // and redirect the user back to the main page
+    if (error === 'AUTH_REQUIRED') {
+      $state.go('parties');
+    }
+  });
+});
+
 angular.module("socially").config(function ($urlRouterProvider, $stateProvider, $locationProvider) {
   $locationProvider.html5Mode(true);
 
-- 
2.3.2 (Apple Git-55)


From ecdd189e9101ef5611fcac169067497e7c5d1120 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:27:21 +0300
Subject: [PATCH 064/262] Step 9.1: Remove the autopublish package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 2c41414..c1e6c5e 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -14,7 +14,6 @@ tracker                 # Meteor's client-side reactive programming library
 standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 
-autopublish             # Publish all data to the clients (for prototyping)
 angular@1.2.0-rc.3
 angularui:angular-ui-router
 accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index 7c88f93..4a7fd61 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -10,7 +10,6 @@ angular-meteor-data@0.0.1
 angular-templates@0.0.1
 angular:angular@1.4.7
 angularui:angular-ui-router@0.2.15
-autopublish@1.0.4
 autoupdate@1.2.4
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
-- 
2.3.2 (Apple Git-55)


From 347386bb5a25608c418f7fade72d51535284a93c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 20:50:23 +0300
Subject: [PATCH 065/262] Step 9.2: Usage of publish method

---
 server/parties.js | 13 +++++++++++++
 1 file changed, 13 insertions(+)
 create mode 100644 server/parties.js

diff --git a/server/parties.js b/server/parties.js
new file mode 100644
index 0000000..277f09a
--- /dev/null
+++ b/server/parties.js
@@ -0,0 +1,13 @@
+Meteor.publish("parties", function () {
+  return Parties.find({
+    $or:[
+      {$and:[
+        {"public": true},
+        {"public": {$exists: true}}
+      ]},
+      {$and:[
+        {owner: this.userId},
+        {owner: {$exists: true}}
+      ]}
+    ]});
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6c59cf0bf44c4506c73196380f383cb71879ab80 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 17:44:37 +0300
Subject: [PATCH 066/262] Step 9.3: Add subscription for parties

---
 client/parties/controllers/partiesList.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index ef2c64f..34e0d55 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,5 +1,5 @@
 angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor) {
-  $scope.parties = $meteor.collection(Parties);
+  $scope.parties = $meteor.collection(Parties).subscribe('parties');
 
   $scope.remove = function (party) {
     $scope.parties.splice($scope.parties.indexOf(party), 1);
-- 
2.3.2 (Apple Git-55)


From a3dcf91d1227e5bb3286e116f0c0943b9c9767e2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:00:41 +0300
Subject: [PATCH 067/262] Step 9.4: Add checkbox for public party

---
 client/parties/views/parties-list.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 9453b78..e0f11ea 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -3,6 +3,8 @@
   <input ng-model="newParty.name">
   <label>Description</label>
   <input ng-model="newParty.description">
+  <label>Public</label>
+  <input type="checkbox" ng-model="newParty.public">
   <button ng-click="newParty.owner=$root.currentUser._id; parties.save(newParty)">Add</button>
   <button ng-click="removeAll()">Remove All</button>
 </form>
-- 
2.3.2 (Apple Git-55)


From e822066a5e878ea09acfc7142cb092226ed54996 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:03:38 +0300
Subject: [PATCH 068/262] Step 9.5: Add checkbox for public party in the
 details

---
 client/parties/views/party-details.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index 31f8472..f798477 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -1,4 +1,6 @@
 Here you will see and change the details of the party:
 
 <input ng-model="party.name">
-<input ng-model="party.description">
\ No newline at end of file
+<input ng-model="party.description">
+<label>Is public</label>
+<input type="checkbox" ng-model="party.public">
-- 
2.3.2 (Apple Git-55)


From c9e729d46d4f8035ded29e6c81057c4abfbfa3e8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 17:49:40 +0300
Subject: [PATCH 069/262] Step 9.6: Create the users publication in the server

---
 server/users.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 server/users.js

diff --git a/server/users.js b/server/users.js
new file mode 100644
index 0000000..f5becea
--- /dev/null
+++ b/server/users.js
@@ -0,0 +1,3 @@
+Meteor.publish("users", function () {
+  return Meteor.users.find({}, {fields: {emails: 1, profile: 1}});
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 269bda8646d446efae0a0193d55438cbdde2bccd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 17:52:46 +0300
Subject: [PATCH 070/262] Step 9.7: Add subscription to users

---
 client/parties/controllers/partyDetails.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index a46e036..7d31eb1 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -1,3 +1,4 @@
 angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $stateParams, $meteor) {
   $scope.party = $meteor.object(Parties, $stateParams.partyId);
-});
+  $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9ca96d78591dcfc592d51f025488b624eb013e49 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 17:53:01 +0300
Subject: [PATCH 071/262] Step 9.8: Add subscription to parties

---
 client/parties/controllers/partyDetails.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 7d31eb1..2d9322e 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -1,4 +1,4 @@
 angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $stateParams, $meteor) {
-  $scope.party = $meteor.object(Parties, $stateParams.partyId);
+  $scope.party = $meteor.object(Parties, $stateParams.partyId).subscribe('parties');
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 819e90fec584fcda2e064e6a1b034fa51220c88b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:09:09 +0300
Subject: [PATCH 072/262] Step 9.9: Add the user details

---
 client/parties/views/party-details.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index f798477..a640092 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -4,3 +4,10 @@ Here you will see and change the details of the party:
 <input ng-model="party.description">
 <label>Is public</label>
 <input type="checkbox" ng-model="party.public">
+
+<ul>
+  Users:
+  <li ng-repeat="user in users">
+    <div>{{ user.emails[0].address }}</div>
+  </li>
+</ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c4dc86341fce55843fe3cb6d2adf7bce95ea5552 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:13:54 +0300
Subject: [PATCH 073/262] Step 11.1: Update the module initialization

---
 client/lib/app.js | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 6d0ace5..651ffb3 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1 +1,12 @@
-angular.module('socially',['angular-meteor', 'ui.router', 'accounts.ui']);
\ No newline at end of file
+angular.module('socially',['angular-meteor', 'ui.router', 'accounts.ui']);
+
+function onReady() {
+  angular.bootstrap(document, ['socially'], {
+    strictDi: true
+  });
+}
+
+if (Meteor.isCordova)
+  angular.element(document).on("deviceready", onReady);
+else
+  angular.element(document).ready(onReady);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From fd2593d8588301c1450dda16eece255cdafac1ca Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:16:29 +0300
Subject: [PATCH 074/262] Step 11.2: Remove the ng-app directive

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 9d3ee8a..66bd59f 100644
--- a/client/index.html
+++ b/client/index.html
@@ -3,7 +3,7 @@
 </head>
 <body>
 
-<div ng-app="socially" ng-strict-di="">
+<div>
   <login-buttons></login-buttons>
   <h1>
     <a href="/parties">Home</a>
-- 
2.3.2 (Apple Git-55)


From 6508dece126e27b5fa60fc573b8f13ec51939be7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:32:39 +0300
Subject: [PATCH 075/262] Step 12.1: Add the parties publish

---
 server/parties.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/server/parties.js b/server/parties.js
index 277f09a..663bcd8 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,4 @@
-Meteor.publish("parties", function () {
+Meteor.publish("parties", function (options) {
   return Parties.find({
     $or:[
       {$and:[
@@ -9,5 +9,5 @@ Meteor.publish("parties", function () {
         {owner: this.userId},
         {owner: {$exists: true}}
       ]}
-    ]});
+    ]}, options);
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 399e1dc64cf204e2429c49402405a60de2d7d239 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:33:21 +0300
Subject: [PATCH 076/262] Step 12.2: Add pagination and sort scope params

---
 client/parties/controllers/partiesList.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 34e0d55..6f4d8f6 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,6 +1,10 @@
 angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor) {
   $scope.parties = $meteor.collection(Parties).subscribe('parties');
 
+  $scope.page = 1;
+  $scope.perPage = 3;
+  $scope.sort = {name: 1};
+
   $scope.remove = function (party) {
     $scope.parties.splice($scope.parties.indexOf(party), 1);
   };
-- 
2.3.2 (Apple Git-55)


From 489ccd7ea435ac4061b4425aa73ee644e4f638b9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:33:49 +0300
Subject: [PATCH 077/262] Step 12.3: Add parties subscription

---
 client/parties/controllers/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 6f4d8f6..f89772c 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -5,6 +5,8 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.perPage = 3;
   $scope.sort = {name: 1};
 
+  $meteor.subscribe('parties');
+
   $scope.remove = function (party) {
     $scope.parties.splice($scope.parties.indexOf(party), 1);
   };
-- 
2.3.2 (Apple Git-55)


From 041a2b912677a9fbdc9e71c15b47c50943d1bc46 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:34:10 +0300
Subject: [PATCH 078/262] Step 12.4: Add the params to the subscription

---
 client/parties/controllers/partiesList.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index f89772c..bf8cce4 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -5,7 +5,11 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.perPage = 3;
   $scope.sort = {name: 1};
 
-  $meteor.subscribe('parties');
+  $meteor.subscribe('parties', {
+    limit: parseInt($scope.perPage),
+    skip: parseInt(($scope.page - 1) * $scope.perPage),
+    sort: $scope.sort
+  });
 
   $scope.remove = function (party) {
     $scope.parties.splice($scope.parties.indexOf(party), 1);
-- 
2.3.2 (Apple Git-55)


From adb53e6b5819de7452534dcd2c085f436a050d82 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:34:38 +0300
Subject: [PATCH 079/262] Step 12.5: Use cursor in the parties collection

---
 client/parties/controllers/partiesList.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index bf8cce4..d784995 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,10 +1,15 @@
 angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor) {
-  $scope.parties = $meteor.collection(Parties).subscribe('parties');
 
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
 
+  $scope.parties = $meteor.collection(function() {
+    return Parties.find({}, {
+      sort : $scope.sort
+    });
+  });
+
   $meteor.subscribe('parties', {
     limit: parseInt($scope.perPage),
     skip: parseInt(($scope.page - 1) * $scope.perPage),
-- 
2.3.2 (Apple Git-55)


From e566d2797870243137833f2b91fd1bbbed09486d Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:48:28 +0300
Subject: [PATCH 080/262] Step 12.6: Add the angularutils:pagination package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index c1e6c5e..05c4f48 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -20,3 +20,4 @@ accounts-password
 dotansimha:accounts-ui-angular
 accounts-facebook
 accounts-twitter
+angularutils:pagination
diff --git a/.meteor/versions b/.meteor/versions
index 4a7fd61..853a001 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -10,6 +10,7 @@ angular-meteor-data@0.0.1
 angular-templates@0.0.1
 angular:angular@1.4.7
 angularui:angular-ui-router@0.2.15
+angularutils:pagination@0.7.0
 autoupdate@1.2.4
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
-- 
2.3.2 (Apple Git-55)


From dc5e86497d769cb46e2aecb77ac764efa72c617b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:32:41 +0300
Subject: [PATCH 081/262] Step 12.7: Add the pagination module

---
 client/lib/app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 651ffb3..ecbe322 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1,4 +1,4 @@
-angular.module('socially',['angular-meteor', 'ui.router', 'accounts.ui']);
+angular.module('socially',['angular-meteor', 'ui.router', 'accounts.ui', 'angularUtils.directives.dirPagination']);
 
 function onReady() {
   angular.bootstrap(document, ['socially'], {
-- 
2.3.2 (Apple Git-55)


From 5688873b874480f5a3e307a11e5ad172dfc7f94c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:33:26 +0300
Subject: [PATCH 082/262] Step 12.8: Use the pagination directive

---
 client/parties/views/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index e0f11ea..63b5934 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -9,7 +9,7 @@
   <button ng-click="removeAll()">Remove All</button>
 </form>
 <ul>
-  <li ng-repeat="party in parties">
+  <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
-- 
2.3.2 (Apple Git-55)


From 5cadc5763c5ff2aeb48253ac3740b0d1eb05463b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:38:23 +0300
Subject: [PATCH 083/262] Step 12.9: Add the pagination controls

---
 client/parties/views/parties-list.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 63b5934..f9bd9a1 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -14,4 +14,5 @@
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
   </li>
-</ul>
\ No newline at end of file
+</ul>
+<dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 405ce77ac1f9e4ad3c7de76fe0bf4d27fce36595 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:38:36 +0300
Subject: [PATCH 084/262] Step 12.10: Add the pageChanged method to the
 controller

---
 client/parties/controllers/partiesList.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index d784995..fc5a8ea 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -20,7 +20,11 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     $scope.parties.splice($scope.parties.indexOf(party), 1);
   };
 
-  $scope.removeAll = function () {
+  $scope.removeAll = function(){
     $scope.parties.remove();
   };
+
+  $scope.pageChanged = function(newPage) {
+    $scope.page = newPage;
+  };
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From dcf41538926664f1a5223add110693f339a982a7 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 02:50:32 +0300
Subject: [PATCH 085/262] Step 12.11: Add the tmeasday:publish-counts package

---
 .meteor/packages | 1 +
 .meteor/versions | 3 ++-
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/.meteor/packages b/.meteor/packages
index 05c4f48..50247a0 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -21,3 +21,4 @@ dotansimha:accounts-ui-angular
 accounts-facebook
 accounts-twitter
 angularutils:pagination
+tmeasday:publish-counts
diff --git a/.meteor/versions b/.meteor/versions
index 853a001..52fa5c4 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -86,7 +86,8 @@ srp@1.0.4
 standard-minifiers@1.0.2
 templating@1.1.5
 templating-tools@1.0.0
-tracker@1.0.9
+tmeasday:publish-counts@0.7.2
+tracker@1.0.8
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
-- 
2.3.2 (Apple Git-55)


From 31a07135b53663653c5f9cb5fcb9670ad8c6fd14 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:41:09 +0300
Subject: [PATCH 086/262] Step 12.12: Add parties count publish

---
 server/parties.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index 663bcd8..9622905 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,16 @@
 Meteor.publish("parties", function (options) {
+  Counts.publish(this, 'numberOfParties', Parties.find({
+    $or:[
+      {$and:[
+        {'public': true},
+        {'public': {$exists: true}}
+      ]},
+      {$and:[
+        {owner: this.userId},
+        {owner: {$exists: true}}
+      ]}
+    ]}), { noReady: true });
+
   return Parties.find({
     $or:[
       {$and:[
-- 
2.3.2 (Apple Git-55)


From 026762f61612d209d49d5d1eca8a0319cbc64353 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:44:18 +0300
Subject: [PATCH 087/262] Step 12.13: Add parties count to the client

---
 client/parties/controllers/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index fc5a8ea..a3be704 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -14,6 +14,8 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     limit: parseInt($scope.perPage),
     skip: parseInt(($scope.page - 1) * $scope.perPage),
     sort: $scope.sort
+  }).then(function(){
+    $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
   });
 
   $scope.remove = function (party) {
-- 
2.3.2 (Apple Git-55)


From 8ee5862b3a38411b80ad804436422a38c0669218 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:44:44 +0300
Subject: [PATCH 088/262] Step 12.14: Add autorun to wrap the subscribe

---
 client/parties/controllers/partiesList.js | 14 ++++++++------
 1 file changed, 8 insertions(+), 6 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index a3be704..3bac6c9 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -10,12 +10,14 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     });
   });
 
-  $meteor.subscribe('parties', {
-    limit: parseInt($scope.perPage),
-    skip: parseInt(($scope.page - 1) * $scope.perPage),
-    sort: $scope.sort
-  }).then(function(){
-    $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
+  $meteor.autorun($scope, function() {
+    $meteor.subscribe('parties', {
+      limit: parseInt($scope.perPage),
+      skip: parseInt(($scope.page - 1) * $scope.perPage),
+      sort: $scope.sort
+    }).then(function(){
+      $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
+    });
   });
 
   $scope.remove = function (party) {
-- 
2.3.2 (Apple Git-55)


From 67d3b47ab9fb133579abca705e0d5f5b156fbfd7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:45:18 +0300
Subject: [PATCH 089/262] Step 12.15: Added usage of getReactively

---
 client/parties/controllers/partiesList.js | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 3bac6c9..a356dd0 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -12,9 +12,9 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
 
   $meteor.autorun($scope, function() {
     $meteor.subscribe('parties', {
-      limit: parseInt($scope.perPage),
-      skip: parseInt(($scope.page - 1) * $scope.perPage),
-      sort: $scope.sort
+      limit: parseInt($scope.getReactively('perPage')),
+      skip: (parseInt($scope.getReactively('page')) - 1) * parseInt($scope.getReactively('perPage')),
+      sort: $scope.getReactively('sort')
     }).then(function(){
       $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
     });
-- 
2.3.2 (Apple Git-55)


From d5c5b95cba9289b850874928a0beb6f3d5e345b2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:45:55 +0300
Subject: [PATCH 090/262] Step 12.16: Added usage of getReactively to the
 collection

---
 client/parties/controllers/partiesList.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index a356dd0..b252774 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -6,7 +6,7 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
 
   $scope.parties = $meteor.collection(function() {
     return Parties.find({}, {
-      sort : $scope.sort
+      sort : $scope.getReactively('sort')
     });
   });
 
-- 
2.3.2 (Apple Git-55)


From f64e096d44ba2fc744d790fa2832eaa6a5115a1c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:48:12 +0300
Subject: [PATCH 091/262] Step 12.17: Add sort controls to the view

---
 client/parties/views/parties-list.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index f9bd9a1..968ccf8 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -9,6 +9,13 @@
   <button ng-click="removeAll()">Remove All</button>
 </form>
 <ul>
+  <h1>Parties:</h1>
+  <div>
+    <select ng-model="orderProperty">
+      <option value="1">Ascending</option>
+      <option value="-1">Descending</option>
+    </select>
+  </div>
   <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
-- 
2.3.2 (Apple Git-55)


From 836c8525ae6b536159be49c7b3e418a8119221f6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:49:18 +0300
Subject: [PATCH 092/262] Step 12.18: Add order logic to the client

---
 client/parties/controllers/partiesList.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index b252774..9a6d599 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -31,4 +31,9 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.pageChanged = function(newPage) {
     $scope.page = newPage;
   };
+
+  $scope.$watch('orderProperty', function(){
+    if ($scope.orderProperty)
+      $scope.sort = {name: parseInt($scope.orderProperty)};
+  });
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 60054f4964251d295101a3ddfe9ce06e95327563 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:49:41 +0300
Subject: [PATCH 093/262] Step 12.19: Add default sort definition

---
 client/parties/controllers/partiesList.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 9a6d599..09e746c 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -3,6 +3,7 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
+  $scope.orderProperty = '1';
 
   $scope.parties = $meteor.collection(function() {
     return Parties.find({}, {
-- 
2.3.2 (Apple Git-55)


From 2f28a8208e55e35576af043e5382c251272de314 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:48:55 +0300
Subject: [PATCH 094/262] Step 12.20: Add search string to the collection

---
 server/parties.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/server/parties.js b/server/parties.js
index 9622905..5366910 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,4 @@
-Meteor.publish("parties", function (options) {
+Meteor.publish("parties", function (options, searchString) {
   Counts.publish(this, 'numberOfParties', Parties.find({
     $or:[
       {$and:[
-- 
2.3.2 (Apple Git-55)


From e732e1669314d22682aa8f5ef69cc4eb84dcc22b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:50:07 +0300
Subject: [PATCH 095/262] Step 12.21: Add the search logic

---
 server/parties.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index 5366910..c2dc88b 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,5 +1,9 @@
 Meteor.publish("parties", function (options, searchString) {
+  if (searchString == null)
+    searchString = '';
+
   Counts.publish(this, 'numberOfParties', Parties.find({
+    'name' : { '$regex' : '.*' + searchString || '' + '.*', '$options' : 'i' },
     $or:[
       {$and:[
         {'public': true},
@@ -12,6 +16,7 @@ Meteor.publish("parties", function (options, searchString) {
     ]}), { noReady: true });
 
   return Parties.find({
+    'name' : { '$regex' : '.*' + searchString || '' + '.*', '$options' : 'i' },
     $or:[
       {$and:[
         {"public": true},
-- 
2.3.2 (Apple Git-55)


From aa68128807151360ed900c008bc7a8e9a8bdaf6d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:52:28 +0300
Subject: [PATCH 096/262] Step 12.22: Add the search input

---
 client/parties/views/parties-list.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 968ccf8..42b344c 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -11,6 +11,7 @@
 <ul>
   <h1>Parties:</h1>
   <div>
+    <input type="search" ng-model="search" placeholder="Search">
     <select ng-model="orderProperty">
       <option value="1">Ascending</option>
       <option value="-1">Descending</option>
-- 
2.3.2 (Apple Git-55)


From 9f6ba886b0e2eb1026e29535854853c0bf15136e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:53:48 +0300
Subject: [PATCH 097/262] Step 12.23: Add the search param to the subscribe

---
 client/parties/controllers/partiesList.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 09e746c..ccb3442 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -16,7 +16,7 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
       limit: parseInt($scope.getReactively('perPage')),
       skip: (parseInt($scope.getReactively('page')) - 1) * parseInt($scope.getReactively('perPage')),
       sort: $scope.getReactively('sort')
-    }).then(function(){
+    }, $scope.getReactively('search')).then(function(){
       $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
     });
   });
-- 
2.3.2 (Apple Git-55)


From ffa086c546d03980fe5fbe7c26ea829051c19511 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:54:32 +0300
Subject: [PATCH 098/262] Step 12.24: Remove the subscription from the object

---
 client/parties/controllers/partyDetails.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 2d9322e..7d31eb1 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -1,4 +1,4 @@
 angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $stateParams, $meteor) {
-  $scope.party = $meteor.object(Parties, $stateParams.partyId).subscribe('parties');
+  $scope.party = $meteor.object(Parties, $stateParams.partyId);
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0a064ff38839f5b94763bfc33bcb181d398c6390 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:54:58 +0300
Subject: [PATCH 099/262] Step 12.25: Add $scope subscription to the collection

---
 client/parties/controllers/partyDetails.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 7d31eb1..09a8dc7 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -1,4 +1,5 @@
 angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $stateParams, $meteor) {
   $scope.party = $meteor.object(Parties, $stateParams.partyId);
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
+  $scope.$meteorSubscribe('parties');
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7944dcc6a147d7192f9f78332259e9ac27281717 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:57:59 +0300
Subject: [PATCH 100/262] Step 13.1: Create the filter

---
 client/parties/filters/uninvited.js | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 create mode 100644 client/parties/filters/uninvited.js

diff --git a/client/parties/filters/uninvited.js b/client/parties/filters/uninvited.js
new file mode 100644
index 0000000..9166e47
--- /dev/null
+++ b/client/parties/filters/uninvited.js
@@ -0,0 +1,14 @@
+angular.module('socially').filter('uninvited', function () {
+  return function (users, party) {
+    if (!party)
+      return false;
+
+    return _.filter(users, function (user) {
+      if (user._id == party.owner ||
+        _.contains(party.invited, user._id))
+        return false;
+      else
+        return true;
+    });
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 3bd10ef975afd270784fb3358d893098aac34af4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 21:59:45 +0300
Subject: [PATCH 101/262] Step 13.2: Use the filter

---
 client/parties/views/party-details.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index a640092..5ab9471 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -6,8 +6,8 @@ Here you will see and change the details of the party:
 <input type="checkbox" ng-model="party.public">
 
 <ul>
-  Users:
-  <li ng-repeat="user in users">
+  Users to invite:
+  <li ng-repeat="user in users | uninvited:party">
     <div>{{ user.emails[0].address }}</div>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 507de02644b11b25c96193842f5cd2be032eb532 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:00:48 +0300
Subject: [PATCH 102/262] Step 13.3: Use filter to display user details

---
 client/parties/views/party-details.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index 5ab9471..4642f74 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -8,6 +8,6 @@ Here you will see and change the details of the party:
 <ul>
   Users to invite:
   <li ng-repeat="user in users | uninvited:party">
-    <div>{{ user.emails[0].address }}</div>
+    <div>{{ user | displayName }}</div>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a2d160277f52b5183ab93bc5dfbd142b4c015453 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:01:22 +0300
Subject: [PATCH 103/262] Step 13.4: Create the displayName filter

---
 client/parties/filters/displayName.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 client/parties/filters/displayName.js

diff --git a/client/parties/filters/displayName.js b/client/parties/filters/displayName.js
new file mode 100644
index 0000000..162f496
--- /dev/null
+++ b/client/parties/filters/displayName.js
@@ -0,0 +1,12 @@
+angular.module('socially').filter('displayName', function () {
+  return function (user) {
+    if (!user)
+      return;
+    if (user.profile && user.profile.name)
+      return user.profile.name;
+    else if (user.emails)
+      return user.emails[0].address;
+    else
+      return user;
+  }
+});
-- 
2.3.2 (Apple Git-55)


From d6514362e2f4ac892cfcb4a558e290e3fc42037a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:57:40 +0300
Subject: [PATCH 104/262] Step 13.5: Added user details

---
 client/parties/views/parties-list.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 42b344c..970356d 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -21,6 +21,7 @@
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
+    <p><small>Posted by {{ creator(party) }}</small></p>
   </li>
 </ul>
 <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8177eba719a67f5ee1a40fb9cf9e962961a84608 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 18:59:06 +0300
Subject: [PATCH 105/262] Step 13.6: Added the logic to the controller

---
 client/parties/controllers/partiesList.js | 22 ++++++++++++++++++++--
 1 file changed, 20 insertions(+), 2 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index ccb3442..0cbc2f8 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,5 +1,4 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor) {
-
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope) {
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
@@ -37,4 +36,23 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     if ($scope.orderProperty)
       $scope.sort = {name: parseInt($scope.orderProperty)};
   });
+
+  $scope.getUserById = function(userId){
+    return Meteor.users.findOne(userId);
+  };
+
+  $scope.creator = function(party){
+    if (!party)
+      return;
+    var owner = $scope.getUserById(party.owner);
+    if (!owner)
+      return 'nobody';
+
+    if ($rootScope.currentUser)
+      if ($rootScope.currentUser._id)
+        if (owner._id === $rootScope.currentUser._id)
+          return 'me';
+
+    return owner;
+  };
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 49b062bd69db8836dfc37ae6e0e5ade3794be0e5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:01:26 +0300
Subject: [PATCH 106/262] Step 13.7: Added subscribe to the users collection

---
 client/parties/controllers/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 0cbc2f8..5e36b3f 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -4,6 +4,8 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.sort = {name: 1};
   $scope.orderProperty = '1';
 
+  $scope.$meteorSubscribe('users');
+
   $scope.parties = $meteor.collection(function() {
     return Parties.find({}, {
       sort : $scope.getReactively('sort')
-- 
2.3.2 (Apple Git-55)


From bb64478c2bd40ac946246e22c520a19da0814b51 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:13:48 +0300
Subject: [PATCH 107/262] Step 13.8: Use filter to display the user info

---
 client/parties/views/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 970356d..91d2197 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -21,7 +21,7 @@
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
-    <p><small>Posted by {{ creator(party) }}</small></p>
+    <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
 </ul>
 <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9f4a7299454f717d60537d5d5bfd0562aab65b48 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:23:03 +0300
Subject: [PATCH 108/262] Step 14.1: Add meteor method to the model

---
 model/parties.js | 46 +++++++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 45 insertions(+), 1 deletion(-)

diff --git a/model/parties.js b/model/parties.js
index b793c1f..8998b5e 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -10,4 +10,48 @@ Parties.allow({
   remove: function (userId, party) {
     return userId && party.owner === userId;
   }
-});
\ No newline at end of file
+});
+
+Meteor.methods({
+  invite: function (partyId, userId) {
+    check(partyId, String);
+    check(userId, String);
+    var party = Parties.findOne(partyId);
+    if (!party)
+      throw new Meteor.Error(404, "No such party");
+    if (party.owner !== this.userId)
+      throw new Meteor.Error(404, "No such party");
+    if (party.public)
+      throw new Meteor.Error(400,
+        "That party is public. No need to invite people.");
+
+    if (userId !== party.owner && ! _.contains(party.invited, userId)) {
+      Parties.update(partyId, { $addToSet: { invited: userId } });
+
+      var from = contactEmail(Meteor.users.findOne(this.userId));
+      var to = contactEmail(Meteor.users.findOne(userId));
+
+      if (Meteor.isServer && to) {
+        // This code only runs on the server. If you didn't want clients
+        // to be able to see it, you could move it to a separate file.
+        Email.send({
+          from: "noreply@socially.com",
+          to: to,
+          replyTo: from || undefined,
+          subject: "PARTY: " + party.title,
+          text:
+          "Hey, I just invited you to '" + party.title + "' on Socially." +
+          "\n\nCome check it out: " + Meteor.absoluteUrl() + "\n"
+        });
+      }
+    }
+  }
+});
+
+var contactEmail = function (user) {
+  if (user.emails && user.emails.length)
+    return user.emails[0].address;
+  if (user.services && user.services.facebook && user.services.facebook.email)
+    return user.services.facebook.email;
+  return null;
+};
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e5b31370c55098aefc10417e4d4e87d3721bc524 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:10:17 +0300
Subject: [PATCH 109/262] Add check package to the project

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 50247a0..9ecb9c3 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -22,3 +22,4 @@ accounts-facebook
 accounts-twitter
 angularutils:pagination
 tmeasday:publish-counts
+check
-- 
2.3.2 (Apple Git-55)


From 1fbcd87541d4f85ab2af145803d8db24407f0a8d Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:01:09 +0300
Subject: [PATCH 110/262] Step 14.2: Add the email package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 9ecb9c3..c695822 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -23,3 +23,4 @@ accounts-twitter
 angularutils:pagination
 tmeasday:publish-counts
 check
+email
-- 
2.3.2 (Apple Git-55)


From 32cc3f196260dc26df311c33ad36737143255fc1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:11:27 +0300
Subject: [PATCH 111/262] Step 14.3: Add invite method to the client

---
 client/parties/controllers/partyDetails.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 09a8dc7..ecba146 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -2,4 +2,15 @@ angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $sta
   $scope.party = $meteor.object(Parties, $stateParams.partyId);
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
   $scope.$meteorSubscribe('parties');
+
+  $scope.invite = function(user){
+    $meteor.call('invite', $scope.party._id, user._id).then(
+      function(data){
+        console.log('success inviting', data);
+      },
+      function(err){
+        console.log('failed', err);
+      }
+    );
+  };
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a42859392bea0ed030d3a387f5c64695459b6c0b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:26:39 +0300
Subject: [PATCH 112/262] Step 14.4: Add invite button to the view

---
 client/parties/views/party-details.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index 4642f74..609a4ba 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -9,5 +9,6 @@ Here you will see and change the details of the party:
   Users to invite:
   <li ng-repeat="user in users | uninvited:party">
     <div>{{ user | displayName }}</div>
+    <button ng-click="invite(user)">Invite</button>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 3fdd79a4cc39a0dd0434ef8d60f5d3759da2c148 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:27:54 +0300
Subject: [PATCH 113/262] Step 14.5: Add invited logic to the publish

---
 server/parties.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index c2dc88b..b691e30 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -12,6 +12,10 @@ Meteor.publish("parties", function (options, searchString) {
       {$and:[
         {owner: this.userId},
         {owner: {$exists: true}}
+      ]},
+      {$and:[
+        {invited: this.userId},
+        {invited: {$exists: true}}
       ]}
     ]}), { noReady: true });
 
@@ -25,6 +29,10 @@ Meteor.publish("parties", function (options, searchString) {
       {$and:[
         {owner: this.userId},
         {owner: {$exists: true}}
+      ]},
+      {$and:[
+        {invited: this.userId},
+        {invited: {$exists: true}}
       ]}
     ]}, options);
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d94db2b83a2ece0694a8e99ec5a0c363dd1b5ad2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:12:59 +0300
Subject: [PATCH 114/262] Step 14.6: Add RSVP function to the server

---
 model/parties.js | 40 ++++++++++++++++++++++++++++++++++++++++
 1 file changed, 40 insertions(+)

diff --git a/model/parties.js b/model/parties.js
index 8998b5e..37b10e5 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -45,6 +45,46 @@ Meteor.methods({
         });
       }
     }
+  },
+  rsvp: function (partyId, rsvp) {
+    check(partyId, String);
+    check(rsvp, String);
+    if (! this.userId)
+      throw new Meteor.Error(403, "You must be logged in to RSVP");
+    if (! _.contains(['yes', 'no', 'maybe'], rsvp))
+      throw new Meteor.Error(400, "Invalid RSVP");
+    var party = Parties.findOne(partyId);
+    if (! party)
+      throw new Meteor.Error(404, "No such party");
+    if (! party.public && party.owner !== this.userId &&
+      !_.contains(party.invited, this.userId))
+    // private, but let's not tell this to the user
+      throw new Meteor.Error(403, "No such party");
+
+    var rsvpIndex = _.indexOf(_.pluck(party.rsvps, 'user'), this.userId);
+    if (rsvpIndex !== -1) {
+      // update existing rsvp entry
+
+      if (Meteor.isServer) {
+        // update the appropriate rsvp entry with $
+        Parties.update(
+          {_id: partyId, "rsvps.user": this.userId},
+          {$set: {"rsvps.$.rsvp": rsvp}});
+      } else {
+        // minimongo doesn't yet support $ in modifier. as a temporary
+        // workaround, make a modifier that uses an index. this is
+        // safe on the client since there's only one thread.
+        var modifier = {$set: {}};
+        modifier.$set["rsvps." + rsvpIndex + ".rsvp"] = rsvp;
+        Parties.update(partyId, modifier);
+      }
+      // Possible improvement: send email to the other people that are
+      // coming to the party.
+    } else {
+      // add new rsvp entry
+      Parties.update(partyId,
+        {$push: {rsvps: {user: this.userId, rsvp: rsvp}}});
+    }
   }
 });
 
-- 
2.3.2 (Apple Git-55)


From 4f67014502804bf2ccbf5265b12a679a8873cc7a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:13:38 +0300
Subject: [PATCH 115/262] Step 14.7: Add RSVP function to the client

---
 client/parties/controllers/partiesList.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 5e36b3f..c8ba61c 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -39,6 +39,17 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
       $scope.sort = {name: parseInt($scope.orderProperty)};
   });
 
+  $scope.rsvp = function(partyId, rsvp){
+    $meteor.call('rsvp', partyId, rsvp).then(
+      function(data){
+        console.log('success responding', data);
+      },
+      function(err){
+        console.log('failed', err);
+      }
+    );
+  };
+
   $scope.getUserById = function(userId){
     return Meteor.users.findOne(userId);
   };
-- 
2.3.2 (Apple Git-55)


From 7d5938af1a6923fbe37026967967a3a39193fd02 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:33:05 +0300
Subject: [PATCH 116/262] Step 14.8: Add RSVP control to the view

---
 client/parties/views/parties-list.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 91d2197..641126a 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -21,6 +21,13 @@
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
+
+    <div>
+      <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
+      <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
+      <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
+    </div>
+
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From 462ea6006e6e7dc8a6d928005bcf0c74e4b6d96b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:33:44 +0300
Subject: [PATCH 117/262] Step 14.9: Add RSVP list to the view

---
 client/parties/views/parties-list.html | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 641126a..f3e412e 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -27,6 +27,21 @@
       <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
     </div>
+    <div>
+      Who is coming:
+      Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
+      Maybe - {{ (party.rsvps | filter:{rsvp:'maybe'}).length }}
+      No - {{ (party.rsvps | filter:{rsvp:'no'}).length }}
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'yes'}">
+        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'maybe'}">
+        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'no'}">
+        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+    </div>
 
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
-- 
2.3.2 (Apple Git-55)


From 2d83542493f671dba00a1d7c536859791f2dfa0a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:15:51 +0300
Subject: [PATCH 118/262] Step 14.10: Add RSVP list to the view of users who
 not responded

---
 client/parties/views/parties-list.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index f3e412e..b6bca63 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -43,6 +43,13 @@
       </div>
     </div>
 
+    <ul>
+      Users who not responded:
+      <li ng-repeat="invitedUser in outstandingInvitations(party)">
+        {{ invitedUser | displayName }}
+      </li>
+    </ul>
+
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From deef02faf3fdc3116ec87e03e283817e8ff9be2e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:16:26 +0300
Subject: [PATCH 119/262] Step 14.11: Added logic to the controller

---
 client/parties/controllers/partiesList.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index c8ba61c..1bae778 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -50,6 +50,13 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     );
   };
 
+  $scope.outstandingInvitations = function (party) {
+    return _.filter($scope.users, function (user) {
+      return (_.contains(party.invited, user._id) &&
+      !_.findWhere(party.rsvps, {user: user._id}));
+    });
+  };
+
   $scope.getUserById = function(userId){
     return Meteor.users.findOne(userId);
   };
-- 
2.3.2 (Apple Git-55)


From 3cf53132f6bde25f6901932175be014e8bea50d1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:16:58 +0300
Subject: [PATCH 120/262] Step 14.12: Add users collection

---
 client/parties/controllers/partiesList.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 1bae778..d81440d 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -4,7 +4,7 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.sort = {name: 1};
   $scope.orderProperty = '1';
 
-  $scope.$meteorSubscribe('users');
+  $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
 
   $scope.parties = $meteor.collection(function() {
     return Parties.find({}, {
-- 
2.3.2 (Apple Git-55)


From 94f03782c01f6e4b5906ddc920e7fae1499a6e3b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:39:54 +0300
Subject: [PATCH 121/262] Step 15.1: Add ng-show to the directive

---
 client/parties/views/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index b6bca63..511a477 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -1,4 +1,4 @@
-<form>
+<form ng-show="$root.currentUser">
   <label>Name</label>
   <input ng-model="newParty.name">
   <label>Description</label>
-- 
2.3.2 (Apple Git-55)


From 77ea59fdb0e6b6e317df18eb98ed96ca91bfc1a0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:40:35 +0300
Subject: [PATCH 122/262] Step 15.2: Add message to users that not logged in

---
 client/parties/views/parties-list.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 511a477..000c016 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -8,6 +8,9 @@
   <button ng-click="newParty.owner=$root.currentUser._id; parties.save(newParty)">Add</button>
   <button ng-click="removeAll()">Remove All</button>
 </form>
+<div ng-hide="$root.currentUser || $root.loggingIn">
+  Log in to create a party!
+</div>
 <ul>
   <h1>Parties:</h1>
   <div>
-- 
2.3.2 (Apple Git-55)


From ac058c7b917d2decdf87da5c803f61f7426c0fa2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:41:09 +0300
Subject: [PATCH 123/262] Step 15.3: Add ng-show to the RSVP buttons

---
 client/parties/views/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 000c016..4c0bc8d 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -25,7 +25,7 @@
     <p>{{party.description}}</p>
     <button ng-click="remove(party)">X</button>
 
-    <div>
+    <div ng-show="$root.currentUser">
       <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
       <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
-- 
2.3.2 (Apple Git-55)


From c051955eaa8fdd3b9a7d096ce7508bf815f7235f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:41:46 +0300
Subject: [PATCH 124/262] Step 15.4: Add message for not-logged in users on the
 RSVP buttons

---
 client/parties/views/parties-list.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 4c0bc8d..9958adf 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -30,6 +30,10 @@
       <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
     </div>
+    <div ng-hide="$root.currentUser">
+      <i>Sign in to RSVP for this party.</i>
+    </div>
+
     <div>
       Who is coming:
       Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
-- 
2.3.2 (Apple Git-55)


From 466bd6d73f708bf3d28022b9680fe6c8f5c34903 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:42:52 +0300
Subject: [PATCH 125/262] Step 15.5: Add ng-show to delete button

---
 client/parties/views/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 9958adf..00395d5 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -23,7 +23,7 @@
   <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
-    <button ng-click="remove(party)">X</button>
+    <button ng-click="remove(party)" ng-show="$root.currentUser && $root.currentUser._id == party.owner">X</button>
 
     <div ng-show="$root.currentUser">
       <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
-- 
2.3.2 (Apple Git-55)


From 5184d51e7adb3251e3a210b2abd02a14a0fed218 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:18:44 +0300
Subject: [PATCH 126/262] Step 15.6: Add ng-if to outstanding RSVP

---
 client/parties/views/parties-list.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index 00395d5..d1c9715 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -50,12 +50,15 @@
       </div>
     </div>
 
-    <ul>
+    <ul ng-if="!party.public">
       Users who not responded:
       <li ng-repeat="invitedUser in outstandingInvitations(party)">
         {{ invitedUser | displayName }}
       </li>
     </ul>
+    <div ng-if="party.public">
+      Everyone is invited
+    </div>
 
     <p><small>Posted by {{ creator(party) | displayName }}</small></p>
   </li>
-- 
2.3.2 (Apple Git-55)


From aa981b321c4189f83d0db2cdc63a7100413b8773 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:19:00 +0300
Subject: [PATCH 127/262] Step 15.7: Add canInvite logic

---
 client/parties/controllers/partyDetails.js | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index ecba146..21613a2 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -13,4 +13,12 @@ angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $sta
       }
     );
   };
-});
\ No newline at end of file
+
+  $scope.canInvite = function (){
+    if (!$scope.party)
+      return false;
+
+    return !$scope.party.public &&
+      $scope.party.owner === Meteor.userId();
+  };
+});
-- 
2.3.2 (Apple Git-55)


From d76a19b45adce269e464f83fd3afcbf2ef800bb0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:47:19 +0300
Subject: [PATCH 128/262] Step 15.8: Add usage for ng-show with canInvite

---
 client/parties/views/party-details.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index 609a4ba..a695811 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -5,10 +5,13 @@ Here you will see and change the details of the party:
 <label>Is public</label>
 <input type="checkbox" ng-model="party.public">
 
-<ul>
+<ul ng-show="canInvite()">
   Users to invite:
   <li ng-repeat="user in users | uninvited:party">
     <div>{{ user | displayName }}</div>
     <button ng-click="invite(user)">Invite</button>
   </li>
+  <li ng-if="(users | uninvited:party).length <= 0">
+    Everyone are already invited.
+  </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6ef466038b245a9cd53516c7f496fd850572b4ee Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:49:32 +0300
Subject: [PATCH 129/262] Step 15.9: Example of ng-disabled

---
 client/parties/views/party-details.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index a695811..f17a8f2 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -1,9 +1,9 @@
 Here you will see and change the details of the party:
 
-<input ng-model="party.name">
-<input ng-model="party.description">
+<input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id">
+<input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id">
 <label>Is public</label>
-<input type="checkbox" ng-model="party.public">
+<input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
 
 <ul ng-show="canInvite()">
   Users to invite:
-- 
2.3.2 (Apple Git-55)


From b49a06691e30a2534e9677b45a90c9e7ba7c9004 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:07:46 +0300
Subject: [PATCH 130/262] Step 16.1: Add the angularui:angular-google-maps
 package

---
 .meteor/packages | 3 ++-
 .meteor/versions | 2 ++
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/.meteor/packages b/.meteor/packages
index c695822..c938d95 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -22,5 +22,6 @@ accounts-facebook
 accounts-twitter
 angularutils:pagination
 tmeasday:publish-counts
-check
 email
+check
+angularui:angular-google-maps
diff --git a/.meteor/versions b/.meteor/versions
index 52fa5c4..6251b67 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -9,6 +9,7 @@ angular@1.2.0-rc.3
 angular-meteor-data@0.0.1
 angular-templates@0.0.1
 angular:angular@1.4.7
+angularui:angular-google-maps@2.2.1
 angularui:angular-ui-router@0.2.15
 angularutils:pagination@0.7.0
 autoupdate@1.2.4
@@ -84,6 +85,7 @@ spacebars@1.0.7
 spacebars-compiler@1.0.7
 srp@1.0.4
 standard-minifiers@1.0.2
+stevezhu:lodash@1.0.2
 templating@1.1.5
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
-- 
2.3.2 (Apple Git-55)


From b6b9c7be0b0311d25ae2697952fb9a754e87d193 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:54:08 +0300
Subject: [PATCH 131/262] Step 16.1: Add google maps module dependency

---
 client/lib/app.js | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index ecbe322..76d8982 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1,5 +1,10 @@
-angular.module('socially',['angular-meteor', 'ui.router', 'accounts.ui', 'angularUtils.directives.dirPagination']);
-
+angular.module('socially',[
+  'angular-meteor',
+  'ui.router',
+  'accounts.ui',
+  'angularUtils.directives.dirPagination',
+  'uiGmapgoogle-maps'
+]);
 function onReady() {
   angular.bootstrap(document, ['socially'], {
     strictDi: true
-- 
2.3.2 (Apple Git-55)


From 0b28ee05e38b95b9c78c65cf7897201328c03bac Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:21:32 +0300
Subject: [PATCH 132/262] Step 16.2: Add basic map to the view

---
 client/parties/views/party-details.html | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index f17a8f2..73c4640 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -14,4 +14,12 @@ Here you will see and change the details of the party:
   <li ng-if="(users | uninvited:party).length <= 0">
     Everyone are already invited.
   </li>
-</ul>
\ No newline at end of file
+</ul>
+
+<div class="party-details-maps">
+  <div class="angular-google-map-container">
+    <ui-gmap-google-map center="party.location || map.center"
+                        events="map.events" zoom="map.zoom">
+    </ui-gmap-google-map>
+  </div>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ae237b26b8e2895f486413d3bc86792800be40ff Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:21:52 +0300
Subject: [PATCH 133/262] Step 16.3: Add map params to the controller

---
 client/parties/controllers/partyDetails.js | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 21613a2..88063ff 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -21,4 +21,13 @@ angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $sta
     return !$scope.party.public &&
       $scope.party.owner === Meteor.userId();
   };
+
+  $scope.map = {
+    center: {
+      latitude: 45,
+      longitude: -73
+    },
+    zoom: 8,
+    events: {}
+  };
 });
-- 
2.3.2 (Apple Git-55)


From ad1988ef215e5960d1bed5c1955822a2f7e3e24c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 22:56:18 +0300
Subject: [PATCH 134/262] Step 16.4: Create basic CSS style with google map
 style

---
 client/parties/styles/parties.css | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 client/parties/styles/parties.css

diff --git a/client/parties/styles/parties.css b/client/parties/styles/parties.css
new file mode 100644
index 0000000..219ff39
--- /dev/null
+++ b/client/parties/styles/parties.css
@@ -0,0 +1,4 @@
+.angular-google-map-container {
+    height: 400px;
+    width: 400px;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 160d38add6e228523503fc7db3a9de78c46c4707 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:23:30 +0300
Subject: [PATCH 135/262] Step 16.5: Add party marker to the map

---
 client/parties/views/party-details.html | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index 73c4640..7ef1f8d 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -16,10 +16,11 @@ Here you will see and change the details of the party:
   </li>
 </ul>
 
-<div class="party-details-maps">
-  <div class="angular-google-map-container">
-    <ui-gmap-google-map center="party.location || map.center"
-                        events="map.events" zoom="map.zoom">
-    </ui-gmap-google-map>
-  </div>
+<div class="angular-google-map-container">
+  <ui-gmap-google-map center="party.location || map.center"
+                      events="map.events" zoom="map.zoom">
+    <ui-gmap-marker coords="party.location" options="map.marker.options"
+                    events="map.marker.events" idkey="party._id">
+    </ui-gmap-marker>
+  </ui-gmap-google-map>
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0c1ced7f6ebe6779ee481557b917531093bbb6d8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:23:49 +0300
Subject: [PATCH 136/262] Step 16.6: Add the marker creation logic to the
 controller

---
 client/parties/controllers/partyDetails.js | 27 ++++++++++++++++++++++++++-
 1 file changed, 26 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partyDetails.js b/client/parties/controllers/partyDetails.js
index 88063ff..bbd4b0a 100644
--- a/client/parties/controllers/partyDetails.js
+++ b/client/parties/controllers/partyDetails.js
@@ -28,6 +28,31 @@ angular.module("socially").controller("PartyDetailsCtrl", function ($scope, $sta
       longitude: -73
     },
     zoom: 8,
-    events: {}
+    events: {
+      click: function (mapModel, eventName, originalEventArgs) {
+        if (!$scope.party)
+          return;
+
+        if (!$scope.party.location)
+          $scope.party.location = {};
+
+        $scope.party.location.latitude = originalEventArgs[0].latLng.lat();
+        $scope.party.location.longitude = originalEventArgs[0].latLng.lng();
+        //scope apply required because this event handler is outside of the angular domain
+        $scope.$apply();
+      }
+    },
+    marker: {
+      options: { draggable: true },
+      events: {
+        dragend: function (marker, eventName, args) {
+          if (!$scope.party.location)
+            $scope.party.location = {};
+
+          $scope.party.location.latitude = marker.getPosition().lat();
+          $scope.party.location.longitude = marker.getPosition().lng();
+        }
+      }
+    }
   };
 });
-- 
2.3.2 (Apple Git-55)


From 0d49d5424a65cb1999a48129257e2faa66e6b376 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:26:01 +0300
Subject: [PATCH 137/262] Step 16.7: Add map to the parties list

---
 client/parties/views/parties-list.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index d1c9715..f9d688f 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -20,6 +20,13 @@
       <option value="-1">Descending</option>
     </select>
   </div>
+  <div class="angular-google-map-container">
+    <ui-gmap-google-map center="party.location || map.center" zoom="map.zoom">
+      <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
+                       fit="true" idkey="'_id'" doRebuildAll="true">
+      </ui-gmap-markers>
+    </ui-gmap-google-map>
+  </div>
   <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
     <a href="/parties/{{party._id}}">{{party.name}}</a>
     <p>{{party.description}}</p>
-- 
2.3.2 (Apple Git-55)


From 0764be7b548adfee67a4c276334280cf1c06678c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:26:16 +0300
Subject: [PATCH 138/262] Step 16.8: Add map logic to the parties list
 controller

---
 client/parties/controllers/partiesList.js | 17 ++++++++++++++++-
 1 file changed, 16 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index d81440d..88ce88b 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,4 +1,4 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope) {
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state) {
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
@@ -19,6 +19,21 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
       sort: $scope.getReactively('sort')
     }, $scope.getReactively('search')).then(function(){
       $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
+
+      $scope.parties.forEach( function (party) {
+        party.onClicked = function () {
+          $state.go('partyDetails', {partyId: party._id});
+        };
+      });
+
+      $scope.map = {
+        center: {
+          latitude: 45,
+          longitude: -73
+        },
+        zoom: 8
+      };
+
     });
   });
 
-- 
2.3.2 (Apple Git-55)


From bfeb8102455a99f610288b874a7b733a1e981d53 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:08:21 +0300
Subject: [PATCH 139/262] Step 17.1: Add main CSS file

---
 client/styles/main.css | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 client/styles/main.css

diff --git a/client/styles/main.css b/client/styles/main.css
new file mode 100644
index 0000000..4397047
--- /dev/null
+++ b/client/styles/main.css
@@ -0,0 +1,3 @@
+body {
+    background-color: rgba(0,0,0,.04);
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From f7a554a97d15651c59d717c3373de140de702528 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:27:28 +0300
Subject: [PATCH 140/262] Step 17.2: Add the twbs:bootstrap package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index c938d95..70e07a0 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -25,3 +25,4 @@ tmeasday:publish-counts
 email
 check
 angularui:angular-google-maps
+twbs:bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index 6251b67..c89cac3 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -90,6 +90,7 @@ templating@1.1.5
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
 tracker@1.0.8
+twbs:bootstrap@3.3.5
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
-- 
2.3.2 (Apple Git-55)


From 72e7d5fd8a284e81cedb586d72e54ea9bce78fb2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:09:03 +0300
Subject: [PATCH 141/262] Step 17.3: Add navbar and style to the login button

---
 client/index.html | 17 +++++++++++------
 1 file changed, 11 insertions(+), 6 deletions(-)

diff --git a/client/index.html b/client/index.html
index 66bd59f..a34fa95 100644
--- a/client/index.html
+++ b/client/index.html
@@ -4,12 +4,17 @@
 <body>
 
 <div>
-  <login-buttons></login-buttons>
-  <h1>
-    <a href="/parties">Home</a>
-  </h1>
-
-  <div ui-view></div>
+  <header class="navbar navbar-fixed-top">
+    <div class="container-fluid">
+      <div class="navbar-header">
+        <h1>
+          <a href="/parties">Home</a>
+        </h1>
+      </div>
+      <login-buttons></login-buttons>
+    </div>
+  </header>
+  <div ui-view class="container-fluid"></div>
 </div>
 
 </body>
-- 
2.3.2 (Apple Git-55)


From f8f1653c7188c38562a35ee3c141a4c523ce3980 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:48:29 +0300
Subject: [PATCH 142/262] Step 17.4: Add the less package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 70e07a0..38e9136 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -26,3 +26,4 @@ email
 check
 angularui:angular-google-maps
 twbs:bootstrap
+less
-- 
2.3.2 (Apple Git-55)


From 48488666d1f7d281bf5031e93c817eee75a04656 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:09:43 +0300
Subject: [PATCH 143/262] Step 17.5: Basic usage of LESS

---
 client/styles/main.css  | 3 ---
 client/styles/main.less | 8 ++++++++
 2 files changed, 8 insertions(+), 3 deletions(-)
 delete mode 100644 client/styles/main.css
 create mode 100644 client/styles/main.less

diff --git a/client/styles/main.css b/client/styles/main.css
deleted file mode 100644
index 4397047..0000000
--- a/client/styles/main.css
+++ /dev/null
@@ -1,3 +0,0 @@
-body {
-    background-color: rgba(0,0,0,.04);
-}
\ No newline at end of file
diff --git a/client/styles/main.less b/client/styles/main.less
new file mode 100644
index 0000000..6acada4
--- /dev/null
+++ b/client/styles/main.less
@@ -0,0 +1,8 @@
+body {
+    background-color: rgba(0,0,0,.2);
+    padding-top: 70px;
+
+    .navbar {
+        background-color: #ffffff;
+    }
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8eb81dc1bf15600211731decb13bacaa66e388e3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:10:22 +0300
Subject: [PATCH 144/262] Step 17.6: Change the name of parties css

---
 client/parties/styles/parties.css         | 4 ----
 client/parties/styles/parties.import.less | 4 ++++
 2 files changed, 4 insertions(+), 4 deletions(-)
 delete mode 100644 client/parties/styles/parties.css
 create mode 100644 client/parties/styles/parties.import.less

diff --git a/client/parties/styles/parties.css b/client/parties/styles/parties.css
deleted file mode 100644
index 219ff39..0000000
--- a/client/parties/styles/parties.css
+++ /dev/null
@@ -1,4 +0,0 @@
-.angular-google-map-container {
-    height: 400px;
-    width: 400px;
-}
\ No newline at end of file
diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
new file mode 100644
index 0000000..219ff39
--- /dev/null
+++ b/client/parties/styles/parties.import.less
@@ -0,0 +1,4 @@
+.angular-google-map-container {
+    height: 400px;
+    width: 400px;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 43b91b3006fa192adfbf4e76cb7072d28bd2eee0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 17 Aug 2015 23:10:50 +0300
Subject: [PATCH 145/262] Step 17.7: Add import to parties LESS file

---
 client/styles/main.less | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/styles/main.less b/client/styles/main.less
index 6acada4..87c5240 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -5,4 +5,7 @@ body {
     .navbar {
         background-color: #ffffff;
     }
-}
\ No newline at end of file
+}
+
+
+@import "../parties/styles/parties.import.less";
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d54ec009a371d5e0fec807e59e12a9e882ba0e58 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 03:55:47 +0300
Subject: [PATCH 146/262] Step 17.8: Add the angularui:angular-ui-bootstrap
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 38e9136..fe1744b 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -27,3 +27,4 @@ check
 angularui:angular-google-maps
 twbs:bootstrap
 less
+angularui:angular-ui-bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index c89cac3..65646dc 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -10,6 +10,7 @@ angular-meteor-data@0.0.1
 angular-templates@0.0.1
 angular:angular@1.4.7
 angularui:angular-google-maps@2.2.1
+angularui:angular-ui-bootstrap@0.13.0
 angularui:angular-ui-router@0.2.15
 angularutils:pagination@0.7.0
 autoupdate@1.2.4
-- 
2.3.2 (Apple Git-55)


From 768f95b4aade36210fcce3655bea21eb1e3968c6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:45:31 +0300
Subject: [PATCH 147/262] Step 17.9: Update the index.html style and tags

---
 client/index.html | 25 ++++++++++++++-----------
 1 file changed, 14 insertions(+), 11 deletions(-)

diff --git a/client/index.html b/client/index.html
index a34fa95..250571e 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,20 +1,23 @@
 <head>
+  <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
+  <link href='http://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
+  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
 </head>
 <body>
 
-<div>
-  <header class="navbar navbar-fixed-top">
-    <div class="container-fluid">
-      <div class="navbar-header">
-        <h1>
-          <a href="/parties">Home</a>
-        </h1>
-      </div>
+<nav class="navbar navbar-default navbar-fixed-top">
+  <div class="container">
+    <div class="navbar-header">
+      <a class="navbar-brand" href="/">socially</a>
+    </div>
+    <div class="navbar-right-container">
       <login-buttons></login-buttons>
     </div>
-  </header>
-  <div ui-view class="container-fluid"></div>
-</div>
+  </div>
+</nav>
 
+<div class="h100">
+  <div ui-view class="ma-main-container container-fluid h100"></div>
+</div>
 </body>
-- 
2.3.2 (Apple Git-55)


From 6af2a265b11d5826a840d1c10c746ae185938dff Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:47:43 +0300
Subject: [PATCH 148/262] Step 17.10: Add dependency for ui-bootstrap

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 76d8982..ad169e4 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -3,7 +3,8 @@ angular.module('socially',[
   'ui.router',
   'accounts.ui',
   'angularUtils.directives.dirPagination',
-  'uiGmapgoogle-maps'
+  'uiGmapgoogle-maps',
+  'ui.bootstrap'
 ]);
 function onReady() {
   angular.bootstrap(document, ['socially'], {
-- 
2.3.2 (Apple Git-55)


From e80966d5040c7c7f12a86e8929838734714214e5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:49:19 +0300
Subject: [PATCH 149/262] Step 17.11: Move the logic of add new party to
 separated controller

---
 client/parties/controllers/addNewParty.js | 10 ++++++++++
 1 file changed, 10 insertions(+)
 create mode 100644 client/parties/controllers/addNewParty.js

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
new file mode 100644
index 0000000..f2d0d1a
--- /dev/null
+++ b/client/parties/controllers/addNewParty.js
@@ -0,0 +1,10 @@
+angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$modalInstance', 'parties',
+  function ($scope, $meteor, $rootScope, $state, $modalInstance, parties) {
+
+    $scope.addNewParty = function () {
+      $scope.newParty.owner = $rootScope.currentUser._id;
+      parties.push($scope.newParty);
+      $scope.newParty = '';
+      $modalInstance.close();
+    }
+  }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cec7ffb74f17a566cf65fd34274249c4f4518785 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 14:57:13 +0300
Subject: [PATCH 150/262] Step 17.12: Create the view of new party modal

---
 client/parties/views/add-new-party-modal.html | 24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 client/parties/views/add-new-party-modal.html

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
new file mode 100644
index 0000000..5fd3485
--- /dev/null
+++ b/client/parties/views/add-new-party-modal.html
@@ -0,0 +1,24 @@
+<div class="container-fluid ma-add-new-party-container">
+  <div class="alert alert-info" ng-hide="$root.currentUser || $root.loggingIn">
+    Please log in to create a party!
+  </div>
+
+  <form ng-show="$root.currentUser || $root.loggingIn">
+    <h2>Create a new party</h2>
+
+    <div class="form-group">
+      <label for="nameInput">Name</label>
+      <input ng-model="newParty.name" id="nameInput" type="text" class="form-control">
+    </div>
+    <div class="form-group">
+      <label for="description">Description</label>
+      <input ng-model="newParty.description" id="description" type="text" class="form-control">
+    </div>
+    <div class="form-group">
+      <label for="public">
+        <input type="checkbox" ng-model="newParty.public" id="public"> Public
+      </label>
+    </div>
+    <button ng-click="addNewParty()" class="btn">Add</button>
+  </form>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b598a6537126a8d50992c467b91facda2cd61b62 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:29:08 +0300
Subject: [PATCH 151/262] Step 17.13: Update the parties list HTML

---
 client/parties/views/parties-list.html | 175 +++++++++++++++++++++------------
 1 file changed, 110 insertions(+), 65 deletions(-)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index f9d688f..c66ae56 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -1,73 +1,118 @@
-<form ng-show="$root.currentUser">
-  <label>Name</label>
-  <input ng-model="newParty.name">
-  <label>Description</label>
-  <input ng-model="newParty.description">
-  <label>Public</label>
-  <input type="checkbox" ng-model="newParty.public">
-  <button ng-click="newParty.owner=$root.currentUser._id; parties.save(newParty)">Add</button>
-  <button ng-click="removeAll()">Remove All</button>
-</form>
-<div ng-hide="$root.currentUser || $root.loggingIn">
-  Log in to create a party!
-</div>
-<ul>
-  <h1>Parties:</h1>
-  <div>
-    <input type="search" ng-model="search" placeholder="Search">
-    <select ng-model="orderProperty">
-      <option value="1">Ascending</option>
-      <option value="-1">Descending</option>
-    </select>
-  </div>
-  <div class="angular-google-map-container">
-    <ui-gmap-google-map center="party.location || map.center" zoom="map.zoom">
-      <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
-                       fit="true" idkey="'_id'" doRebuildAll="true">
-      </ui-gmap-markers>
-    </ui-gmap-google-map>
-  </div>
-  <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count">
-    <a href="/parties/{{party._id}}">{{party.name}}</a>
-    <p>{{party.description}}</p>
-    <button ng-click="remove(party)" ng-show="$root.currentUser && $root.currentUser._id == party.owner">X</button>
-
-    <div ng-show="$root.currentUser">
-      <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')">
-      <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')">
-      <input type="button" value="No" ng-click="rsvp(party._id, 'no')">
-    </div>
-    <div ng-hide="$root.currentUser">
-      <i>Sign in to RSVP for this party.</i>
-    </div>
+<div class="row h100">
+  <div class="col-md-6 ma-parties-col">
+    <div class="row">
+      <div class="col-xs-8">
+        <form class="form-inline search-form">
+          <div class="form-group">
+            <label class="sr-only" for="search">Search</label>
 
-    <div>
-      Who is coming:
-      Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
-      Maybe - {{ (party.rsvps | filter:{rsvp:'maybe'}).length }}
-      No - {{ (party.rsvps | filter:{rsvp:'no'}).length }}
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'yes'}">
-        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
-      </div>
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'maybe'}">
-        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+            <div class="input-group">
+              <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div>
+              <input type="text" ng-model="search" placeholder="Search" id="search" class="form-control">
+            </div>
+          </div>
+          <div class="form-group">
+            <label class="sr-only" for="sort-order">Sort Order</label>
+            <select ng-model="orderProperty" class="form-control">
+              <option value="1">Ascending</option>
+              <option value="-1">Descending</option>
+            </select>
+          </div>
+        </form>
       </div>
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'no'}">
-        {{ getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      <div class="col-xs-4 ma-add-button-container">
+        <button class="btn" ng-click="openAddNewPartyModal()"><i class="fa fa-plus"></i></button>
       </div>
     </div>
+    <ul class="list-group">
+      <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count"
+          class="list-group-item ma-party-item">
+
+        <i ng-click="remove(party)" class="ma-remove fa fa-times"
+           ng-show="$root.currentUser && $root.currentUser._id == party.owner"></i>
+
+
+        <div class="row">
+          <div class="col-sm-8">
+            <h2 class="ma-party-name"><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
+
+            <p class="ma-party-description">{{party.description}}</p>
+          </div>
+        </div>
+
+        <div class="row ma-party-item-bottom">
+          <div class="col-sm-8 ma-posted-by-col">
+            <span class="ma-posted-by">Posted by {{ creator(party) | displayName }}  </span>
+
+            <span ng-if="party.public" class="ma-everyone-invited"><i class="fa fa-male"></i> Everyone is invited</span>
+
+                        <span ng-if="!party.public" class="ma-everyone-invited">
+                             <i class="fa fa-user-secret"></i>  This is a private event
+                        </span>
+
+            <div ng-show="$root.currentUser" class="ma-rsvp-buttons">
+              <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')" class="btn"
+                     ng-class="{'btn-primary' : isRSVP('yes', party)}">
+              <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')" class="btn"
+                     ng-class="{'btn-primary' : isRSVP('maybe', party)}">
+              <input type="button" value="No" ng-click="rsvp(party._id, 'no')" class="btn"
+                     ng-class="{'btn-primary' : isRSVP('no', party)}">
+            </div>
+            <div ng-hide="$root.currentUser">
+              <i>Sign in to RSVP for this party.</i>
+            </div>
+
+
+          </div>
+          <div class="col-sm-4">
+            <div class="ma-rsvp-sum">
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'yes'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  YES
+                </div>
+              </div>
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  MAYBE
+                </div>
+              </div>
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'no'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  NO
+                </div>
+              </div>
+            </div>
+
+            <ul ng-if="!party.public">
+              <li ng-repeat="invitedUser in outstandingInvitations(party)">
+                {{ invitedUser | displayName }}
+              </li>
+            </ul>
+
+          </div>
+        </div>
 
-    <ul ng-if="!party.public">
-      Users who not responded:
-      <li ng-repeat="invitedUser in outstandingInvitations(party)">
-        {{ invitedUser | displayName }}
       </li>
     </ul>
-    <div ng-if="party.public">
-      Everyone is invited
-    </div>
+    <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
 
-    <p><small>Posted by {{ creator(party) | displayName }}</small></p>
-  </li>
-</ul>
-<dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
\ No newline at end of file
+  </div>
+  <div class="col-md-6 h100 ma-angular-map-col">
+    <div class="angular-google-map-container h100">
+      <ui-gmap-google-map center="map.center" zoom="map.zoom" options="map.options">
+        <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
+                         fit="true" idkey="'_id'" doRebuildAll="true">
+        </ui-gmap-markers>
+      </ui-gmap-google-map>
+    </div>
+  </div>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From edf22cf8772ab2de5856faae3be775b40f7e6861 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:29:32 +0300
Subject: [PATCH 152/262] Step 17.14: Update the logic of the parties list and
 add style to the map

---
 client/parties/controllers/partiesList.js | 116 ++++++++++++++++++++++++++----
 1 file changed, 102 insertions(+), 14 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 88ce88b..39a6fc6 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,4 +1,4 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state) {
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $modal) {
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
@@ -20,22 +20,82 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     }, $scope.getReactively('search')).then(function(){
       $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
 
-      $scope.parties.forEach( function (party) {
-        party.onClicked = function () {
-          $state.go('partyDetails', {partyId: party._id});
+        $scope.parties.forEach( function (party) {
+          party.onClicked = function () {
+            $state.go('partyDetails', {partyId: party._id});
+          };
+        });
+
+        var styles1 = [{
+          "featureType": "landscape.natural",
+          "elementType": "geometry.fill",
+          "stylers": [{"visibility": "on"}, {"color": "#e0efef"}]
+        }, {
+          "featureType": "poi",
+          "elementType": "geometry.fill",
+          "stylers": [{"visibility": "on"}, {"hue": "#1900ff"}, {"color": "#c0e8e8"}]
+        }, {
+          "featureType": "road",
+          "elementType": "geometry",
+          "stylers": [{"lightness": 100}, {"visibility": "simplified"}]
+        }, {
+          "featureType": "road",
+          "elementType": "labels",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "transit.line",
+          "elementType": "geometry",
+          "stylers": [{"visibility": "on"}, {"lightness": 700}]
+        }, {"featureType": "water", "elementType": "all", "stylers": [{"color": "#7dcdcd"}]}];
+        var styles2 = [{
+          "featureType": "administrative",
+          "elementType": "labels.text.fill",
+          "stylers": [{"color": "#444444"}]
+        }, {
+          "featureType": "landscape",
+          "elementType": "all",
+          "stylers": [{"color": "#f2f2f2"}]
+        }, {
+          "featureType": "poi",
+          "elementType": "all",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "road",
+          "elementType": "all",
+          "stylers": [{"saturation": -100}, {"lightness": 45}]
+        }, {
+          "featureType": "road.highway",
+          "elementType": "all",
+          "stylers": [{"visibility": "simplified"}]
+        }, {
+          "featureType": "road.arterial",
+          "elementType": "labels.icon",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "transit",
+          "elementType": "all",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "water",
+          "elementType": "all",
+          "stylers": [{"color": "#46bcec"}, {"visibility": "on"}]
+        }];
+
+
+        $scope.map = {
+          center: {
+            latitude: 45,
+            longitude: -73
+          },
+          options: {
+            styles: styles2,
+            maxZoom: 10
+          },
+          zoom: 8
         };
-      });
-
-      $scope.map = {
-        center: {
-          latitude: 45,
-          longitude: -73
-        },
-        zoom: 8
-      };
 
+      });
     });
-  });
 
   $scope.remove = function (party) {
     $scope.parties.splice($scope.parties.indexOf(party), 1);
@@ -90,4 +150,32 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
 
     return owner;
   };
+  
+  $scope.openAddNewPartyModal = function () {
+    var modalInstance = $modal.open({
+      animation: true,
+      templateUrl: 'client/parties/views/add-new-party-modal.html',
+      controller: 'AddNewPartyCtrl',
+      resolve: {
+        parties: function () {
+          return $scope.parties;
+        }
+      }
+    });
+
+    modalInstance.result.then(function () {
+    }, function () {
+    });
+  };
+
+  $scope.isRSVP = function (rsvp, party) {
+    if (!$rootScope.currentUser._id) return false;
+    var rsvpIndex = party.myRsvpIndex;
+    rsvpIndex = rsvpIndex || _.indexOf(_.pluck(party.rsvps, 'user'), $rootScope.currentUser._id);
+
+    if (rsvpIndex !== -1) {
+      party.myRsvpIndex = rsvpIndex;
+      return party.rsvps[rsvpIndex].rsvp === rsvp;
+    }
+  }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cb8990d3c17ceab73197bfcd9b0e2f9354151a97 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 15:03:57 +0300
Subject: [PATCH 153/262] Step 17.15: Create less file for each component and
 update the CSS rules

---
 client/parties/styles/navbar.import.less        |  35 +++++++
 client/parties/styles/new.party.import.less     |  19 ++++
 client/parties/styles/parties.import.less       | 123 +++++++++++++++++++++++-
 client/parties/styles/party.details.import.less |  26 +++++
 4 files changed, 200 insertions(+), 3 deletions(-)
 create mode 100644 client/parties/styles/navbar.import.less
 create mode 100644 client/parties/styles/new.party.import.less
 create mode 100644 client/parties/styles/party.details.import.less

diff --git a/client/parties/styles/navbar.import.less b/client/parties/styles/navbar.import.less
new file mode 100644
index 0000000..96a6b49
--- /dev/null
+++ b/client/parties/styles/navbar.import.less
@@ -0,0 +1,35 @@
+// Override Bootstrap navbar
+.navbar {
+  background-color: #ffffff;
+  border-bottom: #eee 1px solid;
+  color: @color3;
+  font-family: 'Muli', sans-serif;
+  a {
+    color: @color3;
+    text-decoration: none !important;
+  }
+
+  .navbar-right-container {
+    position: absolute;
+    top: 17px;
+    right: 17px;
+  }
+}
+
+// Overrise Meteor Login Buttons
+#login-dropdown-list.accounts-dialog {
+  right: 14px;
+  left: auto;
+}
+
+#login-buttons .login-button,
+.accounts-dialog .login-button {
+  background: @color3;
+  color: white;
+  border: none;
+
+  &:hover {
+    background: @color3;
+    color: white;
+  }
+}
\ No newline at end of file
diff --git a/client/parties/styles/new.party.import.less b/client/parties/styles/new.party.import.less
new file mode 100644
index 0000000..6c678fe
--- /dev/null
+++ b/client/parties/styles/new.party.import.less
@@ -0,0 +1,19 @@
+.ma-add-new-party-container {
+  padding: 20px;
+  > form {
+    > h2 {
+      font-siz: 15px;
+      margin-bottom: 20px;
+    }
+    button {
+      background: @color3;
+      color: @color5;
+    }
+  }
+
+  .alert.alert-info {
+    background: @color3;
+    color: @color5;
+    margin-bottom: 0;
+  }
+}
\ No newline at end of file
diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 219ff39..e863737 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -1,4 +1,121 @@
-.angular-google-map-container {
-    height: 400px;
-    width: 400px;
+.ma-add-button-container {
+    button.btn {
+        background: @color3;
+        float: right;
+        margin-right: 5px;
+        outline: none;
+        i {
+            color: @color5;
+        }
+    }
+}
+
+.ma-parties-col {
+    padding-top: 20px;
+}
+
+.ma-party-item {
+    .ma-party-name {
+        margin-bottom: 20px;
+        a {
+            color: @color6;
+            text-decoration: none !important;
+            font-weight: 400;
+        }
+    }
+    .ma-party-description {
+        color: @color6;
+        font-weight: 300;
+        padding-left: 18px;
+        font-size: 14px;
+    }
+
+    .ma-remove {
+        color: lighten(@color7, 20%);
+        position: absolute;
+        right: 20px;
+        top: 20px;
+        &:hover {
+            color: @color7;
+        }
+    }
+
+    .ma-party-item-bottom {
+        padding-top: 10px;
+        .ma-posted-by-col {
+            .ma-posted-by {
+                color: darken(@color4, 30%);
+                font-size: 12px;
+            }
+            .ma-everyone-invited {
+                @media (max-width: 400px) {
+                    display: block;
+                    i {
+                        margin-left: 0px !important;
+                    }
+                }
+                font-size: 12px;
+                color: darken(@color4, 10%);
+                i {
+                    color: darken(@color4, 10%);
+                    margin-left: 5px;
+                }
+            }
+        }
+
+        .ma-rsvp-buttons {
+            input.btn {
+                color: darken(@color3, 20%);
+                background: transparent !important;
+                outline: none;
+                padding-left: 0;
+                &:active {
+                    box-shadow: none;
+                }
+                &:hover {
+                    color: darken(@color3, 30%);
+                }
+                &.btn-primary {
+                    color: lighten(@color3, 10%);
+                    border: 0;
+                    background: transparent !important;
+                }
+            }
+        }
+
+        .ma-rsvp-sum {
+            width: 160px;
+            @media (min-width: 400px) {
+                float: right;
+            }
+            @media (max-width: 400px) {
+                margin: 0 auto;
+            }
+        }
+        .ma-rsvp-amount {
+            display: inline-block;
+            text-align: center;
+            width: 50px;
+            .ma-amount {
+                font-weight: bold;
+                font-size: 20px;
+            }
+            .ma-rsvp-title {
+                font-size: 11px;
+                color: #aaa;
+                text-transform: uppercase;
+            }
+        }
+    }
+}
+
+.ma-angular-map-col {
+    .angular-google-map-container, .angular-google-map {
+        height: 100%;
+        width: 100%;
+    }
+}
+
+.search-form {
+    margin-bottom: 1em;
 }
\ No newline at end of file
diff --git a/client/parties/styles/party.details.import.less b/client/parties/styles/party.details.import.less
new file mode 100644
index 0000000..4f19b98
--- /dev/null
+++ b/client/parties/styles/party.details.import.less
@@ -0,0 +1,26 @@
+.ma-party-details-container {
+  padding: 20px;
+  .angular-google-map-container {
+    width: 100%;
+    height: 100%;
+  }
+  .angular-google-map {
+    width: 100%;
+    height: 400px;
+  }
+  .ma-map-title {
+    font-size: 16px;
+    font-weight: bolder;
+  }
+  .ma-invite-list {
+    margin-top: 20px;
+    margin-bottom: 20px;
+    h3 {
+      font-size: 16px;
+      font-weight: bolder;
+    }
+    ul {
+      padding: 0;
+    }
+  }
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1d9f667aa9264f5a4baf098b49a7f2126b8f70e6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 15:04:28 +0300
Subject: [PATCH 154/262] Step 17.16: Update the main less file to use the new
 files

---
 client/styles/main.less | 38 ++++++++++++++++++++++++++++++++------
 1 file changed, 32 insertions(+), 6 deletions(-)

diff --git a/client/styles/main.less b/client/styles/main.less
index 87c5240..e75ad09 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,11 +1,37 @@
+@color1 : #2F2933;
+@color2 : #01A2A6;
+@color3 : #29D9C2;
+@color4 : #BDF271;
+@color5 : #FFFFA6;
+@color6 : #2F2933;
+@color7 : #FF6F69;
+
+html,body{
+    height:100%;
+}
+
 body {
-    background-color: rgba(0,0,0,.2);
-    padding-top: 70px;
+    background-color: #f8f8f8;
+    padding-top: 50px;
+    font-family: 'Muli', sans-serif;
+}
 
-    .navbar {
-        background-color: #ffffff;
-    }
+.h100{
+    height : 100%;
 }
 
+.w100{
+    width:100%;
+}
+
+
+.ma-main-container{
+    @media (min-width: 400px) {
+        padding-right : 0;
+    }
+}
 
-@import "../parties/styles/parties.import.less";
\ No newline at end of file
+@import "../parties/styles/parties.import.less";
+@import "../parties/styles/navbar.import.less";
+@import "../parties/styles/new.party.import.less";
+@import "../parties/styles/party.details.import.less";
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e278c01069e26ecbe0b198e0d8aa0316dcc1def0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 15:05:35 +0300
Subject: [PATCH 155/262] Step 17.17: Update the view of party details page

---
 client/parties/views/party-details.html | 72 +++++++++++++++++++++++----------
 1 file changed, 50 insertions(+), 22 deletions(-)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index 7ef1f8d..104a657 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -1,26 +1,54 @@
-Here you will see and change the details of the party:
+<div class="row ma-party-details-container">
+  <div class="col-sm-6 col-sm-offset-3">
+    <legend>
+      View and Edit Your Party Details:
+    </legend>
+    <form class="form-horizontal">
+      <div class="form-group">
+        <label>Party Name</label>
+        <input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id" type="text"
+               class="form-control">
+      </div>
+      <div class="form-group">
+        <label>Party Name</label>
+        <input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id" type="text"
+               class="form-control">
+      </div>
+      <div class="form-group">
+        <label>Is public</label>
+        <input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
+      </div>
+    </form>
 
-<input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id">
-<input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id">
-<label>Is public</label>
-<input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
+    <div class="ma-invite-list" ng-show="canInvite()">
+      <h3>
+        Users to invite:
+      </h3>
+      <ul>
 
-<ul ng-show="canInvite()">
-  Users to invite:
-  <li ng-repeat="user in users | uninvited:party">
-    <div>{{ user | displayName }}</div>
-    <button ng-click="invite(user)">Invite</button>
-  </li>
-  <li ng-if="(users | uninvited:party).length <= 0">
-    Everyone are already invited.
-  </li>
-</ul>
+        <li ng-repeat="user in users | uninvited:party">
+          <div>{{ user | displayName }}</div>
+          <button ng-click="invite(user)">Invite</button>
+        </li>
+        <li ng-if="(users | uninvited:party).length <= 0">
+          Everyone are already invited.
+        </li>
+      </ul>
+    </div>
+
+
+    <h3 class="ma-map-title">
+      Click the map to set the party location
+    </h3>
+
+    <div class="angular-google-map-container">
+      <ui-gmap-google-map center="party.location || map.center" 
+                          events="map.events" zoom="map.zoom">
+        <ui-gmap-marker coords="party.location" options="map.marker.options" 
+                        events="map.marker.events" idkey="party._id">
+        </ui-gmap-marker>
+      </ui-gmap-google-map>
+    </div>
+  </div>
 
-<div class="angular-google-map-container">
-  <ui-gmap-google-map center="party.location || map.center"
-                      events="map.events" zoom="map.zoom">
-    <ui-gmap-marker coords="party.location" options="map.marker.options"
-                    events="map.marker.events" idkey="party._id">
-    </ui-gmap-marker>
-  </ui-gmap-google-map>
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 353158d5a0589da272ca597ce9d3580a1c3bbdfe Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:17:21 +0300
Subject: [PATCH 156/262] Step 18.1: Remove the twbs:bootstrap package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index fe1744b..75c33b5 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -25,6 +25,5 @@ tmeasday:publish-counts
 email
 check
 angularui:angular-google-maps
-twbs:bootstrap
 less
 angularui:angular-ui-bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index 65646dc..303fc2e 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -91,7 +91,6 @@ templating@1.1.5
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
 tracker@1.0.8
-twbs:bootstrap@3.3.5
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
-- 
2.3.2 (Apple Git-55)


From c3197019fb7edf03ae828fede56cd5c842adae06 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:20:39 +0300
Subject: [PATCH 157/262] Step 18.2: Add the angular:angular-material package

---
 .meteor/packages | 1 +
 .meteor/versions | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 75c33b5..1044ccb 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -27,3 +27,4 @@ check
 angularui:angular-google-maps
 less
 angularui:angular-ui-bootstrap
+angular:angular-material
diff --git a/.meteor/versions b/.meteor/versions
index 303fc2e..6cca12a 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -9,6 +9,9 @@ angular@1.2.0-rc.3
 angular-meteor-data@0.0.1
 angular-templates@0.0.1
 angular:angular@1.4.7
+angular:angular-animate@1.4.7
+angular:angular-aria@1.4.7
+angular:angular-material@0.11.0
 angularui:angular-google-maps@2.2.1
 angularui:angular-ui-bootstrap@0.13.0
 angularui:angular-ui-router@0.2.15
-- 
2.3.2 (Apple Git-55)


From c91b7addb9837085776d94cb4dd800eda497907b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:32:13 +0300
Subject: [PATCH 158/262] Step 18.3: Add the ngMaterial dependency

---
 client/lib/app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index ad169e4..f3db72d 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -4,7 +4,7 @@ angular.module('socially',[
   'accounts.ui',
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
-  'ui.bootstrap'
+  'ngMaterial'
 ]);
 function onReady() {
   angular.bootstrap(document, ['socially'], {
-- 
2.3.2 (Apple Git-55)


From 2130c1701baf48ab3717ca33ee529e62a7a509f3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:32:28 +0300
Subject: [PATCH 159/262] Step 18.4: Remove $modal and use $mdDialog instead

---
 client/parties/controllers/partiesList.js | 39 ++++++++++++++++---------------
 1 file changed, 20 insertions(+), 19 deletions(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 39a6fc6..fa9993b 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,4 +1,4 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $modal) {
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $mdDialog) {
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
@@ -148,25 +148,26 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
         if (owner._id === $rootScope.currentUser._id)
           return 'me';
 
-    return owner;
-  };
-  
-  $scope.openAddNewPartyModal = function () {
-    var modalInstance = $modal.open({
-      animation: true,
-      templateUrl: 'client/parties/views/add-new-party-modal.html',
-      controller: 'AddNewPartyCtrl',
-      resolve: {
-        parties: function () {
-          return $scope.parties;
+      return owner;
+    };
+
+    $scope.openAddNewPartyModal = function(){
+      $mdDialog.show({
+        controller: 'AddNewPartyCtrl',
+        templateUrl: 'client/parties/views/add-new-party-modal.html',
+        clickOutsideToClose:true,
+        resolve: {
+          parties: function () {
+            return $scope.parties;
+          }
         }
-      }
-    });
-
-    modalInstance.result.then(function () {
-    }, function () {
-    });
-  };
+      })
+        .then(function(answer) {
+          $scope.status = 'You said the information was "' + answer + '".';
+        }, function() {
+          $scope.status = 'You cancelled the dialog.';
+        });
+    };
 
   $scope.isRSVP = function (rsvp, party) {
     if (!$rootScope.currentUser._id) return false;
-- 
2.3.2 (Apple Git-55)


From 39a8e366ef4c7116c74d7bb12545ad25820e1b0a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:34:26 +0300
Subject: [PATCH 160/262] Step 18.5: Update usage in the modal controller

---
 client/parties/controllers/addNewParty.js | 19 ++++++++++++-------
 1 file changed, 12 insertions(+), 7 deletions(-)

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
index f2d0d1a..af25c36 100644
--- a/client/parties/controllers/addNewParty.js
+++ b/client/parties/controllers/addNewParty.js
@@ -1,10 +1,15 @@
-angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$modalInstance', 'parties',
-  function ($scope, $meteor, $rootScope, $state, $modalInstance, parties) {
-
+angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog', 'parties',
+  function ($scope, $meteor, $rootScope, $state, $mdDialog, parties) {
+    $scope.newParty = {};
     $scope.addNewParty = function () {
-      $scope.newParty.owner = $rootScope.currentUser._id;
-      parties.push($scope.newParty);
-      $scope.newParty = '';
-      $modalInstance.close();
+      if($scope.newParty.name){
+        $scope.newParty.owner = $rootScope.currentUser._id;
+        parties.push($scope.newParty);
+        $scope.newParty = '';
+        $mdDialog.hide();
+      }
+    }
+    $scope.close = function () {
+      $mdDialog.hide();
     }
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 3368087b444829a0e4aac9317a3f5dfbae1ecd9e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:46:47 +0300
Subject: [PATCH 161/262] Step 18.6: Update the LESS files to match
 angular-material

---
 client/parties/styles/navbar.import.less        |  36 +-----
 client/parties/styles/new.party.import.less     |  19 ---
 client/parties/styles/parties.import.less       | 151 ++++++++----------------
 client/parties/styles/party.details.import.less |  28 +----
 client/styles/main.less                         |  35 +-----
 5 files changed, 55 insertions(+), 214 deletions(-)
 delete mode 100644 client/parties/styles/new.party.import.less

diff --git a/client/parties/styles/navbar.import.less b/client/parties/styles/navbar.import.less
index 96a6b49..f42291d 100644
--- a/client/parties/styles/navbar.import.less
+++ b/client/parties/styles/navbar.import.less
@@ -1,35 +1,5 @@
-// Override Bootstrap navbar
-.navbar {
-  background-color: #ffffff;
-  border-bottom: #eee 1px solid;
-  color: @color3;
-  font-family: 'Muli', sans-serif;
-  a {
-    color: @color3;
-    text-decoration: none !important;
-  }
-
-  .navbar-right-container {
-    position: absolute;
-    top: 17px;
-    right: 17px;
-  }
-}
-
-// Overrise Meteor Login Buttons
-#login-dropdown-list.accounts-dialog {
-  right: 14px;
-  left: auto;
-}
-
-#login-buttons .login-button,
-.accounts-dialog .login-button {
-  background: @color3;
-  color: white;
-  border: none;
-
-  &:hover {
-    background: @color3;
-    color: white;
+md-toolbar {
+  h2{
+    margin : 0;
   }
 }
\ No newline at end of file
diff --git a/client/parties/styles/new.party.import.less b/client/parties/styles/new.party.import.less
deleted file mode 100644
index 6c678fe..0000000
--- a/client/parties/styles/new.party.import.less
+++ /dev/null
@@ -1,19 +0,0 @@
-.ma-add-new-party-container {
-  padding: 20px;
-  > form {
-    > h2 {
-      font-siz: 15px;
-      margin-bottom: 20px;
-    }
-    button {
-      background: @color3;
-      color: @color5;
-    }
-  }
-
-  .alert.alert-info {
-    background: @color3;
-    color: @color5;
-    margin-bottom: 0;
-  }
-}
\ No newline at end of file
diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index e863737..0f7beb6 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -1,121 +1,62 @@
-.ma-add-button-container {
-    button.btn {
-        background: @color3;
-        float: right;
-        margin-right: 5px;
-        outline: none;
-        i {
-            color: @color5;
-        }
-    }
+
+.navbar-text {
+    margin-right: 0;
 }
 
-.ma-parties-col {
-    padding-top: 20px;
+#login-dropdown-list.accounts-dialog {
+    right: 14px;
+    left: auto;
 }
 
-.ma-party-item {
-    .ma-party-name {
-        margin-bottom: 20px;
-        a {
-            color: @color6;
-            text-decoration: none !important;
-            font-weight: 400;
-        }
-    }
-    .ma-party-description {
-        color: @color6;
-        font-weight: 300;
-        padding-left: 18px;
-        font-size: 14px;
+.search-form {
+    margin-bottom: 1em;
+}
+
+.ma-parties-list{
+    .angular-google-map{
+        box-sizing: border-box;
+        -webkit-flex: 1;
+        -ms-flex: 1;
+        flex: 1;
+        -webkit-flex-direction: row;
+        -ms-flex-direction: row;
+        flex-direction: row;
+        box-sizing: border-box;
+        display: -webkit-flex;
+        display: -moz-flex;
+        display: -ms-flexbox;
+        display: flex;
     }
 
-    .ma-remove {
-        color: lighten(@color7, 20%);
-        position: absolute;
-        right: 20px;
-        top: 20px;
-        &:hover {
-            color: @color7;
-        }
+    .angular-google-map-container{
+        box-sizing: border-box;
+        -webkit-flex: 1;
+        -ms-flex: 1;
+        flex: 1;
     }
 
-    .ma-party-item-bottom {
-        padding-top: 10px;
-        .ma-posted-by-col {
-            .ma-posted-by {
-                color: darken(@color4, 30%);
-                font-size: 12px;
-            }
-            .ma-everyone-invited {
-                @media (max-width: 400px) {
-                    display: block;
-                    i {
-                        margin-left: 0px !important;
-                    }
-                }
-                font-size: 12px;
-                color: darken(@color4, 10%);
-                i {
-                    color: darken(@color4, 10%);
-                    margin-left: 5px;
-                }
-            }
+    .rsvps-sum{
+        float:left;
+        width:50px;
+        text-align: center;
+        .rsvps-amount{
+            font-size:24px;
         }
-
-        .ma-rsvp-buttons {
-            input.btn {
-                color: darken(@color3, 20%);
-                background: transparent !important;
-                outline: none;
-                padding-left: 0;
-                &:active {
-                    box-shadow: none;
-                }
-                &:hover {
-                    color: darken(@color3, 30%);
-                }
-                &.btn-primary {
-                    color: lighten(@color3, 10%);
-                    border: 0;
-                    background: transparent !important;
-                }
-            }
+        .rsvps-title{
+            font-size:13px;
+            color:#aaa;
         }
+    }
 
-        .ma-rsvp-sum {
-            width: 160px;
-            @media (min-width: 400px) {
-                float: right;
-            }
-            @media (max-width: 400px) {
-                margin: 0 auto;
+    .ma-party{
+        .ma-name{
+            a{
+                text-decoration: none;
+                color : #333;
             }
         }
-        .ma-rsvp-amount {
-            display: inline-block;
-            text-align: center;
-            width: 50px;
-            .ma-amount {
-                font-weight: bold;
-                font-size: 20px;
-            }
-            .ma-rsvp-title {
-                font-size: 11px;
-                color: #aaa;
-                text-transform: uppercase;
-            }
-        }
-    }
-}
+        .ma-description{
 
-.ma-angular-map-col {
-    .angular-google-map-container, .angular-google-map {
-        height: 100%;
-        width: 100%;
+        }
     }
-}
-
-.search-form {
-    margin-bottom: 1em;
 }
\ No newline at end of file
diff --git a/client/parties/styles/party.details.import.less b/client/parties/styles/party.details.import.less
index 4f19b98..6011e87 100644
--- a/client/parties/styles/party.details.import.less
+++ b/client/parties/styles/party.details.import.less
@@ -1,26 +1,6 @@
-.ma-party-details-container {
-  padding: 20px;
-  .angular-google-map-container {
-    width: 100%;
-    height: 100%;
-  }
-  .angular-google-map {
-    width: 100%;
-    height: 400px;
-  }
-  .ma-map-title {
-    font-size: 16px;
-    font-weight: bolder;
-  }
-  .ma-invite-list {
-    margin-top: 20px;
-    margin-bottom: 20px;
-    h3 {
-      font-size: 16px;
-      font-weight: bolder;
-    }
-    ul {
-      padding: 0;
-    }
+.ma-party-details{
+  .angular-google-map-container, .angular-google-map{
+    width:100%;
+    height:400px;
   }
 }
\ No newline at end of file
diff --git a/client/styles/main.less b/client/styles/main.less
index e75ad09..438dc59 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,37 +1,6 @@
-@color1 : #2F2933;
-@color2 : #01A2A6;
-@color3 : #29D9C2;
-@color4 : #BDF271;
-@color5 : #FFFFA6;
-@color6 : #2F2933;
-@color7 : #FF6F69;
-
-html,body{
-    height:100%;
-}
-
-body {
-    background-color: #f8f8f8;
-    padding-top: 50px;
-    font-family: 'Muli', sans-serif;
-}
-
-.h100{
-    height : 100%;
-}
-
-.w100{
-    width:100%;
-}
-
-
-.ma-main-container{
-    @media (min-width: 400px) {
-        padding-right : 0;
-    }
+html, body {
 }
 
 @import "../parties/styles/parties.import.less";
+@import "../parties/styles/party.details.import.less";
 @import "../parties/styles/navbar.import.less";
-@import "../parties/styles/new.party.import.less";
-@import "../parties/styles/party.details.import.less";
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 22b490847546d4005a455a4d3eb518cabace68ce Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:49:04 +0300
Subject: [PATCH 162/262] Step 18.7: Update the index.html to use
 angular-material

---
 client/index.html | 30 ++++++++++++------------------
 1 file changed, 12 insertions(+), 18 deletions(-)

diff --git a/client/index.html b/client/index.html
index 250571e..5d08d6f 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,23 +1,17 @@
 <head>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
-  <link href='http://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
-  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
+  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
 </head>
-<body>
-
-<nav class="navbar navbar-default navbar-fixed-top">
-  <div class="container">
-    <div class="navbar-header">
-      <a class="navbar-brand" href="/">socially</a>
-    </div>
-    <div class="navbar-right-container">
-      <login-buttons></login-buttons>
-    </div>
+<body layout="column">
+<md-toolbar md-scroll-shrink layout="row" layout-align="start center" layout-padding>
+  <h2>
+    <a ui-sref="parties"><span class="md-title">Socially</span></a>
+  </h2>
+  <span flex></span>
+  <div class="navbar-right navbar-text">
+    <login-buttons></login-buttons>
   </div>
-</nav>
-
-<div class="h100">
-  <div ui-view class="ma-main-container container-fluid h100"></div>
-</div>
-</body>
+</md-toolbar>
+<div ui-view flex-gt-sm layout-gt-sm="row"></div>
+</body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e0ba68b8a580544b21a8e756e2178454df38b7da Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:51:31 +0300
Subject: [PATCH 163/262] Step 18.8: Update parties list to use material's
 directives

---
 client/parties/views/parties-list.html | 163 ++++++++++++---------------------
 1 file changed, 60 insertions(+), 103 deletions(-)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index c66ae56..a389551 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -1,118 +1,75 @@
-<div class="row h100">
-  <div class="col-md-6 ma-parties-col">
-    <div class="row">
-      <div class="col-xs-8">
-        <form class="form-inline search-form">
-          <div class="form-group">
-            <label class="sr-only" for="search">Search</label>
-
-            <div class="input-group">
-              <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div>
-              <input type="text" ng-model="search" placeholder="Search" id="search" class="form-control">
-            </div>
-          </div>
-          <div class="form-group">
-            <label class="sr-only" for="sort-order">Sort Order</label>
-            <select ng-model="orderProperty" class="form-control">
-              <option value="1">Ascending</option>
-              <option value="-1">Descending</option>
-            </select>
-          </div>
-        </form>
-      </div>
-      <div class="col-xs-4 ma-add-button-container">
-        <button class="btn" ng-click="openAddNewPartyModal()"><i class="fa fa-plus"></i></button>
-      </div>
-    </div>
-    <ul class="list-group">
-      <li dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count"
-          class="list-group-item ma-party-item">
-
-        <i ng-click="remove(party)" class="ma-remove fa fa-times"
-           ng-show="$root.currentUser && $root.currentUser._id == party.owner"></i>
-
-
-        <div class="row">
-          <div class="col-sm-8">
-            <h2 class="ma-party-name"><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
-
-            <p class="ma-party-description">{{party.description}}</p>
-          </div>
+<md-content flex-gt-sm layout-gt-sm="row" class="ma-parties-list">
+  <div layout-gt-sm="row" flex-gt-sm>
+    <div flex-gt-sm="50" flex-sm>
+      <div>
+        <div layout-padding layout="row">
+          <md-input-container style="width:50%;margin-right:10px;">
+            <label>Search</label>
+            <input type="text" ng-model="search"/>
+          </md-input-container>
+          <md-select ng-model="orderProperty" placeholder="Sort Order" >
+            <md-option value="1">Ascending</md-option>
+            <md-option value="-1">Descending</md-option>
+          </md-select>
+          <md-button class="md-fab" aria-label="Eat cake" ng-click="openAddNewPartyModal()">
+            <md-icon md-font-set="material-icons"> add </md-icon>
+          </md-button>
         </div>
+      </div>
+      <md-content class="md-padding" style="padding-top:0;">
+        <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
+        <div  dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count" class="ma-party">
+          <md-card>
+            <md-card-content>
+              <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
+              <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
 
-        <div class="row ma-party-item-bottom">
-          <div class="col-sm-8 ma-posted-by-col">
-            <span class="ma-posted-by">Posted by {{ creator(party) | displayName }}  </span>
-
-            <span ng-if="party.public" class="ma-everyone-invited"><i class="fa fa-male"></i> Everyone is invited</span>
-
-                        <span ng-if="!party.public" class="ma-everyone-invited">
-                             <i class="fa fa-user-secret"></i>  This is a private event
-                        </span>
-
-            <div ng-show="$root.currentUser" class="ma-rsvp-buttons">
-              <input type="button" value="I'm going!" ng-click="rsvp(party._id, 'yes')" class="btn"
-                     ng-class="{'btn-primary' : isRSVP('yes', party)}">
-              <input type="button" value="Maybe" ng-click="rsvp(party._id, 'maybe')" class="btn"
-                     ng-class="{'btn-primary' : isRSVP('maybe', party)}">
-              <input type="button" value="No" ng-click="rsvp(party._id, 'no')" class="btn"
-                     ng-class="{'btn-primary' : isRSVP('no', party)}">
-            </div>
-            <div ng-hide="$root.currentUser">
-              <i>Sign in to RSVP for this party.</i>
-            </div>
 
+              <div layout="row">
+                <div flex="1">
+                  <p style="margin-top:0px;margin-bottom:3px;font-size:14px;color:#aaa;">
+                    <small>Posted by {{ creator(party) | displayName }}</small>
+                    <span ng-if="party.public" style="font-size:12px;color:#999;">| Everyone is invited</span>
+                  </p>
 
-          </div>
-          <div class="col-sm-4">
-            <div class="ma-rsvp-sum">
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'yes'}).length || "0"}}
+                  <div ng-show="$root.currentUser" class="md-actions" layout="row">
+                    <md-button ng-click="rsvp(party._id, 'yes')">I'm going!</md-button>
+                    <md-button ng-click="rsvp(party._id, 'maybe')">Maybe</md-button>
+                    <md-button ng-click="rsvp(party._id, 'no')">No</md-button>
+                  </div>
                 </div>
-                <div class="ma-rsvp-title">
-                  YES
+                <div  layout="row" layout-align="end end">
+                  <div ng-hide="$root.currentUser" style="font-size:13px;margin-bottom:10px;">
+                    Sign in to RSVP for this party
+                  </div>
+                  <div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'yes'}).length || "0" }}</div>
+                      <div class="rsvps-title">Yes</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0" }}</div>
+                      <div class="rsvps-title">Maybe</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'no'}).length || "0" }}</div>
+                      <div class="rsvps-title">No</div>
+                    </div>
+                  </div>
                 </div>
               </div>
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0"}}
-                </div>
-                <div class="ma-rsvp-title">
-                  MAYBE
-                </div>
-              </div>
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'no'}).length || "0"}}
-                </div>
-                <div class="ma-rsvp-title">
-                  NO
-                </div>
-              </div>
-            </div>
-
-            <ul ng-if="!party.public">
-              <li ng-repeat="invitedUser in outstandingInvitations(party)">
-                {{ invitedUser | displayName }}
-              </li>
-            </ul>
-
-          </div>
+            </md-card-content>
+          </md-card>
         </div>
+      </md-content>
 
-      </li>
-    </ul>
-    <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
-
-  </div>
-  <div class="col-md-6 h100 ma-angular-map-col">
-    <div class="angular-google-map-container h100">
-      <ui-gmap-google-map center="map.center" zoom="map.zoom" options="map.options">
+    </div>
+    <div flex-gt-sm="50" flex-sm layout="row" style="min-height:300px;">
+      <ui-gmap-google-map options="map.options" center="map.center" zoom="map.zoom" flex layout="row">
         <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
                          fit="true" idkey="'_id'" doRebuildAll="true">
         </ui-gmap-markers>
       </ui-gmap-google-map>
     </div>
   </div>
-</div>
\ No newline at end of file
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7e69db8e72c472e7e789742db4b4b80f1616bed8 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:34:12 +0300
Subject: [PATCH 164/262] Step 18.9: Add the
 planettraining:material-design-icons package

---
 .meteor/packages | 1 +
 .meteor/versions | 8 +++++---
 2 files changed, 6 insertions(+), 3 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 1044ccb..02a6613 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -28,3 +28,4 @@ angularui:angular-google-maps
 less
 angularui:angular-ui-bootstrap
 angular:angular-material
+planettraining:material-design-icons
diff --git a/.meteor/versions b/.meteor/versions
index 6cca12a..bcf235b 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -11,11 +11,11 @@ angular-templates@0.0.1
 angular:angular@1.4.7
 angular:angular-animate@1.4.7
 angular:angular-aria@1.4.7
-angular:angular-material@0.11.0
+angular:angular-material@0.11.4
 angularui:angular-google-maps@2.2.1
 angularui:angular-ui-bootstrap@0.13.0
 angularui:angular-ui-router@0.2.15
-angularutils:pagination@0.7.0
+angularutils:pagination@0.9.1_2
 autoupdate@1.2.4
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
@@ -66,6 +66,7 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.3
 mongo-id@1.0.1
+nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
 oauth@1.1.6
@@ -74,6 +75,7 @@ oauth2@1.1.5
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.2
+planettraining:material-design-icons@2.0.0
 promise@0.5.1
 random@1.0.5
 rate-limit@1.0.0
@@ -93,7 +95,7 @@ stevezhu:lodash@1.0.2
 templating@1.1.5
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
-tracker@1.0.8
+tracker@1.0.9
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
-- 
2.3.2 (Apple Git-55)


From a7371d68a921ab8cd4ba439bda4ea946949cfb73 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:56:15 +0300
Subject: [PATCH 165/262] Step 18.10: Add angular material icons definitions

---
 client/lib/app.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/client/lib/app.js b/client/lib/app.js
index f3db72d..5be09e6 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -6,6 +6,23 @@ angular.module('socially',[
   'uiGmapgoogle-maps',
   'ngMaterial'
 ]);
+
+var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
+
+  $mdIconProvider
+    .iconSet("social", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-social.svg")
+    .iconSet("action", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-action.svg")
+    .iconSet("communication", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-communication.svg")
+    .iconSet("content", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-content.svg")
+    .iconSet("toggle", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-toggle.svg")
+    .iconSet("navigation", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-navigation.svg")
+    .iconSet("image", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-image.svg");
+
+}];
+
+angular.module('socially')
+  .config(themeIcons);
+
 function onReady() {
   angular.bootstrap(document, ['socially'], {
     strictDi: true
-- 
2.3.2 (Apple Git-55)


From eff5d958b19e65a7886ec6a634ba19ad2dfbfedf Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 22:58:59 +0300
Subject: [PATCH 166/262] Step 18.11: Update party details view to use
 angular-material

---
 client/parties/views/party-details.html | 82 +++++++++++++++------------------
 1 file changed, 37 insertions(+), 45 deletions(-)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index 104a657..a1d808c 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -1,54 +1,46 @@
-<div class="row ma-party-details-container">
-  <div class="col-sm-6 col-sm-offset-3">
-    <legend>
-      View and Edit Your Party Details:
+<div layout="row" flex class="ma-party-details">
+  <div flex="33" offset="33">
+    <legend style="margin:20px 0;">
+      Here you will see and change the details of the party:
     </legend>
-    <form class="form-horizontal">
-      <div class="form-group">
+    <form layout="column">
+      <md-input-container>
         <label>Party Name</label>
-        <input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id" type="text"
-               class="form-control">
-      </div>
-      <div class="form-group">
-        <label>Party Name</label>
-        <input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id" type="text"
-               class="form-control">
-      </div>
-      <div class="form-group">
-        <label>Is public</label>
-        <input type="checkbox" ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id">
-      </div>
-    </form>
+        <input ng-model="party.name" ng-disabled="party.owner != $root.currentUser._id" type="text" aria-label="Name">
+      </md-input-container>
+      <md-input-container>
+        <label>Party Description</label>
+        <input ng-model="party.description" ng-disabled="party.owner != $root.currentUser._id" type="text" aria-label="Description">
+      </md-input-container>
+      <md-checkbox ng-model="party.public" ng-disabled="party.owner != $root.currentUser._id" aria-label="Public">
+        Is public
+      </md-checkbox>
 
-    <div class="ma-invite-list" ng-show="canInvite()">
-      <h3>
-        Users to invite:
-      </h3>
-      <ul>
+      <div layout="row" layout-align="left">
+        <md-button ng-click="save()">Save</md-button>
+        <md-button ng-click="reset()">Reset form</md-button>
+        <md-button ng-href="/parties">Cancel</md-button>
+      </div>
 
-        <li ng-repeat="user in users | uninvited:party">
+      <md-list ng-show="canInvite()">
+        <md-subheader class="md-no-sticky">Users to invite:</md-subheader>
+        <md-list-item ng-repeat="user in users | uninvited:party">
           <div>{{ user | displayName }}</div>
-          <button ng-click="invite(user)">Invite</button>
-        </li>
-        <li ng-if="(users | uninvited:party).length <= 0">
+          <md-button ng-click="invite(user)">Invite</md-button>
+        </md-list-item>
+        <md-list-item ng-if="(users | uninvited:party).length <= 0">
           Everyone are already invited.
-        </li>
-      </ul>
-    </div>
+        </md-list-item>
+      </md-list>
 
-
-    <h3 class="ma-map-title">
-      Click the map to set the party location
-    </h3>
-
-    <div class="angular-google-map-container">
-      <ui-gmap-google-map center="party.location || map.center" 
-                          events="map.events" zoom="map.zoom">
-        <ui-gmap-marker coords="party.location" options="map.marker.options" 
-                        events="map.marker.events" idkey="party._id">
-        </ui-gmap-marker>
-      </ui-gmap-google-map>
-    </div>
+      <div class="angular-google-map-container">
+        <ui-gmap-google-map center="party.location || map.center" 
+                            events="map.events" zoom="map.zoom">
+          <ui-gmap-marker coords="party.location" options="map.marker.options" 
+                          events="map.marker.events" idkey="party._id">
+          </ui-gmap-marker>
+        </ui-gmap-google-map>
+      </div>
+    </form>
   </div>
-
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 40b0824b3b1ee09175c8558aac7eb7f11475e0ad Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 9 Sep 2015 23:01:12 +0300
Subject: [PATCH 167/262] Step 18.12: Update new party modal view to use
 angular-material

---
 client/parties/views/add-new-party-modal.html | 54 ++++++++++++++++-----------
 1 file changed, 32 insertions(+), 22 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index 5fd3485..464d006 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -1,24 +1,34 @@
-<div class="container-fluid ma-add-new-party-container">
-  <div class="alert alert-info" ng-hide="$root.currentUser || $root.loggingIn">
-    Please log in to create a party!
-  </div>
-
-  <form ng-show="$root.currentUser || $root.loggingIn">
-    <h2>Create a new party</h2>
-
-    <div class="form-group">
-      <label for="nameInput">Name</label>
-      <input ng-model="newParty.name" id="nameInput" type="text" class="form-control">
+<md-dialog aria-label="Mango (Fruit)">
+  <form>
+    <md-toolbar>
+      <div class="md-toolbar-tools">
+        <h2> Create a new party</h2>
+        <span flex></span>
+      </div>
+    </md-toolbar>
+    <md-dialog-content style="min-width:300px;max-width:800px;max-height:810px; ">
+      <div  ng-show="$root.currentUser">
+        <md-input-container>
+          <label>Name</label>
+          <input ng-model="newParty.name" id="nameInput" type="text" aria-label="Name">
+        </md-input-container>
+        <md-input-container>
+          <label>Description</label>
+          <input ng-model="newParty.description" id="description" type="text" aria-label="Description">
+        </md-input-container>
+        <md-checkbox ng-model="newParty.public" id="public" aria-label="Public">
+          Public
+        </md-checkbox>
+      </div>
+    </md-dialog-content>
+    <div class="md-actions" layout="row">
+      <span flex></span>
+      <md-button ng-click="close()">
+        Close
+      </md-button>
+      <md-button ng-click="addNewParty()" style="margin-right:20px;">
+        Add
+      </md-button>
     </div>
-    <div class="form-group">
-      <label for="description">Description</label>
-      <input ng-model="newParty.description" id="description" type="text" class="form-control">
-    </div>
-    <div class="form-group">
-      <label for="public">
-        <input type="checkbox" ng-model="newParty.public" id="public"> Public
-      </label>
-    </div>
-    <button ng-click="addNewParty()" class="btn">Add</button>
   </form>
-</div>
\ No newline at end of file
+</md-dialog>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c2218530a8ff58f532f7871b55a14a779bf35a42 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:57:59 +0300
Subject: [PATCH 168/262] Step 18.13: Custom auth buttons

---
 client/index.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 5d08d6f..f739374 100644
--- a/client/index.html
+++ b/client/index.html
@@ -10,7 +10,10 @@
   </h2>
   <span flex></span>
   <div class="navbar-right navbar-text">
-    <login-buttons></login-buttons>
+    <md-button ng-href="/login" ng-hide="$root.currentUser">Login</md-button>
+    <md-button ng-href="/register" ng-hide="$root.currentUser">Sign up</md-button>
+    <div ng-show="$root.currentUser">{{ $root.currentUser | displayName }}</div>
+    <md-button ng-href="/logout" ng-show="$root.currentUser">Logout</md-button>
   </div>
 </md-toolbar>
 <div ui-view flex-gt-sm layout-gt-sm="row"></div>
-- 
2.3.2 (Apple Git-55)


From c87b3202c932f907f8d6f4825501c5c73b4aad22 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:58:20 +0300
Subject: [PATCH 169/262] Step 18.14: Add custom auth routes

---
 client/routes.js | 32 +++++++++++++++++++++++++++++++-
 1 file changed, 31 insertions(+), 1 deletion(-)

diff --git a/client/routes.js b/client/routes.js
index b48fe70..4f86aa7 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -22,10 +22,40 @@ angular.module("socially").config(function ($urlRouterProvider, $stateProvider,
       templateUrl: 'client/parties/views/party-details.html',
       controller: 'PartyDetailsCtrl',
       resolve: {
-        "currentUser": function ($meteor) {
+        "currentUser": function($meteor){
           return $meteor.requireUser();
         }
       }
+    })
+    .state('login', {
+      url: '/login',
+      templateUrl: 'client/users/views/login.html',
+      controller: 'LoginCtrl',
+      controllerAs: 'lc'
+    })
+    .state('register',{
+      url: '/register',
+      templateUrl: 'client/users/views/register.html',
+      controller: 'RegisterCtrl',
+      controllerAs: 'rc'
+    })
+    .state('resetpw', {
+      url: '/resetpw',
+      templateUrl: 'client/users/views/reset-password.html',
+      controller: 'ResetCtrl',
+      controllerAs: 'rpc'
+    })
+    .state('logout', {
+      url: '/logout',
+      resolve: {
+        "logout": function($meteor, $state) {
+          return $meteor.logout().then(function(){
+            $state.go('parties');
+          }, function(err){
+            console.log('logout error - ', err);
+          });
+        }
+      }
     });
 
   $urlRouterProvider.otherwise("/parties");
-- 
2.3.2 (Apple Git-55)


From 52ba0e256743757b74a2023d6513575c335062e9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:51:12 +0300
Subject: [PATCH 170/262] Step 18.15: Create login controller

---
 client/users/controllers/login.js | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 client/users/controllers/login.js

diff --git a/client/users/controllers/login.js b/client/users/controllers/login.js
new file mode 100644
index 0000000..d1e4664
--- /dev/null
+++ b/client/users/controllers/login.js
@@ -0,0 +1,23 @@
+angular.module("socially").controller("LoginCtrl", ['$meteor', '$state',
+  function ($meteor, $state) {
+    var vm = this;
+
+    vm.credentials = {
+      email: '',
+      password: ''
+    };
+
+    vm.error = '';
+
+    vm.login = function () {
+      $meteor.loginWithPassword(vm.credentials.email, vm.credentials.password).then(
+        function () {
+          $state.go('parties');
+        },
+        function (err) {
+          vm.error = 'Login error - ' + err;
+        }
+      );
+    };
+  }
+]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 979e683f2e41d45bcaecef38faedadda9c823aef Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:51:31 +0300
Subject: [PATCH 171/262] Step 18.16: Create login view

---
 client/users/views/login.html | 62 +++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 62 insertions(+)
 create mode 100644 client/users/views/login.html

diff --git a/client/users/views/login.html b/client/users/views/login.html
new file mode 100644
index 0000000..587e578
--- /dev/null
+++ b/client/users/views/login.html
@@ -0,0 +1,62 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Sign in </h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Use existing account</p>
+      </div>
+      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="google" style="color: #DC4A38;"></md-icon>
+          <span> Google</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="facebook" style="color: #3F62B4;"></md-icon>
+          <span>Facebook </span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="twitter" style="color: #27AAE2;"></md-icon>
+          <span>Twitter </span>
+        </md-button>
+      </div>
+      <md-divider class="inset"></md-divider>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Sign in with your email</p>
+      </div>
+
+      <form name="loginForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <label> Email </label>
+          <input type="text" ng-model="lc.credentials.email" aria-label="email" required/>
+        </md-input-container>
+        <md-input-container>
+          <label> Password </label>
+          <input type="password" ng-model="lc.credentials.password" aria-label="password" required/>
+        </md-input-container>
+        <div layout="row" layout-align="space-between center">
+          <a class="md-button" href="/resetPassword">Forgot password?</a>
+          <md-button class="md-raised md-primary" ng-click="lc.login()" aria-label="login"
+                     ng-disabled="lc.loginForm.$invalid()">Sign In
+          </md-button>
+        </div>
+      </form>
+      <md-toolbar ng-show="lc.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ lc.error }}</p>
+      </md-toolbar>
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/register">Need an account?</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ce47270d3597ff0181f86e2eb17f069cf939bc00 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:53:17 +0300
Subject: [PATCH 172/262] Step 18.17: Create register controller

---
 client/users/controllers/register.js | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 client/users/controllers/register.js

diff --git a/client/users/controllers/register.js b/client/users/controllers/register.js
new file mode 100644
index 0000000..f21b5f5
--- /dev/null
+++ b/client/users/controllers/register.js
@@ -0,0 +1,23 @@
+angular.module("socially").controller("RegisterCtrl", ['$meteor', '$state',
+  function ($meteor, $state) {
+    var vm = this;
+
+    vm.credentials = {
+      email: '',
+      password: ''
+    };
+
+    vm.error = '';
+
+    vm.register = function () {
+      $meteor.createUser(vm.credentials).then(
+        function () {
+          $state.go('parties');
+        },
+        function (err) {
+          vm.error = 'Registration error - ' + err;
+        }
+      );
+    };
+  }
+]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d495702e51416e07daa22b49359978fb0a3bae49 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:53:37 +0300
Subject: [PATCH 173/262] Step 18.18: Create register view

---
 client/users/views/register.html | 63 ++++++++++++++++++++++++++++++++++++++++
 1 file changed, 63 insertions(+)
 create mode 100644 client/users/views/register.html

diff --git a/client/users/views/register.html b/client/users/views/register.html
new file mode 100644
index 0000000..6eac4fc
--- /dev/null
+++ b/client/users/views/register.html
@@ -0,0 +1,63 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Register a new account</h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">Use your email?</p>
+      </div>
+
+      <form name="registerForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container >
+          <label> Email </label>
+          <input type="text" ng-model="rc.credentials.email" placeholder="email" aria-label="email" required/>
+        </md-input-container>
+        <md-input-container >
+          <label> Password </label>
+          <input type="password" ng-model="rc.credentials.password" placeholder="password" aria-label="password" required/>
+        </md-input-container>
+        <div layout="row" layout-align="end center">
+          <md-button class="md-raised md-primary" ng-click="rc.register()" aria-label="login" ng-disabled="rc.registerForm.$invalid()">Register</md-button>
+        </div>
+      </form>
+
+      <md-divider class="inset"></md-divider>
+
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Want to use an existing account? </p>
+      </div>
+
+      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="google" style="color: #DC4A38;"></md-icon>
+          <span> Google</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="facebook" style="color: #3F62B4;"></md-icon>
+          <span>Facebook </span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="twitter" style="color: #27AAE2;"></md-icon>
+          <span>Twitter </span>
+        </md-button>
+      </div>
+      <md-toolbar ng-show="rc.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ rc.error }}</p>
+      </md-toolbar>
+
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/login">Already a user?</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
-- 
2.3.2 (Apple Git-55)


From b569eecc0f871482b2bd9b6c97142e00d9a6f88c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 10 Sep 2015 18:54:24 +0300
Subject: [PATCH 174/262] Step 18.19: Create reset controller

---
 client/users/controllers/reset.js | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
 create mode 100644 client/users/controllers/reset.js

diff --git a/client/users/controllers/reset.js b/client/users/controllers/reset.js
new file mode 100644
index 0000000..56be12f
--- /dev/null
+++ b/client/users/controllers/reset.js
@@ -0,0 +1,22 @@
+angular.module("socially").controller("ResetCtrl", ['$meteor', '$state',
+  function ($meteor, $state) {
+    var vm = this;
+
+    vm.credentials = {
+      email: ''
+    };
+
+    vm.error = '';
+
+    vm.reset = function () {
+      $meteor.forgotPassword(vm.credentials).then(
+        function () {
+          $state.go('parties');
+        },
+        function (err) {
+          vm.error = 'Error sending forgot password email - ' + err;
+        }
+      );
+    };
+  }
+]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 04db7ef9f3032592a92e69b1a8f904087681308c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Tue, 18 Aug 2015 17:02:39 +0300
Subject: [PATCH 175/262] Step 18.20: Create reset view

---
 client/users/views/reset-password.html | 40 ++++++++++++++++++++++++++++++++++
 1 file changed, 40 insertions(+)
 create mode 100644 client/users/views/reset-password.html

diff --git a/client/users/views/reset-password.html b/client/users/views/reset-password.html
new file mode 100644
index 0000000..66c87a3
--- /dev/null
+++ b/client/users/views/reset-password.html
@@ -0,0 +1,40 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Reset Password</h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">Enter your email so we can send you a reset link</p>
+      </div>
+
+      <form name="resetForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <label> Email </label>
+          <input type="text" ng-model="rpc.credentials.email" placeholder="email" aria-label="email" required/>
+        </md-input-container>
+        <div layout="row" layout-align="end center">
+          <md-button class="md-raised md-primary" ng-click="rpc.reset()" aria-label="reset"
+                     ng-disabled="rc.resetForm.$invalid()">Send Email
+          </md-button>
+        </div>
+      </form>
+
+      <md-toolbar ng-show="rc.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ rpc.error }}</p>
+      </md-toolbar>
+
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/login">Sign in</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4cd83450e4bc247ad20e703a09970043a37725b3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 2 Nov 2015 21:19:44 +0200
Subject: [PATCH 176/262] Step 18.21: Add icon configuration

---
 client/users/config.js | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 client/users/config.js

diff --git a/client/users/config.js b/client/users/config.js
new file mode 100644
index 0000000..198197c
--- /dev/null
+++ b/client/users/config.js
@@ -0,0 +1,9 @@
+angular.module('socially').config(
+  function ($mdIconProvider) {
+
+    //configure social icons for registration
+    $mdIconProvider
+      .icon('facebook','icons/facebook.svg')
+      .icon('twitter','icons/twitter.svg')
+      .icon('google-plus','icons/google-plus.svg')
+  });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From afb571c6a6854859eb1d14f4f0ce4a904662b466 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Thu, 5 Nov 2015 21:50:59 +0200
Subject: [PATCH 177/262] Step 18.22: Add SVG icons

---
 public/icons/facebook.svg | 1 +
 public/icons/google.svg   | 1 +
 public/icons/twitter.svg  | 1 +
 3 files changed, 3 insertions(+)
 create mode 100644 public/icons/facebook.svg
 create mode 100644 public/icons/google.svg
 create mode 100644 public/icons/twitter.svg

diff --git a/public/icons/facebook.svg b/public/icons/facebook.svg
new file mode 100644
index 0000000..c2b7501
--- /dev/null
+++ b/public/icons/facebook.svg
@@ -0,0 +1 @@
+<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M17,2V2H17V6H15C14.31,6 14,6.81 14,7.5V10H14L17,10V14H14V22H10V14H7V10H10V6A4,4 0 0,1 14,2H17Z" /></svg>
\ No newline at end of file
diff --git a/public/icons/google.svg b/public/icons/google.svg
new file mode 100644
index 0000000..bf7f0d3
--- /dev/null
+++ b/public/icons/google.svg
@@ -0,0 +1 @@
+<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M23,11H21V9H19V11H17V13H19V15H21V13H23M8,11V13.4H12C11.8,14.4 10.8,16.4 8,16.4C5.6,16.4 3.7,14.4 3.7,12C3.7,9.6 5.6,7.6 8,7.6C9.4,7.6 10.3,8.2 10.8,8.7L12.7,6.9C11.5,5.7 9.9,5 8,5C4.1,5 1,8.1 1,12C1,15.9 4.1,19 8,19C12,19 14.7,16.2 14.7,12.2C14.7,11.7 14.7,11.4 14.6,11H8Z" /></svg>
\ No newline at end of file
diff --git a/public/icons/twitter.svg b/public/icons/twitter.svg
new file mode 100644
index 0000000..7c22e25
--- /dev/null
+++ b/public/icons/twitter.svg
@@ -0,0 +1 @@
+<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 96aa86f72abf90bbec8a2c5d828e25076827eba3 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:48:03 +0300
Subject: [PATCH 178/262] Step 20.1: Add the cfs:standard-packages package

---
 .meteor/packages |  1 +
 .meteor/versions | 18 ++++++++++++++++++
 2 files changed, 19 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 02a6613..5bf3dd7 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -29,3 +29,4 @@ less
 angularui:angular-ui-bootstrap
 angular:angular-material
 planettraining:material-design-icons
+cfs:standard-packages
diff --git a/.meteor/versions b/.meteor/versions
index bcf235b..5894244 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -28,6 +28,22 @@ boilerplate-generator@1.0.4
 caching-compiler@1.0.0
 caching-html-compiler@1.0.2
 callback-hook@1.0.4
+cfs:access-point@0.1.49
+cfs:base-package@0.0.30
+cfs:collection@0.5.5
+cfs:collection-filters@0.2.4
+cfs:data-man@0.0.6
+cfs:file@0.1.17
+cfs:http-methods@0.0.30
+cfs:http-publish@0.0.13
+cfs:power-queue@0.9.11
+cfs:reactive-list@0.0.9
+cfs:reactive-property@0.0.4
+cfs:standard-packages@0.5.9
+cfs:storage-adapter@0.2.3
+cfs:tempstore@0.1.5
+cfs:upload-http@0.0.20
+cfs:worker@0.1.4
 check@1.1.0
 dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
@@ -66,6 +82,7 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.3
 mongo-id@1.0.1
+mongo-livedata@1.0.9
 nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
@@ -77,6 +94,7 @@ ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.2
 planettraining:material-design-icons@2.0.0
 promise@0.5.1
+raix:eventemitter@0.1.3
 random@1.0.5
 rate-limit@1.0.0
 reactive-dict@1.1.3
-- 
2.3.2 (Apple Git-55)


From 50f6398b7f792eef30f8074ca39135f02b966076 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:53:05 +0300
Subject: [PATCH 179/262] Step 20.2: Add the cfs:gridfs package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 5bf3dd7..9a388d8 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -30,3 +30,4 @@ angularui:angular-ui-bootstrap
 angular:angular-material
 planettraining:material-design-icons
 cfs:standard-packages
+cfs:gridfs
diff --git a/.meteor/versions b/.meteor/versions
index 5894244..8c013c2 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -34,6 +34,7 @@ cfs:collection@0.5.5
 cfs:collection-filters@0.2.4
 cfs:data-man@0.0.6
 cfs:file@0.1.17
+cfs:gridfs@0.0.33
 cfs:http-methods@0.0.30
 cfs:http-publish@0.0.13
 cfs:power-queue@0.9.11
-- 
2.3.2 (Apple Git-55)


From c72c39c2cfe56daf937a4255e9529c231c8357ce Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:59:57 +0300
Subject: [PATCH 180/262] Step 20.3: Create the Images collection and publish
 it

---
 model/images.js | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)
 create mode 100644 model/images.js

diff --git a/model/images.js b/model/images.js
new file mode 100644
index 0000000..5cec451
--- /dev/null
+++ b/model/images.js
@@ -0,0 +1,31 @@
+Images = new FS.Collection("images", {
+  stores: [
+    new FS.Store.GridFS("original")
+  ],
+  filter: {
+    allow: {
+      contentTypes: ['image/*']
+    }
+  }
+});
+
+if (Meteor.isServer) {
+  Images.allow({
+    insert: function (userId) {
+      return (userId ? true : false);
+    },
+    remove: function (userId) {
+      return (userId ? true : false);
+    },
+    download: function () {
+      return true;
+    },
+    update: function (userId) {
+      return (userId ? true : false);
+    }
+  });
+
+  Meteor.publish('images', function() {
+    return Images.find({});
+  });
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 635b4647f10e27e52caf6965d48c0a76f39bc0de Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 20:00:22 +0300
Subject: [PATCH 181/262] Step 20.4: Add the collectionFS to the controller

---
 client/parties/controllers/partiesList.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index fa9993b..728a44b 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -5,6 +5,7 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
   $scope.orderProperty = '1';
 
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
+  $scope.images = $meteor.collectionFS(Images, false, Images).subscribe('images');
 
   $scope.parties = $meteor.collection(function() {
     return Parties.find({}, {
-- 
2.3.2 (Apple Git-55)


From ffae7656da05db487eb3218c4ad784a8c7a69c44 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:56:10 +0300
Subject: [PATCH 182/262] Step 20.5: Add the danialfarid:ng-file-upload package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 9a388d8..2bd459d 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -31,3 +31,4 @@ angular:angular-material
 planettraining:material-design-icons
 cfs:standard-packages
 cfs:gridfs
+danialfarid:ng-file-upload
diff --git a/.meteor/versions b/.meteor/versions
index 8c013c2..ad5dc29 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -46,6 +46,7 @@ cfs:tempstore@0.1.5
 cfs:upload-http@0.0.20
 cfs:worker@0.1.4
 check@1.1.0
+danialfarid:ng-file-upload@5.0.9
 dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
-- 
2.3.2 (Apple Git-55)


From 5e0c955cf78c68ca68d90516a69438b2f0390e45 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:10:51 +0300
Subject: [PATCH 183/262] Step 20.6: Add dependency for 'ngFileUpload' to the
 module

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 5be09e6..e5b7798 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -4,7 +4,8 @@ angular.module('socially',[
   'accounts.ui',
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
-  'ngMaterial'
+  'ngMaterial',
+  'ngFileUpload'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From 01cc4984c735b751c920a8a9659c872d73ed9360 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:35:57 +0300
Subject: [PATCH 184/262] Step 20.7: Add usage of file uploader

---
 client/parties/views/add-new-party-modal.html | 24 ++++++++++++++++++++++--
 1 file changed, 22 insertions(+), 2 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index 464d006..e27ba83 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -1,4 +1,4 @@
-<md-dialog aria-label="Mango (Fruit)">
+<md-dialog>
   <form>
     <md-toolbar>
       <div class="md-toolbar-tools">
@@ -6,7 +6,7 @@
         <span flex></span>
       </div>
     </md-toolbar>
-    <md-dialog-content style="min-width:300px;max-width:800px;max-height:810px; ">
+    <md-dialog-content style="min-width:800px;max-width:800px;max-height:100%; ">
       <div  ng-show="$root.currentUser">
         <md-input-container>
           <label>Name</label>
@@ -16,6 +16,26 @@
           <label>Description</label>
           <input ng-model="newParty.description" id="description" type="text" aria-label="Description">
         </md-input-container>
+        <md-whiteframe class="md-whiteframe-z1" layout="column">
+          <div layout="row" class="images-container-title">
+            <div flex>
+              <h3>Add photos to your party!</h3>
+              <div ng-controller="AddPhotoCtrl">
+                <div ngf-drop ngf-select
+                     ngf-change="addImages($files)"
+                     ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}" class="drop-box"
+                     ngf-multiple="false" ngf-allow-dir="false" ngf-accept="'image/*'"
+                     ngf-drop-available="dropAvailable">
+                  <div>Click here to select image</div>
+                  <div>
+                    <strong>OR</strong>
+                  </div>
+                  <div ng-show="dropAvailable">You can also drop image to here</div>
+                </div>
+              </div>
+            </div>
+          </div>
+        </md-whiteframe>
         <md-checkbox ng-model="newParty.public" id="public" aria-label="Public">
           Public
         </md-checkbox>
-- 
2.3.2 (Apple Git-55)


From 67a1f3b8c7ba079ff707ac8fa80b6b241dd59dd3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:36:17 +0300
Subject: [PATCH 185/262] Step 20.8: Create the file upload controller

---
 client/parties/controllers/addPhoto.js | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 client/parties/controllers/addPhoto.js

diff --git a/client/parties/controllers/addPhoto.js b/client/parties/controllers/addPhoto.js
new file mode 100644
index 0000000..4b62c15
--- /dev/null
+++ b/client/parties/controllers/addPhoto.js
@@ -0,0 +1,9 @@
+angular.module("socially").controller("AddPhotoCtrl", function ($scope, $meteor, $rootScope, $state, $mdDialog) {
+  $scope.addImages = function (files) {
+    if (files.length > 0) {
+      $scope.images.save(files[0]);
+    }
+  };
+
+  $scope.close = $mdDialog.hide;
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c5803ae7aac1750563cebd7a0aadb3e45dcc491d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 11:36:56 +0300
Subject: [PATCH 186/262] Step 20.9: Add the images collection to the new party
 modal

---
 client/parties/controllers/addNewParty.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
index af25c36..25e890f 100644
--- a/client/parties/controllers/addNewParty.js
+++ b/client/parties/controllers/addNewParty.js
@@ -1,6 +1,8 @@
 angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '$rootScope', '$state', '$mdDialog', 'parties',
   function ($scope, $meteor, $rootScope, $state, $mdDialog, parties) {
     $scope.newParty = {};
+    $scope.images = $meteor.collectionFS(Images, false, Images);
+
     $scope.addNewParty = function () {
       if($scope.newParty.name){
         $scope.newParty.owner = $rootScope.currentUser._id;
-- 
2.3.2 (Apple Git-55)


From 0a6970b8853e440b0ad0854f3ea3dd8b816930cf Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:04:27 +0300
Subject: [PATCH 187/262] Step 20.10: Add some style to the upload component

---
 client/parties/styles/parties.import.less | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 0f7beb6..31cc3d1 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -59,4 +59,23 @@
 
         }
     }
+}
+
+.drop-box {
+    background: #F8F8F8;
+    border: 5px dashed #DDD;
+    width: 230px;
+    height: 120px;
+    text-align: center;
+    padding-top: 25px;
+    margin-left: 10px;
+    margin-bottom: 20px;
+}
+
+.drop-box.dragover {
+    border: 5px dashed blue;
+}
+
+.drop-box.dragover-err {
+    border: 5px dashed red;
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1cda53213ec85351757c3b7289229f638db8db81 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 04:58:20 +0300
Subject: [PATCH 188/262] Step 20.11: Add the alexk111:ng-img-crop package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 2bd459d..1ac421a 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -32,3 +32,4 @@ planettraining:material-design-icons
 cfs:standard-packages
 cfs:gridfs
 danialfarid:ng-file-upload
+alexk111:ng-img-crop
diff --git a/.meteor/versions b/.meteor/versions
index ad5dc29..8b3026d 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -5,6 +5,7 @@ accounts-password@1.1.4
 accounts-twitter@1.0.6
 accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
+alexk111:ng-img-crop@0.3.2
 angular@1.2.0-rc.3
 angular-meteor-data@0.0.1
 angular-templates@0.0.1
-- 
2.3.2 (Apple Git-55)


From 2f68b84281fd4bb8101dca8f6e5b8a19995390fc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 00:58:04 +0200
Subject: [PATCH 189/262] Step 20.12: Add dependency for ngImgCrop

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index e5b7798..e2b262a 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -5,7 +5,8 @@ angular.module('socially',[
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
   'ngMaterial',
-  'ngFileUpload'
+  'ngFileUpload',
+  'ngImgCrop'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From 93097bf0e87ef153bc78e75119834d92f7ebca90 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 00:58:21 +0200
Subject: [PATCH 190/262] Step 20.13: Update the image upload logic

---
 client/parties/controllers/addPhoto.js | 18 ++++++++++++++----
 1 file changed, 14 insertions(+), 4 deletions(-)

diff --git a/client/parties/controllers/addPhoto.js b/client/parties/controllers/addPhoto.js
index 4b62c15..60d5a0d 100644
--- a/client/parties/controllers/addPhoto.js
+++ b/client/parties/controllers/addPhoto.js
@@ -1,9 +1,19 @@
-angular.module("socially").controller("AddPhotoCtrl", function ($scope, $meteor, $rootScope, $state, $mdDialog) {
+angular.module("socially").controller("AddPhotoCtrl", function ($scope) {
   $scope.addImages = function (files) {
     if (files.length > 0) {
-      $scope.images.save(files[0]);
+      var reader = new FileReader();
+
+      reader.onload = function (e) {
+        $scope.$apply(function () {
+          $scope.imgSrc = e.target.result;
+          $scope.myCroppedImage = '';
+        });
+      };
+
+      reader.readAsDataURL(files[0]);
+    }
+    else {
+      $scope.imgSrc = undefined;
     }
   };
-
-  $scope.close = $mdDialog.hide;
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d1d882caaf2ec25cafef0195002ba105111edb23 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:10:42 +0300
Subject: [PATCH 191/262] Step 20.14: Add usage of ngImgCrop

---
 client/parties/views/add-new-party-modal.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index e27ba83..ff647a9 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -32,6 +32,10 @@
                   </div>
                   <div ng-show="dropAvailable">You can also drop image to here</div>
                 </div>
+                <div ng-show="imgSrc" class="ng-crop-container">
+                  <h3>Great! Now edit & crop your image...</h3><br />
+                  <img-crop image="imgSrc" result-image="myCroppedImage" area-type="square"></img-crop>
+                </div>
               </div>
             </div>
           </div>
-- 
2.3.2 (Apple Git-55)


From 9be6d8b3afca71fb3961d11d9c71a52d7c343bfb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:10:57 +0300
Subject: [PATCH 192/262] Step 20.15: Add ng-hide to the uploader

---
 client/parties/views/add-new-party-modal.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index ff647a9..75cd7da 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -21,7 +21,7 @@
             <div flex>
               <h3>Add photos to your party!</h3>
               <div ng-controller="AddPhotoCtrl">
-                <div ngf-drop ngf-select
+                <div ng-hide="imgSrc" ngf-drop ngf-select
                      ngf-change="addImages($files)"
                      ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}" class="drop-box"
                      ngf-multiple="false" ngf-allow-dir="false" ngf-accept="'image/*'"
-- 
2.3.2 (Apple Git-55)


From 213bf4b0995d0f07d959463592d44530adeff71a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:17:35 +0300
Subject: [PATCH 193/262] Step 20.16: Add some CSS to make the crop look better

---
 client/parties/styles/parties.import.less | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 31cc3d1..facbb89 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -78,4 +78,13 @@
 
 .drop-box.dragover-err {
     border: 5px dashed red;
-}
\ No newline at end of file
+}
+
+.uploaded-image {
+    max-height: 100px;
+    max-width: 200px;
+}
+
+.ng-crop-container {
+    height: 350px;
+}
-- 
2.3.2 (Apple Git-55)


From 5b3b9248b52a56f40aa7c31f0733d86d26d7b85c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 01:00:25 +0200
Subject: [PATCH 194/262] Step 20.17: Add save button for the cropped image

---
 client/parties/views/add-new-party-modal.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index 75cd7da..e3b3983 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -33,7 +33,10 @@
                   <div ng-show="dropAvailable">You can also drop image to here</div>
                 </div>
                 <div ng-show="imgSrc" class="ng-crop-container">
-                  <h3>Great! Now edit & crop your image...</h3><br />
+                  <h3>Great! Now edit & crop your image...</h3>
+                  <md-button ng-click="saveCroppedImage()" ng-disabled="!imgSrc" class="md-primary">
+                    Save Image
+                  </md-button>
                   <img-crop image="imgSrc" result-image="myCroppedImage" area-type="square"></img-crop>
                 </div>
               </div>
-- 
2.3.2 (Apple Git-55)


From 672bd0c11d625a00036e70a23176ae49d570765b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 01:00:41 +0200
Subject: [PATCH 195/262] Step 20.18: Add logic to save the cropped image

---
 client/parties/controllers/addPhoto.js | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/parties/controllers/addPhoto.js b/client/parties/controllers/addPhoto.js
index 60d5a0d..094effc 100644
--- a/client/parties/controllers/addPhoto.js
+++ b/client/parties/controllers/addPhoto.js
@@ -16,4 +16,14 @@ angular.module("socially").controller("AddPhotoCtrl", function ($scope) {
       $scope.imgSrc = undefined;
     }
   };
+
+  $scope.saveCroppedImage = function () {
+    if ($scope.myCroppedImage !== '') {
+      $scope.images.save($scope.myCroppedImage).then(function (result) {
+        $scope.newPartyImages.push(result[0]._id);
+        $scope.imgSrc = undefined;
+        $scope.myCroppedImage = '';
+      });
+    }
+  };
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1d1d94d0ff9fa010913c77482406a21dde3d976c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:21:49 +0300
Subject: [PATCH 196/262] Step 20.19: Add an array to hold all the new images

---
 client/parties/controllers/addNewParty.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
index 25e890f..b4642a7 100644
--- a/client/parties/controllers/addNewParty.js
+++ b/client/parties/controllers/addNewParty.js
@@ -2,6 +2,7 @@ angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '
   function ($scope, $meteor, $rootScope, $state, $mdDialog, parties) {
     $scope.newParty = {};
     $scope.images = $meteor.collectionFS(Images, false, Images);
+    $scope.newPartyImages = [];
 
     $scope.addNewParty = function () {
       if($scope.newParty.name){
-- 
2.3.2 (Apple Git-55)


From b97087a04b27718b4b27350b6009e79149ee3269 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:29:01 +0300
Subject: [PATCH 197/262] Step 20.20: Add the display of uploaded images

---
 client/parties/views/add-new-party-modal.html | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index e3b3983..ae8f7fd 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -40,6 +40,12 @@
                   <img-crop image="imgSrc" result-image="myCroppedImage" area-type="square"></img-crop>
                 </div>
               </div>
+              <br />
+              <div layout="row" class="images-container-title">
+                <div class="party-image-container" ng-repeat="image in newPartyImages">
+                  <img ng-src="{{ image.url() }}"/><br/>
+                </div>
+              </div>
             </div>
           </div>
         </md-whiteframe>
-- 
2.3.2 (Apple Git-55)


From a1db2efd2183a60bfc909ba0b40859d66ad87b94 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 05:00:34 +0300
Subject: [PATCH 198/262] Step 20.21: Add the vitalets:angular-xeditable
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 1ac421a..844702c 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -33,3 +33,4 @@ cfs:standard-packages
 cfs:gridfs
 danialfarid:ng-file-upload
 alexk111:ng-img-crop
+vitalets:angular-xeditable
diff --git a/.meteor/versions b/.meteor/versions
index 8b3026d..05e80f4 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -121,5 +121,6 @@ twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
 url@1.0.5
+vitalets:angular-xeditable@0.1.9
 webapp@1.2.3
 webapp-hashing@1.0.5
-- 
2.3.2 (Apple Git-55)


From 77643a1d29fb47d34db4ce85946068ddff08b8fa Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:30:58 +0300
Subject: [PATCH 199/262] Step 20.22: Add xeditable dependency

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index e2b262a..2150127 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -6,7 +6,8 @@ angular.module('socially',[
   'uiGmapgoogle-maps',
   'ngMaterial',
   'ngFileUpload',
-  'ngImgCrop'
+  'ngImgCrop',
+  'xeditable'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From 42a9072cf1c0d1ae5ce11fd0a986ebbb67dda7f7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:32:23 +0300
Subject: [PATCH 200/262] Step 20.23: Add usage of angular-xeditable

---
 client/parties/views/add-new-party-modal.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index ae8f7fd..b7abd11 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -1,5 +1,4 @@
 <md-dialog>
-  <form>
     <md-toolbar>
       <div class="md-toolbar-tools">
         <h2> Create a new party</h2>
@@ -44,6 +43,8 @@
               <div layout="row" class="images-container-title">
                 <div class="party-image-container" ng-repeat="image in newPartyImages">
                   <img ng-src="{{ image.url() }}"/><br/>
+                  <a href="#" editable-text="image.metadata.description"
+                     onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
                 </div>
               </div>
             </div>
@@ -63,5 +64,4 @@
         Add
       </md-button>
     </div>
-  </form>
 </md-dialog>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0dd0ad51a6949e9d2858ce6c260e419cc95eeb31 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:33:12 +0300
Subject: [PATCH 201/262] Step 20.24: Add the logic to update the description

---
 client/parties/controllers/addNewParty.js | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
index b4642a7..761dcc5 100644
--- a/client/parties/controllers/addNewParty.js
+++ b/client/parties/controllers/addNewParty.js
@@ -11,8 +11,13 @@ angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '
         $scope.newParty = '';
         $mdDialog.hide();
       }
-    }
+    };
+
     $scope.close = function () {
       $mdDialog.hide();
-    }
+    };
+
+    $scope.updateDescription = function($data, image) {
+      image.update({$set: {'metadata.description': $data}});
+    };
   }]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cb8e832cd45785c09373526bce44e0bab28cdf09 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:38:38 +0300
Subject: [PATCH 202/262] Step 20.25: Use div instead of form

---
 client/parties/views/add-new-party-modal.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index b7abd11..3c8347b 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -1,4 +1,5 @@
 <md-dialog>
+  <div class="like-form">
     <md-toolbar>
       <div class="md-toolbar-tools">
         <h2> Create a new party</h2>
@@ -64,4 +65,5 @@
         Add
       </md-button>
     </div>
+  </div>
 </md-dialog>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7082dcd4dc7089cceddac21390c0f0a554c1e0db Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:38:57 +0300
Subject: [PATCH 203/262] Step 20.26: Add form-layout to the div

---
 client/styles/main.less | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/styles/main.less b/client/styles/main.less
index 438dc59..a964692 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,6 +1,16 @@
 html, body {
 }
 
+.like-form {
+  display: -webkit-flex;
+  display: -ms-flexbox;
+  display: flex;
+  -webkit-flex-direction: column;
+  -ms-flex-direction: column;
+  flex-direction: column;
+  overflow: auto;
+}
+
 @import "../parties/styles/parties.import.less";
 @import "../parties/styles/party.details.import.less";
 @import "../parties/styles/navbar.import.less";
-- 
2.3.2 (Apple Git-55)


From 276a3ec4859ad4a9b8dd2f0dd292bf9765ef621a Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 05:03:47 +0300
Subject: [PATCH 204/262] Step 20.27: Add the
 netanelgilad:angular-sortable-view package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 844702c..ad36f9b 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -34,3 +34,4 @@ cfs:gridfs
 danialfarid:ng-file-upload
 alexk111:ng-img-crop
 vitalets:angular-xeditable
+netanelgilad:angular-sortable-view
diff --git a/.meteor/versions b/.meteor/versions
index 05e80f4..2ffafbd 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -86,6 +86,7 @@ mobile-status-bar@1.0.6
 mongo@1.1.3
 mongo-id@1.0.1
 mongo-livedata@1.0.9
+netanelgilad:angular-sortable-view@0.0.13_1
 nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
-- 
2.3.2 (Apple Git-55)


From 3006b4617cae4ef2deb98694b07a023517e3bc90 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:40:59 +0300
Subject: [PATCH 205/262] Step 20.28: Add dependency for
 'angular-sortable-view'

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 2150127..fea5ab3 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -7,7 +7,8 @@ angular.module('socially',[
   'ngMaterial',
   'ngFileUpload',
   'ngImgCrop',
-  'xeditable'
+  'xeditable',
+  'angular-sortable-view'
 ]);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
-- 
2.3.2 (Apple Git-55)


From fdd3cc0c699132c6d6085e151575f5970f075de2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:41:57 +0300
Subject: [PATCH 206/262] Step 20.29: Add usage for angular-sortable

---
 client/parties/views/add-new-party-modal.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index 3c8347b..51f6c0f 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -41,9 +41,9 @@
                 </div>
               </div>
               <br />
-              <div layout="row" class="images-container-title">
-                <div class="party-image-container" ng-repeat="image in newPartyImages">
-                  <img ng-src="{{ image.url() }}"/><br/>
+              <div layout="row" class="images-container-title" sv-root sv-part="newPartyImages">
+                <div sv-element class="party-image-container" ng-repeat="image in newPartyImages">
+                  <img draggable="false" ng-src="{{ image.url() }}"/><br/>
                   <a href="#" editable-text="image.metadata.description"
                      onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
                 </div>
-- 
2.3.2 (Apple Git-55)


From 86e9266d7085b4bd219eba656956345b1f2065e0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 13:42:21 +0300
Subject: [PATCH 207/262] Step 20.30: Add indication for main image in the view

---
 client/parties/views/add-new-party-modal.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index 51f6c0f..70d0469 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -43,6 +43,7 @@
               <br />
               <div layout="row" class="images-container-title" sv-root sv-part="newPartyImages">
                 <div sv-element class="party-image-container" ng-repeat="image in newPartyImages">
+                  <div class="main-image" ng-show="$index === 0">Main Image</div>
                   <img draggable="false" ng-src="{{ image.url() }}"/><br/>
                   <a href="#" editable-text="image.metadata.description"
                      onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
-- 
2.3.2 (Apple Git-55)


From 539bc36d51e228ffbd1f3a60faf50ec2e1f4a381 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:00:20 +0300
Subject: [PATCH 208/262] Step 20.31: Add some css to the image gallery

---
 client/parties/styles/parties.import.less | 25 +++++++++++++++++++++++++
 1 file changed, 25 insertions(+)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index facbb89..4470813 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -88,3 +88,28 @@
 .ng-crop-container {
     height: 350px;
 }
+
+.images-container-title {
+    padding-bottom: 30px;
+}
+
+.party-image-container {
+    position: relative;
+    margin-right: 10px;
+    max-height: 200px;
+    max-width: 200px;
+
+    img {
+        max-height: 100%;
+        max-width: 100%;
+    }
+}
+
+.main-image {
+    position: absolute;
+    top: 0;
+    left: 0;
+    width: 100%;
+    text-align: center;
+    background-color: #f8f8f8;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 750c1b00e820a1ba0a7320aac45cfe82de0960fa Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:03:34 +0300
Subject: [PATCH 209/262] Step 20.32: Save the party with the images

---
 client/parties/controllers/addNewParty.js | 16 +++++++++++++++-
 1 file changed, 15 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/addNewParty.js b/client/parties/controllers/addNewParty.js
index 761dcc5..7c82ada 100644
--- a/client/parties/controllers/addNewParty.js
+++ b/client/parties/controllers/addNewParty.js
@@ -7,8 +7,22 @@ angular.module("socially").controller("AddNewPartyCtrl", ['$scope', '$meteor', '
     $scope.addNewParty = function () {
       if($scope.newParty.name){
         $scope.newParty.owner = $rootScope.currentUser._id;
+
+        // Link the images and the order to the new party
+        if ($scope.newPartyImages && $scope.newPartyImages.length > 0) {
+          $scope.newParty.images = [];
+
+          angular.forEach($scope.newPartyImages, function(image) {
+            $scope.newParty.images.push({id: image._id});
+          });
+        }
+
+        // Save the party
         parties.push($scope.newParty);
-        $scope.newParty = '';
+
+        // Reset the form
+        $scope.newPartyImages = [];
+        $scope.newParty = {};
         $mdDialog.hide();
       }
     };
-- 
2.3.2 (Apple Git-55)


From 7ac7eeb15fd7cb11a9d5b992d2e7023497be79d6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 20:01:47 +0300
Subject: [PATCH 210/262] Step 20.33: Display the party's main image

---
 client/parties/views/parties-list.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
index a389551..ea83c45 100644
--- a/client/parties/views/parties-list.html
+++ b/client/parties/views/parties-list.html
@@ -20,6 +20,10 @@
         <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
         <div  dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count" class="ma-party">
           <md-card>
+            <div ng-if="party.images && party.images.length > 0"
+                 ng-style="getMainImage(party.images)"
+                 class="party-image">
+            </div>
             <md-card-content>
               <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
               <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
-- 
2.3.2 (Apple Git-55)


From fd98b0ce3dfecb14114506cd2c38e0b448c3ffe6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 20:02:05 +0300
Subject: [PATCH 211/262] Step 20.34: Add the logic to get the main image

---
 client/parties/controllers/partiesList.js | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
index 728a44b..7c91ef9 100644
--- a/client/parties/controllers/partiesList.js
+++ b/client/parties/controllers/partiesList.js
@@ -1,4 +1,4 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $mdDialog) {
+angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $mdDialog, $filter) {
   $scope.page = 1;
   $scope.perPage = 3;
   $scope.sort = {name: 1};
@@ -13,6 +13,16 @@ angular.module("socially").controller("PartiesListCtrl", function ($scope, $mete
     });
   });
 
+  $scope.getMainImage = function(images) {
+    if (images && images.length && images[0] && images[0].id) {
+      var url = $filter('filter')($scope.images, {_id: images[0].id})[0].url();
+
+      return {
+        'background-image': 'url("' + url + '")'
+      }
+    }
+  };
+
   $meteor.autorun($scope, function() {
     $meteor.subscribe('parties', {
       limit: parseInt($scope.getReactively('perPage')),
-- 
2.3.2 (Apple Git-55)


From 4141cb1caf3ab5f71abf92b1ed1439cefd18aa9e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:11:42 +0300
Subject: [PATCH 212/262] Step 20.35: Add style to the main image

---
 client/parties/styles/parties.import.less | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/parties/styles/parties.import.less b/client/parties/styles/parties.import.less
index 4470813..0e73444 100644
--- a/client/parties/styles/parties.import.less
+++ b/client/parties/styles/parties.import.less
@@ -112,4 +112,10 @@
     width: 100%;
     text-align: center;
     background-color: #f8f8f8;
+}
+
+.party-image {
+    background-size: cover;
+    width: 100%;
+    height: 200px;
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ca29f47e5fe0ec258d713021318684be2a711345 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Mon, 28 Sep 2015 05:06:19 +0300
Subject: [PATCH 213/262] Step 20.36: Add the cfs:graphicsmagick package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index ad36f9b..381b3de 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -35,3 +35,4 @@ danialfarid:ng-file-upload
 alexk111:ng-img-crop
 vitalets:angular-xeditable
 netanelgilad:angular-sortable-view
+cfs:graphicsmagick
diff --git a/.meteor/versions b/.meteor/versions
index 2ffafbd..ada665c 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -35,6 +35,7 @@ cfs:collection@0.5.5
 cfs:collection-filters@0.2.4
 cfs:data-man@0.0.6
 cfs:file@0.1.17
+cfs:graphicsmagick@0.0.18
 cfs:gridfs@0.0.33
 cfs:http-methods@0.0.30
 cfs:http-publish@0.0.13
-- 
2.3.2 (Apple Git-55)


From 421d8be2856207ee21c7ca9ef26680acac1f4c4b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:13:15 +0300
Subject: [PATCH 214/262] Step 20.37: Add another store for the thumbnails

---
 model/images.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/model/images.js b/model/images.js
index 5cec451..3b06d5f 100644
--- a/model/images.js
+++ b/model/images.js
@@ -1,6 +1,11 @@
 Images = new FS.Collection("images", {
   stores: [
-    new FS.Store.GridFS("original")
+    new FS.Store.GridFS("original"),
+    new FS.Store.GridFS("thumbnail", {
+      transformWrite: function(fileObj, readStream, writeStream) {
+        gm(readStream, fileObj.name()).resize('32', '32', '!').stream().pipe(writeStream);
+      }
+    })
   ],
   filter: {
     allow: {
-- 
2.3.2 (Apple Git-55)


From 7a29bd3425adc2f40773626c09fdee51aec6c5c6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 11 Sep 2015 14:13:50 +0300
Subject: [PATCH 215/262] Step 20.38: Add thumbnails usage

---
 client/parties/views/add-new-party-modal.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/add-new-party-modal.html b/client/parties/views/add-new-party-modal.html
index 70d0469..eed885c 100644
--- a/client/parties/views/add-new-party-modal.html
+++ b/client/parties/views/add-new-party-modal.html
@@ -44,7 +44,7 @@
               <div layout="row" class="images-container-title" sv-root sv-part="newPartyImages">
                 <div sv-element class="party-image-container" ng-repeat="image in newPartyImages">
                   <div class="main-image" ng-show="$index === 0">Main Image</div>
-                  <img draggable="false" ng-src="{{ image.url() }}"/><br/>
+                  <img draggable="false" ng-src="{{ image.url({store: 'thumbnail'}) }}"/><br/>
                   <a href="#" editable-text="image.metadata.description"
                      onbeforesave="updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
                 </div>
-- 
2.3.2 (Apple Git-55)


From 860732911ffa5717fe81a5d0c7f17700cb3775e1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 17 Oct 2015 19:09:22 +0300
Subject: [PATCH 216/262] Add README

---
 .gitignore |  1 +
 COC.md     | 21 +++++++++++++++++++++
 README.md  | 64 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 86 insertions(+)
 create mode 100644 .gitignore
 create mode 100644 COC.md
 create mode 100644 README.md

diff --git a/.gitignore b/.gitignore
new file mode 100644
index 0000000..485dee6
--- /dev/null
+++ b/.gitignore
@@ -0,0 +1 @@
+.idea
diff --git a/COC.md b/COC.md
new file mode 100644
index 0000000..4748e55
--- /dev/null
+++ b/COC.md
@@ -0,0 +1,21 @@
+# Code of Conduct
+
+Learning in plain sight can be an intimidating experience. Your code, mistakes, and community feedback are all publically displayed for everyone to see. While this is true for any open source project, course participants are here to learn and can feel a lot more vulnerable.
+
+It is absolutely crucial that any interaction is done with respect, care, and without judgment, and that any feedback is provided gently. We want to teach and learn from each other, and for that to happen, we must treat each other with care.
+
+This course is dedicated to providing a harassment-free learning experience for everyone, regardless of gender, age, sexual orientation, disability, physical appearance, body size, race, or religion (or lack thereof). We do not tolerate harassment of participants in any form. Sexual language and imagery is not appropriate in any material posted to this repository or in other venues discussing it (e.g. Twitter and other online media). Participants violating these rules may be sanctioned or expelled from the course at the discretion of the maintainers as well as reported to GitHub for abuse.
+
+Harassment includes offensive verbal comments related to gender, age, sexual orientation, disability, physical appearance, body size, race, religion, sexual images in public spaces, deliberate intimidation, stalking, following, harassing photography or recording, sustained disruption of others, inappropriate physical contact, and unwelcome sexual attention.
+
+Participants asked to stop any harassing behavior are expected to comply immediately.
+
+Teachers and maintainers are also subject to the anti-harassment policy. In particular, they should not use sexualized images, activities, or other material.
+
+If a participant engages in harassing behavior, the maintainers may take any action they deem appropriate, including warning the offender or expulsion from the course.
+
+If you are being harassed, notice that someone else is being harassed, or have any other concerns, please contact a member of course team immediately. The list of maintainers can be found at the top of the [README document](https://github.com/hueniverse/hueniversity/blob/master/README.md).
+
+We expect participants to follow these rules at any related social events.
+
+(Adapted from http://confcodeofconduct.com/)
diff --git a/README.md b/README.md
new file mode 100644
index 0000000..9c9c1bd
--- /dev/null
+++ b/README.md
@@ -0,0 +1,64 @@
+# meteor-angular-socially - [Tutorial's site](http://angularjs.meteor.com/tutorial)
+angular-meteor example and tutorial app.
+
+The tutorial starts at branch 'step_00' till the last step.
+
+The master branch is always equal to the last step.
+
+Here is the deployed final version - http://socially-step18.meteor.com/
+
+Please contribute to the tutorial.
+Pull request the master branch to add new features or pull request specific step to improve that step.
+
+Our goal in this tutorial is to add more steps as we go along, to cover as many use cases as possible.
+
+Thanks @MilosStanic for writing step 18 on angular-material
+
+An example with the `controller as` syntax can be found in [this branch](https://github.com/Urigo/meteor-angular-socially/tree/step_12_controller_as_vm).
+
+# angular-meteor University! <a href="http://angularjs.meteor.com/"><img src="http://angularjs.meteor.com/images/logo-large.png" width="60" height="60" /></a>  
+
+The angular-meteor university is a community learning experiment, we would like to create a similar experience to the [hueniversity](https://github.com/hueniverse/hueniversity)
+
+
+[![Join the chat at https://gitter.im/Urigo/angular-meteor](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/Urigo/angular-meteor?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)
+
+The first assignments will be to rewrite the tutorial steps, and follow the latest angular-meteor API , in a more [consistent style](https://github.com/johnpapa/angular-styleguide).
+We also hope the community will propose better solutions than the current ones.
+When we will catch up with the latest steps we will create new steps.
+
+### What am I going to learn?
+You will learn how to build a full stack application using meteor and angular. It will start with the basics and move on to the more advanced topic such as users and authentication, application architecture, reactivity, mobile app, ionic, working with files, Angular Server, ES6 and more.
+
+
+### What do I need to know?
+You should feel comfortable writing simple functions in JavaScript, working with GitHub, using basic git commands, have a basic familiarity with mongoDB, and be able to pick up new subjects by reading tutorials and documentation.
+
+### How advanced is this course?
+We'll start from the basics and make our way to the most advanced topics. The way this course is structured, you can choose which assignments to participate in, so more experienced developers can "sit out" or help others during the basic assignments and participate when it gets to areas they are not as strong in. However, since teaching is one of the most effective ways to learn, we believe that participating early will improve the existing skills of advanced developers.
+The assignment will include just enough information to get you going, but you will need to do most of the learning on your own by using the wide range of online resources available. However, the real benefit of this process will come from the code review of your Pull Request. This is where expert developers will review your work and provide you specific and actionable feedback.
+
+### How does it work?
+First, read the [Code of Conduct](https://github.com/Urigo/meteor-angular-socially/blob/master/COC.md) !
+
+Simple, you start by forking this repo.
+Every few days a new issue will be posted with an [`assignment` label](https://github.com/Urigo/meteor-angular-socially/labels/assignment)
+. If you would like to participate in the assignment, try to solve it and when you are done, submit a Pull Request back to this repo to the `step_NUMBER_u` branch. Make sure your code complies with the [john papa angular style guid](https://github.com/johnpapa/angular-styleguide).
+While you wait for the assignment to close, take a look at what others are submitting and see if you can improve your own solution (borrow ideas, add tests, write examples, update the documentation). If you see ways in which others can improve their solution, please dont hesitate to comment on their Pull Request.
+Each assignment will have a final submission date. When the issue expires, one of the Pull Requests submitted will be picked and merged and published as the new tutorial step. Any follow up assignments will be based on the merged code.
+Before starting the next assignment, make sure [your fork matches the current](https://github.com/Urigo/meteor-angular-socially/blob/master/guides/git.md ) assignment step branch (`step_NUMBER_u`) since only one Pull Request can be accepted.
+
+### How can I help?
+
+There are lots of way you can help make this experiment succeed and help shape a new format for teaching development skills:
+Submit Pull Requests to improve this readme, add examples, write quick tutorials on how to work with git, etc.
+Add new steps to angular-meteor-socially tutorial.
+Look for issues with a [help wanted label](https://github.com/Urigo/meteor-angular-socially/labels/help%20wanted) and help with those.
+Randomly pick submitted Pull Request and review them, offering advice and helping others improve their skills.
+Submit Pull Request or open issues with proposals for [angular-meteor](https://github.com/Urigo/angular-meteor) 
+
+### Anything else?
+[Open an issue](https://github.com/Urigo/meteor-angular-socially/issues/new), it's free.
+
+
+
-- 
2.3.2 (Apple Git-55)


From 5e60102324aa6b8b877e7d247dbec469466eeadc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 20:10:04 +0200
Subject: [PATCH 217/262] Step 21.1: Add mobile platform to the project

---
 .meteor/platforms | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/.meteor/platforms b/.meteor/platforms
index efeba1b..81ae701 100644
--- a/.meteor/platforms
+++ b/.meteor/platforms
@@ -1,2 +1,3 @@
-server
 browser
+ios
+server
-- 
2.3.2 (Apple Git-55)


From 8b489ce410ba02824713f9e712b4d9bef9b3a851 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 20:14:39 +0200
Subject: [PATCH 218/262] Step 21.2: Create the socially-mobile package

---
 packages/socially-mobile/README.md                |  0
 packages/socially-mobile/package.js               | 24 +++++++++++++++++++++++
 packages/socially-mobile/socially-mobile-tests.js |  5 +++++
 packages/socially-mobile/socially-mobile.js       |  1 +
 4 files changed, 30 insertions(+)
 create mode 100644 packages/socially-mobile/README.md
 create mode 100644 packages/socially-mobile/package.js
 create mode 100644 packages/socially-mobile/socially-mobile-tests.js
 create mode 100644 packages/socially-mobile/socially-mobile.js

diff --git a/packages/socially-mobile/README.md b/packages/socially-mobile/README.md
new file mode 100644
index 0000000..e69de29
diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
new file mode 100644
index 0000000..01ea9c1
--- /dev/null
+++ b/packages/socially-mobile/package.js
@@ -0,0 +1,24 @@
+Package.describe({
+  name: 'socially-mobile',
+  version: '0.0.1',
+  // Brief, one-line summary of the package.
+  summary: '',
+  // URL to the Git repository containing the source code for this package.
+  git: '',
+  // By default, Meteor will default to using README.md for documentation.
+  // To avoid submitting documentation, set this field to null.
+  documentation: 'README.md'
+});
+
+Package.onUse(function(api) {
+  api.versionsFrom('1.2.0.1');
+  api.use('ecmascript');
+  api.addFiles('socially-mobile.js');
+});
+
+Package.onTest(function(api) {
+  api.use('ecmascript');
+  api.use('tinytest');
+  api.use('socially-mobile');
+  api.addFiles('socially-mobile-tests.js');
+});
diff --git a/packages/socially-mobile/socially-mobile-tests.js b/packages/socially-mobile/socially-mobile-tests.js
new file mode 100644
index 0000000..c5623d8
--- /dev/null
+++ b/packages/socially-mobile/socially-mobile-tests.js
@@ -0,0 +1,5 @@
+// Write your tests here!
+// Here is an example.
+Tinytest.add('example', function (test) {
+  test.equal(true, true);
+});
diff --git a/packages/socially-mobile/socially-mobile.js b/packages/socially-mobile/socially-mobile.js
new file mode 100644
index 0000000..164ddd9
--- /dev/null
+++ b/packages/socially-mobile/socially-mobile.js
@@ -0,0 +1 @@
+// Write your package code here!
-- 
2.3.2 (Apple Git-55)


From 8a62b45bbabb941ef97075183ceee2b969961d6b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 20:19:42 +0200
Subject: [PATCH 219/262] Step 21.3: Clean up and add the package

---
 .meteor/packages                                  | 1 +
 .meteor/versions                                  | 2 ++
 packages/socially-mobile/socially-mobile-tests.js | 5 -----
 packages/socially-mobile/socially-mobile.js       | 1 -
 4 files changed, 3 insertions(+), 6 deletions(-)
 delete mode 100644 packages/socially-mobile/socially-mobile-tests.js
 delete mode 100644 packages/socially-mobile/socially-mobile.js

diff --git a/.meteor/packages b/.meteor/packages
index 381b3de..31447f0 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -36,3 +36,4 @@ alexk111:ng-img-crop
 vitalets:angular-xeditable
 netanelgilad:angular-sortable-view
 cfs:graphicsmagick
+socially-mobile
diff --git a/.meteor/versions b/.meteor/versions
index ada665c..664a108 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -95,6 +95,7 @@ oauth@1.1.6
 oauth1@1.1.5
 oauth2@1.1.5
 observe-sequence@1.0.7
+okland:accounts-phone@0.0.21
 ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.2
 planettraining:material-design-icons@2.0.0
@@ -110,6 +111,7 @@ routepolicy@1.0.6
 service-configuration@1.0.5
 session@1.1.1
 sha@1.0.4
+socially-mobile@0.0.1
 spacebars@1.0.7
 spacebars-compiler@1.0.7
 srp@1.0.4
diff --git a/packages/socially-mobile/socially-mobile-tests.js b/packages/socially-mobile/socially-mobile-tests.js
deleted file mode 100644
index c5623d8..0000000
--- a/packages/socially-mobile/socially-mobile-tests.js
+++ /dev/null
@@ -1,5 +0,0 @@
-// Write your tests here!
-// Here is an example.
-Tinytest.add('example', function (test) {
-  test.equal(true, true);
-});
diff --git a/packages/socially-mobile/socially-mobile.js b/packages/socially-mobile/socially-mobile.js
deleted file mode 100644
index 164ddd9..0000000
--- a/packages/socially-mobile/socially-mobile.js
+++ /dev/null
@@ -1 +0,0 @@
-// Write your package code here!
-- 
2.3.2 (Apple Git-55)


From 03376c6201a01138f9bb0b8bd500981dd02d0782 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 20:21:18 +0200
Subject: [PATCH 220/262] Step 21.4: Add some logic to the package file

---
 packages/socially-mobile/package.js | 9 +--------
 1 file changed, 1 insertion(+), 8 deletions(-)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index 01ea9c1..d3c0ba4 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -1,24 +1,17 @@
 Package.describe({
   name: 'socially-mobile',
   version: '0.0.1',
-  // Brief, one-line summary of the package.
   summary: '',
-  // URL to the Git repository containing the source code for this package.
   git: '',
-  // By default, Meteor will default to using README.md for documentation.
-  // To avoid submitting documentation, set this field to null.
   documentation: 'README.md'
 });
 
 Package.onUse(function(api) {
   api.versionsFrom('1.2.0.1');
-  api.use('ecmascript');
-  api.addFiles('socially-mobile.js');
+  api.use('angular');
 });
 
 Package.onTest(function(api) {
-  api.use('ecmascript');
   api.use('tinytest');
   api.use('socially-mobile');
-  api.addFiles('socially-mobile-tests.js');
 });
-- 
2.3.2 (Apple Git-55)


From c38849b0326d15be21f95a5acdff9f2aa2c5a099 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:13:48 +0200
Subject: [PATCH 221/262] Step 21.5: Create the angular module for the mobile
 package

---
 packages/socially-mobile/client/lib/module.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 packages/socially-mobile/client/lib/module.js

diff --git a/packages/socially-mobile/client/lib/module.js b/packages/socially-mobile/client/lib/module.js
new file mode 100644
index 0000000..f078654
--- /dev/null
+++ b/packages/socially-mobile/client/lib/module.js
@@ -0,0 +1 @@
+angular.module('socially.mobile', []);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From f491e32392ca344e3de3ce7a4812d341009555ee Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:14:06 +0200
Subject: [PATCH 222/262] Step 21.6: Add routes file with login route

---
 packages/socially-mobile/client/routes.js | 8 ++++++++
 1 file changed, 8 insertions(+)
 create mode 100644 packages/socially-mobile/client/routes.js

diff --git a/packages/socially-mobile/client/routes.js b/packages/socially-mobile/client/routes.js
new file mode 100644
index 0000000..aee3b59
--- /dev/null
+++ b/packages/socially-mobile/client/routes.js
@@ -0,0 +1,8 @@
+angular.module('socially.mobile').config(function($stateProvider) {
+  $stateProvider.state('login', {
+    url: '/login',
+    templateUrl: '/packages/socially-mobile/client/users/views/login-mobile.html',
+    controller: 'LoginCtrl',
+    controllerAs: 'lc'
+  });
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 01b8d4341dffa8695716ed53b876ef14bb6eef79 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:14:26 +0200
Subject: [PATCH 223/262] Step 21.7: Add the mobile login page

---
 packages/socially-mobile/client/users/views/login-mobile.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 packages/socially-mobile/client/users/views/login-mobile.html

diff --git a/packages/socially-mobile/client/users/views/login-mobile.html b/packages/socially-mobile/client/users/views/login-mobile.html
new file mode 100644
index 0000000..5b6a3f2
--- /dev/null
+++ b/packages/socially-mobile/client/users/views/login-mobile.html
@@ -0,0 +1 @@
+mobile login
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c260d553e5a713152f396887da569be0c1e48c8b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:14:52 +0200
Subject: [PATCH 224/262] Step 21.8: Include actual files in the package

---
 packages/socially-mobile/package.js | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index d3c0ba4..71b4ab8 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -9,6 +9,15 @@ Package.describe({
 Package.onUse(function(api) {
   api.versionsFrom('1.2.0.1');
   api.use('angular');
+
+  api.addFiles([
+    'client/lib/module.js',
+    'client/routes.js'
+  ], 'web.cordova');
+
+  api.addAssets([
+    'client/users/views/login-mobile.html'
+  ], 'web.cordova');
 });
 
 Package.onTest(function(api) {
-- 
2.3.2 (Apple Git-55)


From 80455f04ed35ad9ce98915629433e763325bb743 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:15:13 +0200
Subject: [PATCH 225/262] Step 21.9: Remove the original login route

---
 client/routes.js | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

diff --git a/client/routes.js b/client/routes.js
index 4f86aa7..665f2f9 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -27,12 +27,7 @@ angular.module("socially").config(function ($urlRouterProvider, $stateProvider,
         }
       }
     })
-    .state('login', {
-      url: '/login',
-      templateUrl: 'client/users/views/login.html',
-      controller: 'LoginCtrl',
-      controllerAs: 'lc'
-    })
+
     .state('register',{
       url: '/register',
       templateUrl: 'client/users/views/register.html',
-- 
2.3.2 (Apple Git-55)


From 4334a69441ef98427ac671f4d69bad373427240c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:17:34 +0200
Subject: [PATCH 226/262] Step 21.10: Add modules isolation

---
 client/lib/app.js | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index fea5ab3..f12b3fe 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1,4 +1,4 @@
-angular.module('socially',[
+var modulesToLoad = [
   'angular-meteor',
   'ui.router',
   'accounts.ui',
@@ -9,7 +9,13 @@ angular.module('socially',[
   'ngImgCrop',
   'xeditable',
   'angular-sortable-view'
-]);
+];
+
+if (Meteor.isCordova) {
+  modulesToLoad = modulesToLoad.concat(['socially.mobile']);
+}
+
+angular.module('socially', modulesToLoad);
 
 var themeIcons = ['$mdIconProvider' , function ($mdIconProvider) {
 
-- 
2.3.2 (Apple Git-55)


From 0a3bfed69e8c176018fa70f1ff48a279c77724a8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:17:54 +0200
Subject: [PATCH 227/262] Step 21.11: Add module isolation for browser

---
 client/lib/app.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/lib/app.js b/client/lib/app.js
index f12b3fe..fa414d8 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -14,6 +14,9 @@ var modulesToLoad = [
 if (Meteor.isCordova) {
   modulesToLoad = modulesToLoad.concat(['socially.mobile']);
 }
+else {
+  modulesToLoad = modulesToLoad.concat(['socially.browser']);
+}
 
 angular.module('socially', modulesToLoad);
 
-- 
2.3.2 (Apple Git-55)


From 690369f2936fe3391599a8be0dd0b67fd34cc4b6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:18:26 +0200
Subject: [PATCH 228/262] Step 21.12: Add the socially-browser module with
 similar logic

---
 packages/socially-browser/package.js | 26 ++++++++++++++++++++++++++
 1 file changed, 26 insertions(+)
 create mode 100644 packages/socially-browser/package.js

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
new file mode 100644
index 0000000..f908a67
--- /dev/null
+++ b/packages/socially-browser/package.js
@@ -0,0 +1,26 @@
+Package.describe({
+  name: 'socially-browser',
+  version: '0.0.1',
+  summary: '',
+  git: '',
+  documentation: 'README.md'
+});
+
+Package.onUse(function(api) {
+  api.versionsFrom('1.2.0.1');
+  api.use('angular');
+
+  api.addFiles([
+    'client/lib/module.js',
+    'client/routes.js'
+  ], 'web.browser');
+
+  api.addAssets([
+    'client/users/views/login-browser.html'
+  ], 'web.browser');
+});
+
+Package.onTest(function(api) {
+  api.use('tinytest');
+  api.use('socially-mobile');
+});
-- 
2.3.2 (Apple Git-55)


From 60fcba393530244106854a244c2d6292f2a6354c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:19:05 +0200
Subject: [PATCH 229/262] Step 21.13: Add angular module

---
 packages/socially-browser/client/lib/module.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 packages/socially-browser/client/lib/module.js

diff --git a/packages/socially-browser/client/lib/module.js b/packages/socially-browser/client/lib/module.js
new file mode 100644
index 0000000..b0d348f
--- /dev/null
+++ b/packages/socially-browser/client/lib/module.js
@@ -0,0 +1 @@
+angular.module('socially.browser', []);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a0d7eb43ee0e194da2c06eed5d099d6d86a8e460 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:19:28 +0200
Subject: [PATCH 230/262] Step 21.14: Add routes for browser package

---
 packages/socially-browser/client/routes.js | 8 ++++++++
 1 file changed, 8 insertions(+)
 create mode 100644 packages/socially-browser/client/routes.js

diff --git a/packages/socially-browser/client/routes.js b/packages/socially-browser/client/routes.js
new file mode 100644
index 0000000..2421c0e
--- /dev/null
+++ b/packages/socially-browser/client/routes.js
@@ -0,0 +1,8 @@
+angular.module('socially.browser').config(function($stateProvider) {
+  $stateProvider.state('login', {
+    url: '/login',
+    templateUrl: '/packages/socially-browser/client/users/views/login-browser.html',
+    controller: 'LoginCtrl',
+    controllerAs: 'lc'
+  });
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5a5844053125fcf9a90351853fd83dc0da8e390d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:19:45 +0200
Subject: [PATCH 231/262] Step 21.15: Add the view for browser login

---
 packages/socially-browser/client/users/views/login-browser.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 packages/socially-browser/client/users/views/login-browser.html

diff --git a/packages/socially-browser/client/users/views/login-browser.html b/packages/socially-browser/client/users/views/login-browser.html
new file mode 100644
index 0000000..100bb4c
--- /dev/null
+++ b/packages/socially-browser/client/users/views/login-browser.html
@@ -0,0 +1 @@
+browser login
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9c8dc17435ba2440fded6080115e14c21ff31b93 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:43:13 +0200
Subject: [PATCH 232/262] Step 21.16: Add the socially-browser package to the
 project

---
 .meteor/packages | 1 +
 .meteor/versions | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/.meteor/packages b/.meteor/packages
index 31447f0..3f186b3 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -37,3 +37,4 @@ vitalets:angular-xeditable
 netanelgilad:angular-sortable-view
 cfs:graphicsmagick
 socially-mobile
+socially-browser
diff --git a/.meteor/versions b/.meteor/versions
index 664a108..5135c60 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -95,7 +95,6 @@ oauth@1.1.6
 oauth1@1.1.5
 oauth2@1.1.5
 observe-sequence@1.0.7
-okland:accounts-phone@0.0.21
 ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.2
 planettraining:material-design-icons@2.0.0
@@ -111,6 +110,7 @@ routepolicy@1.0.6
 service-configuration@1.0.5
 session@1.1.1
 sha@1.0.4
+socially-browser@0.0.1
 socially-mobile@0.0.1
 spacebars@1.0.7
 spacebars-compiler@1.0.7
-- 
2.3.2 (Apple Git-55)


From 3a98d7955dafe8028cd6930c8713b438f09478c3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:20:52 +0200
Subject: [PATCH 233/262] Step 21.17: Add the actual view for browser login

---
 .../client/users/views/login-browser.html          | 61 +++++++++++++++++++++-
 1 file changed, 60 insertions(+), 1 deletion(-)

diff --git a/packages/socially-browser/client/users/views/login-browser.html b/packages/socially-browser/client/users/views/login-browser.html
index 100bb4c..89c1edc 100644
--- a/packages/socially-browser/client/users/views/login-browser.html
+++ b/packages/socially-browser/client/users/views/login-browser.html
@@ -1 +1,60 @@
-browser login
\ No newline at end of file
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Sign in </h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Use existing account</p>
+      </div>
+      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="google-plus" style="color: #DC4A38;"></md-icon>
+          <span> Google</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="facebook" style="color: #3F62B4;"></md-icon>
+          <span>Facebook </span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="twitter" style="color: #27AAE2;"></md-icon>
+          <span>Twitter </span>
+        </md-button>
+      </div>
+      <md-divider class="inset"></md-divider>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Sign in with your email</p>
+      </div>
+
+      <form name="loginForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container >
+          <label> Email </label>
+          <input type="text" ng-model="lc.credentials.email" placeholder="email" aria-label="email" required/>
+        </md-input-container>
+        <md-input-container >
+          <label> Password </label>
+          <input type="password" ng-model="lc.credentials.password" placeholder="password" aria-label="password" required/>
+        </md-input-container>
+        <div layout="row" layout-align="space-between center">
+          <a class="md-button" href="/socially/resetpw">Forgot password?</a>
+          <md-button class="md-raised md-primary" ng-click="lc.login()" aria-label="login" ng-disabled="lc.loginForm.$invalid()">Sign In</md-button>
+        </div>
+      </form>
+      <md-toolbar ng-show="lc.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ lc.error }}</p>
+      </md-toolbar>
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/socially/register">Need an account?</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6758a13b05ff408bd73ab725fb9b229f9bf3a36f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:21:51 +0200
Subject: [PATCH 234/262] Step 21.18: move the login controller and update it's
 module

---
 client/users/controllers/login.js                  | 23 ----------------------
 .../client/users/controllers/login.js              | 21 ++++++++++++++++++++
 2 files changed, 21 insertions(+), 23 deletions(-)
 delete mode 100644 client/users/controllers/login.js
 create mode 100644 packages/socially-browser/client/users/controllers/login.js

diff --git a/client/users/controllers/login.js b/client/users/controllers/login.js
deleted file mode 100644
index d1e4664..0000000
--- a/client/users/controllers/login.js
+++ /dev/null
@@ -1,23 +0,0 @@
-angular.module("socially").controller("LoginCtrl", ['$meteor', '$state',
-  function ($meteor, $state) {
-    var vm = this;
-
-    vm.credentials = {
-      email: '',
-      password: ''
-    };
-
-    vm.error = '';
-
-    vm.login = function () {
-      $meteor.loginWithPassword(vm.credentials.email, vm.credentials.password).then(
-        function () {
-          $state.go('parties');
-        },
-        function (err) {
-          vm.error = 'Login error - ' + err;
-        }
-      );
-    };
-  }
-]);
\ No newline at end of file
diff --git a/packages/socially-browser/client/users/controllers/login.js b/packages/socially-browser/client/users/controllers/login.js
new file mode 100644
index 0000000..8b9227b
--- /dev/null
+++ b/packages/socially-browser/client/users/controllers/login.js
@@ -0,0 +1,21 @@
+angular.module("socially.browser").controller("LoginCtrl", function ($meteor, $state) {
+  var vm = this;
+
+  vm.credentials = {
+    email: '',
+    password: ''
+  };
+
+  vm.error = '';
+
+  vm.login = function () {
+    $meteor.loginWithPassword(vm.credentials.email, vm.credentials.password).then(
+      function () {
+        $state.go('parties');
+      },
+      function (err) {
+        vm.error = 'Login error - ' + err;
+      }
+    );
+  };
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9332893c702ed7272cc0818628b8609ea6f83dc0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:22:39 +0200
Subject: [PATCH 235/262] Step 21.19: Remove old login view from the root
 project

---
 client/users/views/login.html | 62 -------------------------------------------
 1 file changed, 62 deletions(-)
 delete mode 100644 client/users/views/login.html

diff --git a/client/users/views/login.html b/client/users/views/login.html
deleted file mode 100644
index 587e578..0000000
--- a/client/users/views/login.html
+++ /dev/null
@@ -1,62 +0,0 @@
-<md-content layout="row" layout-align="center start" layout-fill layout-margin>
-
-  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
-
-    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
-      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
-        <h3 class="md-display-1"> Sign in </h3>
-      </div>
-    </md-toolbar>
-
-    <div layout="column" layout-fill layout-margin layout-padding>
-      <div layout="row" layout-fill layout-margin>
-        <p class="md-body-2"> Use existing account</p>
-      </div>
-      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="google" style="color: #DC4A38;"></md-icon>
-          <span> Google</span>
-        </md-button>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="facebook" style="color: #3F62B4;"></md-icon>
-          <span>Facebook </span>
-        </md-button>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="twitter" style="color: #27AAE2;"></md-icon>
-          <span>Twitter </span>
-        </md-button>
-      </div>
-      <md-divider class="inset"></md-divider>
-
-      <div layout="row" layout-fill layout-margin>
-        <p class="md-body-2"> Sign in with your email</p>
-      </div>
-
-      <form name="loginForm" layout="column" layout-fill layout-padding layout-margin>
-        <md-input-container>
-          <label> Email </label>
-          <input type="text" ng-model="lc.credentials.email" aria-label="email" required/>
-        </md-input-container>
-        <md-input-container>
-          <label> Password </label>
-          <input type="password" ng-model="lc.credentials.password" aria-label="password" required/>
-        </md-input-container>
-        <div layout="row" layout-align="space-between center">
-          <a class="md-button" href="/resetPassword">Forgot password?</a>
-          <md-button class="md-raised md-primary" ng-click="lc.login()" aria-label="login"
-                     ng-disabled="lc.loginForm.$invalid()">Sign In
-          </md-button>
-        </div>
-      </form>
-      <md-toolbar ng-show="lc.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
-        <p class="md-body-1">{{ lc.error }}</p>
-      </md-toolbar>
-      <md-divider></md-divider>
-      <div layout="row" layout-align="center">
-        <a class="md-button" href="/register">Need an account?</a>
-      </div>
-
-    </div>
-
-  </md-whiteframe>
-</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cabc80e63712b10643e3ae621ad42498968ce211 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:23:31 +0200
Subject: [PATCH 236/262] Step 21.20: Load the browser login controller in the
 package

---
 packages/socially-browser/package.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index f908a67..337a54d 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -12,7 +12,8 @@ Package.onUse(function(api) {
 
   api.addFiles([
     'client/lib/module.js',
-    'client/routes.js'
+    'client/routes.js',
+    'client/users/controllers/login.js'
   ], 'web.browser');
 
   api.addAssets([
-- 
2.3.2 (Apple Git-55)


From 33643d93db48890149cbe8a4fe06cae77c9882d0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:37:14 +0200
Subject: [PATCH 237/262] Step 21.21: Add login mobile view

---
 .../client/users/views/login-mobile.html           | 34 +++++++++++++++++++++-
 1 file changed, 33 insertions(+), 1 deletion(-)

diff --git a/packages/socially-mobile/client/users/views/login-mobile.html b/packages/socially-mobile/client/users/views/login-mobile.html
index 5b6a3f2..033bd8d 100644
--- a/packages/socially-mobile/client/users/views/login-mobile.html
+++ b/packages/socially-mobile/client/users/views/login-mobile.html
@@ -1 +1,33 @@
-mobile login
\ No newline at end of file
+<md-content layout="row">
+  <span flex></span>
+  <md-whiteframe layout="column" flex="50">
+    <div layout="row" layout-align="space-around center">
+      <div>Login with SMS</div>
+    </div>
+    <div ng-show="lc.error" class="md-warn">
+      <small>{{ lc.error }}</small>
+    </div>
+    <form layout="column" ng-show="lc.isStepTwo">
+      <md-input-container>
+        <input type="text" ng-model="lc.verificationCode"
+               placeholder="code"/>
+      </md-input-container>
+      <md-button class="md-raised md-primary" ng-click="lc.verifyCode()"
+                 aria-label="login">Verify Code
+      </md-button>
+    </form>
+    <form layout="column" ng-show="!lc.isStepTwo">
+      <md-input-container>
+        <input type="text" ng-model="lc.phoneNumber"
+               placeholder="phone"/>
+      </md-input-container>
+      <md-button class="md-raised md-primary" ng-click="lc.verifyPhone()"
+                 aria-label="login">Send SMS
+      </md-button>
+    </form>
+    <div layout="row" layout-align="space-around center">
+      <a href="/resetpw">Forgot password?</a>
+    </div>
+  </md-whiteframe>
+  <span flex></span>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From f63db87fdca495581424cc34f11ebcd527e50633 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 00:00:21 +0200
Subject: [PATCH 238/262] Step 21.22: Add the okland:accounts-phone package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 3f186b3..35fef22 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -38,3 +38,4 @@ netanelgilad:angular-sortable-view
 cfs:graphicsmagick
 socially-mobile
 socially-browser
+okland:accounts-phone
diff --git a/.meteor/versions b/.meteor/versions
index 5135c60..de83710 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -95,6 +95,7 @@ oauth@1.1.6
 oauth1@1.1.5
 oauth2@1.1.5
 observe-sequence@1.0.7
+okland:accounts-phone@0.0.21
 ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.2
 planettraining:material-design-icons@2.0.0
-- 
2.3.2 (Apple Git-55)


From dc83108554850cdabbdd2a9213c06407ea83764d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 00:00:35 +0200
Subject: [PATCH 239/262] Step 21.23: Add the login controller

---
 .../client/users/controllers/login.js              | 24 ++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 packages/socially-mobile/client/users/controllers/login.js

diff --git a/packages/socially-mobile/client/users/controllers/login.js b/packages/socially-mobile/client/users/controllers/login.js
new file mode 100644
index 0000000..512184e
--- /dev/null
+++ b/packages/socially-mobile/client/users/controllers/login.js
@@ -0,0 +1,24 @@
+angular.module("socially.mobile").controller("LoginCtrl", function ($meteor, $state) {
+  var vm = this;
+
+  vm.isStepTwo = false;
+  vm.phoneNumber = '';
+  vm.verificationCode = '';
+  vm.error = '';
+
+  vm.verifyPhone = function () {
+    Accounts.requestPhoneVerification(vm.phoneNumber);
+    vm.isStepTwo = true;
+  };
+
+  vm.verifyCode = function () {
+    Accounts.verifyPhone(vm.phoneNumber, vm.verificationCode, function (err) {
+      if (err) {
+        vm.error = err;
+      }
+      else {
+        $state.go('parties');
+      }
+    });
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a6835b71f6ab9c584139ae92e91fa2e1bd3e1cd0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 25 Oct 2015 21:37:58 +0200
Subject: [PATCH 240/262] Step 21.24: Include login controller in the package

---
 packages/socially-mobile/package.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index 71b4ab8..5c2c866 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -12,7 +12,8 @@ Package.onUse(function(api) {
 
   api.addFiles([
     'client/lib/module.js',
-    'client/routes.js'
+    'client/routes.js',
+    'client/users/controllers/login.js'
   ], 'web.cordova');
 
   api.addAssets([
-- 
2.3.2 (Apple Git-55)


From adcb888cd7fead85b7cd6f023e010d0d50dfb9f3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 19:38:33 +0200
Subject: [PATCH 241/262] Step 22.1: Clean index.html file

---
 client/index.html | 15 +--------------
 1 file changed, 1 insertion(+), 14 deletions(-)

diff --git a/client/index.html b/client/index.html
index f739374..25da888 100644
--- a/client/index.html
+++ b/client/index.html
@@ -3,18 +3,5 @@
   <base href="/">
   <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
 </head>
-<body layout="column">
-<md-toolbar md-scroll-shrink layout="row" layout-align="start center" layout-padding>
-  <h2>
-    <a ui-sref="parties"><span class="md-title">Socially</span></a>
-  </h2>
-  <span flex></span>
-  <div class="navbar-right navbar-text">
-    <md-button ng-href="/login" ng-hide="$root.currentUser">Login</md-button>
-    <md-button ng-href="/register" ng-hide="$root.currentUser">Sign up</md-button>
-    <div ng-show="$root.currentUser">{{ $root.currentUser | displayName }}</div>
-    <md-button ng-href="/logout" ng-show="$root.currentUser">Logout</md-button>
-  </div>
-</md-toolbar>
-<div ui-view flex-gt-sm layout-gt-sm="row"></div>
+<body ui-view="">
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2808c00ea31fc4d3bb178e7ead26c59309d75276 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 19:39:01 +0200
Subject: [PATCH 242/262] Step 22.2: Add browser main page and add the main
 view

---
 packages/socially-browser/client/browser-main.html | 13 +++++++++++++
 1 file changed, 13 insertions(+)
 create mode 100644 packages/socially-browser/client/browser-main.html

diff --git a/packages/socially-browser/client/browser-main.html b/packages/socially-browser/client/browser-main.html
new file mode 100644
index 0000000..3d64306
--- /dev/null
+++ b/packages/socially-browser/client/browser-main.html
@@ -0,0 +1,13 @@
+<md-toolbar md-scroll-shrink layout="row" layout-align="start center" layout-padding>
+  <h2>
+    <a ui-sref="socially.parties"><span class="md-title">Socially</span></a>
+  </h2>
+  <span flex></span>
+  <div class="navbar-right navbar-text">
+    <md-button ng-href="/socially/login" ng-hide="$root.currentUser">Login</md-button>
+    <md-button ng-href="/socially/register" ng-hide="$root.currentUser">Sign up</md-button>
+    <div ng-show="$root.currentUser" ng-bind="$root.currentUser"></div>
+    <md-button ng-href="/socially/logout" ng-show="$root.currentUser">Logout</md-button>
+  </div>
+</md-toolbar>
+<div ui-view="main" flex-gt-sm layout-gt-sm="row"></div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 677e669c6c6ef3beb7036ff2291c57a4dda15aa9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 19:39:37 +0200
Subject: [PATCH 243/262] Step 22.3: Move the parties list state and add the
 main state

---
 packages/socially-browser/client/routes.js | 33 +++++++++++++++++++++++-------
 1 file changed, 26 insertions(+), 7 deletions(-)

diff --git a/packages/socially-browser/client/routes.js b/packages/socially-browser/client/routes.js
index 2421c0e..1ee9602 100644
--- a/packages/socially-browser/client/routes.js
+++ b/packages/socially-browser/client/routes.js
@@ -1,8 +1,27 @@
-angular.module('socially.browser').config(function($stateProvider) {
-  $stateProvider.state('login', {
-    url: '/login',
-    templateUrl: '/packages/socially-browser/client/users/views/login-browser.html',
-    controller: 'LoginCtrl',
-    controllerAs: 'lc'
-  });
+angular.module('socially.browser').config(function ($stateProvider) {
+  $stateProvider
+    .state('socially.login', {
+      url: '/login',
+      views: {
+        main: {
+          templateUrl: '/packages/socially-browser/client/users/views/login-browser.html',
+          controller: 'LoginCtrl',
+          controllerAs: 'lc'
+        }
+      }
+    })
+    .state('socially', {
+      url: '/socially',
+      templateUrl: '/packages/socially-browser/client/browser-main.html',
+      abstract: true
+    })
+    .state('socially.parties', {
+      url: '/parties',
+      views: {
+        main: {
+          templateUrl: '/packages/socially-browser/client/parties/views/parties-list.html',
+          controller: 'PartiesListCtrl'
+        }
+      }
+    });
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 88fcac32ad8c04be83980b5cca8b298b4afe6b27 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 00:03:22 +0200
Subject: [PATCH 244/262] Step 22.4: Update the routes to match the new views
 structure

---
 client/routes.js | 51 +++++++++++++++++++++++++++++----------------------
 1 file changed, 29 insertions(+), 22 deletions(-)

diff --git a/client/routes.js b/client/routes.js
index 665f2f9..4f7a918 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -12,35 +12,42 @@ angular.module("socially").config(function ($urlRouterProvider, $stateProvider,
   $locationProvider.html5Mode(true);
 
   $stateProvider
-    .state('parties', {
-      url: '/parties',
-      templateUrl: 'client/parties/views/parties-list.html',
-      controller: 'PartiesListCtrl'
-    })
-    .state('partyDetails', {
+
+    .state('socially.partyDetails', {
       url: '/parties/:partyId',
-      templateUrl: 'client/parties/views/party-details.html',
-      controller: 'PartyDetailsCtrl',
-      resolve: {
-        "currentUser": function($meteor){
-          return $meteor.requireUser();
+      views: {
+        main: {
+          templateUrl: 'client/parties/views/party-details.html',
+          controller: 'PartyDetailsCtrl',
+          resolve: {
+            "currentUser": function($meteor){
+              return $meteor.requireUser();
+            }
+          }
         }
       }
     })
-
-    .state('register',{
+    .state('socially.register',{
       url: '/register',
-      templateUrl: 'client/users/views/register.html',
-      controller: 'RegisterCtrl',
-      controllerAs: 'rc'
+      views: {
+        main: {
+          templateUrl: 'client/users/views/register.html',
+          controller: 'RegisterCtrl',
+          controllerAs: 'rc'
+        }
+      }
     })
-    .state('resetpw', {
+    .state('socially.resetpw', {
       url: '/resetpw',
-      templateUrl: 'client/users/views/reset-password.html',
-      controller: 'ResetCtrl',
-      controllerAs: 'rpc'
+      views: {
+        main: {
+          templateUrl: 'client/users/views/reset-password.html',
+          controller: 'ResetCtrl',
+          controllerAs: 'rpc'
+        }
+      }
     })
-    .state('logout', {
+    .state('socially.logout', {
       url: '/logout',
       resolve: {
         "logout": function($meteor, $state) {
@@ -53,5 +60,5 @@ angular.module("socially").config(function ($urlRouterProvider, $stateProvider,
       }
     });
 
-  $urlRouterProvider.otherwise("/parties");
+  $urlRouterProvider.otherwise("/socially/parties");
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e8403a48ce2db4e36f4d3267c79744bae5ca4e21 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 00:05:06 +0200
Subject: [PATCH 245/262] Step 22.5: Move parties list ctrl to the browser
 package

---
 client/parties/controllers/partiesList.js          | 193 ---------------------
 .../client/parties/controllers/partiesList.js      | 193 +++++++++++++++++++++
 2 files changed, 193 insertions(+), 193 deletions(-)
 delete mode 100644 client/parties/controllers/partiesList.js
 create mode 100644 packages/socially-browser/client/parties/controllers/partiesList.js

diff --git a/client/parties/controllers/partiesList.js b/client/parties/controllers/partiesList.js
deleted file mode 100644
index 7c91ef9..0000000
--- a/client/parties/controllers/partiesList.js
+++ /dev/null
@@ -1,193 +0,0 @@
-angular.module("socially").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $mdDialog, $filter) {
-  $scope.page = 1;
-  $scope.perPage = 3;
-  $scope.sort = {name: 1};
-  $scope.orderProperty = '1';
-
-  $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
-  $scope.images = $meteor.collectionFS(Images, false, Images).subscribe('images');
-
-  $scope.parties = $meteor.collection(function() {
-    return Parties.find({}, {
-      sort : $scope.getReactively('sort')
-    });
-  });
-
-  $scope.getMainImage = function(images) {
-    if (images && images.length && images[0] && images[0].id) {
-      var url = $filter('filter')($scope.images, {_id: images[0].id})[0].url();
-
-      return {
-        'background-image': 'url("' + url + '")'
-      }
-    }
-  };
-
-  $meteor.autorun($scope, function() {
-    $meteor.subscribe('parties', {
-      limit: parseInt($scope.getReactively('perPage')),
-      skip: (parseInt($scope.getReactively('page')) - 1) * parseInt($scope.getReactively('perPage')),
-      sort: $scope.getReactively('sort')
-    }, $scope.getReactively('search')).then(function(){
-      $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
-
-        $scope.parties.forEach( function (party) {
-          party.onClicked = function () {
-            $state.go('partyDetails', {partyId: party._id});
-          };
-        });
-
-        var styles1 = [{
-          "featureType": "landscape.natural",
-          "elementType": "geometry.fill",
-          "stylers": [{"visibility": "on"}, {"color": "#e0efef"}]
-        }, {
-          "featureType": "poi",
-          "elementType": "geometry.fill",
-          "stylers": [{"visibility": "on"}, {"hue": "#1900ff"}, {"color": "#c0e8e8"}]
-        }, {
-          "featureType": "road",
-          "elementType": "geometry",
-          "stylers": [{"lightness": 100}, {"visibility": "simplified"}]
-        }, {
-          "featureType": "road",
-          "elementType": "labels",
-          "stylers": [{"visibility": "off"}]
-        }, {
-          "featureType": "transit.line",
-          "elementType": "geometry",
-          "stylers": [{"visibility": "on"}, {"lightness": 700}]
-        }, {"featureType": "water", "elementType": "all", "stylers": [{"color": "#7dcdcd"}]}];
-        var styles2 = [{
-          "featureType": "administrative",
-          "elementType": "labels.text.fill",
-          "stylers": [{"color": "#444444"}]
-        }, {
-          "featureType": "landscape",
-          "elementType": "all",
-          "stylers": [{"color": "#f2f2f2"}]
-        }, {
-          "featureType": "poi",
-          "elementType": "all",
-          "stylers": [{"visibility": "off"}]
-        }, {
-          "featureType": "road",
-          "elementType": "all",
-          "stylers": [{"saturation": -100}, {"lightness": 45}]
-        }, {
-          "featureType": "road.highway",
-          "elementType": "all",
-          "stylers": [{"visibility": "simplified"}]
-        }, {
-          "featureType": "road.arterial",
-          "elementType": "labels.icon",
-          "stylers": [{"visibility": "off"}]
-        }, {
-          "featureType": "transit",
-          "elementType": "all",
-          "stylers": [{"visibility": "off"}]
-        }, {
-          "featureType": "water",
-          "elementType": "all",
-          "stylers": [{"color": "#46bcec"}, {"visibility": "on"}]
-        }];
-
-
-        $scope.map = {
-          center: {
-            latitude: 45,
-            longitude: -73
-          },
-          options: {
-            styles: styles2,
-            maxZoom: 10
-          },
-          zoom: 8
-        };
-
-      });
-    });
-
-  $scope.remove = function (party) {
-    $scope.parties.splice($scope.parties.indexOf(party), 1);
-  };
-
-  $scope.removeAll = function(){
-    $scope.parties.remove();
-  };
-
-  $scope.pageChanged = function(newPage) {
-    $scope.page = newPage;
-  };
-
-  $scope.$watch('orderProperty', function(){
-    if ($scope.orderProperty)
-      $scope.sort = {name: parseInt($scope.orderProperty)};
-  });
-
-  $scope.rsvp = function(partyId, rsvp){
-    $meteor.call('rsvp', partyId, rsvp).then(
-      function(data){
-        console.log('success responding', data);
-      },
-      function(err){
-        console.log('failed', err);
-      }
-    );
-  };
-
-  $scope.outstandingInvitations = function (party) {
-    return _.filter($scope.users, function (user) {
-      return (_.contains(party.invited, user._id) &&
-      !_.findWhere(party.rsvps, {user: user._id}));
-    });
-  };
-
-  $scope.getUserById = function(userId){
-    return Meteor.users.findOne(userId);
-  };
-
-  $scope.creator = function(party){
-    if (!party)
-      return;
-    var owner = $scope.getUserById(party.owner);
-    if (!owner)
-      return 'nobody';
-
-    if ($rootScope.currentUser)
-      if ($rootScope.currentUser._id)
-        if (owner._id === $rootScope.currentUser._id)
-          return 'me';
-
-      return owner;
-    };
-
-    $scope.openAddNewPartyModal = function(){
-      $mdDialog.show({
-        controller: 'AddNewPartyCtrl',
-        templateUrl: 'client/parties/views/add-new-party-modal.html',
-        clickOutsideToClose:true,
-        resolve: {
-          parties: function () {
-            return $scope.parties;
-          }
-        }
-      })
-        .then(function(answer) {
-          $scope.status = 'You said the information was "' + answer + '".';
-        }, function() {
-          $scope.status = 'You cancelled the dialog.';
-        });
-    };
-
-  $scope.isRSVP = function (rsvp, party) {
-    if (!$rootScope.currentUser._id) return false;
-    var rsvpIndex = party.myRsvpIndex;
-    rsvpIndex = rsvpIndex || _.indexOf(_.pluck(party.rsvps, 'user'), $rootScope.currentUser._id);
-
-    if (rsvpIndex !== -1) {
-      party.myRsvpIndex = rsvpIndex;
-      return party.rsvps[rsvpIndex].rsvp === rsvp;
-    }
-  }
-});
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/controllers/partiesList.js b/packages/socially-browser/client/parties/controllers/partiesList.js
new file mode 100644
index 0000000..5354a00
--- /dev/null
+++ b/packages/socially-browser/client/parties/controllers/partiesList.js
@@ -0,0 +1,193 @@
+angular.module("socially.browser").controller("PartiesListCtrl", function ($scope, $meteor, $rootScope, $state, $mdDialog, $filter) {
+  $scope.page = 1;
+  $scope.perPage = 3;
+  $scope.sort = {name: 1};
+  $scope.orderProperty = '1';
+
+  $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
+  $scope.images = $meteor.collectionFS(Images, false, Images).subscribe('images');
+
+  $scope.parties = $meteor.collection(function() {
+    return Parties.find({}, {
+      sort : $scope.getReactively('sort')
+    });
+  });
+
+  $scope.getMainImage = function(images) {
+    if (images && images.length && images[0] && images[0].id) {
+      var url = $filter('filter')($scope.images, {_id: images[0].id})[0].url();
+
+      return {
+        'background-image': 'url("' + url + '")'
+      }
+    }
+  };
+
+  $meteor.autorun($scope, function() {
+    $meteor.subscribe('parties', {
+      limit: parseInt($scope.getReactively('perPage')),
+      skip: (parseInt($scope.getReactively('page')) - 1) * parseInt($scope.getReactively('perPage')),
+      sort: $scope.getReactively('sort')
+    }, $scope.getReactively('search')).then(function(){
+      $scope.partiesCount = $meteor.object(Counts ,'numberOfParties', false);
+
+        $scope.parties.forEach( function (party) {
+          party.onClicked = function () {
+            $state.go('partyDetails', {partyId: party._id});
+          };
+        });
+
+        var styles1 = [{
+          "featureType": "landscape.natural",
+          "elementType": "geometry.fill",
+          "stylers": [{"visibility": "on"}, {"color": "#e0efef"}]
+        }, {
+          "featureType": "poi",
+          "elementType": "geometry.fill",
+          "stylers": [{"visibility": "on"}, {"hue": "#1900ff"}, {"color": "#c0e8e8"}]
+        }, {
+          "featureType": "road",
+          "elementType": "geometry",
+          "stylers": [{"lightness": 100}, {"visibility": "simplified"}]
+        }, {
+          "featureType": "road",
+          "elementType": "labels",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "transit.line",
+          "elementType": "geometry",
+          "stylers": [{"visibility": "on"}, {"lightness": 700}]
+        }, {"featureType": "water", "elementType": "all", "stylers": [{"color": "#7dcdcd"}]}];
+        var styles2 = [{
+          "featureType": "administrative",
+          "elementType": "labels.text.fill",
+          "stylers": [{"color": "#444444"}]
+        }, {
+          "featureType": "landscape",
+          "elementType": "all",
+          "stylers": [{"color": "#f2f2f2"}]
+        }, {
+          "featureType": "poi",
+          "elementType": "all",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "road",
+          "elementType": "all",
+          "stylers": [{"saturation": -100}, {"lightness": 45}]
+        }, {
+          "featureType": "road.highway",
+          "elementType": "all",
+          "stylers": [{"visibility": "simplified"}]
+        }, {
+          "featureType": "road.arterial",
+          "elementType": "labels.icon",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "transit",
+          "elementType": "all",
+          "stylers": [{"visibility": "off"}]
+        }, {
+          "featureType": "water",
+          "elementType": "all",
+          "stylers": [{"color": "#46bcec"}, {"visibility": "on"}]
+        }];
+
+
+        $scope.map = {
+          center: {
+            latitude: 45,
+            longitude: -73
+          },
+          options: {
+            styles: styles2,
+            maxZoom: 10
+          },
+          zoom: 8
+        };
+
+      });
+    });
+
+  $scope.remove = function (party) {
+    $scope.parties.splice($scope.parties.indexOf(party), 1);
+  };
+
+  $scope.removeAll = function(){
+    $scope.parties.remove();
+  };
+
+  $scope.pageChanged = function(newPage) {
+    $scope.page = newPage;
+  };
+
+  $scope.$watch('orderProperty', function(){
+    if ($scope.orderProperty)
+      $scope.sort = {name: parseInt($scope.orderProperty)};
+  });
+
+  $scope.rsvp = function(partyId, rsvp){
+    $meteor.call('rsvp', partyId, rsvp).then(
+      function(data){
+        console.log('success responding', data);
+      },
+      function(err){
+        console.log('failed', err);
+      }
+    );
+  };
+
+  $scope.outstandingInvitations = function (party) {
+    return _.filter($scope.users, function (user) {
+      return (_.contains(party.invited, user._id) &&
+      !_.findWhere(party.rsvps, {user: user._id}));
+    });
+  };
+
+  $scope.getUserById = function(userId){
+    return Meteor.users.findOne(userId);
+  };
+
+  $scope.creator = function(party){
+    if (!party)
+      return;
+    var owner = $scope.getUserById(party.owner);
+    if (!owner)
+      return 'nobody';
+
+    if ($rootScope.currentUser)
+      if ($rootScope.currentUser._id)
+        if (owner._id === $rootScope.currentUser._id)
+          return 'me';
+
+      return owner;
+    };
+
+    $scope.openAddNewPartyModal = function(){
+      $mdDialog.show({
+        controller: 'AddNewPartyCtrl',
+        templateUrl: 'client/parties/views/add-new-party-modal.html',
+        clickOutsideToClose:true,
+        resolve: {
+          parties: function () {
+            return $scope.parties;
+          }
+        }
+      })
+        .then(function(answer) {
+          $scope.status = 'You said the information was "' + answer + '".';
+        }, function() {
+          $scope.status = 'You cancelled the dialog.';
+        });
+    };
+
+  $scope.isRSVP = function (rsvp, party) {
+    if (!$rootScope.currentUser._id) return false;
+    var rsvpIndex = party.myRsvpIndex;
+    rsvpIndex = rsvpIndex || _.indexOf(_.pluck(party.rsvps, 'user'), $rootScope.currentUser._id);
+
+    if (rsvpIndex !== -1) {
+      party.myRsvpIndex = rsvpIndex;
+      return party.rsvps[rsvpIndex].rsvp === rsvp;
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7c37ba3a3206fbd0fbb36405aa7bd60827784755 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 00:06:16 +0200
Subject: [PATCH 246/262] Step 22.6: Update root package states names

---
 client/users/controllers/register.js | 2 +-
 client/users/controllers/reset.js    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/users/controllers/register.js b/client/users/controllers/register.js
index f21b5f5..157a009 100644
--- a/client/users/controllers/register.js
+++ b/client/users/controllers/register.js
@@ -12,7 +12,7 @@ angular.module("socially").controller("RegisterCtrl", ['$meteor', '$state',
     vm.register = function () {
       $meteor.createUser(vm.credentials).then(
         function () {
-          $state.go('parties');
+          $state.go('socially.parties');
         },
         function (err) {
           vm.error = 'Registration error - ' + err;
diff --git a/client/users/controllers/reset.js b/client/users/controllers/reset.js
index 56be12f..c7684bc 100644
--- a/client/users/controllers/reset.js
+++ b/client/users/controllers/reset.js
@@ -11,7 +11,7 @@ angular.module("socially").controller("ResetCtrl", ['$meteor', '$state',
     vm.reset = function () {
       $meteor.forgotPassword(vm.credentials).then(
         function () {
-          $state.go('parties');
+          $state.go('socially.parties');
         },
         function (err) {
           vm.error = 'Error sending forgot password email - ' + err;
-- 
2.3.2 (Apple Git-55)


From 9880c399635fa7a907f65ee4c1c2dc8c502a134b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Fri, 6 Nov 2015 00:07:51 +0200
Subject: [PATCH 247/262] Step 22.7: Update state name on the login controller

---
 packages/socially-browser/client/users/controllers/login.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/packages/socially-browser/client/users/controllers/login.js b/packages/socially-browser/client/users/controllers/login.js
index 8b9227b..80662d1 100644
--- a/packages/socially-browser/client/users/controllers/login.js
+++ b/packages/socially-browser/client/users/controllers/login.js
@@ -11,7 +11,7 @@ angular.module("socially.browser").controller("LoginCtrl", function ($meteor, $s
   vm.login = function () {
     $meteor.loginWithPassword(vm.credentials.email, vm.credentials.password).then(
       function () {
-        $state.go('parties');
+        $state.go('socially.parties');
       },
       function (err) {
         vm.error = 'Login error - ' + err;
-- 
2.3.2 (Apple Git-55)


From 500f2396c8823d259e3314e93035bb3e193eda1c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 19:40:46 +0200
Subject: [PATCH 248/262] Step 22.7: Move the parties list view to the browser
 package

---
 client/parties/views/parties-list.html             | 79 ----------------------
 .../client/parties/views/parties-list.html         | 79 ++++++++++++++++++++++
 2 files changed, 79 insertions(+), 79 deletions(-)
 delete mode 100644 client/parties/views/parties-list.html
 create mode 100644 packages/socially-browser/client/parties/views/parties-list.html

diff --git a/client/parties/views/parties-list.html b/client/parties/views/parties-list.html
deleted file mode 100644
index ea83c45..0000000
--- a/client/parties/views/parties-list.html
+++ /dev/null
@@ -1,79 +0,0 @@
-<md-content flex-gt-sm layout-gt-sm="row" class="ma-parties-list">
-  <div layout-gt-sm="row" flex-gt-sm>
-    <div flex-gt-sm="50" flex-sm>
-      <div>
-        <div layout-padding layout="row">
-          <md-input-container style="width:50%;margin-right:10px;">
-            <label>Search</label>
-            <input type="text" ng-model="search"/>
-          </md-input-container>
-          <md-select ng-model="orderProperty" placeholder="Sort Order" >
-            <md-option value="1">Ascending</md-option>
-            <md-option value="-1">Descending</md-option>
-          </md-select>
-          <md-button class="md-fab" aria-label="Eat cake" ng-click="openAddNewPartyModal()">
-            <md-icon md-font-set="material-icons"> add </md-icon>
-          </md-button>
-        </div>
-      </div>
-      <md-content class="md-padding" style="padding-top:0;">
-        <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
-        <div  dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count" class="ma-party">
-          <md-card>
-            <div ng-if="party.images && party.images.length > 0"
-                 ng-style="getMainImage(party.images)"
-                 class="party-image">
-            </div>
-            <md-card-content>
-              <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
-              <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
-
-
-              <div layout="row">
-                <div flex="1">
-                  <p style="margin-top:0px;margin-bottom:3px;font-size:14px;color:#aaa;">
-                    <small>Posted by {{ creator(party) | displayName }}</small>
-                    <span ng-if="party.public" style="font-size:12px;color:#999;">| Everyone is invited</span>
-                  </p>
-
-                  <div ng-show="$root.currentUser" class="md-actions" layout="row">
-                    <md-button ng-click="rsvp(party._id, 'yes')">I'm going!</md-button>
-                    <md-button ng-click="rsvp(party._id, 'maybe')">Maybe</md-button>
-                    <md-button ng-click="rsvp(party._id, 'no')">No</md-button>
-                  </div>
-                </div>
-                <div  layout="row" layout-align="end end">
-                  <div ng-hide="$root.currentUser" style="font-size:13px;margin-bottom:10px;">
-                    Sign in to RSVP for this party
-                  </div>
-                  <div>
-                    <div class="rsvps-sum">
-                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'yes'}).length || "0" }}</div>
-                      <div class="rsvps-title">Yes</div>
-                    </div>
-                    <div class="rsvps-sum">
-                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0" }}</div>
-                      <div class="rsvps-title">Maybe</div>
-                    </div>
-                    <div class="rsvps-sum">
-                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'no'}).length || "0" }}</div>
-                      <div class="rsvps-title">No</div>
-                    </div>
-                  </div>
-                </div>
-              </div>
-            </md-card-content>
-          </md-card>
-        </div>
-      </md-content>
-
-    </div>
-    <div flex-gt-sm="50" flex-sm layout="row" style="min-height:300px;">
-      <ui-gmap-google-map options="map.options" center="map.center" zoom="map.zoom" flex layout="row">
-        <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
-                         fit="true" idkey="'_id'" doRebuildAll="true">
-        </ui-gmap-markers>
-      </ui-gmap-google-map>
-    </div>
-  </div>
-</md-content>
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/views/parties-list.html b/packages/socially-browser/client/parties/views/parties-list.html
new file mode 100644
index 0000000..c5ea770
--- /dev/null
+++ b/packages/socially-browser/client/parties/views/parties-list.html
@@ -0,0 +1,79 @@
+<md-content flex-gt-sm layout-gt-sm="row" class="ma-parties-list">
+  <div layout-gt-sm="row" flex-gt-sm>
+    <div flex-gt-sm="50" flex-sm>
+      <div>
+        <div layout-padding layout="row">
+          <md-input-container style="width:50%;margin-right:10px;">
+            <label>Search</label>
+            <input type="text" ng-model="search"/>
+          </md-input-container>
+          <md-select ng-model="orderProperty" placeholder="Sort Order" >
+            <md-option value="1">Ascending</md-option>
+            <md-option value="-1">Descending</md-option>
+          </md-select>
+          <md-button class="md-fab" aria-label="Eat cake" ng-click="openAddNewPartyModal()">
+            <md-icon md-font-set="material-icons"> add </md-icon>
+          </md-button>
+        </div>
+      </div>
+      <md-content class="md-padding" style="padding-top:0;">
+        <dir-pagination-controls on-page-change="pageChanged(newPageNumber)"></dir-pagination-controls>
+        <div  dir-paginate="party in parties | itemsPerPage: perPage" total-items="partiesCount.count" class="ma-party">
+          <md-card>
+            <div ng-if="party.images && party.images.length > 0"
+                 ng-style="getMainImage(party.images)"
+                 class="party-image">
+            </div>
+            <md-card-content>
+              <h2 class="md-title ma-name" style=""><a href="/socially/parties/{{party._id}}">{{party.name}}</a></h2>
+              <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
+
+
+              <div layout="row">
+                <div flex="1">
+                  <p style="margin-top:0px;margin-bottom:3px;font-size:14px;color:#aaa;">
+                    <small>Posted by {{ creator(party) | displayName }}</small>
+                    <span ng-if="party.public" style="font-size:12px;color:#999;">| Everyone is invited</span>
+                  </p>
+
+                  <div ng-show="$root.currentUser" class="md-actions" layout="row">
+                    <md-button ng-click="rsvp(party._id, 'yes')">I'm going!</md-button>
+                    <md-button ng-click="rsvp(party._id, 'maybe')">Maybe</md-button>
+                    <md-button ng-click="rsvp(party._id, 'no')">No</md-button>
+                  </div>
+                </div>
+                <div  layout="row" layout-align="end end">
+                  <div ng-hide="$root.currentUser" style="font-size:13px;margin-bottom:10px;">
+                    Sign in to RSVP for this party
+                  </div>
+                  <div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'yes'}).length || "0" }}</div>
+                      <div class="rsvps-title">Yes</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0" }}</div>
+                      <div class="rsvps-title">Maybe</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'no'}).length || "0" }}</div>
+                      <div class="rsvps-title">No</div>
+                    </div>
+                  </div>
+                </div>
+              </div>
+            </md-card-content>
+          </md-card>
+        </div>
+      </md-content>
+
+    </div>
+    <div flex-gt-sm="50" flex-sm layout="row" style="min-height:300px;">
+      <ui-gmap-google-map options="map.options" center="map.center" zoom="map.zoom" flex layout="row">
+        <ui-gmap-markers models="parties" coords="'location'" click="onClicked()"
+                         fit="true" idkey="'_id'" doRebuildAll="true">
+        </ui-gmap-markers>
+      </ui-gmap-google-map>
+    </div>
+  </div>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cb8c76e87f2d30d7a33d04968f4a3adee6aa3805 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 19:41:01 +0200
Subject: [PATCH 249/262] Step 22.8: Update package.js file with new files

---
 packages/socially-browser/package.js | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index 337a54d..0f683cf 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -13,11 +13,14 @@ Package.onUse(function(api) {
   api.addFiles([
     'client/lib/module.js',
     'client/routes.js',
-    'client/users/controllers/login.js'
+    'client/users/controllers/login.js',
+    'client/parties/controllers/partiesList.js'
   ], 'web.browser');
 
   api.addAssets([
-    'client/users/views/login-browser.html'
+    'client/users/views/login-browser.html',
+    'client/parties/views/parties-list.html',
+    'client/browser-main.html'
   ], 'web.browser');
 });
 
-- 
2.3.2 (Apple Git-55)


From 07bbb4bd46b5ca87d1328c0ee8bf991ca3cb67ad Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 19:41:25 +0200
Subject: [PATCH 250/262] Step 22.9: Update URLs in the party details view

---
 client/parties/views/party-details.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/views/party-details.html b/client/parties/views/party-details.html
index a1d808c..4baf9d5 100644
--- a/client/parties/views/party-details.html
+++ b/client/parties/views/party-details.html
@@ -19,7 +19,7 @@
       <div layout="row" layout-align="left">
         <md-button ng-click="save()">Save</md-button>
         <md-button ng-click="reset()">Reset form</md-button>
-        <md-button ng-href="/parties">Cancel</md-button>
+        <md-button ng-href="/socially/parties">Cancel</md-button>
       </div>
 
       <md-list ng-show="canInvite()">
-- 
2.3.2 (Apple Git-55)


From ac46c4d839bbd4b3187cf74fdf40d9f38f4d4a5b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 20:20:07 +0200
Subject: [PATCH 251/262] Step 22.10: Add dependecy for ionic

---
 packages/socially-mobile/package.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index 5c2c866..1824e5d 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -9,6 +9,7 @@ Package.describe({
 Package.onUse(function(api) {
   api.versionsFrom('1.2.0.1');
   api.use('angular');
+  api.use('driftyco:ionic');
 
   api.addFiles([
     'client/lib/module.js',
-- 
2.3.2 (Apple Git-55)


From 68e8801974e822d9af76768adf1565640f2a4a3f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 20:20:24 +0200
Subject: [PATCH 252/262] Step 22.11: Add angularjs dependencty for ionic

---
 packages/socially-mobile/client/lib/module.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/packages/socially-mobile/client/lib/module.js b/packages/socially-mobile/client/lib/module.js
index f078654..e87b1c4 100644
--- a/packages/socially-mobile/client/lib/module.js
+++ b/packages/socially-mobile/client/lib/module.js
@@ -1 +1 @@
-angular.module('socially.mobile', []);
\ No newline at end of file
+angular.module('socially.mobile', ['ionic']);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ec8279b8e0235b583a1dfecb8e659f5eeaa0a912 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 20:20:43 +0200
Subject: [PATCH 253/262] Step 22.12: Add mobile main page using ionic

---
 packages/socially-mobile/client/mobile-main.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 packages/socially-mobile/client/mobile-main.html

diff --git a/packages/socially-mobile/client/mobile-main.html b/packages/socially-mobile/client/mobile-main.html
new file mode 100644
index 0000000..4313839
--- /dev/null
+++ b/packages/socially-mobile/client/mobile-main.html
@@ -0,0 +1,3 @@
+<ion-nav-bar class="bar-positive" align-title="center">
+</ion-nav-bar>
+<ion-nav-view name="main"></ion-nav-view>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 354b52a59e9f5c8324dfd0972a18c4a6cd849bce Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 20:21:03 +0200
Subject: [PATCH 254/262] Step 22.13: Add stub ionic view for parties list

---
 packages/socially-mobile/client/parties/views/parties-list.html | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 packages/socially-mobile/client/parties/views/parties-list.html

diff --git a/packages/socially-mobile/client/parties/views/parties-list.html b/packages/socially-mobile/client/parties/views/parties-list.html
new file mode 100644
index 0000000..2d11cb4
--- /dev/null
+++ b/packages/socially-mobile/client/parties/views/parties-list.html
@@ -0,0 +1,4 @@
+<ion-view title="Socially" hide-back-button="true">
+  <ion-content class="padding">
+  </ion-content>
+</ion-view>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 27669a33fbe521538d98e178e5cf631844223cd5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 20:22:27 +0200
Subject: [PATCH 255/262] Step 22.14: Update package includes

---
 packages/socially-mobile/package.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index 1824e5d..40e09a8 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -18,7 +18,9 @@ Package.onUse(function(api) {
   ], 'web.cordova');
 
   api.addAssets([
-    'client/users/views/login-mobile.html'
+    'client/users/views/login-mobile.html',
+    'client/parties/views/parties-list.html',
+    'client/mobile-main.html'
   ], 'web.cordova');
 });
 
-- 
2.3.2 (Apple Git-55)


From a1f028c2a7fc616a095a296498a3c4d56d70715d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 20:22:50 +0200
Subject: [PATCH 256/262] Step 22.15: Add the routes of the mobile view

---
 packages/socially-mobile/client/routes.js | 27 ++++++++++++++++++++++-----
 1 file changed, 22 insertions(+), 5 deletions(-)

diff --git a/packages/socially-mobile/client/routes.js b/packages/socially-mobile/client/routes.js
index aee3b59..91c8b54 100644
--- a/packages/socially-mobile/client/routes.js
+++ b/packages/socially-mobile/client/routes.js
@@ -1,8 +1,25 @@
 angular.module('socially.mobile').config(function($stateProvider) {
-  $stateProvider.state('login', {
+  $stateProvider.state('socially.login', {
     url: '/login',
-    templateUrl: '/packages/socially-mobile/client/users/views/login-mobile.html',
-    controller: 'LoginCtrl',
-    controllerAs: 'lc'
-  });
+    views: {
+      main: {
+        templateUrl: '/packages/socially-mobile/client/users/views/login-mobile.html',
+        controller: 'LoginCtrl',
+        controllerAs: 'lc'
+      }
+    }
+  })
+    .state('socially', {
+      url: '/socially',
+      templateUrl: '/packages/socially-mobile/client/mobile-main.html',
+      abstract: true
+    })
+    .state('socially.parties', {
+      url: '/parties',
+      views: {
+        main: {
+          templateUrl: '/packages/socially-mobile/client/parties/views/parties-list.html'
+        }
+      }
+    });
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0572b575f9545bffc5bdc27ae01f2fa228cabfee Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 20:42:10 +0200
Subject: [PATCH 257/262] Step 22.16: Add parties list controller for mobile

---
 .../client/parties/controllers/partiesList.js                | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 packages/socially-mobile/client/parties/controllers/partiesList.js

diff --git a/packages/socially-mobile/client/parties/controllers/partiesList.js b/packages/socially-mobile/client/parties/controllers/partiesList.js
new file mode 100644
index 0000000..0ac0fd4
--- /dev/null
+++ b/packages/socially-mobile/client/parties/controllers/partiesList.js
@@ -0,0 +1,12 @@
+angular.module("socially.mobile").controller("PartiesListCtrl", function ($scope, $meteor) {
+  $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
+  $scope.images = $meteor.collectionFS(Images, false, Images).subscribe('images');
+
+  $scope.parties = $meteor.collection(function () {
+    return Parties.find({}, {});
+  });
+
+  $meteor.autorun($scope, function() {
+    $meteor.subscribe('parties', {});
+  });
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6cfef1a12815bec190b89a8723e04695d92aed5c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 20:43:05 +0200
Subject: [PATCH 258/262] Step 22.17: Use PartiesListCtrl with the view

---
 packages/socially-mobile/client/routes.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/packages/socially-mobile/client/routes.js b/packages/socially-mobile/client/routes.js
index 91c8b54..878deeb 100644
--- a/packages/socially-mobile/client/routes.js
+++ b/packages/socially-mobile/client/routes.js
@@ -18,7 +18,8 @@ angular.module('socially.mobile').config(function($stateProvider) {
       url: '/parties',
       views: {
         main: {
-          templateUrl: '/packages/socially-mobile/client/parties/views/parties-list.html'
+          templateUrl: '/packages/socially-mobile/client/parties/views/parties-list.html',
+          controller: 'PartiesListCtrl'
         }
       }
     });
-- 
2.3.2 (Apple Git-55)


From 06cc36ce07b066a85f45f0b07f87b3902cbe77d7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 20:43:21 +0200
Subject: [PATCH 259/262] Step 22.18: Include the controller file

---
 packages/socially-mobile/package.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index 40e09a8..cd4c458 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -14,7 +14,8 @@ Package.onUse(function(api) {
   api.addFiles([
     'client/lib/module.js',
     'client/routes.js',
-    'client/users/controllers/login.js'
+    'client/users/controllers/login.js',
+    'client/parties/controllers/partiesList.js'
   ], 'web.cordova');
 
   api.addAssets([
-- 
2.3.2 (Apple Git-55)


From 8d72a8bbdca29d83cb2044a5ce354693edcf8424 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 21:28:31 +0200
Subject: [PATCH 260/262] Step 22.19: Add the parties list view

---
 .../client/parties/views/parties-list.html               | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

diff --git a/packages/socially-mobile/client/parties/views/parties-list.html b/packages/socially-mobile/client/parties/views/parties-list.html
index 2d11cb4..c55bbfa 100644
--- a/packages/socially-mobile/client/parties/views/parties-list.html
+++ b/packages/socially-mobile/client/parties/views/parties-list.html
@@ -1,4 +1,20 @@
 <ion-view title="Socially" hide-back-button="true">
   <ion-content class="padding">
+    <div class="list card">
+      <div ng-repeat="party in parties">
+        <div class="item" ng-class="{'item-avatar': party.images && party.images.length > 0}">
+          <img ng-if="party.images && party.images.length > 0" ng-src="{{ getMainImageUrl(party.images) }}">
+          {{party.name}}
+        </div>
+        <div class="item item-text-wrap">
+          {{party.description}}
+        </div>
+        <div class="item item-divider">
+          Yes: {{ (party.rsvps | filter:{rsvp:'yes'}).length || "0" }},
+          Maybe: {{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0" }},
+          No: {{ (party.rsvps | filter:{rsvp:'no'}).length || "0" }}
+        </div>
+      </div>
+    </div>
   </ion-content>
 </ion-view>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b201774ad812f2f5e368592c2c6b16f8bf3998d9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 31 Oct 2015 21:28:35 +0200
Subject: [PATCH 261/262] Step 22.20: Add getMainImageUrl method to the
 controller

---
 .../socially-mobile/client/parties/controllers/partiesList.js  | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/packages/socially-mobile/client/parties/controllers/partiesList.js b/packages/socially-mobile/client/parties/controllers/partiesList.js
index 0ac0fd4..50fc2e2 100644
--- a/packages/socially-mobile/client/parties/controllers/partiesList.js
+++ b/packages/socially-mobile/client/parties/controllers/partiesList.js
@@ -1,4 +1,4 @@
-angular.module("socially.mobile").controller("PartiesListCtrl", function ($scope, $meteor) {
+angular.module("socially.mobile").controller("PartiesListCtrl", function ($scope, $meteor, $filter) {
   $scope.users = $meteor.collection(Meteor.users, false).subscribe('users');
   $scope.images = $meteor.collectionFS(Images, false, Images).subscribe('images');
 
@@ -9,4 +9,12 @@ angular.module("socially.mobile").controller("PartiesListCtrl", function ($scope
   $meteor.autorun($scope, function() {
     $meteor.subscribe('parties', {});
   });
+
+  $scope.getMainImageUrl = function(images) {
+    if (images && images.length && images[0] && images[0].id) {
+      var url = $filter('filter')($scope.images, {_id: images[0].id})[0].url();
+
+      return url;
+    }
+  };
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 71af334e5b36b376ad2cadbb3758fd8ec183e9e3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 2 Nov 2015 08:07:57 +0200
Subject: [PATCH 262/262] Update README.md

---
 README.md | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/README.md b/README.md
index 9c9c1bd..acae482 100644
--- a/README.md
+++ b/README.md
@@ -1,11 +1,11 @@
-# meteor-angular-socially - [Tutorial's site](http://angularjs.meteor.com/tutorial)
+# meteor-angular-socially - [Tutorial's site](http://angular-meteor.com/tutorialIntro)
 angular-meteor example and tutorial app.
 
 The tutorial starts at branch 'step_00' till the last step.
 
 The master branch is always equal to the last step.
 
-Here is the deployed final version - http://socially-step18.meteor.com/
+Here is the deployed final version - http://socially-step22.meteor.com/
 
 Please contribute to the tutorial.
 Pull request the master branch to add new features or pull request specific step to improve that step.
@@ -16,7 +16,7 @@ Thanks @MilosStanic for writing step 18 on angular-material
 
 An example with the `controller as` syntax can be found in [this branch](https://github.com/Urigo/meteor-angular-socially/tree/step_12_controller_as_vm).
 
-# angular-meteor University! <a href="http://angularjs.meteor.com/"><img src="http://angularjs.meteor.com/images/logo-large.png" width="60" height="60" /></a>  
+# angular-meteor University! <a href="http://angularjs.meteor.com/"><img src="http://angular-meteor.com/images/logo.png" /></a>  
 
 The angular-meteor university is a community learning experiment, we would like to create a similar experience to the [hueniversity](https://github.com/hueniverse/hueniversity)
 
-- 
2.3.2 (Apple Git-55)

